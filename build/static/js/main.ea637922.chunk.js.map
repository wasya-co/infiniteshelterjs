{"version":3,"sources":["components/galleries/Galleries.module.scss","components/application/DayNightToggle.module.scss","components/newsitems/Newsitems.module.scss","components/application/PurchaseModal.module.scss","components/application/Application.module.scss","../config/environments/production_ish/config.js","components/cities/Cities.module.scss","resources/markers/Markers.module.scss","components/locations/ItemModal.module.scss","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../../ishlibjs/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../../ishlibjs/node_modules/@ionic/core/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","components/application/UnlockModal.module.scss","components/venues/Venues.module.scss","shared/C.jsx","shared/TwofoldContext.jsx","../../src/shared/C.jsx","../../src/shared/request.jsx","../../src/shared/S.jsx","../../src/shared/TwofoldContext.jsx","../../src/shared/index.jsx","../../src/components/users/AuthWidget.jsx","../../src/components/users/LoginModal.jsx","../../src/components/users/RegisterModal.jsx","../../src/components/users/index.jsx","../../src/TestApp.jsx","../../src/components/users/JwtContext.jsx","../../src/components/users/Scratchpad.jsx","../../src/components/SideMenu/index.jsx","../../src/index.jsx","shared/Api.jsx","components/TwofoldLayout/index.jsx","components/application/BottomDrawer.jsx","components/application/Breadcrumbs.jsx","components/application/DayNightToggle.jsx","components/application/MainHeader.jsx","components/application/MapuiLayout.jsx","components/application/MapuiMobileLayout.jsx","components/application/Menu.jsx","components/application/MenuLeft.jsx","components/application/Metaline.jsx","components/application/PurchaseModal.jsx","components/application/Rating.jsx","components/application/UnlockModal.jsx","components/users/Account.jsx","components/users/MyAccountWidget.jsx","components/users/index.jsx","shared/AppMock.jsx","shared/AppRouter.jsx","shared/Collapsible.jsx","shared/request.jsx","shared/S.jsx","shared/useWindowSize.jsx","shared/index.jsx","components/cities/CitiesList.jsx","components/newsitems/NewsitemGallery.jsx","components/newsitems/NewsitemPhoto.jsx","components/newsitems/NewsitemReport.jsx","components/newsitems/NewsitemVideo.jsx","components/newsitems/Newsitems.jsx","components/Votable/Votable.jsx","components/Votable/index.jsx","components/newsitems/NewsitemContainer.jsx","components/newsitems/ItemIcon.jsx","components/newsitems/index.js","components/venues/Venues.jsx","components/cities/CitiesShow.jsx","components/galleries/GalleriesShow.jsx","components/galleries/MyGalleries.jsx","resources/markers/MarkerModal.jsx","resources/markers/MarkersList.jsx","resources/markers/MarkerForm.jsx","resources/markers/index.jsx","components/locations/GoogleMaps.jsx","resources/reports/ReportsForm.jsx","resources/reports/ReportsShow.jsx","components/locations/ItemModal.jsx","components/locations/LocationsShowDesktop.jsx","components/locations/LocationsShowMobile.jsx","components/3d_locations/Blocker.jsx","components/3d_locations/Crosshair.jsx","components/3d_locations/PointerLockControls.js","components/3d_locations/vendor/RotationPad.js","components/3d_locations/vendor/MovementPad.js","components/3d_locations/vendor/TouchControls.js","components/3d_locations/Equirectangular4.jsx","components/3d_locations/TabiversePlanet.jsx","components/3d_locations/ThreePanelDesktop.jsx","components/3d_locations/ThreePanelMobile.jsx","components/3d_locations/ThreePanelV1.jsx","components/3d_locations/ThreePanelV2.jsx","components/3d_locations/ThreePanelV3.jsx","components/3d_locations/ThreePanelV4.jsx","components/locations/LocationsShowMobile3d.jsx","components/locations/MapPanel.jsx","components/locations/MapPanelNoZoom.jsx","components/locations/RatedRestrictionModal.jsx","components/locations/GoogleMaps2.jsx","components/locations/WrappedMapPanel.jsx","components/locations/ZoomCtrl.jsx","components/sites/Features.jsx","components/sites/SitesShow.jsx","components/sites/SitesShow1.jsx","components/videos/Videos.jsx","AppDesktop.jsx","AppMobile.jsx","AppWrapper.jsx","serviceWorker.js","index.jsx"],"names":["module","exports","appIndexPath","apiOrigin","domain","debug","homePath","requireLogin","stripePublicKey","router","longTermTokenPath","loginPath","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","webpackEmptyAsyncContext","C","actions","new","show","anonUser","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","report","photo","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","Equirectangular","GoogleMaps","MapPanel","MapPanelNoZoom","TabiversePlanet","ThreePanelV1","ThreePanelV4","names","editorMode","rated","nc17","ratedConfirmation","ref","init","loading","theme","themes","dark","light","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","vote_values","up","down","TwofoldContext","React","createContext","TwofoldContextProvider","children","props","_currentUser","currentUser","_setCurrentUser","setCurrentUser","itemToUnlock","setItemToUnlock","layout","setLayout","_showItem","showItem","_setShowItem","setShowItem","toggleTheme","zoom","setZoom","api","useApi","useState","JSON","parse","localStorage","getItem","_setBottomDrawerOpen","mountedRef","useRef","useEffect","current","a","getMyAccount","r","fn","closure","setTimeout","clearTimeout","is_purchasing","_setEditorMode","folded","setFolded","_itemToUnlock","_setItemToUnlock","location","setLocation","loginModalOpen","setLoginModalOpen","mapPanelWidth","setMapPanelWidth","mapPanelHeight","setMapPanelHeight","purchaseModalOpen","setPurchaseModalOpen","_setRatedConfirmation","registerModalOpen","setRegisterModalOpen","tmp","showUrl","setShowUrl","err","logg","setTwofoldPercent","localZoom","setLocalZoom","Provider","value","setBottomDrawerOpen","m","setItem","stringify","setEditorMode","t","setRatedConfirmation","which","scratchpad","axios","S","borderWidth","bottomDrawerClosedHeight","bottomDrawerOpenHeight","breadcrumbsHeight","thinBorderWidth","thinBorderRadius","thinBorder","colors","text","background","blue","darkGrey","lightGrey","red","border","cardBackground","Actions","styled","Btn","CloseBtn","p","style","cursor","onClick","PropTypes","isRequired","_FlexCol","FlexCol","className","FlexRow","b","c","window","console","_Header","ModalHeader","onClose","RegisterWithEmailBtn","LoginWithEmailBtn","IconLogout","w","h","xmlns","width","height","viewBox","enableBackground","d","AuthWidget","useContext","LoginModal","email","setEmail","password","setPassword","doPasswordLogin","toast","Modal","styles","isOpen","overlayClassName","portalClassName","LoginModalPortal","Notice","htmlFor","name","type","onChange","onKeyDown","flexDirection","justifyContent","marginTop","margin","RegisterModal","password2","setPassword2","out","doRegister","AuthContext","AuthContextProvider","_loginModalOpen","_setLoginModalOpen","_registerModalOpen","_setRegisterModalOpen","moreProps","config","TestApp","request","position","JwtContext","JwtContextProvider","resp","object","string","process","ReactDOM","document","token","deleteNewsitem","data","post","user","doUnlock","kind","path","getCities","get","getCity","slug","getGallery","getLocation","getReport","getTag","tag","initPayment","amount_cents","amountCents","postLogin","myVideosPath","applicationHome","params","vote","voter_id","votee_id","votee_class_name","unvote","LongLine","div","orientation","propTypes","Drawer","_Drawer","getLibrary","provider","Web3","Inner0","Inner1","borderHeight","Inner2","WClosed","BottomDrawer","IconButton","aria-label","fontSize","anchor","elevation","open","BackdropProps","invisible","variant","paddingRight","B0","B1","W0","WBreadcrumbs","Breadcrumbs","breadcrumbs","history","useHistory","idx","length","push","key","textDecoration","MenuLeft","arrayOf","shape","DayNightToggle","container","readOnly","checked","sunMoon","dots","stars1","stars2","Header","Root","MainHeader","MapuiContainer","bottomDrawerHeight","MapuiLayout","MapuiMobileLayout","newspaperOutline","bus","person","powerOutline","SideMenu","drawerOpen","setDrawerOpen","top","left","button","bookmarks","W","withRouter","created_at","username","city","tags","pp_date","stripePromise","loadStripe","_PurchaseModal","stripe","useStripe","elements","useElements","setAmountCents","buyUnlocks","event","preventDefault","client_secret","confirmCardPayment","payment_method","card","getElement","CardElement","result","error","message","paymentIntent","status","handle","setInterval","response","clearInterval","setAppElement","LoginModalOverlay","onSubmit","target","disabled","PurchaseModal","Rating","rate","rating","setRating","iconMapping","0","starOutline","1","starHalf","2","star","Array","fill","i","icon","BtnRow","modalStyle","overlay","content","maxWidth","UnlockModal","match","useRouteMatch","item_type","resource_name","inflector","tableize","closable","cost","premium_tier","n_unlocks","isPushNotificationsAvailable","Capacitor","isPluginAvailable","greeterAddress","tokenAddress","PasswordLogin","LoginRow","Account","greeting","setGreetingValue","notifications","setNotifications","setScratchpad","register","PushNotifications","addListener","showToast","alert","_n","n","logg2","ns","nofitication","msg","Toast","requestAccount","ethereum","method","fetchGreeting","ethers","providers","Web3Provider","contract","Contract","Greeter","abi","greet","log","account","Token","balanceOf","balance","toString","signer","getSigner","setGreeting","transaction","wait","transfer","userAccount","amount","transation","checkPermissions","res","receive","requestPermissions","Grid","spacing","item","xs","src","alt","placeholder","setUserAccount","setAmount","to","notif","title","body","color","expand","smallWidth","_Img","Img","_CoinManager","InjectedConnector","CoinManager","MyAccountWidget","avatar","useWeb3React","active","library","connector","activate","deactivate","profile_photo_url","FacebookLogin","Plugins","FACEBOOK_PERMISSIONS","FbLogin","doFbLogin","login","permissions","accessToken","BuyBtn","span","Logout","removeItem","AppRouter","cityVenuesPath","cityPath","Gt","Inner","Label","WTransparent","Collapsible","ctx","CollapsibleContext","setCollapsibles","label","bool","settings","baseURL","create","mediumWidth","lightTheme","cyan","gold","darkTheme","useWindowSize","size","setSize","useLayoutEffect","updateSize","innerWidth","innerHeight","addEventListener","removeEventListener","BackIcon","IonIcon","BackBtn","arrowBack","goBack","ChevronLeft","_ChevronLeft","ChevronRight","_ChevronRight","_Card","_Box","Card","_props","navigateToItem","CollapsibleContextProvider","defaultCollapsibles","descr","_setCollapsibles","classify","slice","ms","split","charAt","toUpperCase","join","toLowerCase","_Circle","Loading","replace","MenuIcon","_MenuIcon","PurchasedIcon","substring","_WBordered","WBordered","_WBorderedItem","WBorderedItem","WidgetContainer","Wrapper","Counts","Count","_IonIcon","Number","Cities","cities","setCities","filteredCities","setFilteredCities","showLoading","setShowLoading","ev","filter","indexOf","trim","funnel","bookmark","n_reports","n_galleries","image","n_videos","videocam","onDidDismiss","duration","Images","Thumb0","Thumb1","_Thumb2","Thumb2","NewsitemGallery","photos","thumb_url","n_photos","array","ImageLarge","img","NewsitemPhoto","large_url","NewsitemReport","NewsitemVideo","display","youtube_id","frameBorder","allow","allowFullScreen","maxHeight","preload","controls","url","W1","_EditModeActions","EditModeActions","confirm","newsitem_id","Newsitems","newsitems","newsitem","IconUp","version","x","y","IconDown","WCount","Votable","votes_score","votesScore","setVotesScore","upFill","setUpFill","downFill","setDownFill","current_user_vote_value","currentUserVoteValue","setCurrentUserVoteValue","Col","_Row","Row","RowInline","Title","h2","boxShadow","NewsitemContainer","is_premium","is_purchased","alignItems","overflowWrap","subhead","dangerouslySetInnerHTML","__html","_Icon","IconGallery","useTheme","IconGem","IconGlasses","IconReport","IconVideo","fillRule","clipRule","_W0","ItemIcon","number","GenericNewsitem","Address","_Ra","RightArrow","Venue","Venues","venues","filteredVenues","setFilteredVenues","venue","includes","address","CitiesShow","thisPath","useLocation","setCity","backgroundImage","hero_img","backgroundSize","pin","pathname","exact","render","GalleriesShow","setGallery","narrow","heading","thumbs","ph","full_img_section","MyGalleries","galleries","setGalleries","g","MarkerModal","MarkerContext","markerModalOpen","setMarkerModalOpen","_Marker","Marker","MarkersList","goto","title_img_path","times","MarkerForm","MarkerContextProvider","marker","setMarker","ReportForm","ReportsShow","ItemModal","useParams","action","locationPath","reportname","ReportsForm","_D","Description","_Handle","Handle","offsetX","setOffsetX","dragging","setDragging","onMouseUp","onMouseMove","clientX","movedBy","movedByPercent","prev","onMouseDown","pageX","onMouseLeave","pointer","IframeModal","ariaHideApp","scrolling","allowtransparency","Left","Right","LocationsShowDesktop","windowWidth","windowHeight","setMarkers","mapPanelRef","offsetWidth","offsetHeight","itemType","item_slug","marginBottom","flexWrap","labels","_Description","LocationsShowMobile","setLoading","map_panel_type","withZoom","_Blocker","Crosshair","_euler","Euler","_vector","Vector3","_changeEvent","_lockEvent","_unlockEvent","_PI_2","Math","PI","PointerLockControls","camera","domElement","undefined","warn","isLocked","minPolarAngle","maxPolarAngle","scope","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","max","min","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","connect","disconnect","dispose","this","getObject","getDirection","direction","v","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","addScaledVector","moveRight","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","RotationPad","eventRepeatTimeout","newLeft","newTop","angle","mouseDown","self","regionData","handleData","rotationPad","region","css","pageY","offset","pow","centerX","centerY","radius","atan2","cos","sin","round","deltaX","parseInt","deltaY","sendEvent","dx","dy","moveEvent","$","Event","detail","bubbles","trigger","update","_Pad","Pad","MovementPad","regionRef","clientWidth","clientHeight","getBoundingClientRect","middle","stopEvent","CustomEvent","onTouchStart","persist","targetTouches","TouchControls","options","speedFactor","delta","rotationFactor","maxPitch","hitTest","hitTestDistance","isRightMouseDown","rotationMatrices","cameraHolder","THREE","add","fpsBody","mouse","calculateCameraRotation","factor","ry","rotation","rx","on","setRotation","enabled","stopPropagation","keyCode","clientY","originalEvent","rotationMatrixF","makeRotationY","rotationMatrixB","rotationMatrixL","rotationMatrixR","prepareRotationMatrices","prototype","addToScene","scene","setPosition","z","set","stopMouseMoving","getHitObjects","hitObjects","Blocker","Equirectangular2","renderer","texture","markerObjects","blockerRef","wContainerRef","instructionsRef","fog","moveLeft","moveBackward","canJump","velocity","axes","wContainer","floorGeometry","rotateX","loadTexture","wrapS","wrapT","repeat","floorMaterial","floor","textureLoader","assetPath","img_path","load","rt","fromEquirectangularTexture","antialias","setPixelRatio","devicePixelRatio","appendChild","onWindowResize","animate","prevTime","performance","now","canvas","needResize","resizeRendererToDisplaySize","aspect","updateProjectionMatrix","requestAnimationFrame","time","cameraDirection","clone","intersections","intersectObjects","onObject","normalize","geometry","material","planet","Loc","loader","asset3d_path","gltf","worldOctree","fromGraphNode","traverse","child","isMesh","castShadow","receiveShadow","anisotropy","GLTFLoader","Octree","abs","translateX","raycaster","objects","attributes","l","count","vertex","fromBufferAttribute","random","setXYZ","toNonIndexed","colorsFloor","setHSL","setAttribute","vertexColors","manager","scale","onProgress","loaded","total","OBJLoader","obj","xhr","lengthComputable","percentComplete","cube","ray","origin","markerObjectsIdxs","pMat","uniforms","main_color","border_color","thickness","opacity","center","vertexShader","fragmentShader","texturePath","modelPath","modelPath2","onError","mtlLoader","MTLLoader","setPath","materials","objLoader","setMaterials","uuid","Location","clock","directionalLight","fillLight1","plc","sphereGeometry","sphereMaterial","spheres","sphereIdx","playerCollider","Capsule","playerVelocity","playerDirection","playerOnFloor","mouseTime","keyStates","vector1","vector2","vector3","order","shadow","near","far","right","bottom","mapSize","bias","sphere","mesh","collider","shadowMap","outputEncoding","toneMapping","getWorldDirection","end","impulse","exp","multiplyScalar","throwBall","updateSpheres","deltaTime","forEach","sphereIntersect","normal","dot","depth","damping","addVectors","start","sphere_center","r2","point","d2","distanceToSquared","subVectors","v1","v2","sub","sqrt","playerSphereCollision","s1","j","s2","spheresCollisions","getForwardVector","getSideVector","cross","updatePlayer","deltaPosition","translate","capsuleIntersect","playerCollisions","speedDelta","getDelta","modelName","wrappedOnLoad","LocationsShowMobile3d","ThreePanelMobile","Div1","ZoomCtrl","zIndex","padding","div1Ref","scroll","behavior","centerOffsetY","centerOffsetX","nextZoomByWidth","nextZoomByHeight","nextZoom","RatedRestrictionModal","Map","onIdle","setMap","google","maps","useDeepCompareEffectForMaps","setOptions","eventName","clearListeners","useDeepCompareMemoize","callback","dependencies","App","clicks","setClicks","lat","lng","setCenter","form","flexBasis","overflow","latLng","toJSON","apiKey","getZoom","getCenter","flexGrow","WrappedMapPanel","forwardRef","Equirectangular4","ThreePanelV2","ThreePanelV3","ThreePanelDesktop","Features","features","f","inner_html","sm","SitesShow","site","setSite","SitesShow1","artTag","homeRow1Tag","interestingLocationsTag","useStyles","makeStyles","paper","textAlign","palette","secondary","redBorder","root","VideoItem","Video","video_url","Videos","videos","setVideos","jwtToken","classes","AppDesktop","Container","Route","main","from","component","CitiesList","__Container","_Container","AppMobile","paddingBottom","AppWrapper","os","setOs","Device","getInfo","info","operatingSystem","setTheme","childProps","Boolean","hostname","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"uGACAA,EAAOC,QAAU,CAAC,cAAgB,iCAAiC,QAAU,2BAA2B,MAAQ,yBAAyB,OAAS,0BAA0B,OAAS,0BAA0B,KAAO,wBAAwB,iBAAmB,oCAAoC,KAAO,0B,oBCA5SD,EAAOC,QAAU,CAAC,UAAY,kCAAkC,OAAS,+BAA+B,KAAO,6BAA6B,WAAa,mCAAmC,OAAS,+BAA+B,OAAS,+BAA+B,QAAU,gCAAgC,KAAO,+B,oBCA7TD,EAAOC,QAAU,CAAC,KAAO,wBAAwB,UAAY,6BAA6B,SAAW,4BAA4B,UAAY,6BAA6B,MAAQ,yBAAyB,MAAQ,yBAAyB,gBAAgB,iCAAiC,SAAW,4BAA4B,YAAc,+BAA+B,gBAAgB,iCAAiC,YAAY,6BAA6B,YAAY,6BAA6B,YAAY,6BAA6B,YAAY,6BAA6B,aAAa,8BAA8B,OAAS,4B,oBCA1nBD,EAAOC,QAAU,CAAC,WAAa,kCAAkC,kBAAoB,yCAAyC,OAAS,gC,oBCAvID,EAAOC,QAAU,CAAC,aAAa,gCAAgC,SAAW,8BAA8B,KAAO,0BAA0B,KAAO,0BAA0B,KAAO,0BAA0B,OAAS,4BAA4B,MAAQ,6B,mtnBCAxPD,EAAOC,QAAU,CACfC,aAAc,YACdC,UAAW,+BACXC,OAAQ,mBACRC,OAAO,EACPC,SAAU,0BACVC,cAAc,EACdC,gBAAiB,mCAGjBC,OAAQ,CACNC,kBAAmB,6BACnBC,UAAW,sB,oBCZfX,EAAOC,QAAU,CAAC,OAAS,uBAAuB,QAAU,wBAAwB,YAAY,0BAA0B,iBAAiB,+BAA+B,eAAe,6BAA6B,cAAc,4BAA4B,mBAAmB,iCAAiC,gBAAgB,8BAA8B,UAAY,0BAA0B,cAAc,4BAA4B,WAAW,yBAAyB,aAAa,2BAA2B,SAAW,yBAAyB,gBAAgB,8BAA8B,OAAS,uBAAuB,OAAS,uBAAuB,MAAQ,sBAAsB,cAAc,4BAA4B,SAAW,yBAAyB,OAAS,uBAAuB,cAAc,4BAA4B,QAAU,wBAAwB,IAAM,oBAAoB,iBAAiB,+BAA+B,IAAM,oBAAoB,YAAY,0BAA0B,YAAY,0BAA0B,aAAa,2BAA2B,OAAS,uBAAuB,YAAY,0BAA0B,gBAAgB,8BAA8B,cAAc,4BAA4B,SAAW,yBAAyB,cAAc,4BAA4B,eAAe,+B,6+zDCA3zCD,EAAOC,QAAU,CAAC,YAAc,6BAA6B,mBAAqB,sC,oBCAlFD,EAAOC,QAAU,CAAC,UAAY,6BAA6B,aAAa,gC,0DCDxE,IAAIW,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,E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","file":"static/js/main.ea637922.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"GalleriesShow\":\"Galleries_GalleriesShow__eB0J9\",\"heading\":\"Galleries_heading__i_svo\",\"title\":\"Galleries_title__3tmwS\",\"narrow\":\"Galleries_narrow__1LN1G\",\"thumbs\":\"Galleries_thumbs__bq4Ur\",\"card\":\"Galleries_card__vP3-g\",\"full_img_section\":\"Galleries_full_img_section__1V5cq\",\"item\":\"Galleries_item__3uUTi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"DayNightToggle_container__3SXTK\",\"switch\":\"DayNightToggle_switch__2IqQw\",\"fill\":\"DayNightToggle_fill__Bgb5K\",\"background\":\"DayNightToggle_background__3k8xs\",\"stars1\":\"DayNightToggle_stars1__tkZmJ\",\"stars2\":\"DayNightToggle_stars2__3Bruk\",\"sunMoon\":\"DayNightToggle_sunMoon__12mN8\",\"dots\":\"DayNightToggle_dots__2ECIQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"Newsitems_icon__2m8Yx\",\"Newsitems\":\"Newsitems_Newsitems__28DCM\",\"Newsitem\":\"Newsitems_Newsitem__1YV1X\",\"newsitems\":\"Newsitems_newsitems__2__cT\",\"items\":\"Newsitems_items__1vDXi\",\"image\":\"Newsitems_image__XooGU\",\"title-heading\":\"Newsitems_title-heading__3SnV-\",\"routable\":\"Newsitems_routable__3F6RC\",\"description\":\"Newsitems_description__Quuc5\",\"image-section\":\"Newsitems_image-section__3_ISy\",\"play-icon\":\"Newsitems_play-icon__2n6oc\",\"premium-0\":\"Newsitems_premium-0__2W-9I\",\"premium-1\":\"Newsitems_premium-1__1sKSC\",\"premium-2\":\"Newsitems_premium-2__1e7dc\",\"image-item\":\"Newsitems_image-item__JlSoP\",\"number\":\"Newsitems_number__WsUI_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LoginModal\":\"PurchaseModal_LoginModal__XwjI2\",\"LoginModalOverlay\":\"PurchaseModal_LoginModalOverlay__2J_Pd\",\"Notice\":\"PurchaseModal_Notice__3s00H\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item-inner\":\"Application_item-inner__3N6Hp\",\"metaline\":\"Application_metaline__3gOIl\",\"user\":\"Application_user__1xsl8\",\"city\":\"Application_city__1DWKA\",\"tags\":\"Application_tags__1G31y\",\"rating\":\"Application_rating__1H0OR\",\"stars\":\"Application_stars__3Lbga\"};","\nmodule.exports = {\n  appIndexPath: \"src/index\", // used in webpack\n  apiOrigin: \"https://manager.piousbox.com\",\n  domain: \"tgm.piousbox.com\", // required! 2021-08-31\n  debug: false,\n  homePath: \"/en/locations/show/root\",\n  requireLogin: false,\n  stripePublicKey: 'pk_live_xQX97vdZNe11A3HBVZc1GX6H',\n\n  // This router isn't used. _vp_ 2022-09-04\n  router: {\n    longTermTokenPath: '/api/users/long_term_token',\n    loginPath: '/api/users/login',\n  },\n}\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cities\":\"Cities_cities__2jyZa\",\"heading\":\"Cities_heading__1Y4L0\",\"city-show\":\"Cities_city-show__3p8O5\",\"filter-section\":\"Cities_filter-section__QkWYj\",\"filter-input\":\"Cities_filter-input__2qrNk\",\"filter-icon\":\"Cities_filter-icon__2RFrY\",\"bookmark-section\":\"Cities_bookmark-section__WbPmK\",\"bookmark-text\":\"Cities_bookmark-text__3pldy\",\"container\":\"Cities_container__pdWN1\",\"img-section\":\"Cities_img-section__2XiwK\",\"city-img\":\"Cities_city-img__JuCos\",\"city-title\":\"Cities_city-title__39j3v\",\"bookmark\":\"Cities_bookmark__5911O\",\"bookmark-icon\":\"Cities_bookmark-icon__25eUJ\",\"switch\":\"Cities_switch__2FFHz\",\"slider\":\"Cities_slider__2HQAT\",\"round\":\"Cities_round__NaUgd\",\"section-one\":\"Cities_section-one__2Ual1\",\"location\":\"Cities_location__2PNVH\",\"status\":\"Cities_status__1Joy3\",\"status-grid\":\"Cities_status-grid__E_QYt\",\"numbers\":\"Cities_numbers__3AaL3\",\"mid\":\"Cities_mid__-Ei45\",\"tags-container\":\"Cities_tags-container__1O8GT\",\"btn\":\"Cities_btn__3AZfF\",\"city-name\":\"Cities_city-name__2cKBL\",\"menu-item\":\"Cities_menu-item__LuXCf\",\"delete-btn\":\"Cities_delete-btn__3a5p9\",\"random\":\"Cities_random__8loYT\",\"info-icon\":\"Cities_info-icon__3crMF\",\"section-three\":\"Cities_section-three__3wkyz\",\"menu-option\":\"Cities_menu-option__3NgIq\",\"selected\":\"Cities_selected__3LwuR\",\"section-two\":\"Cities_section-two__SNgaW\",\"tags-section\":\"Cities_tags-section__k90Gs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MarkerModal\":\"Markers_MarkerModal__3oYjU\",\"MarkerModalOverlay\":\"Markers_MarkerModalOverlay__2qeYq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ItemModal\":\"ItemModal_ItemModal__n2Ttj\",\"plt-mobile\":\"ItemModal_plt-mobile__2YguR\"};","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t940,\n\t\t6\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t941,\n\t\t7\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t942,\n\t\t8\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t943,\n\t\t18\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t944,\n\t\t19\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t945,\n\t\t47\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t946,\n\t\t20\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t947,\n\t\t21\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t948,\n\t\t22\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t949,\n\t\t23\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t950,\n\t\t48\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t951,\n\t\t11\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t952,\n\t\t24\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t953,\n\t\t49\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t954,\n\t\t50\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t955,\n\t\t25\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t956,\n\t\t26\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t957,\n\t\t27\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t958,\n\t\t28\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t959,\n\t\t29\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t960,\n\t\t9\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t961,\n\t\t15\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t962,\n\t\t10\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t963,\n\t\t30\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t964,\n\t\t31\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t965,\n\t\t32\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t966,\n\t\t12\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t967,\n\t\t17\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t968,\n\t\t51\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t969,\n\t\t33\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t970,\n\t\t34\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t971,\n\t\t35\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t972,\n\t\t36\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t973,\n\t\t52\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t974,\n\t\t14\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t975,\n\t\t53\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t976,\n\t\t37\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t977,\n\t\t16\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t978,\n\t\t38\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t979,\n\t\t39\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t980,\n\t\t40\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t981,\n\t\t13\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t982,\n\t\t54\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 495;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t983,\n\t\t61\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 497;\nmodule.exports = webpackAsyncContext;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 528;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 529;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ReactModal__Overlay\":\"UnlockModal_ReactModal__Overlay__1d8v7\",\"ReactModal__Overlay--after-open\":\"UnlockModal_ReactModal__Overlay--after-open__SJ6oC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"venues-section\":\"Venues_venues-section__1Cg8m\",\"filter-section\":\"Venues_filter-section__3uQ4r\",\"filter-input\":\"Venues_filter-input__2ykRc\",\"filter-icon\":\"Venues_filter-icon__3VaeF\",\"container\":\"Venues_container__2SioC\",\"venues\":\"Venues_venues__3j85M\",\"info-section\":\"Venues_info-section__1E-6x\",\"reviews\":\"Venues_reviews__1Bh8Y\",\"description\":\"Venues_description__2oWIo\",\"tags\":\"Venues_tags__eZTOS\",\"forward-arrow\":\"Venues_forward-arrow__38w3n\",\"image-section\":\"Venues_image-section__gaKYX\"};","\n/**\n * Constants\n */\nconst C = {\n\n  // A\n  actions: { // CRUD\n    new: 'new',\n    show: 'show',\n  },\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    photo: 'Photo',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    GoogleMaps: \"GoogleMaps\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    TabiversePlanet: \"TabiversePlanet\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: { // for localStorage\n    editorMode: 'editorMode',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n  ref: {\n    init: 'init',\n    loading: 'loading',\n  },\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n  vote_values: {\n    up: 'up',\n    down: 'down',\n  },\n}\nexport default C\n","\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useEffect, useRef, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  C,\n  logg,\n  request,\n  useApi,\n} from \"$shared\"\n\n/**\n * ishjs has a newer version of this. _vp_ 2022-03-05\n*/\nconst TwofoldContext = React.createContext({})\nconst TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  let {\n    currentUser: _currentUser, setCurrentUser: _setCurrentUser, // for testing only. _vp_ 2022-03-18\n    itemToUnlock, setItemToUnlock,\n    layout, setLayout,\n    showItem: _showItem, setShowItem: _setShowItem,\n    theme, toggleTheme,\n    zoom, setZoom, // it's a prop for testing only. _vp_ 2022-03-18\n  } = props\n\n  const api = useApi()\n\n  /* B */\n\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n\n  /* C */\n  let [ currentUser, setCurrentUser ] = useState(C.anonUser)\n  if (_setCurrentUser) {\n    [ currentUser, setCurrentUser ] = [ _currentUser, _setCurrentUser ]\n  }\n\n  /* Get the current_user on load */\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    if (!mountedRef.current) { return } // @TODO: hmmm do I need this?\n\n    const fn = async () => {\n      const r = await api.getMyAccount()\n      setCurrentUser(r)\n    }\n    fn()\n\n    return () => mountedRef.current = null\n  }, [currentUser])\n\n  // Refresh current_user if is_purchasing\n  useEffect(() => {\n    let closure = setTimeout(() => {\n\n      const fn = async () => {\n        const r = await api.getMyAccount()\n        setCurrentUser(r)\n      }\n      fn()\n\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* E */\n  const [ editorMode, _setEditorMode ] = useState(JSON.parse(localStorage.getItem(C.names.editorMode)))\n  const setEditorMode = (t) => {\n    localStorage.setItem(C.names.editorMode, t)\n    _setEditorMode(t)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ _itemToUnlock, _setItemToUnlock ] = useState({})\n  if (!itemToUnlock) {\n    itemToUnlock = _itemToUnlock\n    setItemToUnlock = _setItemToUnlock\n  }\n  /* why is this here? remove. _vp_ 2022-03-18 */\n  // const setItemToUnlock = (item) => {\n  //   if (itemToUnlock.id !== item.id && !loginModalOpen) {\n  //     _setItemToUnlock(item)\n  //   }\n  // }\n\n  /* L */\n  const [ location, setLocation ] = useState(null)\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalOpen, setPurchaseModalOpen ] = useState(false)\n\n  /* R */\n\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n\n  /* S */\n  let [ showItem, setShowItem ] = useState(false)\n  if (!!_setShowItem) { setShowItem = _setShowItem }\n  if (!!_showItem) { showItem = _showItem }\n\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ localZoom, setLocalZoom ] = useState(1)\n  if (!zoom) {\n    zoom = localZoom\n    setZoom = setLocalZoom\n  }\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser,\n\n    editorMode, setEditorMode,\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    location, setLocation,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalOpen, setPurchaseModalOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n    registerModalOpen, setRegisterModalOpen,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\n\nexport default TwofoldContext\nexport {\n  TwofoldContextProvider,\n}\n","\n/**\n * Constants\n *\n * * C.anonUser\n * * C.current_user\n * * C.jwt_token\n * * C.item_types\n *\n */\nconst C = {\n\n  // A\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: {\n    scratchpad: 'Scratchpad',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","\nimport axios from \"axios\"\n\n/*\nimport config from \"config\"\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings)\n*/\n\nexport default axios.create({})\n","\n/**\n * Style Constants\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    blue: '#6aa3e9',\n    darkGrey: '#605d5d',\n    lightGrey: '#988b8b',\n    red: 'red',\n    border: 'black',\n    cardBackground: 'white'\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    blue: '#73b0fa',\n    darkGrey: '#b3afaf',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n    border: 'white',\n    cardBackground: '#1a1a1a'\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}","\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\n\nimport {\n  C,\n } from \"$shared\"\n\nconst TwofoldContext = React.createContext({})\nconst TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n    theme, toggleTheme, // @TODO: Theme is not part of TwofoldContext! _vp_ 2022-09-04\n  } = props\n\n  const api = useApi()\n\n  useEffect(() => {\n    let closure = setTimeout(async () => {\n      const result = await api.getMyAccount()\n      setCurrentUser(result)\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch?\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalIsOpen, setPurchaseModalIsOpen ] = useState(false)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalIsOpen, setPurchaseModalIsOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\nTwofoldContextProvider.propTypes = {} // none so far\n\nexport {\n  TwofoldContext,\n  TwofoldContextProvider,\n}\n// Is is better to have, or not have, this default export? _vp_ 2022-09-04\nexport default TwofoldContextProvider\n\n","/*\n *  $shared / index\n */\nimport { arrowBack, closeOutline, } from 'ionicons/icons'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport {\n  ChevronLeft as _ChevronLeft,\n  ChevronRight as _ChevronRight,\n  Close as _Close,\n  Menu as _MenuIcon,\n} from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\nimport {\n  Route as _Route, useHistory,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport C from './C'\n\n/* A */\n\nconst Actions = styled.div`\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n`;\nexport { Actions }\n\n/* B */\n\n/**\n * Back Button\n */\n// const BackIcon = styled(IonIcon)\n// @TODO: reintroduce IonIcon maybe?\nconst BackIcon = styled.div`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n`;\n\n\n/* C */\nexport { default as C } from './C'\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * CloseBtn\n**/\nexport const CloseBtn = ({ children, ...props }) => {\n  return <_Close style={{ cursor: 'pointer', ...props.style }} {...props} />\n};\nCloseBtn.propTypes = {\n  onClick: PropTypes.func.isRequired,\n}\n\n/* D */\n\n/* F */\n\n/**\n * FlexCol\n**/\nconst _FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n`;\nexport const FlexCol = ({ children, ...props }) => <_FlexCol className=\"FlexCol\" {...props} >{children}</_FlexCol>\n\n/**\n * FlexRow\n**/\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n`;\n\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0 && typeof window !== \"undefined\") {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n\nconst _Header = styled.div`\n  flex-grow: 1;\n  text-align: center;\n  font-size: 1.2rem;\n`;\nexport const ModalHeader = ({ children, onClose, ...props }) => {\n  return <FlexRow >\n    <_Header>{children}</_Header>\n    <CloseBtn onClick={onClose} />\n  </FlexRow>\n}\nModalHeader.propTypes = {\n  onClose: PropTypes.func.isRequired,\n}\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport { TwofoldContext, TwofoldContextProvider } from './TwofoldContext'\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n * Used in collapsibles and MarkersList\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","\nimport React, { Fragment as F, useContext, } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext, AuthContextProvider,\n  FacebookLogin,\n  LoginModal, LoginWithEmail,\n  RegisterModal, RegisterWithEmail,\n} from \"$components/users\"\n\nimport {\n  Btn,\n  C,\n  FlexCol, FlexRow,\n  logg,\n} from \"$shared\"\n\n\nconst RegisterWithEmailBtn = (props) => {\n  return <Btn {...props} >Register with Email</Btn>\n}\nconst LoginWithEmailBtn = (props) => {\n  return <Btn {...props} >Login with Email</Btn>\n}\n\nconst IconLogout = ({ fill, w, h, ...props }) => {\n  // const theme = useTheme()\n\n  w = w ? w : '12px'\n  h = h ? h : '12px'\n  // fill = fill ? fill : theme.colors.text // @TODO: implement theme in ishlibjs\n  fill = fill ? fill : '#333333'\n\n  return <span {...props} >\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h}\n      viewBox=\"0 0 96.943 96.943\" style={{ enableBackground: 'new 0 0 96.943 96.943' }}\n    ><g><g><path d=\"M61.168,83.92H11.364V13.025H61.17c1.104,0,2-0.896,2-2V3.66c0-1.104-0.896-2-2-2H2c-1.104,0-2,0.896-2,2v89.623 c0,1.104,0.896,2,2,2h59.168c1.105,0,2-0.896,2-2V85.92C63.168,84.814,62.274,83.92,61.168,83.92z\"/> <path d=\"M96.355,47.058l-26.922-26.92c-0.75-0.751-2.078-0.75-2.828,0l-6.387,6.388c-0.781,0.781-0.781,2.047,0,2.828 l12.16,12.162H19.737c-1.104,0-2,0.896-2,2v9.912c0,1.104,0.896,2,2,2h52.644L60.221,67.59c-0.781,0.781-0.781,2.047,0,2.828 l6.387,6.389c0.375,0.375,0.885,0.586,1.414,0.586c0.531,0,1.039-0.211,1.414-0.586l26.922-26.92 c0.375-0.375,0.586-0.885,0.586-1.414C96.943,47.941,96.73,47.433,96.355,47.058z\"/> </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g></g><g></g><g></g>\n    </svg>\n  </span>\n}\n\n/**\n * If user is logged in, display the email/handle and allow logout.\n * If user is not logged in, allow registration and login via Fb, and email+passwd.\n *\n * @TODO: doesn't seem like this belongs in ishlibjs _vp_ 2022-09-04\n**/\nconst AuthWidget = (props) => {\n  // logg(props, 'AuthWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    doLogout: _doLogout,\n    setLoginModalOpen,\n    setRegisterModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'AuthWidgetUsedAuthContext')\n\n  // @TODO: doesn't belong here. Should be injected from the host. _vp_ 2022-09-04\n  const doLogout = () => {\n    setCurrentUser(C.anonUser)\n    localStorage.removeItem('jwt_token')\n    window.location.reload(false)\n  }\n\n  if (currentUser?.email) {\n    return <FlexRow>\n      [&nbsp;{currentUser.email}&nbsp;<IconLogout onClick={doLogout} >Logout</IconLogout>&nbsp;]\n    </FlexRow>\n  }\n\n  return <F>\n    <FlexCol>\n      {/* <FacebookLogin /> */}\n      <RegisterWithEmailBtn onClick={() => { setRegisterModalOpen(true) }} />\n      <LoginWithEmailBtn    onClick={() => { setLoginModalOpen(true) }} />\n    </FlexCol>\n\n    <RegisterModal />\n    <LoginModal />\n\n  </F>\n}\nAuthWidget.propTypes = {} // none so far\n\nexport default AuthWidget\n","\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n  ModalHeader,\n  request,\n} from \"$shared\"\nimport {\n  AuthContext, AuthContextProvider,\n} from './'\n\nimport styles from './LoginModal.module.scss'\n\n/**\n * LoginModal\n**/\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal, ishlibjs')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LoginModalUsedAuthContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const api = useApi()\n\n  // @TODO: this should be injected, right? _vp_ 2022-09-04\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((r) => {\n      setLoginModalOpen(false)\n      window.location.reload(false)\n    }).catch((err) => {\n      logg(err, 'e323 - cannot postLogin()')\n      // setCurrentUser(C.anonUser)\n      toast(\"Could not login.\")\n    })\n  }\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={!!loginModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => setLoginModalOpen(false)} >Login</ModalHeader>\n    { 'string' === typeof loginModalOpen && <FlexRow>\n      <div className={styles.Notice} >{ loginModalOpen }</div>\n    </FlexRow> }\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input name='email' type='email' value={email} onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input name='password' type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n        onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n      />\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n      </FlexRow>\n    </FlexCol>\n    <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n    <FlexRow style={{ justifyContent: 'center' }} >\n      <a onClick={() => setLoginModalOpen(false) || setRegisterModalOpen(true) }>Register Instead</a>\n    </FlexRow>\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport React, { useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  ModalHeader,\n  logg,\n} from '$shared'\nimport {\n  AuthContext,\n} from '$components/users'\n\nimport styles from './LoginModal.module.scss'\n\n\n/**\n * RegisterModal\n *\n * Uses LoginModal styling\n**/\nconst RegisterModal = (props) => {\n  // logg(props, 'RegisterModal')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'registerModalUsedContext')\n\n  const api = useApi()\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const [ password2, setPassword2 ] = useState('')\n\n  const doRegister = async (email, password, password2) => {\n    if (password !== password2) {\n      toast('Passwords do not match')\n      return\n    }\n    const out = api.doRegister({ email, password })\n\n    out.then((r) => {\n      setRegisterModalOpen(false)\n      setLoginModalOpen(r.message)\n    }).catch((e) => {\n      toast(\"Registration failed\")\n    })\n  }\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={registerModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => setRegisterModalOpen(false)} >Register</ModalHeader>\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input type='email'    name='email'     value={email}    onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input type='password' name='password'  value={password} onChange={(e) => setPassword(e.target.value) } />\n\n      <label htmlFor='password2'>Confirm Password</label>\n      <input type='password' name='password2' value={password2} onChange={(e) => setPassword2(e.target.value) } />\n\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn className=\"Submit\" onClick={() => doRegister(email, password, password2) }>Register</Btn>\n      </FlexRow>\n      <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n      <FlexRow style={{ justifyContent: 'center' }} >\n        <a onClick={() => setLoginModalOpen(true) || setRegisterModalOpen(false) }>Login Instead</a>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\nRegisterModal.propTypes = {} // None so far\n\nexport default RegisterModal\n","\nimport { Plugins } from '@capacitor/core'\nimport React, { createContext, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\n/* A */\nconst AuthContext = createContext({})\nconst AuthContextProvider = ({children, ...props }) => {\n  // logg(props, 'AuthContextProvider')\n  let {\n    currentUser: _currentUser = C.anonUser, setCurrentUser: _setCurrentUser,\n    loginModalOpen: _loginModalOpen = false, setLoginModalOpen: _setLoginModalOpen,\n    registerModalOpen: _registerModalOpen = false, setRegisterModalOpen: _setRegisterModalOpen,\n  } = props\n\n  let [ currentUser, setCurrentUser ] = useState(_currentUser)\n  if (_setCurrentUser) {\n    currentUser = _currentUser\n    setCurrentUser = _setCurrentUser\n  }\n\n  let [ loginModalOpen, setLoginModalOpen ] = useState(_loginModalOpen)\n  if (_setLoginModalOpen) {\n    loginModalOpen = _loginModalOpen\n    setLoginModalOpen = _setLoginModalOpen\n  }\n\n  let [ registerModalOpen, setRegisterModalOpen ] = useState(_registerModalOpen)\n  if (_setRegisterModalOpen) {\n    registerModalOpen = _registerModalOpen\n    setRegisterModalOpen = _setRegisterModalOpen\n  }\n\n  const moreProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n  }\n\n  //\n  // props.useApi isRequired\n  //\n  return <AuthContext.Provider value={{ ...props, ...moreProps }} >\n    { children }\n  </AuthContext.Provider>\n}\nAuthContextProvider.propTypes = {\n  useApi: PropTypes.func.isRequired,\n}\n\nexport {\n  AuthContext, AuthContextProvider,\n}\nexport { default as AuthWidget } from './AuthWidget'\n\n/* F */\nconst { FacebookLogin: _FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\n/* J */\n\n\n\n/* L */\nexport { default as LoginModal } from \"./LoginModal\"\n\n/* R */\nexport { default as RegisterModal } from \"./RegisterModal\"\n\n\n","\nimport React, { useState, } from 'react'\nimport { toast, ToastContainer } from 'react-toastify'\n\n// import 'react-toastify/dist/ReactToastify.css' // @TODO: re-add somehow nicer.\n\nimport {\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthWidget,\n  AuthContextProvider,\n  LoginModal,\n } from './components/users'\n\nconst config = {\n  apiOrigin: 'http://localhost:3001',\n}\n\nconst TestApp = () => {\n\n  const useApi = () => ({\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users`, { email, password }).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n  })\n\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false) // useState(\"Please login!\")\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(true) // useState(\"Please register\")\n\n  return <AuthContextProvider {...{\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  }} >\n\n    {/* <LoginModal /> */}\n    <AuthWidget />\n\n    <ToastContainer position=\"bottom-left\" />\n  </AuthContextProvider>\n}\nexport default TestApp\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport { toast } from 'react-toastify'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from \"$shared\"\n\nexport const JwtContext = React.createContext({})\n\n/**\n * JwtContextProvider\n**/\nconst JwtContextProvider = ({ children, ...props }) => {\n  logg(props, 'JwtContextProvider 222')\n  const {\n    api,\n  } = props\n\n  // const maybeUser = JSON.parse(localStorage.getItem(C.current_user)) || C.anonUser\n  const [ currentUser, setCurrentUser ] = useState(C.anonUser)\n  const [ loginModalOpen, setLoginModalOpen ] = useState({})\n\n  // call to verify creds\n  useEffect(() => {\n    logg('setting currentUser...')\n\n    // request.get(`${config.apiOrigin}${config.routes.myAccountPath}`).then((r) => r.data).then((resp) => {\n    api.getMyAccount().then((resp) => {\n      logg(resp, 'got this resp')\n\n      // localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(`Login failed: ${e}`)\n      setCurrentUser(C.anonUser)\n      // localStorage.removeItem(C.current_user)\n      // localStorage.removeItem(C.jwt_token)\n    })\n  }, [])\n\n  return <JwtContext.Provider value={{\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }} >{ children }</JwtContext.Provider>\n}\nJwtContextProvider.props = {\n  api: PropTypes.object,\n}\nexport { JwtContextProvider }\n\n// @TODO: move to shared?\nconst FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst W1 = styled.div`\n  border: 1px solid red;\n`;\n\nconst W2 = styled.div`\n  display: flex;\n`;\n\nexport const SimpleJwtRow = () => {\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  // logg(useContext(JwtContext), 'SimpleJwtRowUsedJwtContext')\n\n  return <W1>\n    <FlexRow>\n      { /* <FbLogin /> */ }\n      { currentUser.email && <W2>\n        <i>{currentUser.email}</i>\n        <Logout />\n      </W2>}\n      { !currentUser.email && <LoginWithPassword /> }\n    </FlexRow>\n  </W1>\n}\n\n\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n// // @TODO: is this obsolete and unused?\n// // _vp_ 2022-09-01\n// export const LoginWithPassword = (props) => {\n//   // logg(useContext(JwtContext), 'useContext(JwtContext)')\n//   const {\n//     api,\n//     currentUser, setCurrentUser,\n//     loginModalOpen, setLoginModalOpen,\n//   } = useContext(JwtContext)\n//   const [ email, setEmail ] = useState('')\n//   const [ password, setPassword ] = useState('')\n//   const doPasswordLogin = async (email, password) => {\n//     // logg(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, 'doPasswordLogin')\n//     // request.post(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, { email, password }).then((r) => r.data\n//     api.postLoginWithPassword({ email, password }).then((resp) => {\n//       localStorage.setItem(C.jwt_token, resp.jwt_token)\n//       // localStorage.setItem(C.current_user, JSON.stringify(resp))\n//       setCurrentUser(resp) // must be done *after* setting C.jwt_token\n//       setLoginModalOpen(false)\n//     }).catch((e) => {\n//       logg(e, 'e322')\n//       // toast(\"Login failed\")\n//       setCurrentUser(C.anonUser)\n//     })\n//   }\n//   return <_W>\n//     <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n//     <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n//       onKeyDown={(e) => {\n//         if (e.key === 'Enter') { doPasswordLogin(email, password) }\n//       }}\n//     />\n//     <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n//   </_W>\n// }\n\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(JwtContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    // localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n","\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n} from '$components/users'\nimport {\n  Actions,\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nconst W0 = styled.div`\n`;\n\n\n/**\n * A single text area that saves locally and in the cloud.\n */\nconst Scratchpad = (props) => {\n  // logg(props, 'Scratchpad')\n\n  const {\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const [ txt, setTxt ] = useState(localStorage.getItem(C.names.scratchpad) || '')\n\n  const doSave = () => {\n    localStorage.setItem(C.names.scratchpad, txt)\n    api.postProfile({ scratchpad: txt }).then((data) => {\n      // toast('Updated profile.')\n    }).catch((err) => {\n      logg('Cannot update profile:', err)\n      // toast('e54 - Cannot update profile.')\n    })\n  }\n\n  return <W0>\n    <textarea name='scratchpad' rows='20' cols='40'\n      onChange={(e) => setTxt(e.target.value) }\n      value={txt}\n    / >\n    <Actions>\n      <Btn onClick={doSave}>Save</Btn>\n    </Actions>\n  </W0>\n}\nScratchpad.propTypes = {\n  // none so far\n}\n\nexport default Scratchpad\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = ({ children, ...props }) => {\n  const { listItems } = props\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em', zIndex: 1 }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          { listItems.map( ({ label, key, path }) => <ListItem button key={key}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(path())\n            } } >{ label }\n          </ListItem> )}\n\n        </List>\n\n        { children }\n      </W0>\n    </Drawer>\n\n  </F>\n}\n\nSideMenu.propTypes = {\n  listItems: PropTypes.array.isRequired, // @TODO: specify: key, label, path\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport {\n  logg,\n} from \"./shared\"\nimport TestApp from './TestApp'\n\n// @TODO: rename\nimport * as jwtManager from './components/users/JwtContext' // this syntax is correct\n\n/* A */\nexport { Actions, } from './shared'\nexport { AuthContext, AuthContextProvider, } from './components/users'\nexport { default as AuthWidget } from \"./components/users/AuthWidget\"\n\n/* C */\nexport { CloseBtn } from './shared'\n\n/* F */\nexport { FlexCol, FlexRow } from \"./shared\"\n\n/* J */\nexport { jwtManager }\n\n/* L */\nexport { logg }\nexport { LoginModal } from './components/users'\n\n/* M */\nexport { ModalHeader } from './shared'\n\n/* P */\n\n/* R */\nexport { RegisterModal } from './components/users'\n\n/* S */\nexport { default as Scratchpad } from \"./components/users/Scratchpad\"\nexport { default as SideMenu } from './components/SideMenu'\n\nif (process.env.REACT_APP_SERVE) {\n  ReactDOM.render(<TestApp />, document.getElementById('root'))\n}\n","import React, { useContext } from 'react'\n\nimport config from \"config\"\nimport {\n  AuthContext,\n} from 'ishlibjs'\n\nimport {\n  C,\n  logg, // eslint-disable-line no-unused-vars\n  request,\n} from \"$shared\"\n\nconst useApi = () => {\n  const {\n    setCurrentUser,\n    setLoginModalOpen,\n  } = useContext(AuthContext)\n\n  const token = localStorage.getItem(C.jwt_token)\n\n  return {\n\n    deleteNewsitem: ({ id }) => {\n      return request.delete(`${config.apiOrigin}/api/newsitems/${id}?jwt_token=${token}`).then((r) => r.data).then((r) => {\n        return r\n      })\n    },\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users/register`, { user: { email, password }} ).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n    /* Returns current user */\n    doUnlock: ({ kind, id }) => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      const path = `/api/payments/unlock?kind=${kind}&id=${id}&jwt_token=${jwt_token}`\n      return request.post(`${config.apiOrigin}${path}`).then((r) => r.data)\n    },\n\n    getCities: ()   => request.get(`${config.apiOrigin}/api/cities`).then((r) => r.data),\n    getCity: (slug) => request.get(`${config.apiOrigin}/api/cities/view/${slug}`),\n    getGallery: (slug) => {\n      return request.get(`${config.apiOrigin}/api/galleries/view/${slug}?jwt_token=${token}`\n      ).then((r) => r.data.gallery)\n    },\n    getLocation: ({ slug }) => { // _vp_ 2022-09-04\n      return request.get(`/api/maps/view/${slug}?jwt_token=${token}`).then(r => r.data).then(r => {\n        return r.map\n      }).catch((err) => {\n        return err\n      })\n    },\n\n    // @TODO: test: upon 401, return anon user. _vp_ 2022-08-15\n    getMyAccount: () => {\n      return request.post(`/api/my/account`, { jwt_token: token, }).then((r) => r.data).catch((err) => {\n        // logg(err, 'Cannot #getMyAccount')\n        return C.anonUser\n      })\n    },\n\n    getReport: (slug) => request.get(`${config.apiOrigin}/api/reports/view/${slug}?jwt_token=${token}`).then((r) => r.data.report),\n\n    getTag: (tag) => request.get(`${config.apiOrigin}/api/tags/view/${tag.slug}`).then((r) => r.data),\n\n    initPayment: (p) => request.post(`${config.apiOrigin}/api/payments2`, { jwt_token: token, amount_cents: p.amountCents }).then((r) => r.data),\n\n    longTermTokenPath: '/api/users/long_term_token', // @TODO: move to config.router _vp_ 2022-09-04\n\n    postLogin: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users/login.json`,\n        { user: { email, password }}\n      ).then((r) => r.data).then((r) => {\n        // logg(r, 'postLoginResponse')\n        localStorage.setItem(C.jwt_token, r.jwt_token)\n        setCurrentUser(r)\n        return r\n        // setLoginModalOpen(false)\n      }).catch((e) => {\n        logg(e, 'e322')\n        return e\n        // toast(\"Login failed\")\n        // setCurrentUser(C.anonUser)\n      })\n    },\n\n    myVideosPath: \"/api/my/videos\", // @TODO: remove\n\n    applicationHome: () => {\n      request.get(`${config.apiOrigin}/api/sites/view/${config.domain}`, { params: { jwt_token: token } }).then((r) => {\n        return r.data\n      })\n    },\n\n    vote: (props) => {\n      const { value, voter_id, votee_id, votee_class_name } = props\n      return request.post(\n        `${config.apiOrigin}/api/v1/vote/${votee_class_name}/${votee_id}/${voter_id}/${value}`,\n        { params: { jwt_token: token } }\n      ).then((r) => {\n        logg(r, 'voted')\n        return r\n      })\n    },\n\n    unvote: () => {\n      logg('Unvote is not implemented!')\n    },\n  }\n\n}\n\nexport default useApi\n","/*\n * components / TwofoldLayout / index.jsx\n */\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\n/**\n * LongLine\n *\n * Turns out I need this still - part of the layout.\n */\nconst LongLine = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  flex-grow: 1;\n\n  width: ${p => p.orientation === C.horizontal ? 'auto' : '10px'};\n  height: ${p => p.orientation === C.horizontal ? '10px' : 'auto'};\n\n  padding: 2px;\n  background: ${p => p.theme.colors.background};\n`;\nLongLine.propTypes = {\n  orientation: PropTypes.string, // 'horizontal' or 'vertical'\n}\n\nexport { LongLine }\n","\nimport _Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport { MyAccountWidget } from \"$components/users\"\nimport { C, logg, MenuIcon, S, TwofoldContext, } from \"$shared\"\n\nconst Drawer = styled(_Drawer)`\n  .MuiDrawer-paper {\n    // border: 1px solid cyan;\n\n    background: ${p=>p.theme.colors.background};\n    z-index: 0;\n  }\n\n  .MuiDrawer-paperAnchorDockedBottom {\n    border-top: 0;\n  }\n`;\n\nfunction getLibrary(provider) {\n  return new Web3(provider)\n}\n\nconst Inner0 = styled.div`\n  display: flex;\n  align-items: flex-start;\n  color: ${p => p.theme.colors.text};\n`;\n\nconst Inner1 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  background: ${p=>p.theme.colors.background};\n  height: calc(${p=>p.theme.bottomDrawerOpenHeight} + 1*${p=>p.theme.borderHeight});\n  margin: ${p=>p.theme.borderWidth};\n\n  flex-grow: 1;\n`;\n\n// TODO: I may not need this\nconst Inner2 = styled.div`\n  // border: 1px solid green;\n\n  background: ${p=>p.theme.colors.cardBackground};\n  height: 100px;\n  display: flex;\n`;\n\nconst WClosed = styled.div`\n  // border: 1px solid yellow;\n\n  position: absolute;\n  bottom: -10px;\n  // left: 10px;\n\n  width: calc(100% - 2*${p=>p.theme.borderWidth});\n\n  display: flex;\n  align-items: center;\n`;\n\n/**\n * BottomDrawer\n */\nconst BottomDrawer = (props) => {\n  // logg(props, 'BottomDrawer')\n\n  const { bottomDrawerOpen, layout, setBottomDrawerOpen } = useContext(TwofoldContext)\n\n  // @TODO: move the component to layout_onecol then\n  if (layout === C.layout_onecol) { return null; }\n\n  return <F>\n\n    <WClosed>\n      <IconButton\n        aria-label=\"open drawer\"\n        onClick={() => setBottomDrawerOpen(true)}\n      ><MenuIcon\n        fontSize=\"small\"\n      /></IconButton>\n      <LongLine orientation={C.horizontal} />\n    </WClosed>\n\n\n    <Drawer anchor={\"bottom\"}\n      elevation={1}\n      open={bottomDrawerOpen}\n      onClose={() => setBottomDrawerOpen(false)}\n      BackdropProps={{ invisible: true }}\n      variant={\"persistent\"}\n    >\n      <Inner0 >\n        <IconButton\n          aria-label=\"open drawer\"\n          onClick={() => setBottomDrawerOpen(false)}\n          style={{ paddingRight: 0 }}\n        ><MenuIcon\n          fontSize=\"small\"\n        /></IconButton>\n\n        <Inner1 >\n          <Inner2 >\n\n            {/* @TODO: move this upstream */}\n            <Web3ReactProvider getLibrary={getLibrary}>\n              <MyAccountWidget />\n            </Web3ReactProvider>\n\n          </Inner2>\n        </Inner1>\n      </Inner0>\n    </Drawer>\n  </F>\n}\nBottomDrawer.propTypes = {} // none so far\n\nexport default BottomDrawer\n\n\n","\nimport {\n  IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonToggle, IonList, IonItem,\n  IonLabel, IonItemDivider,\n} from '@ionic/react'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  DayNightToggle,\n} from './'\nimport { MenuLeft } from \"$components/application\"\nimport {\n  C, logg, request, S, TwofoldContext,\n} from \"$shared\"\n\n\n\n/* B */\n\n// One breadcrumb\nconst B0 = styled.div`\n  color: ${p=> p.theme.colors.text};\n  // padding-right: 0.5em;\n`;\n\n// The divider\nconst B1 = styled.div`\n  padding: 0.5em;\n  color: ${p => p.theme.colors.text};\n`;\n\n/* W */\nconst W0 = styled.div`\n  background: ${p => p.theme.colors.cardBackground};\n  border: ${p=>p.debug?'1':'0'}px solid cyan;\n\n  display: flex;\n  align-items: center;\n  justify-content: stretch;\n\n  z-index: 0;\n\n  // height: ${p => p.theme.breadcrumbsHeight};\n`;\n\nconst WBreadcrumbs = styled.div`\n  display: block;\n  flex-grow: 1;\n  // flex-direction: row;\n  // flex-grow: 1;\n  // flex-wrap: wrap;\n\n  > * {\n    // border: 1px solid red;\n    display: inline;\n  }\n`;\n\n\n/**\n * Breadcrumbs\n */\nconst Breadcrumbs = (props) => {\n  // logg(props, 'Breakcrumbs')\n  const { breadcrumbs=[] } = props\n  const { layout, toggleTheme, theme } = useContext(TwofoldContext)\n  const history = useHistory()\n\n  const out = []\n  breadcrumbs.map((b, idx) => {\n    if (idx+1 === props.breadcrumbs.length) {\n      // last one\n      out.push(<B0 key={idx} >{b.name}</B0>)\n    } else {\n      out.push(<B0\n        key={idx}\n        style={{ textDecoration: 'underline', cursor: 'pointer' }}\n        onClick={() => history.push(`/en/locations/show/${b.slug}`) }\n      >{b.name}</B0>)\n      out.push(<B1 key={`${idx}-divider`} >&gt;</B1>)\n    }\n  })\n\n  return <W0 debug={config.debug} className=\"Breadcrumbs\" >\n    { layout === C.layout_mapui && <MenuLeft variant={C.variants.inline} /> }\n    <WBreadcrumbs className='WBreadcrumbs' >{ out }</WBreadcrumbs>\n    <DayNightToggle toggleTheme={toggleTheme} theme={theme} />\n  </W0>\n}\nBreadcrumbs.propTypes = {\n  breadcrumbs: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      slug: PropTypes.string.isRequired,\n    }),\n  ),\n}\nexport default Breadcrumbs\n","\nimport React from 'react'\n\nimport {\n  C,\n  logg,\n} from '$shared'\n\nimport styles from './DayNightToggle.module.scss'\n\n/**\n * DayNightToggle\n * From: https://codepen.io/fagnanm/pen/RpWNyb\n * From: https://devbeep.com/css-day-night-toggle-switch/\n**/\nconst DayNightToggle = (props) => {\n  // logg(props, 'DayNightToggle')\n  const { toggleTheme, theme } = props\n\n  return (\n    <div className={styles.container} onClick={toggleTheme} >\n      <div className={styles.switch} >\n        <label htmlFor=\"toggle\">\n          <input id=\"toggle\" readOnly={true} type=\"checkbox\" checked={theme === C.themes.light} ></input>\n          <div className={styles.sunMoon} ><div className={styles.dots} ></div></div>\n          <div className={styles.background} ><div className={styles.stars1}></div><div className={styles.stars2}></div></div>\n          {/* <div className={styles.fill}></div> */}\n        </label>\n      </div>\n    </div>\n  );\n}\n\nexport default DayNightToggle\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { logg, C, } from \"$shared\"\nimport { MenuLeft, } from \"$components/application\"\n\nconst Header = styled.div`\n  // border: 1px solid red;\n\n  flex-grow: 1;\n\n  text-align: center;\n  font-size: 2em;\n\n\n`;\n\nconst Root = styled.div`\n  // border: 1px solid blue;\n\n  display: flex;\n  justify-content: center;\n  line-height: 2em;\n  padding: 2em 0;\n`;\n\n/*\n * @TODO: likely destroy this file\n */\nconst MainHeader = (props) => {\n  // logg(props, 'MainMenu')\n\n  return <Root>\n    <MenuLeft variant={C.variants.inline} />\n    <Header>My Local Guide</Header>\n  </Root>\n}\n\nexport default MainHeader\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid purple;\n\n  background: white;\n\n  overflow: hidden;\n  margin: 10px;\n  height: calc(100vh - ${p => p.borderWidth*2}px - ${p => p.bottomDrawerOpen ? `${p.bottomDrawerHeight - p.borderWidth/2}px` : '0px' });\n`\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiLayout = (props) => {\n  return <MapuiContainer {...props} />\n}\n\nexport default MapuiLayout\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid cyan;\n  // background: white;\n\n  overflow-y: auto;\n\n  height: calc(100vh\n    - ${p => p.bottomDrawerOpen ? p.bottomDrawerOpenHeight : p.bottomDrawerClosedHeight });\n`;\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiMobileLayout = (props) => {\n  const { bottomDrawerOpen } = useContext(TwofoldContext)\n  return <MapuiContainer {...props} {...{ bottomDrawerOpen }} {...S} />\n}\n\nexport default MapuiMobileLayout\n","\n\n/*\n * @TODO: Likely destroy this file\n */\n\nimport {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonMenu,\n  IonMenuToggle,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { newspaperOutline, bus, person, powerOutline } from 'ionicons/icons';\nimport './Application.module.scss';\n\nconst appPages = [\n  {\n    title: 'Homefeed',\n    icon: newspaperOutline,\n    url: \"/en\"\n  },\n  {\n    title: 'Cities',\n    icon: bus,\n    url: \"/en/cities\"\n  },\n  {\n    title: 'My Account',\n    icon: person,\n    url: \"/en/account\"\n  },\n  {\n    title: 'Account2',\n    icon: person,\n    url: \"/en/account2\"\n  },\n  {\n    title: 'Login',\n    icon: powerOutline\n  }\n];\n\n/**\n * 20210529 - I think this is obsolete somehow, I'm using MyDrawer in App.jsx\n *\n */\nconst Menu = () => {\n  return (\n    <IonMenu contentId=\"main\" type=\"overlay\">\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Menu</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <img src=\"/assets/hero.png\" />\n        <IonList id=\"inbox-list\">\n          { appPages.map((appPage, index) => <IonMenuToggle key={index} autoHide={false}>\n            <IonItem\n              routerLink={appPage.url}\n              routerDirection=\"none\"\n              lines=\"none\"\n              detail={false}>\n              <IonIcon\n                slot=\"start\"\n                ios={appPage.icon}\n                md={appPage.icon} />\n              <IonLabel>{appPage.title}</IonLabel>\n            </IonItem>\n          </IonMenuToggle>) }\n        </IonList>\n      </IonContent>\n    </IonMenu>\n  )\n}\n\nexport default Menu\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { Menu } from \"$components/application\"\nimport { Api, C, Debug, logg, MenuIcon, TwofoldContext, } from \"$shared\"\n\nconst _LeftWrapper = styled.div`\n  // border: 1px solid green;\n`;\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = (props) => {\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  return <F>\n\n    { /* <Menu /> */ }\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em' }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          <ListItem button key={'newsfeed'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(config.homePath)\n            } } >Home\n          </ListItem>\n\n          { /* <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/threev1\")\n            } } >Three\n          </ListItem>\n\n          <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/construct03d\")\n            } } >Construct0 3D\n          </ListItem>\n\n          <ListItem button key={'cities'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/cities\")\n            } }>\n            <span >Cities</span>\n          </ListItem>\n\n          <ListItem button key={'map 1'} >\n            <span onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations\")\n            } }>The Directory</span>\n          </ListItem> */ }\n\n          { currentUser && currentUser.bookmarks?.map((b, idx) =>\n            <ListItem button key={idx}\n              onClick={() => {\n                setDrawerOpen(false)\n                history.push(`/en/locations/show/${b.slug}`)\n              } } >\n              <span >{b.name}</span>\n            </ListItem>\n          ) }\n\n          <ListItem button key={'account'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(`/en/locations/show/${currentUser.id}`)\n            } } >\n            <span >Account</span>\n          </ListItem>\n\n          <ListItem>\n            Version 0.0.0\n          </ListItem>\n\n        </List>\n        { /* <W2>\n          { loading && 'Loading...' }\n          { currentUser && <F>\n            {currentUser.email}<br />\n            {currentUser.n_stars}<br />\n            some action\n          </F> }\n        </W2> */ }\n      </W0>\n    </Drawer>\n  </F>\n}\n\nSideMenu.propTypes = {\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from \"react\"\nimport { withRouter } from \"react-router-dom\"\nimport \"./Application.module.scss\"\nimport styled from 'styled-components'\n\nimport { Api, logg, request, pp_date } from \"$shared\"\n\nconst W = styled.div`\n  margin: .5em 0;\n  color: ${p=>p.theme.colors.text};\n`\n\nconst Metaline = (props) => {\n  // logg(props, 'Metaline')\n\n  const { created_at, username, city, tags = [] } = props;\n\n  function navigateToCity(){\n    props.history.push(`/en/cities/travel-to/${city.slug}/show/newsfeed`);\n  }\n\n  return (\n    <W>\n      { created_at && <span className=\"date\">On {pp_date(created_at)}&nbsp;</span>}\n      { username && <>by <span className=\"user\" style={{ textDecoration: 'underline' }} >{username}</span>&nbsp;</> }\n      {/* { city     && <>in <span className=\"city\" onClick={navigateToCity}> {city.name} </span>&nbsp;</> } */}\n      {/* { tags     && tags.map((tag, i) => <span key={i} className=\"tags\">{tag.name}</span>) } */}\n    </W>\n  );\n\n}\n\nexport default withRouter(Metaline);","\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport { CardElement, Elements, useElements, useStripe, } from '@stripe/react-stripe-js'\nimport { loadStripe } from '@stripe/stripe-js'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  ModalHeader,\n} from 'ishlibjs'\nimport config from 'config'\n\nimport {\n  logg,\n  TwofoldContext,\n  useApi,\n} from \"$shared\"\n\nimport styles from './PurchaseModal.module.scss'\n\nconst FlexRow = styled.div``;\n\nconst stripePromise = loadStripe(config.stripePublicKey)\n\nconst _PurchaseModal = (props) => {\n  // logg(props, '_PurchaseModal')\n\n  const {\n    currentUser, setCurrentUser,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'PurchaseModalUsedAuthContext')\n\n  const {\n    purchaseModalOpen, setPurchaseModalOpen,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'PurchaseModalUsedTwofoldContext')\n\n  const api = useApi()\n  const stripe = useStripe()\n  const elements = useElements()\n\n  const [ amountCents, setAmountCents ] = useState(50)\n\n  // @TODO: add a virual cue \"Loading\" on button click.\n  const buyUnlocks = async (event) => {\n    event.preventDefault()\n    if (!stripe || !elements) { return }\n\n    // const cardElement = elements.getElement(CardElement)\n    let client_secret = await api.initPayment({ amountCents, })\n\n    const result = await stripe.confirmCardPayment(client_secret.client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    })\n\n    if (result.error) {\n      toast('We are sorry, but something went wrong.')\n      logg(result.error.message, 'e41 - cannot buyUnlocks()')\n\n    } else {\n      if (result.paymentIntent.status === 'succeeded') {\n        const handle = setInterval(async () => {\n\n          let response = await api.getMyAccount()\n          logg(response, 'tr2 success')\n          if (!response.is_purchasing) {\n            logg('clearing interval!')\n            setCurrentUser(response)\n            setPurchaseModalOpen(false)\n            clearInterval(handle)\n          }\n\n        }, 1 * 500)\n        setTimeout(() => clearInterval(handle), 10 * 1000)\n      }\n    }\n  }\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`PurchaseModal ${styles.LoginModal}`}\n    isOpen={purchaseModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => { setPurchaseModalOpen(false) } } >Buy unlocks</ModalHeader>\n    <form onSubmit={buyUnlocks} >\n      <FlexRow>\n        How many cents would you pay for 1 coin? Minimum 50 cents.\n        <input value={amountCents} onChange={e => setAmountCents(e.target.value)} />\n      </FlexRow>\n      <CardElement />\n      <button type=\"submit\" disabled={!stripe} >Pay</button>\n    </form>\n  </Modal>\n}\nconst PurchaseModal = (props) => <Elements stripe={stripePromise}><_PurchaseModal {...props} /></Elements>;\nexport default PurchaseModal\n","import React, { useEffect, useState } from \"react\"\nimport { IonIcon } from \"@ionic/react\"\nimport { starOutline, starHalf, star } from 'ionicons/icons'\nimport \"./Application.module.scss\"\n\nconst Rating = (props) => {\n\n  let rate = props.rate;\n  let [rating, setRating] = useState([]);\n\n  let iconMapping = {\n    0: starOutline,\n    1: starHalf,\n    2: star\n  };\n\n  useEffect(() => {\n\n    let rating = (new Array(5)).fill(0);\n    let i = 0;\n    while (rate > 0) {\n      if (rate < 1) {\n        rating[i] = 1;\n      } else {\n        rating[i] = 2;\n      }\n      rate--;\n      i++;\n    }\n\n    setRating(rating);\n\n  }, []);\n\n  return (\n    <div className=\"rating\">\n      { rating.map((r, i) => <IonIcon key={i} className=\"stars\" icon={iconMapping[r]} ></IonIcon>) }\n    </div>\n  )\n\n}\n\nexport default Rating;","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, } from 'react'\nimport Modal from \"react-modal\"\nimport { useHistory, useRouteMatch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  ModalHeader,\n} from 'ishlibjs'\nimport config from 'config'\n\nimport {\n  Btn,\n  C,\n  inflector,\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nimport './UnlockModal.module.scss'\n\nconst BtnRow = styled.div`\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst modalStyle = {\n  overlay: {},\n  content: {\n    margin: 'auto',\n    maxWidth: '400px',\n\n  }\n}\n\n/**\n * UnlockModal\n */\nconst UnlockModal = (props) => {\n  // logg(props, 'UnlockModal')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    location, setLocation,\n    loginModalOpen, setLoginModalOpen,\n    purchaseModalOpen, setPurchaseModalOpen,\n    ratedConfirmation, setRatedConfirmation,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'unlockModalUsedTwofoldContext')\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'unlockModalUsedAuthContext')\n\n  const api = useApi()\n  const history = useHistory()\n  const match = useRouteMatch()\n\n  const doUnlock = async () => {\n    logg(itemToUnlock, 'itemToUnlock')\n\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    // @TODO: Do I Need to refresh the newsfeed somehow? _vp_ 2022-09-04\n    await api.doUnlock({ kind: itemToUnlock.item_type, id: itemToUnlock.id }).then((r) => {\n      logg(r, 'OK doUnlock')\n\n      setItemToUnlock({}) // @TODO: Change this to null if possible. Test-drive this change. _vp_ 2022-09-04\n      setCurrentUser(r)\n\n      // @TODO: move, copy-pasted from LocationsShowDesktop\n      api.getLocation({ slug: match.params.slug }).then(r => {\n        setLocation(r)\n        if (r.rated === C.rated.nc17 && !ratedConfirmation) { // @TODO: not test-driven, bad!\n          setRatedConfirmation(false)\n        }\n      })\n\n      const resource_name = inflector.tableize(itemToUnlock.item_type)\n      history.push(`/en/locations/show/${match.params.slug}/${resource_name}/show/${itemToUnlock.slug}`)\n\n    }).catch((e) => {\n      logg(e, 'e19 - cannot doUnlock')\n    })\n  }\n\n  /* @TODO: this was here before, but should not be, right? _vp_ 2022-03-19 */\n  // const mountedRef = useRef('init')\n  // useEffect(() => {\n  //   const fn = async () => {\n  //     const r = await api.getMyAccount()\n  //     if (r) {\n  //       setCurrentUser(r)\n  //     }\n  //   }\n  //   fn()\n  //   return () => mountedRef.current = null\n  // }, [itemToUnlock.id])\n\n  if (!itemToUnlock.id) { return null }\n\n  let closable = typeof itemToUnlock.closable === 'undefined' ? true : itemToUnlock.closable\n\n  // @TODO: this is messy\n  let gohome = () => {\n    setItemToUnlock({})\n    setRatedConfirmation(true)\n    history.push(config.homePath)\n  }\n\n  const cost = itemToUnlock.premium_tier\n\n  Modal.setAppElement('body')\n\n  return (<Modal style={modalStyle} isOpen={!!itemToUnlock.id} >\n    <ModalHeader onClose={() => closable && setItemToUnlock(false) } >Unlock this item?</ModalHeader>\n    <p>To access this content, please unlock it first. It costs {cost} coin(s) to unlock.</p>\n    { currentUser && <F>\n      <p>You have <b>{currentUser.n_unlocks}</b> unlocks.</p>\n      { currentUser.n_unlocks >= cost && <Btn className='doUnlock' onClick={doUnlock} >Unlock</Btn> }\n      { currentUser.n_unlocks < cost && <F>\n        <p>You don't have enough unlocks.</p>\n        <Btn onClick={() => { setPurchaseModalOpen(true) ; setItemToUnlock(false)} } >Purchase more.</Btn>\n      </F> }\n    </F> }\n    { !currentUser && <F>\n      <p>You have to be logged in to unlock content. <a onClick={() => { setLoginModalOpen(true) ; setItemToUnlock(false) }}>Please login.</a></p>\n    </F> }\n    <BtnRow>\n      { !closable && <Btn onClick={gohome} >Go Home</Btn> }\n    </BtnRow>\n  </Modal>)\n\n}\n\nexport default UnlockModal\n","\nimport { Capacitor } from '@capacitor/core'\nimport { PushNotifications } from '@capacitor/push-notifications'\nimport { Toast } from \"@capacitor/toast\"\nimport { ethers } from 'ethers'\nimport {\n  IonButton, IonButtons,\n  IonCard, IonCardContent, IonContent,\n  IonFooter,\n  IonHeader,\n  IonItem,\n  IonLabel, IonListHeader, IonList,\n  IonMenuButton,\n  IonPage,\n  IonText, IonTitle, IonToolbar,\n} from '@ionic/react'\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport React, {\n  Fragment as F,\n  useContext, useEffect, useState,\n} from \"react\"\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { FbLogin, Logout, } from \"./\"\nimport { C, logg, logg2, TwofoldContext } from \"$shared\"\nimport { MenuLeft } from \"$components/application\"\nimport Greeter from '$src/artifacts/contracts/Greeter.sol/Greeter.json'\nimport Token from '$src/artifacts/contracts/Token.sol/Token.json'\n\nconst isPushNotificationsAvailable = Capacitor.isPluginAvailable('PushNotifications')\n\n// Update with the contract address logged out to the CLI when it was deployed\nconst greeterAddress = \"0x4bE9765Ca063E73E0aaEd227fd6731473508DbE0\"\nconst tokenAddress = \"0xffa52d00685aC60e65457922aEae2c2783c0cB0E\"\n\nexport const PasswordLogin = () => {\n  return <div>PasswordLogin - @TODO: remove</div>\n}\n\nconst LoginRow = styled.div`\n  display: flex;\n  // border: 1px solid yellow;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst Account = (props) => {\n  // logg(props, 'Account')\n\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const [ greeting, setGreetingValue ] = useState(\"\")\n  const [notifications, setNotifications] = useState([])\n  const [ scratchpad, setScratchpad ] = useState(\"\")\n  const saveScratchpad = () => {}\n\n  // push notifications\n  const register = () => {\n    // Register with Apple / Google to receive push via APNS/FCM\n    PushNotifications.register()\n\n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration', (token) => {\n      showToast('Push registration success')\n    })\n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError', (error) => {\n      alert('Error on registration: ' + JSON.stringify(error))\n    })\n\n    // Show us the notification payload if the app is open on our device\n    PushNotifications.addListener('pushNotificationReceived', (_n) => {\n      const n = _n\n      logg2(n, 'pushNotificationReceived')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'foreground' }]\n      })\n    })\n\n    // Method called when tapping on a notification\n    PushNotifications.addListener('pushNotificationActionPerformed', ({ nofitication: n }) => {\n      logg2(n, 'pushNotificationActionPerformed')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'action' }]\n      })\n    })\n  }\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // push notifications\n  useEffect(() => {\n    if (!isPushNotificationsAvailable) { return }\n\n    PushNotifications.checkPermissions().then((res) => {\n        if (res.receive === 'granted') {\n          register()\n        } else {\n          PushNotifications.requestPermissions().then((res) => {\n            if (res.receive === 'denied') {\n              showToast('Push Notification permission denied')\n            } else {\n              showToast('Push Notification permission granted')\n              register()\n            }\n          })\n        }\n      })\n  }, [])\n\n  // request access to the user's MetaMask account\n  async function requestAccount() {\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n  }\n\n  // call the smart contract, read the current greeting value\n  async function fetchGreeting() {\n    if (typeof window.ethereum !== 'undefined') {\n      const provider = new ethers.providers.Web3Provider(window.ethereum)\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, provider)\n      try {\n        const data = await contract.greet()\n        setGreetingValue(data)\n        // console.log('data: ', data)\n      } catch (err) {\n        console.log(\"Error: \", err)\n      }\n    }\n  }\n\n  async function getBalance() {\n    if (typeof window.ethereum !== 'undefined') {\n      const [account] = await window.ethereum.request({ method: 'eth_requestAccounts' })\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const contract = new ethers.Contract(tokenAddress, Token.abi, provider)\n      const balance = await contract.balanceOf(account);\n      console.log(\"Balance: \", balance.toString());\n    }\n  }\n\n  // call the smart contract, send an update\n  async function setGreeting() {\n    if (!greeting) return\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner()\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, signer)\n      const transaction = await contract.setGreeting(greeting)\n      await transaction.wait()\n      fetchGreeting()\n    }\n  }\n\n  async function sendCoins() {\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(tokenAddress, Token.abi, signer);\n      const transation = await contract.transfer(userAccount, amount);\n      await transation.wait();\n      console.log(`${amount} Coins successfully sent to ${userAccount}`);\n    }\n  }\n\n  return <IonPage>\n    <Grid container>\n      <MenuLeft variant={C.variants.inline} />\n      <h1>Account</h1>\n    </Grid>\n    <IonContent className=\"ion-padding\">\n\n      <Grid container spacing={2} >\n        <Grid item xs={12}>\n          <Grid container>\n            <Grid item xs={6}>\n              <img src=\"/assets/accounts/default-avatar.png\" alt=\"profile pic\" />\n\n              { /* NFT */ }\n              <div>\n                <button onClick={fetchGreeting}>Fetch Greeting</button>\n                <br />\n                <button onClick={setGreeting}>Set Greeting</button>\n                <br />\n                <input value={greeting} onChange={e => setGreetingValue(e.target.value)} placeholder=\"Set greeting\" />\n              </div>\n              <hr />\n              <div>\n                <button onClick={getBalance}>Get Balance</button>\n                <br />\n                <button onClick={sendCoins}>Send Coins</button>\n                <br />\n                <input onChange={e => setUserAccount(e.target.value)} placeholder=\"Account ID\" />\n                <br />\n                <input onChange={e => setAmount(e.target.value)} placeholder=\"Amount\" />\n              </div>\n\n            </Grid>\n            <Grid item xs={6}>\n              { !!currentUser\n                && <F>\n                  <h4>{currentUser.email}</h4>\n                  <ul>\n                    <li><Link to={\"/en/account/my/galleries\"} >My Galleries</Link></li>\n                    <li><a onClick={() => props.history.push(\"/en/account/my/videos\")}>My Videos</a></li>\n                    <li><Logout /></li>\n                  </ul>\n                </F>\n                || <F>\n                  <h4>Not logged in</h4>\n\n                  <LoginRow>\n                    <FbLogin />\n                    <PasswordLogin />\n                  </LoginRow>\n\n                </F> }\n            </Grid>\n          </Grid>\n          <Grid container spacing={2}>\n            <Grid item xs={6} >\n              <textarea value={scratchpad} onChange={setScratchpad} />\n              <button type='submit' onClick={saveScratchpad}>Save Scratchpad</button>\n            </Grid>\n          </Grid>\n        </Grid>\n      </Grid>\n\n      <hr />\n      { /* push notifications */ }\n      { notifications.length && <IonList>\n        { notifications.map((notif) => <IonItem key={notif.id}>\n          <IonLabel>\n            <IonText><h3 className=\"notif-title\">{ notif.title }</h3></IonText>\n            <p>{ notif.body }</p>\n            { notif.type==='foreground' && <p>This data was received in foreground</p> }\n            { notif.type==='action' && <p>This data was received on tap</p> }\n          </IonLabel>\n        </IonItem>) }\n      </IonList> || 'no notifications so far' }\n\n    </IonContent>\n    <IonFooter>\n      <IonToolbar>\n        { isPushNotificationsAvailable && <IonButton\n          color=\"success\" expand=\"full\" onClick={register}>Register for Push</IonButton>\n          || <div><h1>Push notifications not available</h1></div> }\n      </IonToolbar>\n    </IonFooter>\n  </IonPage>\n}\n\nexport default Account\n","\nimport { ethers } from 'ethers'\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Toggle from 'react-toggle'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport config from \"config\"\nimport {\n  AuthContext, AuthWidget,\n  FlexCol, FlexRow,\n} from 'ishlibjs'\n\nimport {\n  PurchaseModal,\n} from '$components/application'\nimport {\n  FbLogin2,\n} from \"./\"\nimport {\n  Btn,\n  Card,\n  logg,\n  request,\n  S,\n  TwofoldContext,\n} from \"$shared\"\n\nimport \"react-toggle/style.css\"\n\nimport bodyNFT from '$src/artifacts/contracts/Body.sol/BodyNFT.json'\n\n/*\n * ropsten, _vp_ 2021-10-26\n * Dana, nude 1 (nude 3)\n */\nconst bodyAddress = '0x3e1a03a9e1682f4dd95413e0be69e5b7bccaf15d'\n\n// // Trash, remove\n// const BuyBtn = styled.span`\n//   border: 1px solid ${p => p.theme.colors.text};\n\n//   padding: 5px;\n//   cursor: pointer;\n// `;\n\nconst Cell = styled.div`\n  margin-right: ${p => p.theme.smallWidth};\n`;\n\nconst _Img = styled.div`\n  border: 1px solid red;\n  background: white;\n\n  max-width: 100px;\n  max-height: 100px;\n  width: 100px;\n  height: 100px;\n  margin-right: ${p => p.theme.smallWidth};\n`;\nconst Img = ({ src }) => {\n  return <_Img><img src={src} alt='' /></_Img>\n}\n\nconst injected = new InjectedConnector() // { supportedChainIds: [1, 3, 4, 5, 42], })\n\nconst _CoinManager = styled.div`\n  display: flex;\n`;\nconst CoinManager = ({ children, ...props }) => {\n  return <_CoinManager className=\"CoinManager\" {...props} >{children}</_CoinManager>\n}\n\nconst W0 = styled.div`\n  // border: 1px solid cyan;\n\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n`;\n\nconst W1 = styled.div``;\n\n/**\n * MyAccountWidget\n**/\nconst MyAccountWidget = (props) => {\n  // logg(props, 'MyAccountWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'MyAccountWidgetUsedAuthContext')\n\n  // @TODO: does this really belong to TwofoldContext?\n  const {\n    editorMode, setEditorMode,\n    purchaseModalOpen, setPurchaseModalOpen,\n  } = useContext(TwofoldContext)\n\n  /*\n   * @TODO: avatar would be an object s.t. multiple styles/sizes are there,\n   * and it should be in a context - shared across threemap, and accountWidget.\n   */\n  const [ avatar, setAvatar ] = useState(\"\")\n  const api = useApi()\n  const { active, account, library, connector, activate, deactivate } = useWeb3React()\n\n  async function connect() {\n    try {\n      await activate(injected)\n    } catch (ex) {\n      logg(ex, 'could not connect')\n    }\n  }\n\n  async function disconnect() {\n    try {\n      deactivate()\n    } catch (ex) {\n      console.log(ex)\n    }\n  }\n\n  // request access to the user's MetaMask account\n  const requestAccount = async () => {\n    await window.ethereum.request({ method: 'eth_requestAccounts' })\n  }\n\n  const myBodies = async () => {\n    if (window.ethereum) {\n      await requestAccount()\n      if (account) {\n        const provider = new ethers.providers.Web3Provider(window.ethereum)\n        const signer = provider.getSigner()\n        const contract = new ethers.Contract(bodyAddress, bodyNFT.abi, signer)\n        const tokensOfOwner = await contract.tokensOfOwner(account)\n\n        // @TODO: this is only first, I need to support unlimited number of bodies connected to the account.\n        const i = 0\n        const result = await contract.tokenURI(tokensOfOwner[i])\n        request.get(result).then(r => r.data.image).then(r => {\n          setAvatar(r)\n        })\n      }\n    }\n  }\n\n\n  useEffect(() => {\n    (async () => {\n      setCurrentUser(await api.getMyAccount())\n    })()\n  }, [])\n\n  return <W0 className=\"MyAccountWidget\" >\n\n    { /* currentUser.profile_photo_url && <Img src={currentUser.profile_photo_url} /> */ }\n    <Img src={avatar || currentUser?.profile_photo_url} />\n\n    <FlexRow>\n\n      { currentUser.email && <CoinManager>\n        [&nbsp;{ typeof currentUser.n_unlocks === 'undefined' ? '?' : currentUser.n_unlocks} coins&nbsp;\n        <AddCircleOutlineIcon onClick={() => setPurchaseModalOpen(true)} />&nbsp;]\n      </CoinManager> }\n\n      { /* set EditorMode */ }\n      {/* <Card>\n        <label>\n          <Toggle\n            defaultChecked={editorMode}\n            icons={false}\n            onChange={() => setEditorMode(!editorMode) } />\n          <span>Editor mode</span>\n        </label>\n      </Card> */}\n\n      <AuthWidget />\n\n    </FlexRow>\n\n    <PurchaseModal />\n\n  </W0>\n}\nMyAccountWidget.propTypes = {\n  // no props\n};\n\n// const WrappedMyAccountWidget = (props) => <Elements stripe={stripePromise}><MyAccountWidget {...props} /></Elements>;\n// export default WrappedMyAccountWidget\nexport default MyAccountWidget\n\n\n\n// { active && <W1> [\n//   <span>Connected with <b>{account}</b></span>\n//   <button onClick={disconnect} >Disconnect</button>\n//   <button onClick={myBodies} >myBodies</button> ]</W1> }\n// { !active && <W1>\n// <span>Not Connected</span>\n// <button onClick={connect} >Connect to MetaMask</button>\n// </W1> }\n\n\n","/*\n * components / users / index\n */\nimport { Plugins } from '@capacitor/core'\nimport { FacebookLoginResponse } from '@capacitor-community/facebook-login'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  Btn,\n  C,\n  FlexCol,\n  logg, request, TwofoldContext, useApi,\n} from \"$shared\"\n\n/* A */\nexport { default as Account } from \"./Account\"\n\n\n/* F */\n// @deprecated below, use ishlibjs\nconst { FacebookLogin } = Plugins\nconst FACEBOOK_PERMISSIONS = ['email']\nexport const FbLogin = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        // localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>FB Login</Btn>\n}\nexport const FbLogin2 = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        // localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>Login or Register with Facebook</Btn>\n}\n// ^ @deprecated above\n\n\n\n/* L */\n\nconst BuyBtn = styled.span`\n  border: 1px solid ${p => p.theme.colors.text};\n\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    // localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <BuyBtn onClick={doLogout}>X</BuyBtn>\n}\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/* M */\nexport { default as MyAccountWidget } from \"./MyAccountWidget\"\n\n/* P */\n\n\n/* R */\n\n","\n/*\n *  $shared / AppMock\n */\n\nimport { createMemoryHistory } from 'history'\nimport _Box from '@material-ui/core/Box'\nimport React, { useState } from 'react'\nimport {\n  Link, Switch, Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\nimport { ThemeProvider } from 'styled-components'\n\nimport {\n  C,\n  logg,\n  S,\n  TwofoldContext, TwofoldContextProvider,\n} from \"$shared\"\nimport { LoginModal } from \"$components/users\"\n\n// @TODO: this is a complete mess, remove and re-do this mock.\nconst AppMock = (props) => {\n  // logg(props, 'AppMock')\n  let {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n    purchaseModalOpen, setPurchaseModalOpen,\n    zoom, setZoom,\n  } = props\n  const history = createMemoryHistory()\n  history.push(\"/en/cities/travel-to/chicago\") // @TODO: move where appropriate\n\n  const [ localItemToUnlock, setLocalItemToUnlock ] = useState({})\n  const [ localCurrentUser, setLocalCurrentUser ] = useState(C.anonUser)\n  const [ localLoginModalOpen, setLocalLoginModalOpen ] = useState(false)\n  const [ localPurchaseModalOpen, setLocalPurchaseModalOpen ] = useState(false)\n  const [ localZoom, setLocalZoom ] = useState(1)\n  if (!currentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n  if (!itemToUnlock) {\n    itemToUnlock = localItemToUnlock\n    setItemToUnlock = setLocalItemToUnlock\n  }\n  if ('undefined' === typeof loginModalOpen) {\n    loginModalOpen = localLoginModalOpen\n    setLoginModalOpen = setLocalLoginModalOpen\n  }\n  if ('undefined' === typeof purchaseModalOpen) {\n    purchaseModalOpen = localPurchaseModalOpen\n    setPurchaseModalOpen = setLocalPurchaseModalOpen\n  }\n  if ('undefined' === typeof zoom) {\n    // logg('no props.zoom?!')\n    zoom = localZoom\n    setZoom = setLocalZoom\n  }\n\n  return <ThemeProvider theme={S.lightTheme}>\n    <Router history={history} >\n      <TwofoldContextProvider {...{\n        // bottomDrawerOpen, setBottomDrawerOpen,\n        currentUser, setCurrentUser,\n        itemToUnlock, setItemToUnlock,\n        // layout, setLayout,\n        loginModalOpen, setLoginModalOpen,\n        purchaseModalOpen, setPurchaseModalOpen,\n        // showUrl, setShowUrl,\n        zoom, setZoom,\n      }} >\n        { props.children }\n        {/* <LoginModal /> */}\n      </TwofoldContextProvider>\n    </Router>\n  </ThemeProvider>\n}\n\nexport default AppMock\n","\nconst AppRouter = {\n\n  cityVenuesPath: (slug) => `/en/cities/travel-to/${slug}/venues`,\n  cityPath: (slug) => `/en/cities/travel-to/${slug}`,\n\n};\n\nexport default AppRouter;\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport {\n  C, CollapsibleContext,\n  logg,\n  S,\n  WBordered, WBorderedItem,\n} from '$shared'\n\nconst Gt = () => <span>&nbsp;&gt;&nbsp;&nbsp;</span>\n\nconst Inner = styled.div`\n  // border: 2px solid red;\n  // max-height: 100vh;\n\n  clear: left;\n`;\n\nconst Lt = () => <span>&nbsp;&lt;&nbsp;&nbsp;</span>\n\nconst Label = styled.div`\n  display: flex;\n  margin-bottom: ${p => p.theme.borderWidth};\n  color: ${p => p.theme.colors.text};\n`;\n\nconst WTransparent = styled.div`\n  background: ${p => p.theme.colors.background};\n  padding: 0 .5em .5em .5em;\n`;\nconst W = ({ children, variant, ...props }) => {\n  switch (variant) {\n    case C.variants.bordered:\n      return <WBordered {...props} >{children}</WBordered>\n    default:\n      return <WTransparent {...props} >{children}</WTransparent>\n  }\n}\n\n\n/**\n * Collapsible\n *\n * @TODO: test-driven _vp_ 2021-10-29\n */\nconst Collapsible = ({ children, ...props }) => {\n  // logg(props, 'Collapsible')\n  const {\n    className='', config, variant,\n  } = props\n\n  const ctx = useContext(CollapsibleContext)\n  if (!ctx) { return null }\n  const { collapsibles, setCollapsibles } = ctx\n\n  const doToggle = () => setCollapsibles({ ...collapsibles, [props.slug]: !collapsibles[props.slug] })\n\n  const collapsible = typeof config === 'undefined' ? true\n    : typeof config.collapsible === 'undefined' ? true\n      : config.collapsible\n  const folded = false // collapsible ? !!collapsibles[props.slug] : false\n\n  return <W variant={variant} className={`Collapsible ${className}`} >\n    { props.label &&  collapsible && <Label onClick={doToggle} >{folded ? <Lt /> : <Gt />} {props.label}</Label> }\n    { props.label && !collapsible && <Label >{props.label}</Label> }\n    { !folded && <Inner>{ children }</Inner> }\n  </W>\n}\n\nCollapsible.propTypes = {\n  className: PropTypes.string,\n  config: PropTypes.shape({\n    collapsible: PropTypes.bool,\n  }),\n  label: PropTypes.string,\n  slug: PropTypes.string.isRequired,\n  variant: PropTypes.string,\n}\nexport default Collapsible\n","import axios from \"axios\";\nimport config from \"config\";\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings);","\n/**\n * Style Constants\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  smallWidth: '10px',\n  mediumWidth: '20px',\n\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    border: 'black',\n    blue: '#6aa3e9',\n    cardBackground: 'white',\n    cyan: \"#49bcc6\",\n    darkGrey: '#605d5d',\n    gold: '#ffe100',\n    lightGrey: '#988b8b',\n    red: 'red',\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    border: 'white',\n    blue: '#73b0fa',\n    cardBackground: '#1a1a1a',\n    cyan: \"#49bcc6\",\n    darkGrey: '#b3afaf',\n    gold: '#ffe100',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}\n","import { useLayoutEffect, useState, } from 'react'\n\n/**\n * useWindowSize\n */\nconst useWindowSize = () => {\n  const [size, setSize] = useState([0, 0]);\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    window.addEventListener('resize', updateSize);\n    updateSize();\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n  return size;\n}\n\nexport default useWindowSize\n","/*\n *  $shared / index\n */\n// alphabetized\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useContext, useEffect, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport C from \"./C\"\nimport { default as TwofoldContext } from './TwofoldContext'\nimport { TwofoldContextProvider } from './TwofoldContext'\n\n/* A */\nimport useApi from \"./Api\"\nexport { default as useApi } from \"./Api\"\nexport { default as AppMock } from \"./AppMock\"\nexport { default as AppRouter } from \"./AppRouter\"\n\n/* B */\n\n/**\n * Back Button\n */\nconst BackIcon = styled(IonIcon)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'BackBtn usedContext')\n\n  const onClick = () => {\n    setShowItem(null)\n    history.goBack()\n  }\n\n  return <BackIcon className=\"BackBtn\"\n    icon={arrowBack}\n    onClick={onClick}\n  ></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n\n  padding: .3em 1em;\n  cursor: pointer;\n`;\n\n\n/* C */\n\nexport { C }\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * A Card\n */\nconst _Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: ${p => p.theme.smallWidth};\n  background: ${p => p.theme.colors.cardBackground};\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\nexport const Card = ({ children, ..._props }) => {\n  logg(_props, 'Card')\n  const { navigateToItem, ...props } = _props\n  return <_Card className=\"Card\" {...props}>{ children }</_Card>\n}\n\nexport { default as Collapsible } from \"./Collapsible\"\nexport const CollapsibleContext = React.createContext({})\n/**\n * @TODO: test-driven\n */\nexport const CollapsibleContextProvider = ({ children, ...props }) => {\n  // logg(props, 'CollapsibleContextProvider')\n\n  let defaultCollapsibles = {\n    [C.collapsible.descr]: true,\n  }\n  let tmp\n  if (tmp = localStorage.getItem(C.collapsibles)) {\n    try {\n      defaultCollapsibles = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'Could not parse collapsibles from localStorage')\n    }\n  }\n  const [ collapsibles, _setCollapsibles ] = useState(defaultCollapsibles)\n  const setCollapsibles = (m) => {\n    localStorage.setItem(C.collapsibles, JSON.stringify(m))\n    _setCollapsibles(m)\n  }\n\n  return <CollapsibleContext.Provider value={{\n    collapsibles, setCollapsibles,\n  }} >{ children }</CollapsibleContext.Provider>\n}\n\n/* D */\n\n/* F */\n\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  classify: (m) => {\n    if (m.slice(-3)==='ies') {\n      m = m.slice(0, -3) + 'y'\n    }\n    if (m.slice(-1)==='s') {\n      m = m.slice(0, -1)\n    }\n    const ms = m.split('_')\n    for (var i = 0; i < ms.length; i++) {\n      ms[i] = ms[i].charAt(0).toUpperCase() + ms[i].slice(1)\n    }\n    return ms.join(\"\")\n  },\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n        // Report, what else?\n        return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg_android = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nconst logg2 = logg\nconst logg4 = logg\nconst logga = logg_android\nexport {\n  logg,\n  logg2,\n  logg4,\n  logga,\n};\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* P */\nexport const PurchasedIcon = () => {\n  return <div className=\"PurchasedIcon\">[purchased]</div>\n}\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\nexport { TwofoldContext, TwofoldContextProvider }\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered.\n * Used in collapsibles and MarkersList\n *\n * This expects a list? _vp_ 2021-11-02\n */\nconst _WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n\n  margin-bottom: 1em;\n  padding: .5em;\n\n  cursor: ${p => p.onClick ? 'pointer' : null};\n`;\nexport const WBordered = ({ children, ...props }) => {\n  return <_WBordered {...props} >{children}</_WBordered>\n}\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nconst _WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n\n  &:empty {\n    height: 0;\n    border: none;\n    padding: 0;\n  };\n`;\nexport const WBorderedItem = ({children, ..._props}) => {\n  const { className, ...props } = _props\n  return <_WBorderedItem className={`WBorderedItem ${className}`} {...props}>{children}</_WBorderedItem>\n}\n\n\nexport const WidgetContainer = ({ children, ..._props }) => {\n  const { className='', ...props } = _props\n  return <WBordered className={`${className} WidgetContainer`} {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","import { IonPage, IonLoading, IonContent, IonIcon as _IonIcon } from '@ionic/react';\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons';\nimport React, { Fragment as F, useEffect, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from 'styled-components'\n\nimport { useApi, AppRouter,\n  logg, // eslint-disable-line no-unused-vars\n  Wrapper } from \"$shared\"\nimport \"./Cities.module.scss\"\n\nconst Counts = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  margin: 1em 0px;\n`;\n\nconst Count = styled.div`\n  // border: 1px solid red;\n\n  display: flex;\n  justify-content: center;\n\n  width: 50%;\n  text-align: center;\n  position: relative;\n  padding: 0.1em;\n`;\n\nconst IonIcon = styled(_IonIcon)`\n  font-size: 2em;\n  color: ${p=>p.theme.darkGrey};\n`;\n\nconst Number = styled.div`\n  // border: 1px solid green;\n\n  padding: 0.5em;\n\n  color: ${p=>p.theme.lightGrey};\n  font-size: 0.9em;\n  font-weight: 600;\n`;\n\nconst Cities = (props) => {\n  const [cities, setCities] = useState([]);\n  const [filteredCities, setFilteredCities] = useState([]);\n  const [showLoading, setShowLoading] = useState(false);\n  const api = useApi()\n  const history = useHistory()\n\n  useEffect(() => {\n    setShowLoading(true);\n    api.getCities().then(res => {\n      setShowLoading(false);\n      setFilteredCities(res);\n      setCities(res);\n    });\n  }, [])\n\n  const filterHandler = (ev) => {\n    let filteredCities = cities.filter(city => {\n      return city.name.toLowerCase().indexOf(ev.target.value.trim().toLowerCase()) > -1;\n    });\n    setFilteredCities(filteredCities);\n  }\n\n  return <F>\n    <Wrapper className='cities' >\n      <h1 className=\"heading\" >Cities</h1>\n\n      <div className=\"filter-section\">\n        <input className=\"filter-input\" onChange={filterHandler} />\n        <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n      </div>\n\n      { /* @TODO: re-add! */ }\n      { /* <div className=\"bookmark-section\">\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={() => { }} checked />\n          <span className=\"slider round\"></span>\n        </label>\n        <span className=\"bookmark-text\">Show only bookmarked</span>\n      </div> */ }\n\n      <div className=\"container\">\n        { filteredCities.map((city, i) => <div key={i} className=\"cities\" onClick={() => history.push(AppRouter.cityPath(city.slug)) } >\n            <div className=\"img-section\">\n              <span className=\"bookmark\" >\n                <IonIcon className=\"bookmark-icon\" icon={bookmark}></IonIcon>\n              </span>\n              <img className=\"city-img\" src={city.photo} />\n              <span className=\"city-title\">{city.name}</span>\n            </div>\n            <Counts>\n              <Count>\n                { /* @TODO: wire in theme provider */ }\n                <Number >{city.n_reports}</Number>\n                <IonIcon icon={newspaperOutline}></IonIcon>\n\n              </Count>\n              <Count>\n\n                <Number >{city.n_galleries}</Number>\n                <IonIcon icon={image}></IonIcon>\n              </Count>\n              <Count>\n\n                <Number >{city.n_videos}</Number>\n                <IonIcon icon={videocam}></IonIcon>\n              </Count>\n            </Counts>\n          </div>\n        ) }\n      </div>\n      &nbsp;\n    </Wrapper>\n\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </F>\n}\n\nexport default Cities;\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\nimport { NewsitemContainer } from './'\n\nimport \"./Newsitems.module.scss\"\n\nconst Images = styled.div`\n  // border: 1px solid red;\n\n  position: relative;\n  width: 100%;\n  max-width: 600px;\n  height: 0;\n  padding-bottom: min( 400px, 66.66% );\n\n  margin: auto;\n`;\n\nconst Thumb0 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 1px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n\n  width: 66.66%;\n  height: 0;\n  padding-bottom: 66.66%;\n\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst Thumb1 = styled.div`\n  // background: #660000;\n\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 0 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 0;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  background-color: #dedede; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst _Thumb2 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 50%;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n\n  background-color: #c4c4c4; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\nconst Thumb2 = ({ children, src, ...props }) => {\n  return <_Thumb2\n    style={{ background: src }}\n  ><div style={{ marginTop: 'calc( 50% - 0.5em )' }} >{children}</div></_Thumb2>\n}\n\n/**\n * NewsitemGallery\n */\nconst NewsitemGallery = (props) => {\n  // logg(props, 'NewsitemGallery')\n  const { item, variant } = props\n\n  const navigateToItem = () => {\n    toast('this click is not implemented!')\n    logg('not implemented')\n  }\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <Images className='Images' onClick={navigateToItem} >\n      <Thumb0 src={item.photos[0] && item.photos[0].thumb_url} />\n      <Thumb1 src={item.photos[1] && item.photos[1].thumb_url} />\n      <Thumb2 src={item.photos[2] && item.photos[2].thumb_url} >({item.n_photos} photos)</Thumb2>\n    </Images>\n  </NewsitemContainer>\n}\nNewsitemGallery.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired,\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemGallery\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { NewsitemContainer } from './'\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\nconst ImageLarge = styled.img`\n  max-width: 100%;\n`;\n\nconst W = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\n/**\n * default\n */\nconst NewsitemPhoto = (props) => {\n  // logg(props, 'NewsitemPhoto')\n  const { item, variant } = props\n\n  return <NewsitemContainer className='Newsitem NewsitemPhoto' {...{ item, variant }} >\n    <W>\n      { item.photos[0] && <ImageLarge src={item.photos[0].large_url} /> }\n    </W>\n  </NewsitemContainer>\n}\n\nNewsitemPhoto.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired, // @TODO: this is wrong, just show one photo\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemPhoto\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon, NewsitemContainer } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, C, logg, request, TwofoldContext } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\n\nconst NewsitemReport = (props) => {\n  // logg(props, \"NewsitemReport\");\n  const { item, variant, } = props\n  return (<NewsitemContainer item={item} variant={variant} />)\n}\n\nNewsitemReport.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemReport\n\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { NewsitemContainer } from \"./\"\n\nimport \"./Newsitems.module.scss\"\n\n/**\n * NewsitemVideo\n *\n**/\nconst NewsitemVideo = (props) => {\n  // logg(props, 'NewsitemVideo')\n  const { item, variant } = props\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <div style={{ display: 'flex', justifyContent: 'center' }} >\n      { item.youtube_id ?\n          <iframe className=\"iframe\" width=\"100%\" height=\"315\" src={`https://www.youtube.com/embed/${item.youtube_id}`} frameBorder=\"0\" allow=\"autoplay; encrypted-media\" allowFullScreen></iframe>\n          : <video style={{ maxWidth: '100%', maxHeight: '50vh' }}  preload=\"metadata\" height=\"auto\" controls><source src={item.url} type=\"video/mp4\" /></video>\n      }\n    </div>\n  </NewsitemContainer>\n}\n\nNewsitemVideo.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemVideo","\nimport PropTypes from 'prop-types'\nimport React, { useContext, } from \"react\"\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport { GenericNewsitem } from \"./\"\nimport NewsitemGallery from \"$components/newsitems/NewsitemGallery\"\nimport NewsitemReport from \"$components/newsitems/NewsitemReport\"\nimport NewsitemPhoto from \"$components/newsitems/NewsitemPhoto\"\nimport NewsitemVideo from \"$components/newsitems/NewsitemVideo\"\nimport {\n  Btn,\n  C,\n  logg,\n  TwofoldContext,\n  useApi,\n} from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\nconst ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nconst W0 = styled.div`\n`;\n\nconst W1 = styled.div`\n  position: relative;\n`;\n\nconst _EditModeActions = styled.div`\n  position: absolute;\n  right: 1em;\n  top: 1em;\n  z-index: 2;\n`;\nconst EditModeActions = ({ children, ...props }) => {\n  // logg(props, 'EditModeActions')\n  const { item } = props\n\n  const {\n    editorMode,\n  } = useContext(TwofoldContext)\n\n  if (!editorMode) { return null }\n\n  const api = useApi()\n\n  const removeStory = (e) => {\n    if (!confirm('Are you sure?')) { return }\n    api.deleteNewsitem({ id: item.newsitem_id }).then((resp) => {\n      toast('Removed the story')\n    }).catch((err) => {\n      logg('320 - cannot delete newsitem')\n    })\n  }\n\n  return <_EditModeActions>\n\n    <Btn onClick={removeStory} >\n      Remove Story\n    </Btn>\n\n  </_EditModeActions>\n}\n\n/**\n * Newsitems\n**/\nconst Newsitems = (props) => {\n  // logg(props, 'Newsitems')\n  const { newsitems=[], variant } = props\n\n  if (!newsitems.length) { return <div>No Newsitems</div> }\n\n  return (\n    <W0 className=\"Newsitems\" {...{ variant }} >\n      { newsitems.map((newsitem, idx) => {\n        const premium_tier = newsitem.premium_tier || 0\n        const icon = ICONS[premium_tier]\n        let item\n\n        switch (newsitem.item_type) {\n          case C.item_types.gallery:\n            item = <NewsitemGallery item={newsitem} variant={variant} />\n            break\n          case C.item_types.report:\n            item = <NewsitemReport  item={newsitem} variant={variant} />\n            break\n          case C.item_types.video:\n            item = <NewsitemVideo   item={newsitem} variant={variant} />\n            break\n          case C.item_types.photo:\n            item = <NewsitemPhoto   item={newsitem} variant={variant} />\n            break\n          default:\n            item = <GenericNewsitem item={newsitem} />\n        }\n\n        return (\n          <W1 key={idx} className={`premium-${premium_tier}`} >\n            <EditModeActions item={newsitem} />\n            { item }\n          </W1>\n        )\n      }) }\n    </W0>\n  )\n}\n\nNewsitems.propTypes = {\n  newsitems: PropTypes.array.isRequired,\n  variant: PropTypes.string,\n}\nexport default Newsitems\n","\nimport React, { useContext, useEffect, useState } from 'react'\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  FlexCol, FlexRow,\n  logg,\n} from 'ishlibjs'\n\nimport {\n  C,\n  TwofoldContext,\n  useApi,\n} from \"$shared\"\n\nconst _IconUp = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n      width=\"20px\" height=\"20px\" viewBox=\"0 0 124.138 124.138\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.138 124.138' }}\n    >\n      <g><path d=\"M50.569,124.138h23.1c4.7,0,9-3.8,9-8.601V81.138c0-4.7,3.5-9,8.2-9h14.699c7.2,0,11.2-8.101,6.801-13.8l-44.101-55\n     c-3.5-4.5-10.2-4.4-13.6,0l-42.9,55c-4.4,5.699-0.4,13.8,6.8,13.8h14.8c4.7,0,8.3,4.2,8.3,9v34.399\n     C41.669,120.338,45.769,124.138,50.569,124.138z\"/></g>\n      <g></g><g></g><g></g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n   </svg>\n </div>\n}\nconst IconUp = styled(_IconUp)`\n  cursor: pointer;\n`;\n\n\nconst _IconDown = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n\t    width=\"20px\" height=\"20px\" viewBox=\"0 0 124.075 124.075\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.075 124.075' }}\n\t  >\n      <g><path d=\"M54.628,120.7c3.5,4.5,10.2,4.5,13.601,0l44.1-54.9c4.4-5.7,0.4-13.8-6.8-13.8h-14.7c-4.7,0-8.2-4.2-8.2-9V8.6\n\t\tc0-4.8-4.2-8.6-9-8.6h-23.1c-4.8,0-8.9,3.8-8.9,8.6V43c0,4.7-3.6,9-8.3,9h-14.8c-7.1,0-11.2,8-6.8,13.7L54.628,120.7z\"/>\n      </g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </div>\n}\nconst IconDown = styled(_IconDown)`\n  cursor: pointer;\n`;\n\nconst WCount = styled.div`\n  text-align: center;\n`;\n\n/**\n * Votable\n *\n**/\nconst Votable = (props) => {\n  // logg(props, 'Votable')\n  const { item } = props\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'Votable Used AuthContext')\n\n  const api = useApi()\n\n  const [ votesScore, setVotesScore ] = useState('undefined' === typeof item.votes_score ? '-' : item.votes_score)\n  const [ upFill, setUpFill ] = useState(\"#cecece\")\n  const [ downFill, setDownFill ] = useState(\"#cecece\")\n\n  const [ currentUserVoteValue, setCurrentUserVoteValue ] = useState(item.current_user_vote_value)\n  useEffect(() => {\n\n    // logg(currentUserVoteValue, 'currentUserVoteValue')\n    // logg(C.vote_values.up, 'one?')\n    // logg(C.vote_values.down, 'two?')\n    // logg(currentUserVoteValue === C.vote_values.up, 'three?')\n    // logg(currentUserVoteValue === C.vote_values.down, 'four?')\n\n\n    if (currentUserVoteValue === C.vote_values.up) {\n      setUpFill('#cc3333')\n      setDownFill('#cecece')\n    }\n    if (currentUserVoteValue === C.vote_values.down) {\n      setUpFill('#cecece')\n      setDownFill('#cc3333')\n    }\n  }, [currentUserVoteValue])\n\n\n  const voteUp = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.up) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n\n      api.vote({\n        value: C.vote_values.up,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'upvoted')\n        setUpFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.up)\n        if (currentUserVoteValue === C.vote_values.down) {\n          setDownFill('#cecece')\n          setVotesScore(votesScore + 2)\n        } else {\n          setVotesScore(votesScore + 1)\n        }\n      })\n\n      // api.vote({\n      //   value: C.vote_values.up,\n      //   votee_class_name: item.item_type, // eg Video\n      //   votee_id: item.id,\n      //   voter_id: currentUser.id,\n      // })\n    }\n  }\n  const voteDown = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.down) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n      api.vote({\n        value: C.vote_values.down,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'downvoted')\n        setDownFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.down)\n        if (currentUserVoteValue === C.vote_values.up) {\n          setUpFill('#cecece')\n          setVotesScore(votesScore - 2)\n        } else {\n          setVotesScore(votesScore - 1)\n        }\n      })\n    }\n  }\n\n  return <FlexCol>\n    <IconUp onClick={voteUp} width={20} height={20} fill={upFill} />\n    <WCount>{ votesScore}</WCount>\n    <IconDown onClick={voteDown} width={20} height={20} fill={downFill} />\n  </FlexCol>\n}\nVotable.propTypes = {\n\n};\n\nexport default Votable\n","\nimport Votable from './Votable'\nexport default Votable\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory, } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport {\n  ItemIcon,\n} from \"./\"\nimport {\n  Metaline,\n} from \"$components/application\"\nimport Votable from \"$components/Votable\"\nimport {\n  C, Card,\n  inflector,\n  logg,\n  request,\n  TwofoldContext,\n  WidgetContainer,\n} from \"$shared\"\n\n// alphabetized\n\nconst Col = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst _Row = styled.div`\n  display: flex;\n  align-items: flex-start;\n\n  margin-top: ${p=>p.theme.smallWidth};\n`;\nconst Row = ({ children, ...props }) => <_Row className='Row' {...props}>{children}</_Row>\n\nconst RowInline = styled.div`\n  > * {\n    display: inline;\n  }\n`;\n\nconst Title = styled.h2`\n  margin-top: 0;\n  margin-bottom: 0;\n  color: ${p=>p.theme.colors.text};\n`;\n\n// @TODO: better management of navigateToItem\nconst W0 = (props) => {\n  // logg(props, 'W0')\n  const { children, navigateToItem, variant } = props\n\n  switch (variant) {\n    case C.variants.bordered:\n      return <WidgetContainer {...props} cursor=\"pointer\" >{ children }</WidgetContainer>\n    default:\n      return <Card boxShadow={2} {...props} onClick={navigateToItem} cursor=\"pointer\" ></Card>\n  }\n}\n\n\n\n/**\n * NewsitemContainer\n *\n * @TODO: should be config with variants: standard container, container for a single photo, etc.\n * but for now I'll use item.item_type\n * _vp_ 2022-03-13\n *\n**/\nconst NewsitemContainer = ({ children, ...props }) => {\n  // logg(props, 'NewsitemContainer')\n  const {\n    className,\n    item,\n    variant,\n  } = props\n  const { item_type, slug } = item\n\n  const history = useHistory()\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    layout,\n    location,\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'NewsitemContainerUsedContext')\n\n  // @TODO: move this elsewhere - make generic, remember there are two routers, internal and external.\n  // move this to internal router\n  // @TODO: for Photo, navigateToItem can show full-screen pic. _vp_ 2022-04-17\n  const navigateToItem = () => {\n    if (item.is_premium && !item.is_purchased) {\n      setItemToUnlock(item)\n    } else {\n      if (layout === C.layout_mapui) {\n        history.push(`/en/locations/show/${location.slug}/${inflector.tableize(item_type)}/show/${slug}`)\n      } else {\n        history.push(`/en/${inflector.tableize(item_type)}/show/${slug}`)\n      }\n    }\n  }\n\n  if (item.item_type === C.item_types.photo) {\n\n    return <W0 {...{ className, navigateToItem: () => {}, variant }} >\n      <Col>\n        <Title>{item.name}</Title>\n        <Metaline {...item} />\n      </Col>\n      { children }\n    </W0>\n\n  } else {\n    return <W0 {...{ className, navigateToItem, variant }} >\n      { children }\n      <Row >\n        <Col style={{ alignItems: 'center' }} >\n          <Votable item={item} />\n        </Col>\n        <Col style={{ overflowWrap: 'break-word' }} >\n          <RowInline>\n            <ItemIcon {...item} />\n            <Title onClick={navigateToItem} >{item.name}</Title>\n          </RowInline>\n          <Metaline {...item} />\n        </Col>\n      </Row>\n      { item.subhead && item.subhead.length && <p className=\"subhead\" dangerouslySetInnerHTML={{ __html: item.subhead }} /> }\n    </W0>\n  }\n}\nNewsitemContainer.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemContainer\n","\nimport * as Ic from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport styled, { useTheme } from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\nconst ReportIcon = () => <div>@TODO: ReportIcon</div>\n\nconst _Icon = styled.span`\n  margin: 0 ${p => p.theme.smallWidth} 0 0;\n`;\n\nconst IconGallery = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n      viewBox=\"0 0 45.964 45.964\" style={{ enableBackground: 'new 0 0 45.964 45.964' }}\n    ><g><g><path d=\"M7.071,30.834V11.062H4.042C1.803,11.062,0,12.893,0,15.13v26.732c0,2.24,1.803,4.051,4.042,4.051h26.733    c2.238,0,4.076-1.811,4.076-4.051v-2.92H15.179C10.733,38.943,7.071,35.281,7.071,30.834z\"/>   <path d=\"M41.913,0.05H15.179c-2.238,0-4.066,1.813-4.066,4.051v26.733c0,2.241,1.829,4.067,4.066,4.067h26.734    c2.237,0,4.051-1.826,4.051-4.067V4.102C45.964,1.862,44.15,0.05,41.913,0.05z M41.363,28.589    c-0.223,0.412-0.652,0.656-1.12,0.656H17.336c-0.403,0-0.782-0.18-1.022-0.502c-0.24-0.324-0.313-0.736-0.197-1.123l3.277-10.839    c0.216-0.713,0.818-1.24,1.554-1.361c0.736-0.12,1.476,0.19,1.908,0.797l4.582,6.437c0.617,0.867,1.812,1.082,2.689,0.484    l4.219-2.865c0.434-0.295,0.967-0.402,1.48-0.299c0.515,0.102,0.966,0.408,1.253,0.848l4.229,6.472    C41.564,27.687,41.585,28.179,41.363,28.589z\"/>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\nconst IconGem = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.gold\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg viewBox=\"0 -32 576 576\" xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n    ><path d=\"M485.5 0L576 160H474.9L405.7 0h79.8zm-128 0l69.2 160H149.3L218.5 0h139zm-267 0h79.8l-69.2 160H0L90.5 0zM0 192h100.7l123 251.7c1.5 3.1-2.7 5.9-5 3.3L0 192zm148.2 0h279.6l-137 318.2c-1 2.4-4.5 2.4-5.5 0L148.2 192zm204.1 251.7l123-251.7H576L357.3 446.9c-2.3 2.7-6.5-.1-5-3.2z\"/>\n    </svg>\n  </_Icon>\n}\n\nconst IconGlasses = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.cyan\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGlasses'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 297 297\"\n      style={{ enableBackground: 'new 0 0 297 297' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M115.167,101.47H24.012C10.751,101.469,0,112.22,0,125.482v43.477c0,14.674,11.896,26.57,26.57,26.57h39.67     c21.977,0,41.223-14.737,46.954-35.953l10.297-45.336c0.633-3.567-0.276-7.232-2.431-9.804     C120.132,103.328,118.132,101.47,115.167,101.47z M24.542,138.106c-1.945,0-3.888-0.742-5.373-2.225     c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747     l-5.428,5.428C28.432,137.364,26.487,138.106,24.542,138.106z M64.111,130.453l-21.71,21.71     c-1.484,1.483-3.429,2.225-5.374,2.225c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71     c2.968-2.966,7.779-2.966,10.747,0C67.078,122.674,67.078,127.485,64.111,130.453z\"/>    <path d=\"M160.885,106.524h-26.517c0.575,3.345,0.587,6.828-0.021,10.307l-2.22,12.693h31l-2.22-12.693     C160.299,113.352,160.311,109.868,160.885,106.524z\"/>    <path d=\"M272.988,101.47h-94.649c-2.965,0-4.965,1.858-5.893,2.966c-2.155,2.572-3.064,6.236-2.43,9.804l10.296,45.336     c5.731,21.216,24.977,35.954,46.954,35.954h43.164c14.674-0.001,26.57-11.897,26.57-26.571v-43.477     C297,112.22,286.249,101.47,272.988,101.47z M192.422,135.881c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428     c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747l-5.428,5.428c-1.484,1.483-3.429,2.225-5.374,2.225     C195.851,138.106,193.906,137.364,192.422,135.881z M237.363,130.453l-21.71,21.71c-1.484,1.483-3.429,2.225-5.374,2.225     c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71c2.968-2.966,7.779-2.966,10.747,0     C240.33,122.674,240.33,127.485,237.363,130.453z\"/>   </g>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\n\nconst IconReport = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconReport'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 184.153 184.153\" style={{ enableBackground: 'new 0 0 184.153 184.153' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M129.318,0H26.06c-1.919,0-3.475,1.554-3.475,3.475v177.203c0,1.92,1.556,3.475,3.475,3.475h132.034 c1.919,0,3.475-1.554,3.475-3.475V34.131C161.568,22.011,140.771,0,129.318,0z M154.62,177.203H29.535V6.949h99.784 c7.803,0,25.301,18.798,25.301,27.182V177.203z\"/><path d=\"M71.23,76.441c15.327,0,27.797-12.47,27.797-27.797c0-15.327-12.47-27.797-27.797-27.797 c-15.327,0-27.797,12.47-27.797,27.797C43.433,63.971,55.902,76.441,71.23,76.441z M71.229,27.797 c11.497,0,20.848,9.351,20.848,20.847c0,0.888-0.074,1.758-0.183,2.617l-18.071-2.708L62.505,29.735    C65.162,28.503,68.112,27.797,71.229,27.797z M56.761,33.668l11.951,19.869c0.534,0.889,1.437,1.49,2.462,1.646l18.669,2.799    c-3.433,6.814-10.477,11.51-18.613,11.51c-11.496,0-20.847-9.351-20.847-20.847C50.381,42.767,52.836,37.461,56.761,33.668z\"/>   <rect x=\"46.907\" y=\"90.339\" width=\"73.058\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"107.712\" width=\"48.644\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"125.085\" width=\"62.542\" height=\"6.949\"/>  </g></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </_Icon>\n}\n\nconst IconVideo = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconVideo' >\n    <svg width={w} height={h} viewBox=\"0 0 33 33\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path fillRule=\"evenodd\" clipRule=\"evenodd\"\n        fill={fill}\n        d=\"M9.89989 0H29.6999C31.5149 0 32.9999 1.485 32.9999 3.3V23.1C32.9999 24.915 31.5149 26.4 29.6999 26.4H9.89989C8.08489 26.4 6.59989 24.915 6.59989 23.1V3.3C6.59989 1.485 8.08489 0 9.89989 0ZM0 6.6H3.3V29.7H26.4V33H3.3C1.485 33 0 31.515 0 29.7V6.6ZM29.7 23.1H9.89997V3.3H29.7V23.1ZM16.5001 20.625V5.775L26.4001 13.2L16.5001 20.625Z\" />\n    </svg>\n  </_Icon>\n}\n\nconst _W0 = styled.div`\n  // border: 1px solid red;\n\n  display: inline;\n  box-sizing: border-box;\n`;\nconst W0 = ({ children, ...props }) => <_W0 className='ItemIcon' {...props}>{children}</_W0>\n\n/**\n * Displays the appropriate icon.\n *\n * @param [Boolean] props.isPurchased\n * @param [Number] props.premiumTier\n * @param [String] props.kind\n */\n export const ItemIcon = (props) => {\n  // logg(props, \"ItemIcon\")\n  const { is_purchased, item_type, premium_tier } = props\n\n  const out = []\n\n  if (premium_tier > 0) {\n    if (is_purchased) {\n      out.push(<IconGlasses key='IconGlasses' />)\n    } else {\n      out.push(<IconGem key='IconGem' />)\n    }\n  }\n  switch (item_type) {\n    case C.item_types.gallery:\n      out.push(<IconGallery key='IconGallery' />)\n      break\n    case C.item_types.report:\n      out.push(<IconReport key='IconReport' />)\n      break\n    case C.item_types.video:\n      out.push(<IconVideo key='IconVideo' />)\n      break\n    default:\n      out.push(<span key='unknown-kind'>[&nbsp;?&nbsp;]</span>)\n  }\n  return <W0>{out}</W0>\n}\nItemIcon.propTypes = {\n  is_purchased: PropTypes.bool, // .isRequired,\n  item_type: PropTypes.string.isRequired,\n  premium_tier: PropTypes.number,\n}\nexport default ItemIcon\n","/*\n * $components / newsitems / index.jsx\n */\nimport React, { Fragment as F, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { Box, inflector, logg } from \"$shared\"\n\n/* G */\n\nexport const GenericNewsitem = (props) => {\n  // logg(props, 'GenericNewsitem')\n  const { item } = props\n\n  return <F>\n    generic newsitem\n    <div dangerouslySetInnerHTML={{ __html: item.description }} />\n  </F>\n}\n\n/* N */\nexport { default as NewsitemGallery } from \"./NewsitemGallery\"\nexport { default as NewsitemPhoto } from \"./NewsitemPhoto\"\nexport { default as NewsitemReport } from \"./NewsitemReport\"\nexport { default as Newsitems } from \"./Newsitems\"\nexport { default as NewsitemContainer } from \"./NewsitemContainer\"\n\n\n\n/* I */\nexport const ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nexport { default as ItemIcon } from \"./ItemIcon\"\n\n/* V */\n\n","import { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport { IonPage, IonContent, IonButton, IonImg, IonIcon } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Rating } from \"$components/application\"\n\nimport \"./Venues.module.scss\"\n\nconst Address = styled.p`\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: ${p => p.theme.darkGrey };\n  font-size: 14px;\n`;\n\nconst Col = styled.div``;\n\n// right arrow container\nconst _Ra = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\nconst RightArrow = () => <_Ra><img className=\"forward-arrow\" src=\"/assets/16x16/arrow-right.png\" /></_Ra>\n\nconst Row = styled.div`\n  display: flex;\n`;\n\nconst Title = styled.div`\n  font-size: 1.5em;\n`;\n\nconst Venue = styled.div`\n  width: 100vw;\n  padding: 1em;\n  margin-bottom: 0.5em;\n  border-bottom: 1px solid #e3d3d3;\n  box-shadow: 0px 1px 5px 1px #b3aeae;\n  background-color: white;\n  position: relative;\n\n  display: flex;\n  justify-content: space-between;\n\n  img.thumb {\n    border-radius: 10px;\n  }\n\n  > div {\n    // border: 1px solid red;\n  }\n`;\n\nconst Venues = (props) => {\n  logg(props, 'Venues')\n\n  const defaultRating = 3.5\n  const [filteredVenues, setFilteredVenues] = useState(props.venues)\n\n  function filterHandler(ev) {\n    let venues = props.venues.filter(venue => {\n      return venue.name.toLowerCase().includes(ev.target.value.toLowerCase())\n    })\n    setFilteredVenues(venues)\n  }\n\n  return (\n    <div className=\"venues-section\">\n      <div>\n        <div className=\"filter-section\">\n          <input className=\"filter-input\" onChange={filterHandler} />\n          <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n        </div>\n      </div>\n      <div className=\"container\">\n\n        { filteredVenues.map((venue, idx) => <Venue key={idx} >\n          <Row>\n            <Col><img style={{ paddingRight: '1em' }} className='thumb' src={venue.photo} /></Col>\n            <Col>\n              <Title>{venue.name}</Title>\n              <div className=\"rating-section\">\n                <Rating rate={defaultRating}></Rating>\n                <span className=\"reviews\">5 reviews</span>\n              </div>\n              <div className=\"tags-section\">\n                { venue.tags.map((tag, idx) => <span key={idx} className=\"tags\">{tag.name}</span> )}\n              </div>\n              <p className=\"description\" dangerouslySetInnerHTML={{ __html: venue.subhead }}></p>\n              { venue.address && <Address>{venue.address}</Address> }\n            </Col>\n\n          </Row>\n          <RightArrow />\n        </Venue> )}\n\n      </div>\n    </div>\n  )\n}\n\nVenues.propTypes = {\n  venues: PropTypes.array.isRequired,\n}\nexport default Venues\n","import React, { useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react'\nimport { pin, newspaperOutline, image, videocam } from 'ionicons/icons'\n\nimport { AppRouter, useApi, logg, Wrapper } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { Venues } from \"$components/venues\"\nimport \"./Cities.module.scss\"\n\nconst CitiesShow = (props) => {\n  logg(props, 'CitiesShow')\n  const { match } = props\n\n  const api = useApi()\n  const history = useHistory()\n  const thisPath = AppRouter.cityPath(match.params.name)\n\n  const location = useLocation()\n\n  const [city, setCity] = useState(null)\n  const [showLoading, setShowLoading] = useState(false)\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    setShowLoading(true)\n    api.getCity(match.params.name).then(res => {\n      if (mountedRef.current) {\n        setCity(res.data.city)\n        setShowLoading(false)\n      }\n    })\n    return () => mountedRef.current = false\n  }, [match.params.name])\n\n  // @TODO: remove this!\n  function changeMenuHandler(menu) {\n    // history.push(`${match.url}/${menu}`);\n  }\n\n  return <Wrapper>\n\n    { city && <div className='wrapper'>\n      <div className='city-show'>\n\n        <header style={{ backgroundImage: `url(${city.hero_img}}`, backgroundSize: \"contain\" }}></header>\n\n        <section className=\"section-one\">\n          <IonIcon icon={pin} className=\"location\"></IonIcon>\n          <h1 className=\"city-name\">{city.name}</h1>\n          <div className=\"status\">\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={newspaperOutline}></IonIcon>\n              <span className=\"numbers\">{city.n_reports}</span>\n            </div>\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={image}></IonIcon>\n              <span className=\"numbers\">{city.n_galleries}</span>\n            </div>\n            <div className=\"status-grid mid\">\n              <IonIcon className=\"info-icon\" icon={videocam}></IonIcon>\n              <span className=\"numbers \">{city.n_videos}</span>\n            </div>\n          </div>\n        </section>\n\n        { /* @TODO: re-add tags here! */ }\n        { /* city.tags && <section className=\"tags-section\">\n          <span className=\"btn delete-btn\" >\n            <IonIcon name=\"close\"> </IonIcon> deselect all\n          </span>\n          { city.tags.map((tag, i) => <span className=\"btn\" key={i} >{tag.name}</span>) }\n        </section> */ }\n\n        <section className=\"section-three\">\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityPath(match.params.name))} >\n            <img src=\"/assets/newsfeed-icon.svg\" alt=\"Newsfeed\" />\n            <p className={`${location.pathname == thisPath ? \"selected\" : \"\"} menu-item`}>Newsfeed</p>\n          </div>\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityVenuesPath(match.params.name))} >\n            <img src=\"/assets/venue-icon.svg\" alt=\"Venues\" />\n            <p className={`${location.pathname.includes(\"venues\") ? \"selected\" : \"\"} menu-item`}>Venues</p>\n          </div>\n        </section>\n\n\n        <Switch>\n          <Route exact path={`${match.url}/venues`} render={() => <Venues    venues={city.venues} />} />\n          <Route exact path={match.url}             render={() => <Newsitems newsitems={city.newsitems} /> } />\n        </Switch>\n\n\n      </div>\n    </div>}\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n    <br /><br /><br />\n  </Wrapper>\n}\n\nexport default CitiesShow\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport {\n  C, logg, request, TwofoldContext, BackBtn,\n} from \"$shared\"\n\nimport styles from \"./Galleries.module.scss\"\n\nconst W0 = styled.div`\n  // border: 1px solid blue;\n  height: auto;\n`;\n\n/**\n * GalleriesShow\n *\n**/\nconst GalleriesShow = (props) => {\n  // logg(props, 'GalleriesShow')\n  const { match } = props // @TODO: this doesnt look like a prop, remove\n\n  const [showLoading, setShowLoading] = useState(false) // @TODO: hmm could it be moved to TwofoldContext ?\n  const [gallery, setGallery] = useState({})\n\n  const mountedRef = useRef('init')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n  } = useContext(TwofoldContext)\n\n  // @TODO: move this into api\n  let getGallery = async () => {\n    const token = localStorage.getItem(C.jwt_token)\n    await request.get(`/api/galleries/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (!mountedRef.current) { return }\n      const gallery = res.data.gallery\n      if (gallery.is_premium && !gallery.is_purchased) {\n        setItemToUnlock(gallery)\n      } else {\n        setGallery(res.data.gallery)\n      }\n    }).catch((err) => {\n      logg(err, 'e65')\n    })\n  }\n\n  useEffect(() => {\n    getGallery()\n    return () => {\n      mountedRef.current = null\n    }\n  }, [gallery.id, itemToUnlock.id] )\n\n  return <W0 className={styles.GalleriesShow} >\n\n    <div className={styles.narrow} >\n      <h1 className={styles.heading} >\n        <BackBtn />\n        <span className={styles.title} >{gallery.name}</span>\n      </h1>\n      <Metaline {...gallery} />\n\n      <div className={styles.thumbs} >\n        { gallery.photos && gallery.photos.map((ph, i) =>\n          <div className={styles.card} key={i}>\n            <div>\n              <IonImg src={ph.thumb_url}></IonImg>\n            </div>\n          </div>\n        ) }\n      </div>\n\n      <div dangerouslySetInnerHTML={{ __html: gallery.description }}></div>\n\n    </div>\n    <div className={styles.full_img_section} >\n\n      { gallery.photos && gallery.photos.map((ph, i) =>\n        <div className={styles.item} key={i}>\n          <img src={ph.large_url} />\n        </div>\n      ) }\n\n    </div>\n\n  </W0>\n}\n\nexport default GalleriesShow","import React, { useEffect, useState } from \"react\";\nimport { IonLoading } from \"@ionic/react\";\n\nimport request from \"$shared/request\";\nimport { logg } from \"$shared\";\nimport { Galleries } from \"./\";\nimport { NewsitemGallery } from \"$components/newsitems\";\n\nconst MyGalleries = (props) => {\n  const [galleries, setGalleries] = useState(null);\n  const [showLoading, setShowLoading] = useState(false);\n\n  useEffect(() => {\n    setShowLoading(true);\n    const token = localStorage.getItem(\"jwtToken\");\n    request.get(`/api/my/galleries`, { params: { jwt_token: token } }).then(r => {\n      logg(r.data, 'MyGalleries data')\n      setGalleries(r.data);\n      setShowLoading(false);\n    })\n  }, []);\n\n  return (<>\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n    { galleries && galleries.length && galleries.map((g) => <NewsitemGallery key={g.id} data={g} /> ) }\n  </>);\n}\n\nexport default MyGalleries;","\nimport React, {\n  useContext, useState,\n} from 'react'\nimport Modal from 'react-modal'\n\nimport {\n  MarkerContext, MarkerContextProvider,\n  MarkerForm,\n} from './'\nimport {\n  logg,\n} from '$shared'\n\nimport styles from './Markers.module.scss'\n\n/**\n * MarkerModal\n *\n * For editing/adding markers.\n**/\nconst MarkerModal = (props) => {\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n  // logg(useContext(MarkerContext), 'MarkerModalUsedContext')\n\n  return <Modal\n    className={`MarkerModal ${styles.MarkerModal}`}\n    isOpen={markerModalOpen}\n  >\n    <h1>\n      marker modal\n      <span onClick={() => setMarkerModalOpen(false)}>[x]</span>\n    </h1>\n    <MarkerForm />\n  </Modal>\n}\n\nexport default MarkerModal\nexport {\n  MarkerContext,\n  MarkerContextProvider,\n  MarkerModal,\n}\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory, } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  PurchasedIcon,\n  TwofoldContext,\n  WBordered, WBorderedItem,\n} from \"$shared\"\n\n/* M */\nconst _Marker = styled.div`\n  color: ${p => p.theme.colors.text};\n  margin: 0 auto 10px auto;\n  width: 120px;\n  text-align: center;\n`;\nconst Marker = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBorderedItem {...props} >{children}</WBorderedItem>\n  } else {\n    return <_Marker className=\"Marker\" {...props} >{children}</_Marker>\n  }\n}\n\n/* W */\nconst _W0 = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n`;\nconst W0 = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBordered {...props}>{children}</WBordered>\n  } else {\n    return <_W0 {...props}>{children}</_W0>\n  }\n}\n\n/**\n * Default\n */\nconst MarkersList = (props) => {\n  // logg(props, 'MarkersList')\n  const { variant } = props\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    showUrl, setShowUrl,\n  } = useContext(TwofoldContext)\n\n  const history = useHistory()\n\n  // @TODO: move this to the api object\n  const goto = (m) => {\n    if (m.premium_tier && !m.is_purchased) {\n      setItemToUnlock({ ...m })\n    } else {\n      if (m.url) {\n        setShowUrl(m.url)\n      }\n      else {\n        history.push(`/en/locations/show/${m.slug}`)\n      }\n    }\n  }\n\n  const out = []\n  props.markers.map((m, idx) => {\n    out.push(<Marker key={idx} variant={variant}\n      onClick={() => goto(m) }\n    >\n      <img src={m.title_img_path} /><br />\n      { m.is_purchased && <PurchasedIcon /> }\n      { m.name }\n    </Marker>)\n  })\n  const times = 12 - out.length % 12\n  for (let i = 0; i < times; i++) { // zero-height placeholders to prettify last row\n    out.push(<Marker variant={variant} key={`padded-${i}`} />)\n  }\n\n  return <W0 className=\"MarkersList\" >\n    {out}\n  </W0>\n}\n\nMarkersList.propTypes = {\n  variant: PropTypes.string,\n}\nexport default MarkersList\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * MarkerForm\n**/\nconst MarkerForm = (props) => {\n  // logg(props, 'MarkerForm')\n  const { item } = props\n\n  return <W0>\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='name' /> destination\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        map image\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        title image\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_active' /> active?\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_public' /> public?\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='url' /> url\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nMarkerForm.propTypes = {\n};\nexport default MarkerForm\n","\nimport React, {\n  useContext, useState,\n} from 'react'\nimport Modal from 'react-modal'\n\nconst MarkerContext = React.createContext({})\nconst MarkerContextProvider = ({ children, ...props }) => {\n\n  const [ marker, setMarker ] = useState()\n  const [ markerModalOpen, setMarkerModalOpen ] = useState(false)\n\n  return <MarkerContext.Provider value={{ marker, setMarker, markerModalOpen, setMarkerModalOpen, }}\n  >{children}</MarkerContext.Provider>\n}\n\n\nexport { default as MarkerModal } from './MarkerModal'\nexport {\n  MarkerContext,\n  MarkerContextProvider,\n}\nexport { default as MarkersList } from \"./MarkersList\"\nexport { default as MarkerForm } from './MarkerForm'\n","\nimport { Wrapper, Status } from \"@googlemaps/react-wrapper\"\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  MarkerContext,\n} from '$resources/markers'\nimport {\n  C, Card,\n  logg, logg4,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\nconst Actions = styled.div`\n  border: 1px solid red;\n\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  z-index: 2;\n`;\n\n// W\nconst W0 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.background};\n\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n`;\n\nconst W1 = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n  height: 100%;\n`;\n\nconst Marker = (options) => {\n  const [marker, setMarker] = React.useState();\n\n  React.useEffect(() => {\n    if (!marker) {\n      setMarker(new google.maps.Marker());\n    }\n\n    // remove marker from map on unmount\n    return () => {\n      if (marker) {\n        marker.setMap(null);\n      }\n    };\n  }, [marker]);\n  React.useEffect(() => {\n    if (marker) {\n      marker.setOptions(options);\n    }\n  }, [marker, options]);\n  return null;\n};\n\nconst MyMap = (props) => {\n  const {\n    center, zoom,\n  } = props\n\n  const ref = useRef()\n  const [map, setMap] = React.useState()\n\n  React.useEffect(() => {\n    if (map) {\n      [\"click\", \"idle\"].forEach((eventName) =>\n        google.maps.event.clearListeners(map, eventName)\n      );\n      if (onClick) {\n        map.addListener(\"click\", onClick);\n      }\n\n      if (onIdle) {\n        map.addListener(\"idle\", () => onIdle(map));\n      }\n    }\n  }, [map, onClick, onIdle]);\n\n  useEffect(() => {\n    if (ref.current && !map) {\n      setMap(new window.google.maps.Map(ref.current, { center, zoom, }));\n    }\n  }, [ref, map]);\n\n  return <div ref={ref} id=\"GoogleMaps\" />\n}\n\nconst Spinner = () => <h1>Loading...</h1>\nconst ErrorComponent = () => <h1>No luck loading GoogleMaps</h1>\nconst render = (status) => {\n  switch (status) {\n    case Status.LOADING:\n      return <Spinner />;\n    case Status.FAILURE:\n      return <ErrorComponent />;\n    case Status.SUCCESS:\n      return <MyMap />;\n  }\n};\n\n/**\n * GoogleMaps\n *\n**/\nconst GoogleMaps = (props) => {\n  // logg(props, 'GoogleMaps')\n  const { map } = props\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'GoogleMapsUsedContext')\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n\n  const history = useHistory()\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  // logg(useWindowSize(), 'usedWindowSize')\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <W0 className=\"GoogleMaps\" >\n\n    { editorMode && <Actions>\n      <Card onClick={() => setMarkerModalOpen(true)} >\n        + Marker\n      </Card>\n    </Actions> }\n\n    <Wrapper apiKey={\"AIzaSyDTM7RYKAlUS84jN1pCmydwEKxUTAMAn6c\"} render={render} >\n\n    </Wrapper>\n  </W0>\n}\n\nexport default GoogleMaps\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * ReportForm\n**/\nconst ReportForm = (props) => {\n  // logg(props, 'ReportForm')\n  const { item } = props\n\n  return <W0>\n\n    <h1>Report Form (@TODO: remove)</h1>\n\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <textarea name='name' /> subhead\n      </FlexRow>\n\n      <FlexRow>\n        item_type: default? longscroll?\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: editable slug, the fucking slug hasn't been solved in 10 years!\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: premium tier\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: tags\n      </FlexRow>\n\n      <FlexRow>\n        public?\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nReportForm.propTypes = {\n};\nexport default ReportForm\n","\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport PropTypes from 'prop-types'\n\nimport {\n  useApi, Card as Box, logg, request\n} from \"$shared\"\n\nconst W0 = styled.div``;\n\n/**\n * ReportsShow\n**/\nconst ReportsShow = (props) => {\n  // logg(props, \"ReportsShow\")\n\n  let [ item, setItem ] = useState({})\n  let api = useApi()\n\n  useEffect(() => {\n    api.getReport(props.match.params.slug).then((data) => {\n      setItem(data)\n    }).catch((err) => {\n      logg(err, 'cannot getReport')\n    })\n  }, [])\n\n  // @TODO: logged in and no access\n\n  // @TODO: logged in and access\n\n  return (<W0>\n    {/* <Box boxShadow={2}> */}\n      <h1>{item.name}</h1>\n      <div className=\"description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n    {/* </Box> */}\n  </W0>)\n}\nReportsShow.propTypes = {\n  // none?\n};\n\n// @TODO: wrap in login HOC\nexport default ReportsShow\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useHistory, useLocation, useParams } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  Actions,\n  CloseBtn,\n} from 'ishlibjs'\n\nimport { C, logg, TwofoldContext } from \"$shared\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport {\n  ReportsForm,\n  ReportsShow,\n} from \"$resources/reports\"\n\nimport styles from './ItemModal.module.scss'\n\n/**\n * ItemModal\n * @TODO: move to $components/application ?\n * shows items, but also I use it to create reports\n *\n**/\nconst ItemModal = (props) => {\n  // logg(props, 'ItemModal')\n  const { item } = props\n\n  const params = useParams()\n  const history = useHistory()\n\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n\n  const onClose = () => {\n    history.push(config.router.locationPath(params.slug))\n    setShowItem(null)\n  }\n\n  if (!item) { return }\n  if (!item.action) { item.action = C.actions.show } // set default\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`ItemModal ${styles.ItemModal}`}\n    isOpen={!!showItem}\n    // overlayClassName={styles.LoginModalOverlay}\n    // portalClassName={styles.LoginModalPortal}\n  >\n    <Actions >\n      <CloseBtn onClick={onClose} />\n    </Actions>\n    { item.item_type === C.item_types.report && item.action === C.actions.show && <ReportsShow match={{ params: { slug: item.reportname } }} /> }\n    { item.item_type === C.item_types.report && item.action === C.actions.new && <ReportsForm /> }\n    { item.item_type === C.item_types.gallery && <GalleriesShow match={{ params: { slug: item.slug } }} /> }\n    .^.\n  </Modal>\n}\n\nexport default ItemModal\n","\nimport { Toast } from \"@capacitor/toast\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  ItemModal,\n  MapPanel, MapPanelNoZoom,\n  RatedRestrictionModal,\n  WrappedMapPanel,\n} from \"./\"\nimport {\n  Breadcrumbs,\n  UnlockModal,\n} from \"$components/application\"\nimport {\n  MarkersList,\n  MarkerModal, MarkerContext, MarkerContextProvider,\n} from '$resources/markers'\nimport {\n  ReportForm,\n} from '$resources/reports'\nimport { CitiesList } from \"$components/cities\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport {\n  C, Card, ChevronLeft, ChevronRight, Collapsible,\n  FlexCol, FlexRow,\n  inflector,\n  Loading, logg,\n  MenuIcon,\n  request,\n  TwofoldContext,\n  useApi, useWindowSize,\n} from \"$shared\"\n\n/* C */\n\n/* D */\n\n// @TODO: move Description into shared ?\nconst _D = styled.div`\n`;\nconst Description = ({ item={} }) => {\n  if (!item.description) { return }\n\n  return <_D className=\"Description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n/* H */\nconst _Handle = styled.div`\n  // border: 1px solid cyan;\n\n  position: fixed;\n  top: 5px;\n  left: ${p => p.foldedLeft\n    ? '10px'\n    : p.foldedRight\n    ? '98%'\n    : `calc(${p.twofoldPercent*100}% - 10px)` };\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  width: 30px;\n  height: 95%; /* @TODO: this needs to account for bottom being open */\n`;\nconst Handle = (props) => {\n  const [ w ] = useWindowSize()\n\n  const [ offsetX, setOffsetX ] = useState()\n  const [ dragging, setDragging ] = useState(false)\n\n  const foldLeft = () => {\n    if (folded === C.foldedRight) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedLeft)\n    }\n  }\n\n  const foldRight = () => {\n    if (folded === C.foldedLeft) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedRight)\n    }\n  }\n\n  const {\n    folded, setFolded,\n    twofoldPercent, setTwofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const onMouseDown = (e) => {\n    setDragging(true)\n    setOffsetX(e.pageX)\n  }\n\n  const onMouseMove = (e) => {\n    if (!dragging) { return }\n    if (e.clientX === 0) { return }\n    const movedBy = e.clientX - offsetX\n    if (movedBy === 0) { return }\n    const movedByPercent = movedBy/w\n    setTwofoldPercent(prev => prev + movedByPercent)\n  }\n\n  const onMouseUp = (e) => {\n    setDragging(false)\n    // document.removeEventListener('mousemove', onMouseMove)\n    // document.removeEventListener('mousedown', onMouseDown)\n  }\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  // draggable=\"true\"\n  return <_Handle className=\"Handle\" {...{ foldedLeft, foldedRight, twofoldPercent }}\n    onMouseMove={onMouseMove}\n    onMouseDown={onMouseDown}\n    onMouseLeave={onMouseUp}\n    onMouseUp={onMouseUp}\n    style={{\n      pointer: 'cursor',\n    }}\n  >\n    {/* <MenuIcon /> */}\n    <ChevronLeft onClick={foldLeft} />\n    <ChevronRight onClick={foldRight} />\n    { [C.foldedRight, C.foldedLeft].indexOf(folded) !== -1  && <LongLine orientation={C.vertical} /> }\n  </_Handle>\n}\n\n/* I */\nconst IframeModal = (props) => {\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  return (<Modal ariaHideApp={false} isOpen={!!showUrl} >\n    <span onClick={() => {  setShowUrl(false) }} >[x]</span>\n\n    <iframe height=\"100%\" style={{ width: \"100%\", height: \"100%\" }} scrolling={\"yes\"} src={props.src}\n      frameBorder=\"no\" allowtransparency=\"true\" allowFullScreen={true} >\n    </iframe>\n  </Modal>)\n}\n\n/* L */\nconst Left = styled.div`\n  background: ${p => p.theme.colors.background};\n  flex: ${p => p.foldedRight ? '99%' : `${p.twofoldPercent*100}%` };\n  overflow: hidden;\n\n  display: flex;\n  flex-direction: column;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\n\n/* R */\n\nconst Right = styled.div`\n  background: ${p => p.theme.colors.background};\n  position: relative;\n\n  padding: 0 0 0 1em;\n  flex: ${p => p.foldedRight ? '2%' : `${(1-p.twofoldPercent)*100}%` };\n  overflow-x: hidden;\n  overflox-y: auto;\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\nconst Row = styled.div`\n  // border: 1px solid magenta;\n\n  display: flex;\n  position: relative;\n`;\n\n\n/**\n * LocationsShowDesktop\n *\n * @TODO: re-introduce MenuIcon in Handle. _vp_ 2022-09-01\n**/\nconst LocationsShowDesktop = (props) => {\n  // logg(props, 'LocationsShowDesktop')\n  const { match } = props\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [ loading, setLoading ] = useState(false)\n  const [ markers, setMarkers ] = useState([])\n\n  const mountedRef = useRef(C.ref.init)\n  const showItemRef = useRef(C.ref.init)\n  const mapPanelRef = useRef(null)\n  const api = useApi()\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    location, setLocation,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  useEffect(() => {\n    if (location) {\n      setMarkers(location.markers)\n\n      if (location.is_premium && !location.is_purchased) {\n        setItemToUnlock({ closable: false, item_type: 'Location', ...location })\n      }\n    }\n  }, [ location ])\n\n  // Load the map\n  // @TODO: What if I'm accessing a gallery I haven't bought access to?\n  useEffect(() => {\n\n    api.getLocation({ slug: match.params.slug }).then(r => {\n      setLocation(r)\n      if (r.rated === C.rated.nc17 && !ratedConfirmation) { // @TODO: not test-driven, bad!\n        setRatedConfirmation(false)\n      }\n      mountedRef.current = match.params.slug\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  // load showItem if any\n  // @TODO: this makes too many calls, improve performance\n  // @TODO: move to api\n  // @TODO: this is duplicated between LocationsShowDesktop,Mobile - consolidate!\n  useEffect(() => {\n    if (!match.params.item_type) { return }\n\n    const itemType = inflector.classify(match.params.item_type)\n    switch (itemType) {\n      case C.item_types.gallery:\n        api.getGallery(match.params.item_slug).then(setShowItem)\n        break\n      case C.item_types.report:\n        api.getReport(match.params.item_slug).then(setShowItem)\n        break\n      default:\n        logg(itemType, 'cannot get this item type')\n    }\n  }, [ match.params.item_slug, match.params.item_type ])\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  return <Row><MarkerContextProvider >\n\n    { !foldedLeft && <Left className='Left'\n        {...{ bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      { <Breadcrumbs {...location} /> }\n      { location && <WrappedMapPanel\n        map={location.map ? location.map : location}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n      /> }\n    </Left> }\n\n    <Right\n        className='Right'\n        {...{\n          bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      <Handle />\n      { location && !foldedRight && <F>\n\n        { /* Markers */ }\n        { markers && markers.length && <Collapsible\n            config={{ collapsible: false }}\n            slug={C.collapsible.markers}\n            variant={C.variants.transparent}\n        >\n          <MarkersList markers={markers}\n            variant={C.variants.bordered}\n          />\n        </Collapsible> || null }\n\n        { /* Tags */ }\n        { location && <FlexRow style={{ marginBottom: '1em', flexWrap: 'wrap' }} >\n          { location.tags.map((tag) => <Card >{tag.name}</Card> )}\n        </FlexRow> }\n\n        { /* Actions */ }\n        { editorMode && <FlexRow style={{ marginBottom: '1em' }} >\n          <Card onClick={() => setShowItem({ action: C.actions.new, item_type: C.item_types.report }) } >\n            + Report\n          </Card>\n          <Card>\n            + Photo\n          </Card>\n          <Card>\n            + Gallery\n          </Card>\n          <Card>\n            + File\n          </Card>\n          {/* <Card> + Spreadsheet </Card> */}\n          <Card> + Marker </Card>\n        </FlexRow> }\n\n        { /* Description */ }\n        { location.description && <Collapsible\n            label={location.labels.description}\n            slug={C.collapsible.description}\n            variant={C.variants.bordered}\n        >\n          <Description item={location} />\n        </Collapsible> || null }\n\n        { /* Newsitems */ }\n        { location.newsitems && location.newsitems.length && <Newsitems\n            variant={C.variants.bordered} newsitems={location.newsitems}\n        /> || null }\n\n      </F> || null }\n    </Right>\n\n    { showUrl && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading && <Loading /> }\n    { !ratedConfirmation && <RatedRestrictionModal {...{ ratedConfirmation, setRatedConfirmation, }} /> }\n    { <MarkerModal /> }\n\n    <UnlockModal />\n\n  </MarkerContextProvider></Row>\n}\n\nexport default LocationsShowDesktop\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  Metaline,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\nimport {\n  ItemModal,\n  MapPanel, MapPanelNoZoom,\n  WrappedMapPanel,\n} from \"./\"\nimport {\n  MarkersList,\n} from '$resources/markers'\nimport {\n  C, Collapsible, CollapsibleContext,\n  inflector,\n  Loading, logg,\n  request,\n  S,\n  TwofoldContext,\n  useApi, useWindowSize,\n  ZoomContext,\n} from \"$shared\"\n\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n  padding: 10px;\n`;\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\nconst W = styled.div`\n  // border: 1px solid yellow;\n`;\n\n\n/**\n * LocationsShowMobile\n *\n * @TODO: what's the difference between this and LocationsShowDesktop? Let's simplify. _vp_ 2022-09-02\n */\nconst LocationsShowMobile = (props) => {\n  logg(props, 'LocationsShowMobile')\n  const {\n    match,\n  } = props\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    location, setLocation,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [loading, setLoading] = useState(false)\n  const api = useApi()\n\n  const mountedRef = useRef('init')\n  const mapPanelRef = useRef(null)\n  const history = useHistory()\n\n  // Get the location data\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) return null\n\n      if (!res.data.map) {\n        setLoading(false)\n        showToast('could not get Location')\n        return null\n      }\n\n      setLocation(res.data.map)\n      setLoading(false)\n      // @TODO: setFlash here?! If I'm accessing a gallery I don't have access to?\n\n    }).catch((e) => {\n      logg(e, 'e13')\n      history.push('/')\n    }).finally(() => {\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n\n  // @TODO: this can probably be much improved. Take either markers of location.map, or location itself.\n  // @TODO: why is this a redirect to /null ?!\n  let markers = []\n  if (location) {\n    markers = location.markers // location ? location.markers.length ? location.markers : location.map.markers : null\n  }\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  // This is to not have MapPanel, only MapPanelNoZoom on mobile _vp_ 2022-03-16\n  let map\n  if (location) {\n    map = location.map || location\n    map = { ...map, config: { ...map.config, map_panel_type: C.map_panel_types.MapPanelNoZoom } }\n  }\n\n  // load showItem if any\n  // @TODO: this makes too many calls, improve performance\n  // @TODO: move to api\n  // @TODO: this is duplicated between LocationsShowDesktop, Mobile - consolidate!\n  useEffect(() => {\n    if (!match.params.item_type) { return }\n\n    const itemType = inflector.classify(match.params.item_type)\n    switch (itemType) {\n      case C.item_types.gallery:\n        api.getGallery(match.params.item_slug).then(setShowItem)\n        break\n      case C.item_types.report:\n        api.getReport(match.params.item_slug).then(setShowItem)\n        break\n      default:\n        logg(itemType, 'cannot get this item type')\n    }\n  }, [ match.params.item_slug, match.params.item_type ])\n\n  return (<W className='LocationsShowMobile' >\n\n    { loading && <i>Loading...</i> }\n\n    { location && <Breadcrumbs {...location} /> }\n    { location && <Collapsible\n        label={location.labels.map}\n        slug={C.collapsible.map}\n    ><WrappedMapPanel\n        map={map}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n        withZoom={false}\n      />\n    </Collapsible> }\n\n    { /* Right-hand side */ }\n\n    { /* @TODO: recursively render map (not location) as appropriate all around in these collapsibles. */ }\n    { markers && markers.length && <Collapsible\n        label={location.labels.markers}\n        slug={C.collapsible.markers}\n    ><MarkersList markers={markers} />\n    </Collapsible> || null }\n\n    { location && location.description && <Collapsible\n        config={location.config.description}\n        label={location.labels.description}\n        slug={C.collapsible.description}\n    ><Description item={location} />\n    </Collapsible> || null }\n\n    { location && location.newsitems.length && <Collapsible\n        label={location.labels.newsitems}\n        slug=\"news-sec\"\n    ><Newsitems newsitems={location.newsitems} />\n    </Collapsible> || null }\n\n    { showUrl  && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading  && <Loading /> }\n\n  </W>)\n}\n\nexport default LocationsShowMobile\n\n\n\n\n// const Div1 = styled.div`\n//   // border: 2px solid brown;\n//   text-align: center;\n//   display: block;\n//   position: relative; /* required for mobile, so that zoomCtrl, etc are inside the collapsible div */\n//   overflow: scroll;\n//   max-height: 80vh; // @TODO: huh?\n// `;\n\n// const CollapsibleNoMargins = styled(Collapsible)`\n//   margin: 0;\n//   padding: 0;\n// `;\n\n// const MapWrapper = styled.div`\n//   // border: 1px solid red;\n//   position: relative;\n// `;\n\n// const ZoomCtrl = (props) => {\n//   const { zoom, setZoom } = useContext(TwofoldContext)\n//   const zoomIn = () => {\n//     setZoom(zoom/2)\n//   }\n//   const zoomOut = () => {\n//     setZoom(zoom*2)\n//   }\n//   const zoomReset = () => {\n//     setZoom(1)\n//   }\n//   return <ZoomCtrlRoot >\n//     <span onClick={zoomIn} >[+]</span>\n//     <span onClick={zoomOut} >[-]</span>\n//     <span onClick={zoomReset} >[1]</span>\n//   </ZoomCtrlRoot>\n// }\n\n// const ZoomCtrlRoot = styled.div`\n//   // border: 1px solid orange;\n//   position: absolute;\n//   top: 0;\n//   left: calc(100vw - 80px);\n//   background: white;\n//   padding: 5px;\n//   display: flex;\n//   flex-direction: column;\n//   z-index: 10;\n// `;\n\n\n\n","\n\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nconst _Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst Blocker = ({children, ...props }) => {\n  return <_Blocker className=\"Blocker\" {...props}>{children}</_Blocker>\n}\n\nexport default _Blocker\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst Crosshair = styled.div`\n// border: 2px solid yellow;\n\nwidth: 50px;\nheight: 50px;\n\nposition: absolute;\nleft: 50%;\ntop: 50%;\n\n::before {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n  transform: rotate(90deg);\n\n  // margin-top: -1em;\n\n}\n::after {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n\n  // margin-top: -1em;\n  // width: 0.5em;\n}\n`;\n\nexport default Crosshair\n","import {\n\tEuler, EventDispatcher, Vector3,\n} from \"three\"\n\nconst _euler = new Euler( 0, 0, 0, 'YXZ' );\nconst _vector = new Vector3();\n\nconst _changeEvent = { type: 'change' };\nconst _lockEvent = { type: 'lock' };\nconst _unlockEvent = { type: 'unlock' };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n\n\tconstructor( camera, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\t\tdomElement = document.body;\n\n\t\t}\n\n\t\tthis.domElement = domElement;\n\t\tthis.isLocked = false;\n\n\t\t// Set to constrain the pitch of the camera\n\t\t// Range is 0 to Math.PI radians\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\tconst scope = this;\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.isLocked === false ) return;\n\n\t\t\tconst movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\t\tconst movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\t\t_euler.setFromQuaternion( camera.quaternion );\n\n\t\t\t_euler.y -= movementX * 0.002;\n\t\t\t_euler.x -= movementY * 0.002;\n\n\t\t\t_euler.x = Math.max( _PI_2 - scope.maxPolarAngle, Math.min( _PI_2 - scope.minPolarAngle, _euler.x ) );\n\n\t\t\tcamera.quaternion.setFromEuler( _euler );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t}\n\n\t\tfunction onPointerlockChange() {\n\n\t\t\tif ( scope.domElement.ownerDocument.pointerLockElement === scope.domElement ) {\n\n\t\t\t\tscope.dispatchEvent( _lockEvent );\n\n\t\t\t\tscope.isLocked = true;\n\n\t\t\t} else {\n\n\t\t\t\tscope.dispatchEvent( _unlockEvent );\n\n\t\t\t\tscope.isLocked = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerlockError() {\n\n\t\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t\t}\n\n\t\tthis.connect = function () {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.disconnect = function () {\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.disconnect();\n\n\t\t};\n\n\t\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\t\treturn camera;\n\n\t\t};\n\n\t\tthis.getDirection = function () {\n\n\t\t\tconst direction = new Vector3( 0, 0, - 1 );\n\n\t\t\treturn function ( v ) {\n\n\t\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.moveForward = function ( distance ) {\n\n\t\t\t// move forward parallel to the xz-plane\n\t\t\t// assumes camera.up is y-up\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\t_vector.crossVectors( camera.up, _vector );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.moveRight = function ( distance ) {\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.lock = function () {\n\n\t\t\tthis.domElement.requestPointerLock();\n\n\t\t};\n\n\t\tthis.unlock = function () {\n\n\t\t\tscope.domElement.ownerDocument.exitPointerLock();\n\n\t\t};\n\n\t\tthis.connect();\n\n\t}\n\n}\n\nexport {\n\tPointerLockControls,\n}\n\nconst unlockEvent = _unlockEvent\nexport { unlockEvent }\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n  color: white;\n  font-size: 2em;\n  border: 1px solid red;\n`;\n\n/**\n * RotationPad\n * _vp_ 2022-09-02\n**/\nconst RotationPad = (props) => {\n  logg(props, 'RotationPad')\n  const { container, } = props\n\n  var mouseDown = false;\n  var mouseStopped = false;\n  var mouseStopTimeout, eventRepeatTimeout;\n  var newLeft, newTop, distance, angle;\n\n\n  const mouseDownHandler = (event) => {\n    mouseDown = true\n    self.handle.css(\"opacity\", \"1.0\")\n    update(event.pageX, event.pageY)\n  }\n\n  self.regionData = {};\n  self.handleData = {};\n\n  // self.rotationPad = $('<div class=\"rotation-pad\"></div>')\n  // self.region = $('<div class=\"region\"></div>')\n  // self.handle = $('<div class=\"handle\"></div>')\n  self.rotationPad = <h1>R</h1>\n  self.region = <h2 onMouseDown={mouseDownHandler} >region</h2>\n  self.handle = <h2>handle</h2>\n\n  // self.rotationPad.append(self.region).append(self.handle)\n  // self.container.append(self.rotationPad)\n\n  // // Aligning pad:\n  // self.rotationPad.css({\n  //   // _vp_ 2022-09-02\n  //   // top: self.container.find(\"canvas\").height() + self.container.position().top - self.region.outerHeight() - 10,\n  //   // left: self.container.find(\"canvas\").width() - self.region.outerWidth() - 20\n  //   top: 100,\n  //   left: 200,\n  // });\n\n  // self.regionData.width = self.region.outerWidth();\n  // self.regionData.height = self.region.outerHeight();\n  // self.regionData.position = self.region.position();\n  // self.regionData.offset = self.region.offset();\n  // self.regionData.radius = self.regionData.width / 2;\n  // self.regionData.centerX = self.regionData.position.left + self.regionData.radius;\n  // self.regionData.centerY = self.regionData.position.top + self.regionData.radius;\n\n  // self.handleData.width = self.handle.outerWidth();\n  // self.handleData.height = self.handle.outerHeight();\n  // self.handleData.radius = self.handleData.width / 2;\n\n  // self.regionData.radius = self.regionData.width / 2 - self.handleData.radius;\n\n  // Mouse events:\n\n  // $(document).on(\"mouseup\", function () {\n  //   mouseDown = false;\n  //   self.resetHandlePosition();\n  // });\n\n  // $(document).on(\"mousemove\", function(event) {\n  //   if (!mouseDown) return;\n  //   update(event.pageX, event.pageY);\n  // });\n\n  // self.region.on(\"touchstart\", function (event) {\n  //   mouseDown = true;\n  //   self.handle.css(\"opacity\", \"1.0\");\n  //   update(event.originalEvent.targetTouches[0].pageX, event.originalEvent.targetTouches[0].pageY);\n  // });\n\n  // $(document).on(\"touchend touchcancel\", function () {\n  //   mouseDown = false;\n  //   self.resetHandlePosition();\n  // });\n\n  // $(document).on(\"touchmove\", function(event) {\n  //   if (!mouseDown) return;\n  //   update(event.originalEvent.touches[0].pageX, event.originalEvent.touches[0].pageY);\n  // });\n\n\n  function update(pageX, pageY) {\n    newLeft = (pageX - self.regionData.offset.left);\n    newTop = (pageY - self.regionData.offset.top);\n\n    // If handle reaches the pad boundaries.\n    distance = Math.pow(self.regionData.centerX - newLeft, 2) + Math.pow(self.regionData.centerY - newTop, 2);\n    if (distance > Math.pow(self.regionData.radius, 2)) {\n      angle = Math.atan2((newTop - self.regionData.centerY), (newLeft - self.regionData.centerX));\n      newLeft = (Math.cos(angle) * self.regionData.radius) + self.regionData.centerX;\n      newTop = (Math.sin(angle) * self.regionData.radius) + self.regionData.centerY;\n    }\n    newTop = Math.round(newTop * 10) / 10;\n    newLeft = Math.round(newLeft * 10) / 10;\n\n    self.handle.css({\n      top: newTop - self.handleData.radius,\n      left: newLeft - self.handleData.radius\n    });\n    // console.log(newTop , newLeft);\n\n    // Providing event and data for handling camera movement.\n    var deltaX = self.regionData.centerX - parseInt(newLeft);\n    var deltaY = self.regionData.centerY - parseInt(newTop);\n    // Normalize x,y between -2 to 2 range.\n    deltaX = -2 + (2+2) * (deltaX - (-self.regionData.radius)) / (self.regionData.radius - (-self.regionData.radius));\n    deltaY = -2 + (2+2) * (deltaY - (-self.regionData.radius)) / (self.regionData.radius - (-self.regionData.radius));\n    deltaX = -1 * Math.round(deltaX * 10) / 10;\n    deltaY = -1 * Math.round(deltaY * 10) / 10;\n    // console.log(deltaX, deltaY);\n\n    sendEvent(deltaX, deltaY);\n  }\n\n  function sendEvent(dx, dy) {\n    if (!mouseDown) {\n      clearTimeout(eventRepeatTimeout);\n      return;\n    }\n\n    clearTimeout(eventRepeatTimeout);\n    eventRepeatTimeout = setTimeout(function() {\n      sendEvent(dx, dy);\n    }, 5);\n\n    var moveEvent = $.Event(\"YawPitch\", {\n      detail: {\n        \"deltaX\": dx,\n        \"deltaY\": dy\n      },\n      bubbles: false\n    });\n    $(self).trigger(moveEvent);\n  }\n\n  const resetHandlePosition = () => {\n    logg('resetting handle position...')\n    // this.handle.animate({\n    //   top: this.regionData.centerY - this.handleData.radius,\n    //   left: this.regionData.centerX - this.handleData.radius,\n    //   opacity: 0.1\n    // }, \"fast\");\n  }\n\n  resetHandlePosition()\n\n  return <W0>[ Rotate4 ]</W0>\n}\n\nexport default RotationPad\n\n\n","\nimport React, { useEffect, useRef } from 'react'\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\n\nconst _Region = styled.div`\n  width: 100%;\n  height: 100%;\n  background: rgba(126, 126, 0, .5);\n`;\nconst Region = ({ children, ref, ...props }) => <_Region innerRef={ref} className='Region' {...props} >{children}</_Region>\n\nconst _Handle = styled.div``;\nconst Handle = ({ children, ...props }) => <_Handle className='Handle' {...props} >{children}</_Handle>\n\nconst _Pad = styled.div`\n  // top: container.find(\"canvas\").height() + container.position().top - regionRef.currentouterHeight() - 10,\n  // left: 20,\n\n  top: 20px;\n  right: 20px;\n\n  position: absolute;\n  width: 100px;\n  height: 100px;\n  border: 1px solid cyan;\n\n`;\nconst Pad = ({ children, ...props }) => <_Pad className='MovementPad' {...props} >{children}</_Pad>\n\n\n/**\n * MovementPad\n * _vp_ 2022-09-02\n**/\nconst MovementPad = (props) => {\n  logg(props, 'MovementPad')\n  const { container } = props\n\n  let mouseDown = false\n  let mouseStopped = false\n  let mouseStopTimeout, eventRepeatTimeout\n  let newLeft, newTop, distance, angle\n\n  const regionData = {}\n  const regionRef = useRef(null)\n  const handleData = {}\n\n  if (regionRef.current) {\n    logg(regionRef.current, 'setting regionData')\n\n    regionData.w = regionRef.current.clientWidth\n    regionData.radius = regionData.w / 2\n    regionData.h = regionRef.current.clientHeight\n    regionData.x = regionRef.current.getBoundingClientRect().x\n    regionData.y = regionRef.current.getBoundingClientRect().y\n    regionData.centerX = regionData.x + regionData.w / 2\n    regionData.centerY = regionData.y + regionData.h / 2\n\n    // handleData.width = handle.outerWidth();\n    // handleData.height = handle.outerHeight();\n    // handleData.radius = handleData.width / 2;\n\n    // regionData.radius = regionData.width / 2 - handleData.radius;\n\n    logg(regionData, 'set RegionData1')\n  }\n\n\n  const onMouseDown = (e) => {\n    logg(e, 'mouseDown')\n\n    // mouseDown = true;\n    // handle.css(\"opacity\", \"1.0\");\n    // update(event.pageX, event.pageY);\n  }\n\n  const onMouseUp = (e) => {\n    // mouseDown = false;\n    // resetHandlePosition();\n  }\n\n  const onMouseMove = (e) => {\n    // if (!mouseDown) return;\n    // update(event.pageX, event.pageY);\n  }\n\n  const onTouchEnd = (e) => { // and touchcancel\n    // mouseDown = false;\n    // resetHandlePosition();\n  }\n\n  const onTouchMove = (e) => {\n    // if (!mouseDown) return;\n    // update(event.originalEvent.touches[0].pageX, event.originalEvent.touches[0].pageY);\n  }\n\n  const onTouchStart = (e) => {\n    e.persist()\n    logg([e.targetTouches[0].pageX, e.targetTouches[0].pageY], 'onTouchStart')\n\n    mouseDown = true\n    // handle.css(\"opacity\", \"1.0\")\n    update(e.targetTouches[0].pageX, e.targetTouches[0].pageY)\n  }\n\n  const update = (pageX, pageY) => {\n    // logg(regionData, 'regionData')\n\n    newLeft = (pageX - regionData.x)\n    newTop = (pageY - regionData.y)\n\n    logg([newLeft, newTop], 'update')\n\n\n    // // If handle reaches the pad boundaries.\n    // distance = Math.pow(regionData.centerX - newLeft, 2) + Math.pow(regionData.centerY - newTop, 2);\n    // if (distance > Math.pow(regionData.radius, 2)) {\n    //   angle = Math.atan2((newTop - regionData.centerY), (newLeft - regionData.centerX));\n    //   newLeft = (Math.cos(angle) * regionData.radius) + regionData.centerX;\n    //   newTop = (Math.sin(angle) * regionData.radius) + regionData.centerY;\n    // }\n    // newTop = Math.round(newTop * 10) / 10;\n    // newLeft = Math.round(newLeft * 10) / 10;\n\n    // handle.css({\n    //   top: newTop - handleData.radius,\n    //   left: newLeft - handleData.radius\n    // });\n    // console.log(newTop , newLeft);\n\n    // Providing event and data for handling camera movement.\n    let deltaX = regionData.centerX - parseInt(newLeft);\n    let deltaY = regionData.centerY - parseInt(newTop);\n    // Normalize x,y between -2 to 2 range.\n    deltaX = -2 + (2+2) * (deltaX - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n    deltaY = -2 + (2+2) * (deltaY - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n    deltaX = Math.round(deltaX * 10) / 10;\n    deltaY = Math.round(deltaY * 10) / 10;\n    // console.log(deltaX, deltaY);\n\n    sendEvent(deltaX, deltaY, 0);\n  }\n\n  function sendEvent(dx, dy, middle) {\n    logg([dx, dy, middle, mouseDown], 'sendEvent')\n\n    if (!mouseDown) {\n      clearTimeout(eventRepeatTimeout);\n      var stopEvent = $.Event(\"stopMove\", {\n        bubbles: false\n      });\n      $(self).trigger(stopEvent);\n      return;\n    }\n\n    clearTimeout(eventRepeatTimeout);\n    eventRepeatTimeout = setTimeout(function() {\n      sendEvent(dx, dy, middle);\n    }, 5 * 1000);\n\n    var moveEvent = new CustomEvent(\"move\", {\n      detail: {\n        \"deltaX\": dx,\n        \"deltaY\": dy,\n        \"middle\": middle,\n      },\n      bubbles: false\n    })\n    // regionRef.current.dispatchEvent(moveEvent)\n    document.dispatchEvent(moveEvent)\n  }\n\n  // const resetHandlePosition = () => {\n  //   // handle.animate({\n  //   //   top: this.regionData.centerY - this.handleData.radius,\n  //   //   left: this.regionData.centerX - this.handleData.radius,\n  //   //   opacity: 0.1\n  //   // }, \"fast\");\n  // }\n\n  // resetHandlePosition()\n\n  return <Pad >\n    <div className='Region' style={{ width: '100px', height: '100px', background: 'rgba(255,0,0,.5)' }}\n      onTouchStart={onTouchStart} ref={regionRef}\n    ><Handle />\n    </div>\n  </Pad>\n};\n\nexport default MovementPad","\nimport React from 'react'\nimport * as THREE from \"three\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\n\nimport RotationPad from './RotationPad'\nimport MovementPad from './MovementPad'\n\nconst W0 = styled.div`\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n  border: 1px solid red;\n  z-index: 2;\n  color: white;\n  font-size: 2em;\n`;\n\n/**\n * TouchControls\n * _vp_ 2022-09-02\n *\n**/\nconst TouchControls = (props) => {\n  logg(props, 'TouchControls')\n  const { container, camera, options } = props\n\n  if (!container?.current) {\n    logg('no current ref in TouchControls!')\n    return null\n  }\n\n  const config = { ...options, ...{\n    speedFactor: 0.5,\n    delta: 1,\n    rotationFactor: 0.002,\n    maxPitch: 55,\n    hitTest: true,\n    hitTestDistance: 40\n  }}\n\n  var isRightMouseDown = false;\n  var rotationMatrices = [];\n  var hitObjects = [];\n\n  var moveForward = false;\n  var moveBackward = false;\n  var moveLeft = false;\n  var moveRight = false;\n  var lockMoveForward = false;\n  var lockMoveBackward = false;\n  var lockMoveLeft = false;\n  var lockMoveRight = false;\n\n  var ztouch = 1, xtouch = 1;\n  var PI_2 = Math.PI / 2;\n  var maxPitch = config.maxPitch * Math.PI / 180;\n  var velocity = new THREE.Vector3(0, 0, 0);\n\n  var cameraHolder = new THREE.Object3D()\n  cameraHolder.name = \"cameraHolder\"\n  cameraHolder.add(camera)\n\n  const scene = null;\n  const fpsBody = new THREE.Object3D();\n  fpsBody.add(cameraHolder);\n  const enabled = true;\n\n  const mouse = new THREE.Vector2();\n\n  $(self.rotationPad).on(\"YawPitch\", function(event) {\n    var rotation = calculateCameraRotation(event.detail.deltaX, event.detail.deltaY);\n    self.setRotation(rotation.rx, rotation.ry);\n  });\n\n  // // Creating movement pad:\n  // self.movementPad = new MovementPad(container);\n  // $(self.movementPad).on(\"move\", function(event) {\n  //   ztouch = Math.abs(event.detail.deltaY);\n  //   xtouch = Math.abs(event.detail.deltaX);\n\n  //   if (event.detail.deltaY == event.detail.middle) {\n  //     ztouch = 1;\n  //     moveForward = moveBackward = false;\n  //   } else {\n  //     if (event.detail.deltaY > event.detail.middle) {\n  //       moveForward = true;\n  //       moveBackward = false;\n  //     }\n  //     else if (event.detail.deltaY < event.detail.middle) {\n  //       moveForward = false;\n  //       moveBackward = true;\n  //     }\n  //   }\n\n  //   if (event.detail.deltaX == event.detail.middle) {\n  //     xtouch = 1;\n  //     moveRight = moveLeft = false;\n  //   } else {\n  //     if (event.detail.deltaX < event.detail.middle) {\n  //       moveRight = true;\n  //       moveLeft = false;\n  //     }\n  //     else if (event.detail.deltaX > event.detail.middle) {\n  //       moveRight = false;\n  //       moveLeft = true;\n  //     }\n  //   }\n  // });\n  // $(self.movementPad).on(\"stopMove\", function(event) {\n  //   ztouch = xtouch = 1;\n  //   moveForward = moveBackward = moveLeft = moveRight = false;\n  // });\n\n\n\n  // container.on(\"contextmenu\", onContextMenu);\n  // container.on(\"mousedown\", onMouseDown);\n  // container.on(\"mouseup\", onMouseUp);\n  container.current.addEventListener('contextmenu', onContextMenu)\n  container.current.addEventListener('mousedown', onMouseDown)\n  container.current.addEventListener('mouseup', onMouseUp)\n\n\n  // $(document).on(\"keydown\", onKeyDown);\n  // $(document).on(\"keyup\", onKeyUp);\n  // $(document).on(\"mousemove\", onMouseMove);\n  // $(document).on(\"mouseout\", onMouseOut);\n\n  container.current.addEventListener('keydown', onKeyDown)\n  container.current.addEventListener(\"keyup\", onKeyUp);\n  container.current.addEventListener(\"mousemove\", onMouseMove);\n  container.current.addEventListener(\"mouseout\", onMouseOut);\n\n  prepareRotationMatrices();\n\n  //\n  // Events:\n  //\n  function onContextMenu(event) {\n    event.preventDefault();\n  };\n\n  function onMouseDown(event) {\n    if (self.enabled && event.button === 2) {\n      isRightMouseDown = true;\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  };\n\n  function onMouseUp(event) {\n    if (self.enabled && event.button === 2) {\n      isRightMouseDown = false;\n    }\n  };\n\n  function onMouseMove(event) {\n    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n\n    if (!self.enabled || !isRightMouseDown) return;\n\n    var movementX = event.originalEvent.movementX || event.originalEvent.mozMovementX || event.originalEvent.webkitMovementX || 0;\n    var movementY = event.originalEvent.movementY || event.originalEvent.mozMovementY || event.originalEvent.webkitMovementY || 0;\n    var rotation = calculateCameraRotation(-1 * movementX, -1 * movementY);\n\n    // console.log(self.mouse, \"\\n\", movementX, rotation);\n\n    self.setRotation(rotation.rx, rotation.ry);\n\n    // updateNavPad();\n  };\n\n  function onMouseOut(e) {\n    isRightMouseDown = false;\n    // self.stopMouseMoving();\n  };\n\n  function onKeyDown(e) {\n    if (!self.enabled) return;\n    switch (e.keyCode) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = true;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = true;\n        break;\n\n      case 40: // down\n      case 83: // s\n        moveBackward = true;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = true;\n        break;\n    }\n  };\n\n  function onKeyUp(e) {\n    switch (e.keyCode) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = false;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = false;\n        break;\n\n      case 40: // down\n      case 83: // a\n        moveBackward = false;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = false;\n        break;\n    }\n  };\n\n  //\n  // Private functions:\n  //\n  function prepareRotationMatrices() {\n    var rotationMatrixF = new THREE.Matrix4();\n    rotationMatrixF.makeRotationY(0);\n    rotationMatrices.push(rotationMatrixF); // forward direction.\n\n    var rotationMatrixB = new THREE.Matrix4();\n    rotationMatrixB.makeRotationY(180 * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixB);\n\n    var rotationMatrixL = new THREE.Matrix4();\n    rotationMatrixL.makeRotationY(90 * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixL);\n\n    var rotationMatrixR = new THREE.Matrix4();\n    rotationMatrixR.makeRotationY((360 - 90) * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixR);\n  };\n\n  function calculateCameraRotation(dx, dy, factor) {\n    var factor = factor ? factor : self.config.rotationFactor;\n    var ry = self.fpsBody.rotation.y - (dx * factor);\n    var rx = cameraHolder.rotation.x - (dy * factor);\n    rx = Math.max(-maxPitch, Math.min(maxPitch, rx));\n\n    return {\n      rx: rx,\n      ry: ry\n    };\n  };\n\n  function lockDirectionByIndex(index) {\n    if (index == 0)\n      self.lockMoveForward(true);\n    else if (index == 1)\n      self.lockMoveBackward(true);\n    else if (index == 2)\n      self.lockMoveLeft(true);\n    else if (index == 3)\n      self.lockMoveRight(true);\n  }\n\n  //\n  // Public functions:\n  //\n  const update = function() {\n    return\n\n    if (config.hitTest)\n      self.hitTest();\n\n    velocity.x += (-1 * velocity.x) * 0.75 * self.config.delta;\n    velocity.z += (-1 * velocity.z) * 0.75 * self.config.delta;\n\n    if (moveForward && !lockMoveForward) velocity.z -= ztouch * self.config.speedFactor * self.config.delta;\n    if (moveBackward && !lockMoveBackward) velocity.z += ztouch * self.config.speedFactor * self.config.delta;\n\n    if (moveLeft && !lockMoveLeft) velocity.x -= xtouch * self.config.speedFactor * self.config.delta;\n    if (moveRight && !lockMoveRight) velocity.x += xtouch * self.config.speedFactor * self.config.delta;\n\n    fpsBody.translateX(velocity.x);\n    fpsBody.translateY(velocity.y);\n    fpsBody.translateZ(velocity.z);\n  };\n\n  const hitTest = function() {\n    return\n\n    self.unlockAllDirections();\n    hitObjects = [];\n    var cameraDirection = self.getDirection2(new THREE.Vector3(0, 0, 0)).clone();\n\n    for (var i = 0; i < 4; i++) {\n      // Applying rotation for each direction:\n      var direction = cameraDirection.clone();\n      direction.applyMatrix4(rotationMatrices[i]);\n\n      var rayCaster = new THREE.Raycaster(fpsBody.position, direction);\n      var intersects = rayCaster.intersectObject(self.scene, true);\n      if ((intersects.length > 0 && intersects[0].distance < self.config.hitTestDistance)) {\n        lockDirectionByIndex(i);\n        hitObjects.push(intersects[0]);\n        // console.log(intersects[0].object.name, i);\n      }\n    }\n\n    return hitObjects;\n  };\n\n  const getDirection2 = function(v) {\n    return\n\n    var self = this;\n    var direction = new THREE.Vector3(0, 0, -1);\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n    var rx = fpsBody.getObjectByName(\"cameraHolder\").rotation.x;;\n    var ry = fpsBody.rotation.y;\n\n    // console.log(\"DIRECTION:\", this);\n    rotation.set(rx, ry, 0);\n    v.copy(direction).applyEuler(rotation);\n    // console.log(v);\n    return v;\n  };\n\n  const getDirection = function() {\n    return\n\n    var self = this;\n    var rx = 0;\n    var ry = 0;\n    var direction = new THREE.Vector3(0, 0, -1);\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n\n    // console.log(\"DIRECTION:\", this);\n    if (self != undefined) {\n      rx = fpsBody.getObjectByName(\"cameraHolder\").rotation.x;\n      ry = fpsBody.rotation.y;\n      console.log(rx, ry);\n    }\n    // var camHolder = self.fpsBody.getObjectByName(\"cameraHolder\");\n\n    return function(v) {\n      rotation.set(rx, ry, 0);\n      v.copy(direction).applyEuler(rotation);\n      // console.log(v);\n      return v;\n    }\n  }();\n\n  // const moveLeft = function() {\n  //   return moveLeft;\n  // };\n\n  // const moveRight = function() {\n  //   return moveRight;\n  // };\n\n  // const moveForward = function() {\n  //   return moveForward;\n  // };\n\n  // const moveBackward = function() {\n  //   return moveBackward;\n  // };\n\n  // const lockMoveForward = function(boolean) {\n  //   lockMoveForward = boolean;\n  // };\n\n  // const lockMoveBackward = function(boolean) {\n  //   lockMoveBackward = boolean;\n  // };\n\n  // const lockMoveLeft = function(boolean) {\n  //   lockMoveLeft = boolean;\n  // };\n\n  // const lockMoveRight = function(boolean) {\n  //   lockMoveRight = boolean;\n  // };\n\n  const unlockAllDirections = function() {\n    self.lockMoveForward(false);\n    self.lockMoveBackward(false);\n    self.lockMoveLeft(false);\n    self.lockMoveRight(false);\n  }\n\n  const setRotation = (x, y) => {\n    var camHolder = fpsBody.getObjectByName(\"cameraHolder\");\n\n    if (x !== null)\n      camHolder.rotation.x = x;\n\n    if (y !== null)\n      fpsBody.rotation.y = y;\n  }\n\n  return <RotationPad />\n  return <W0>[ Touch4 ]</W0>\n}\n\nTouchControls.prototype = {\n  addToScene: function(scene) {\n    this.scene = scene;\n    scene.add(this.fpsBody);\n  },\n\n  setPosition: function(x, y, z) {\n    this.fpsBody.position.set(x, y, z);\n  },\n\n  stopMouseMoving: function() {\n    isRightMouseDown = false;\n  },\n\n  getHitObjects: function() {\n    return hitObjects;\n  }\n\n};\n\nexport default TouchControls\n","\n/*\n * @TODO: this is just a copy of equirectangular2, discard\n */\n\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { PointerLockControls } from './PointerLockControls'\nimport TouchControls from \"./vendor/TouchControls\"\nimport RotationPad from \"./vendor/RotationPad\"\nimport {\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst Blocker = styled.div`\n  border: 1px dashed red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n\n  #Crosshair {\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst W = styled.div`\n  border: 1px solid blue;\n  height: 90vh;\n`;\n\n/**\n * Equirectangular2\n * _vp_ 2021-11-15\n * Let's wire in a simple floor and full-window sizing.\n *\n * Threejs units of measure are centimeters (cm).\n *\n */\nconst Equirectangular2 = (props) => {\n  logg(props, 'Equirectangular2')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene;\n\n  var width, height;\n  var viewAngle = 45,\n    near = 1,\n    far = 10000;\n  var aspect;\n  var stats;\n  var sceneObject, intersected;\n\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const blockerRef = useRef(null)\n  const wContainerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 ) // @TODO: what this?\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 ) // @TODO: what this?\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Origin: axis helper\n     */\n    var axes = new THREE.AxisHelper(700)\n\t\tscene.add(axes)\n\n    const wContainer = wContainerRef.current\n\n    function addControls() {\n      var options = {\n        speedFactor: 0.5,\n        delta: 1,\n        rotationFactor: 0.002,\n        maxPitch: 55,\n        hitTest: true,\n        hitTestDistance: 40\n      };\n      controls = new TouchControls({\n        container: wContainer, camera,\n        options,\n        RotationPad: rotationPad,\n        THREE,\n      });\n      controls.setPosition(0, 35, 400);\n      controls.addToScene(scene);\n      // controls.setRotation(0.15, -0.15);\n    }\n    addControls()\n\n    /*\n     * Floor\n     */\n\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius — Radius of the circle, default = 1.\n     * segments — Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart — Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength — The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.PlaneGeometry( 100, 100, 10, 10 ) // width, height, w segments, h segments\n    // let floorGeometry = new THREE.CircleGeometry(100, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/100x100_lazer-floor.png`)\n    texture.wrapS = THREE.RepeatWrapping\n    texture.wrapT = THREE.RepeatWrapping\n    texture.repeat.set( 10, 10 )\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      map: texture,\n      // transparent: true,\n    })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    // const texturePath = `${modelName}/${modelName}.mtl`\n    // const modelPath = `${modelName}/${modelName}.obj`\n    // const manager = new THREE.LoadingManager()\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n    // const onLoad = (materials) => {\n    //   materials.preload()\n    //   const objLoader = new OBJLoader( manager )\n    //   objLoader.setMaterials( materials )\n    //   objLoader.setPath( scenesPath)\n    //   objLoader.load( modelPath, ( object ) => {\n    //     object.traverse((child) => {\n    //       if (child.isMesh) {\n    //         child.geometry.scale(0.10, 0.10, 0.10) // @TODO: change?\n    //       }\n    //     })\n    //     object.position.x = Math.random() * 500\n    //     object.position.y = 10\n    //     object.position.z = Math.random() * 500\n\n    //     logg(object, '1st object')\n    //     scene.add( object )\n    //     markerObjects.push( object )\n    //     markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' }) // @TODO: change!\n\n    //   }, onProgress, onError )\n    // }\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(scenesPath)\n    // mtlLoader.load(texturePath, onLoad)\n\n\n    /*\n     * Skybox\n     */\n    const textureLoader = new THREE.TextureLoader()\n    const assetPath = map.img_path\n    texture = textureLoader.load(assetPath, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  /* From: https://threejsfundamentals.org/threejs/lessons/threejs-responsive.html */\n  function resizeRendererToDisplaySize() {\n    const canvas = renderer.domElement\n    const width = blockerRef.current.clientWidth\n    const height = blockerRef.current.clientHeight\n    const needResize = canvas.width !== width || canvas.height !== height\n    if (needResize) {\n      renderer.setSize(width, height)\n    }\n    return needResize\n  }\n  function onWindowResize() {\n    if (resizeRendererToDisplaySize()) {\n      const width = blockerRef.current.clientWidth\n      const height = blockerRef.current.clientHeight\n      camera.aspect = width / height\n      camera.updateProjectionMatrix()\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <W ref={wContainerRef} >\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n\n      <RotationPad />\n    </Blocker>\n  </W>\n}\n\nexport default Equirectangular2\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  Blocker,\n} from './'\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\n/**\n * TabiversePlanet\n */\nconst TabiversePlanet = (props) => {\n\n  let camera\n  let geometry\n  let material\n  let planet\n  let renderer\n  let texture\n  let scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  function init() {\n\n    camera = new THREE.PerspectiveCamera( 75, 2, 0.1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n    camera.position.z = -10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0x31231f )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    /*\n     * Floor\n     */\n    // texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    // let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    // floorGeometry.rotateX( - Math.PI / 2 )\n    // const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    /*\n     * Planet\n    **/\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/2k_mercury.jpeg`)\n    geometry = new THREE.SphereBufferGeometry(1, 32, 32)\n    // geometry = new THREE.BoxGeometry( 1, 1, 1 );\n    // material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\n    material = new THREE.MeshBasicMaterial({ map: texture })\n    planet = new THREE.Mesh(geometry, material)\n    planet.position.y = 10\n    planet.position.z = -12\n    scene.add(planet)\n\n    /*\n     * Render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n\n    // camera.rotation.x += 0.01\n    // camera.rotation.y += 0.01\n\n    planet.rotation.y += 0.00035\n\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <Blocker {...S} ref={blockerRef} >\n    </Blocker>\n  </F>\n}\n\nexport default TabiversePlanet\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport styled from 'styled-components'\n\nimport { logg, } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\n// @TODO: make its own component. _vp_ 2022-08-13\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * ThreePanelDesktop\n * Markers are obejcts _vp_ 2021-11-14\n * Continue.           _vp_ 2022-08-13\n *\n *\n */\nconst Loc = (props) => {\n  // logg(props, 'ThreePanelDesktop')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n  const loader = new GLTFLoader()\n  const worldOctree = new Octree()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // const texturesPath = '/assets/textures/'\n    // const manager = new THREE.LoadingManager()\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(texturesPath)\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n\n\n    map.markers.map((marker, idx) => {\n\n      loader.load( marker.asset3d_path, ( gltf ) => {\n        scene.add( gltf.scene );\n        worldOctree.fromGraphNode( gltf.scene );\n        gltf.scene.traverse( child => {\n          if ( child.isMesh ) {\n            child.castShadow = true;\n            child.receiveShadow = true;\n            if ( child.material.map ) {\n              child.material.map.anisotropy = 4;\n            }\n          }\n        } )\n      })\n\n    })\n\n\n\n    /*\n     * Skybox\n    **/\n    const textureLoader = new THREE.TextureLoader()\n    texture = textureLoader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport {\n  Blocker,\n} from './'\nimport TouchControls from './vendor/TouchControls'\nimport MovementPad from './vendor/MovementPad'\n\n\n/**\n * ThreePanelMobile\n * Markers are obejcts _vp_ 2021-11-14\n * Continue.           _vp_ 2022-08-13\n * Continue.           _vp_ 2022-09-02\n *\n *\n */\nconst Loc = (props) => {\n  logg(props, 'ThreePanelMobile')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    fpsBody,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n    document.title = \"InfiniteShelter - ThreePanelMobile :: test\"\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n  const loader = new GLTFLoader()\n  const worldOctree = new Octree()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    **/\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n\n    // Controls\n    var options = {\n      speedFactor: 0.5,\n      delta: 1,\n      rotationFactor: 0.002,\n      maxPitch: 55,\n      hitTest: true,\n      hitTestDistance: 40\n    };\n    // controls = new TouchControls(blockerRef.current, camera, options);\n    // controls.setPosition(0, 35, 400);\n\n    // controls.addToScene(scene);\n    // scene.add( controls.getObject() )\n\n    // blockerRef.current.addEventListener( 'click', function () {\n    //   logg('locked controls')\n    //   controls.lock()\n    // } )\n\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    const onMove = (event) => {\n      logg(event, 'onMove')\n\n      let ztouch = Math.abs(event.detail.deltaY)\n      let xtouch = Math.abs(event.detail.deltaX)\n\n      if (event.detail.deltaY == event.detail.middle) {\n        ztouch = 1;\n        moveForward = moveBackward = false\n      } else {\n        if (event.detail.deltaY > event.detail.middle) {\n          moveForward = true\n          moveBackward = false\n        }\n        else if (event.detail.deltaY < event.detail.middle) {\n          moveForward = false\n          moveBackward = true\n        }\n      }\n\n      if (event.detail.deltaX == event.detail.middle) {\n        xtouch = 1\n        moveRight = moveLeft = false\n      } else {\n        if (event.detail.deltaX < event.detail.middle) {\n          moveRight = true\n          moveLeft = false\n        }\n        else if (event.detail.deltaX > event.detail.middle) {\n          moveRight = false\n          moveLeft = true\n        }\n      }\n\n    }\n    document.addEventListener( 'move', onMove )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n    **/\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    map.markers.map((marker, idx) => {\n\n      loader.load( marker.asset3d_path, ( gltf ) => {\n        scene.add( gltf.scene );\n        worldOctree.fromGraphNode( gltf.scene );\n        gltf.scene.traverse( child => {\n          if ( child.isMesh ) {\n            child.castShadow = true;\n            child.receiveShadow = true;\n            if ( child.material.map ) {\n              child.material.map.anisotropy = 4;\n            }\n          }\n        } )\n      })\n\n    })\n\n    /*\n     * Skybox\n    **/\n    const textureLoader = new THREE.TextureLoader()\n    texture = textureLoader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n    /*\n     * Camera Holder\n    **/\n    var cameraHolder = new THREE.Object3D();\n    cameraHolder.name = \"cameraHolder\";\n    // cameraHolder.add(camera);\n\n    fpsBody = new THREE.Object3D();\n    fpsBody.add(cameraHolder);\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n\n    if (controls?.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n    }\n\n    // onMove\n    if (true) {\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n    }\n\n    camera.translateX(velocity.x);\n    // camera.translateY(velocity.y);\n    // camera.translateZ(velocity.z);\n\n    // camera.translateX(velocity.x);\n    // camera.translateY(velocity.y);\n    // camera.translateZ(velocity.z);\n\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} className=\"Blocker\" >\n      <div id=\"Crosshair\" />\n      {/* <TouchControls container={blockerRef} camera={camera} options={{}} /> */}\n      <MovementPad />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n\n\n\n\n\n\n// /**\n//  * What is blocker? the entire canvas?\n//  *\n//  * @TODO: make its own component. _vp_ 2022-08-13\n// **/\n// const Blocker = styled.div`\n//   border: 2px solid red;\n\n//   position: relative;\n//   width: 700px;\n//   height: 350px;\n\n//   #Crosshair {\n//     // border: 1px solid yellow;\n//     width: 50px;\n//     height: 50px;\n\n//     position: absolute;\n//     left: 50%;\n//     top: 50%;\n//     color: white;\n\n//     ::before {\n//       content: '';\n//       position: absolute;\n//       border-color: white;\n//       border-style: solid;\n//       border-width: 0 0.1em 0 0;\n//       height: 1em;\n//       top: 0em;\n//       left: 0.3em;\n//       // margin-top: -1em;\n//       transform: rotate(90deg);\n//       // width: 0.5em;\n//     }\n//     ::after {\n//       content: '';\n//       position: absolute;\n//       border-color: white;\n//       border-style: solid;\n//       border-width: 0 0.1em 0 0;\n//       height: 1em;\n//       top: 0em;\n//       left: 0.3em;\n//       // margin-top: -1em;\n//       // width: 0.5em;\n//     }\n//   }\n// `;\n\n\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n`;\n\n/**\n * ThreePanelV1\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\nconst Loc = (props) => {\n  logg(props, 'ThreePanelV1')\n\n  let camera, controls,\n    object, objects = [],\n    raycaster, renderer,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n    /*\n    // PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n    // fov — Camera frustum vertical field of view.\n    // aspect — Camera frustum aspect ratio.\n    // near — Camera frustum near plane.\n    // far — Camera frustum far plane.\n    */\n    // camera = new THREE.PerspectiveCamera( 75, 2, 1, 100 )\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 300 )\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    // floor\n    // @TODO: it's not aligned to parcels the way I want\n    let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n\n    // vertex displacement\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      vertex.fromBufferAttribute( position, i )\n      vertex.x += Math.random() * 20 - 10\n      vertex.y += Math.random() * 2\n      vertex.z += Math.random() * 20 - 10\n      position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    floorGeometry.x = -200\n    floorGeometry.y = -200\n    floorGeometry.z = -200\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    // objects\n    /*\n    const boxGeometry = new THREE.BoxGeometry( 20, 20, 20 ).toNonIndexed()\n    position = boxGeometry.attributes.position\n    const colorsBox = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsBox.push( color.r, color.g, color.b )\n    }\n    boxGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsBox, 3 ) )\n    for ( let i = 0; i < 500; i ++ ) {\n      const boxMaterial = new THREE.MeshPhongMaterial( { specular: 0xffffff, flatShading: true, vertexColors: true } )\n      boxMaterial.color.setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n\n      const box = new THREE.Mesh( boxGeometry, boxMaterial )\n      box.position.x = Math.floor( Math.random() * 20 - 10 ) * 20\n      box.position.y = Math.floor( Math.random() * 20 ) * 20 + 10\n      box.position.z = Math.floor( Math.random() * 20 - 10 ) * 20\n      scene.add( box )\n      objects.push( box )\n    }\n    */\n\n    // load OBJ\n\n    // manager\n\n    // this is specifically for tiny-house-1\n    const loadModel = () => {\n      object.traverse((child) => {\n        if ( child.isMesh ) {\n          child.material.map = texture\n          child.geometry.scale(10, 10, 10)\n        }\n      })\n      object.position.x = 100\n      object.position.y = 10\n      object.position.z = 100\n\n      scene.add( object )\n    }\n    const manager = new THREE.LoadingManager( loadModel )\n    manager.onProgress = function ( item, loaded, total ) {\n      console.log( item, loaded, total )\n    }\n\n    // texture\n\n    const textureLoader = new THREE.TextureLoader( manager )\n    const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n    // model\n\n    // tiny-house-1\n    const loader = new OBJLoader( manager )\n    loader.load( '/assets/scenes/tiny-house-1/tiny-house-1.obj', ( obj ) => {\n      object = obj\n    }, ( xhr ) => {\n      if ( xhr.lengthComputable ) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }, (e) => {\n      logg(e, 'onError')\n    } )\n\n\n    // some delimiters for the first 6 parcels!\n    let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    let cube = new THREE.Mesh( geometry, material )\n    cube.position.x = 0\n    cube.position.y = 5\n    cube.position.z = 0\n    scene.add( cube )\n    const items = [\n      { color: 0xff0000, x: 1, y: 0, z: 0 },\n      { color: 0x00ff00, x: 0, y: 1, z: 0 },\n      { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    ]\n    items.map((item, idx) => {\n      logg(item, 'item')\n      const { color, x, y, z } = item\n      geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n      material = new THREE.MeshBasicMaterial({ color: color })\n      cube = new THREE.Mesh( geometry, material )\n      cube.position.x = x*5\n      cube.position.y = 10+y*5\n      cube.position.z = z*5\n      scene.add( cube )\n    })\n\n    const parcels = [\n      { color: 0xff0000, x: 100, y: 1, z: 100 },\n      { color: 0x00ff00, x: 100, y: 1, z: 320 },\n      { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n      { color: 0x660000, x: -120, y: 1, z: 100 },\n      { color: 0x006600, x: -120, y: 1, z: -120 },\n      { color: 0x000066, x: 100, y: 1, z: -120 },\n    ]\n    parcels.map((item, idx) => {\n      const { color, x, y, z } = item\n      const g = new THREE.BoxGeometry( 200, 2, 200 )\n      const m = new THREE.MeshBasicMaterial({color: color})\n      const p = new THREE.Mesh( g, m )\n      p.position.x = x\n      p.position.y = y\n      p.position.z = z\n      scene.add( p )\n    })\n\n    //\n\n\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    // renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setPixelRatio(1)\n    renderer.setSize( 800, 400 )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n      raycaster.ray.origin.copy( controls.getObject().position )\n      raycaster.ray.origin.y -= 10\n      const intersections = raycaster.intersectObjects( objects, false )\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} />\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * Loc = Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\nconst Loc = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius — Radius of the circle, default = 1.\n     * segments — Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart — Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength — The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    let modelName2 = 'girl'\n    const texturePath = `${modelName}/${modelName}.mtl`\n    const modelPath = `${modelName}/${modelName}.obj`\n    const modelPath2 = `${modelName2}/${modelName2}.obj`\n    const manager = new THREE.LoadingManager()\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    // onProgress = function ( item, loaded, total ) {\n    //   console.log( item, loaded, total )\n    // }\n    const onError = () => {}\n    const onLoad = (materials) => {\n      materials.preload()\n      const objLoader = new OBJLoader( manager )\n      objLoader.setMaterials( materials )\n      objLoader.setPath( scenesPath)\n      objLoader.load( modelPath, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(0.10, 0.10, 0.10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '1st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' })\n\n      }, onProgress, onError )\n    }\n    const onLoad2 = (materials) => {\n      // materials.preload()\n      const objLoader = new OBJLoader( manager )\n      // objLoader.setMaterials( materials )\n      objLoader.setPath( objectsPath )\n      objLoader.load( modelPath2, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(10, 10, 10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '2st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'girl', slug: 'demmitv' })\n\n      }, onProgress, onError )\n    }\n    const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setBaseUrl(scenesPath)\n    mtlLoader.setPath(scenesPath)\n    mtlLoader.load(texturePath, onLoad)\n    mtlLoader.load(texturePath, onLoad2)\n\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\nimport * as THREE from \"three\"\nimport Stats from 'three/examples/jsm/libs/stats.module'\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport { Capsule } from 'three/examples/jsm/math/Capsule'\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\n\nimport { Crosshair } from \"./\"\nimport { PointerLockControls, } from './PointerLockControls'\nimport {\n  C,\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst Blocker = styled.div`\n  // border: 2px solid red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n`;\n\n/**\n * Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n *\n * Octree! From: https://threejs.org/examples/games_fps.html\n * @TODO: let's load the map, and collision player on map. _vp_ 202-04-20\n *\n**/\nconst Location = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  let camera, clock,\n    directionalLight,\n    fillLight1,\n    glow,\n    markerObjects = [],\n    pickedObject, plc,\n    raycaster, removedObject, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n\n\n\n  function init_old() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    */\n    const aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera = new THREE.PerspectiveCamera( 75, aspect, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    // scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    const onClick = (event) => {\n      // logg(event, 'onCLick')\n      // logg(pickedObject, 'pickedObject')\n\n      // @TODO: prevent lock-outs!\n      if (pickedObject) {\n        // plc.unlock()\n        // history.push(`/en/locations/show/${pickedObject.slug}`)\n      }\n    }\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n    document.addEventListener( 'click', onClick )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n\n    /*\n     * Floor\n     */\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius — Radius of the circle, default = 1.\n     * segments — Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart — Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength — The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const manager = new THREE.LoadingManager()\n\n    let importModels = [\n      // { modelName: 'wasyaco-reception-2', slug: 'construct1' },\n\n      { modelName: 'camaro75', slug: 'construct1' },\n      { modelName: 'girl',     slug: 'demmitv' },\n\n      // { modelName: 'girl-5',     slug: 'demmitv' },\n    ]\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(objectsPath)\n\n    importModels.map(({ modelName, slug }) => {\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n\n          objLoader.setPath(objectsPath)\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10)\n              }\n            })\n            object.position.x = Math.random() * 200\n            object.position.y = 10\n            object.position.z = Math.random() * 200\n\n            scene.add( object )\n            markerObjects.push({ uuid: object.uuid, name: 'camaro75', object, slug: 'construct1', })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath))\n    })\n\n\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n  }\n\n\n  const GRAVITY = 30;\n\n  const NUM_SPHERES = 100;\n  const SPHERE_RADIUS = 0.2;\n\n  const STEPS_PER_FRAME = 5;\n\n  const sphereGeometry = new THREE.IcosahedronGeometry( SPHERE_RADIUS, 5 );\n  const sphereMaterial = new THREE.MeshLambertMaterial( { color: 0xbbbb44 } );\n\n  const spheres = [];\n  let sphereIdx = 0;\n\n  const worldOctree = new Octree();\n\n  const playerCollider = new Capsule( new THREE.Vector3( 0, 0.35, 0 ), new THREE.Vector3( 0, 1, 0 ), 0.35 );\n\n  const playerVelocity = new THREE.Vector3();\n  const playerDirection = new THREE.Vector3();\n\n  let playerOnFloor = false;\n  let mouseTime = 0;\n\n  const keyStates = {};\n\n  const vector1 = new THREE.Vector3();\n  const vector2 = new THREE.Vector3();\n  const vector3 = new THREE.Vector3();\n\n  const init = () => {\n    clock = new THREE.Clock();\n\n    scene = new THREE.Scene();\n    scene.background = new THREE.Color( 0x88ccee );\n    scene.fog = new THREE.Fog( 0x88ccee, 0, 50 );\n\n    camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n    camera.rotation.order = 'YXZ';\n\n    fillLight1 = new THREE.HemisphereLight( 0x4488bb, 0x002244, 0.5 );\n    fillLight1.position.set( 2, 1, 1 );\n    scene.add( fillLight1 );\n\n    directionalLight = new THREE.DirectionalLight( 0xffffff, 0.8 );\n    directionalLight.position.set( - 5, 25, - 1 );\n    directionalLight.castShadow = true;\n    directionalLight.shadow.camera.near = 0.01;\n    directionalLight.shadow.camera.far = 500;\n    directionalLight.shadow.camera.right = 30;\n    directionalLight.shadow.camera.left = - 30;\n    directionalLight.shadow.camera.top\t= 30;\n    directionalLight.shadow.camera.bottom = - 30;\n    directionalLight.shadow.mapSize.width = 1024;\n    directionalLight.shadow.mapSize.height = 1024;\n    directionalLight.shadow.radius = 4;\n    directionalLight.shadow.bias = - 0.00006;\n    scene.add( directionalLight );\n\n    for ( let i = 0; i < NUM_SPHERES; i ++ ) {\n      const sphere = new THREE.Mesh( sphereGeometry, sphereMaterial );\n      sphere.castShadow = true;\n      sphere.receiveShadow = true;\n\n      scene.add( sphere );\n\n      spheres.push( {\n        mesh: sphere,\n        collider: new THREE.Sphere( new THREE.Vector3( 0, - 100, 0 ), SPHERE_RADIUS ),\n        velocity: new THREE.Vector3()\n      } );\n    }\n\n    /*\n     * controls\n    **/\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer( { antialias: true } )\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    renderer.shadowMap.enabled = true\n    renderer.shadowMap.type = THREE.VSMShadowMap\n    renderer.outputEncoding = THREE.sRGBEncoding\n    renderer.toneMapping = THREE.ACESFilmicToneMapping\n\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n    /*\n     * GLFT Loader\n    **/\n    const loader = new GLTFLoader().setPath( './assets/objects/gltf/' );\n\n    loader.load( 'collision-world.glb', ( gltf ) => {\n      scene.add( gltf.scene );\n      worldOctree.fromGraphNode( gltf.scene );\n      gltf.scene.traverse( child => {\n        if ( child.isMesh ) {\n          child.castShadow = true;\n          child.receiveShadow = true;\n          if ( child.material.map ) {\n            child.material.map.anisotropy = 4;\n          }\n        }\n      } );\n\n      // const helper = new OctreeHelper( worldOctree );\n      // helper.visible = false;\n      // scene.add( helper );\n\n      animate();\n    } );\n\n    /*\n     * keyboard control, event listeners\n    **/\n    document.addEventListener( 'keydown', ( event ) => {\n      keyStates[ event.code ] = true;\n    } );\n\n    document.addEventListener( 'keyup', ( event ) => {\n      keyStates[ event.code ] = false;\n    } );\n\n    document.addEventListener( 'mouseup', () => {\n      if ( document.pointerLockElement !== null ) throwBall();\n    } );\n\n    // document.body.addEventListener( 'mousemove', ( event ) => {\n    //   if ( document.pointerLockElement === document.body ) {\n    //     camera.rotation.y -= event.movementX / 500;\n    //     camera.rotation.x -= event.movementY / 500;\n    //   }\n    // } );\n\n    document.addEventListener( 'mousedown', () => {\n      document.body.requestPointerLock();\n      mouseTime = performance.now();\n    } );\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function playerCollisions() {\n    const result = worldOctree.capsuleIntersect( playerCollider );\n    playerOnFloor = false;\n    if ( result ) {\n      playerOnFloor = result.normal.y > 0;\n      if ( ! playerOnFloor ) {\n        playerVelocity.addScaledVector( result.normal, - result.normal.dot( playerVelocity ) );\n      }\n      playerCollider.translate( result.normal.multiplyScalar( result.depth ) );\n    }\n  }\n\n  function updateSpheres( deltaTime ) {\n    spheres.forEach( sphere => {\n      sphere.collider.center.addScaledVector( sphere.velocity, deltaTime );\n      const result = worldOctree.sphereIntersect( sphere.collider );\n      if ( result ) {\n        sphere.velocity.addScaledVector( result.normal, - result.normal.dot( sphere.velocity ) * 1.5 );\n        sphere.collider.center.add( result.normal.multiplyScalar( result.depth ) );\n      } else {\n        sphere.velocity.y -= GRAVITY * deltaTime;\n      }\n      const damping = Math.exp( - 1.5 * deltaTime ) - 1;\n      sphere.velocity.addScaledVector( sphere.velocity, damping );\n      playerSphereCollision( sphere );\n    } );\n    spheresCollisions();\n    for ( const sphere of spheres ) {\n      sphere.mesh.position.copy( sphere.collider.center );\n    }\n  }\n\n  function throwBall() {\n    const sphere = spheres[ sphereIdx ];\n    camera.getWorldDirection( playerDirection );\n    sphere.collider.center.copy( playerCollider.end ).addScaledVector( playerDirection, playerCollider.radius * 1.5 );\n    // throw the ball with more force if we hold the button longer, and if we move forward\n    const impulse = 15 + 30 * ( 1 - Math.exp( ( mouseTime - performance.now() ) * 0.001 ) );\n    sphere.velocity.copy( playerDirection ).multiplyScalar( impulse );\n    sphere.velocity.addScaledVector( playerVelocity, 2 );\n    sphereIdx = ( sphereIdx + 1 ) % spheres.length;\n  }\n\n  function getForwardVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    return playerDirection;\n  }\n\n  function getSideVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    playerDirection.cross( camera.up );\n    return playerDirection;\n  }\n\n  function updatePlayer( deltaTime ) {\n    let damping = Math.exp( - 4 * deltaTime ) - 1;\n    if ( ! playerOnFloor ) {\n      playerVelocity.y -= GRAVITY * deltaTime;\n      // small air resistance\n      damping *= 0.1;\n    }\n    playerVelocity.addScaledVector( playerVelocity, damping );\n    const deltaPosition = playerVelocity.clone().multiplyScalar( deltaTime );\n    playerCollider.translate( deltaPosition );\n    playerCollisions();\n    camera.position.copy( playerCollider.end );\n  }\n\n  function spheresCollisions() {\n    for ( let i = 0, length = spheres.length; i < length; i ++ ) {\n      const s1 = spheres[ i ];\n      for ( let j = i + 1; j < length; j ++ ) {\n        const s2 = spheres[ j ];\n\n        const d2 = s1.collider.center.distanceToSquared( s2.collider.center );\n        const r = s1.collider.radius + s2.collider.radius;\n        const r2 = r * r;\n\n        if ( d2 < r2 ) {\n          const normal = vector1.subVectors( s1.collider.center, s2.collider.center ).normalize();\n          const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( s1.velocity ) );\n          const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( s2.velocity ) );\n\n          s1.velocity.add( v2 ).sub( v1 );\n          s2.velocity.add( v1 ).sub( v2 );\n\n          const d = ( r - Math.sqrt( d2 ) ) / 2;\n\n          s1.collider.center.addScaledVector( normal, d );\n          s2.collider.center.addScaledVector( normal, - d );\n        }\n      }\n    }\n  }\n\n  function playerSphereCollision( sphere ) {\n    const center = vector1.addVectors( playerCollider.start, playerCollider.end ).multiplyScalar( 0.5 );\n    const sphere_center = sphere.collider.center;\n    const r = playerCollider.radius + sphere.collider.radius;\n    const r2 = r * r;\n\n    // approximation: player = 3 spheres\n    for ( const point of [ playerCollider.start, playerCollider.end, center ] ) {\n      const d2 = point.distanceToSquared( sphere_center );\n\n      if ( d2 < r2 ) {\n        const normal = vector1.subVectors( point, sphere_center ).normalize();\n        const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( playerVelocity ) );\n        const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( sphere.velocity ) );\n\n        playerVelocity.add( v2 ).sub( v1 );\n        sphere.velocity.add( v1 ).sub( v2 );\n\n        const d = ( r - Math.sqrt( d2 ) ) / 2;\n        sphere_center.addScaledVector( normal, - d );\n      }\n    }\n  }\n\n  function teleportPlayerIfOob() {\n    if ( camera.position.y <= - 25 ) {\n      playerCollider.start.set( 0, 0.35, 0 );\n      playerCollider.end.set( 0, 1, 0 );\n      playerCollider.radius = 0.35;\n      camera.position.copy( playerCollider.end );\n      camera.rotation.set( 0, 0, 0 );\n    }\n  }\n\n  function controls( deltaTime ) {\n    // gives a bit of air control\n    const speedDelta = deltaTime * ( playerOnFloor ? 25 : 8 );\n\n    if ( keyStates[ 'KeyW' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyS' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyA' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyD' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( playerOnFloor ) {\n      if ( keyStates[ 'Space' ] ) {\n        playerVelocity.y = 15;\n      }\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( plc.isLocked === true ) {\n\n      const deltaTime = Math.min( 0.05, clock.getDelta() ) / STEPS_PER_FRAME;\n\n      // we look for collisions in substeps to mitigate the risk of\n      // an object traversing another too quickly for detection.\n\n      for ( let i = 0; i < STEPS_PER_FRAME; i ++ ) {\n        controls( deltaTime );\n        updatePlayer( deltaTime );\n        updateSpheres( deltaTime );\n        teleportPlayerIfOob();\n      }\n\n    }\n    prevTime = time\n\n    // @TODO: add stats\n    // @TODO: add OctreeHelper\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <Crosshair />\n    </Blocker>\n  </F>\n}\n\nexport default Location\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * ThreePanelV4\n * Markers are obejcts _vp_ 2021-11-14\n *\n */\nconst ThreePanelV4 = (props) => {\n  logg(props, 'ThreePanelV4')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov — Camera frustum vertical field of view.\n     * aspect — Camera frustum aspect ratio.\n     * near — Camera frustum near plane.\n     * far — Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius — Radius of the circle, default = 1.\n     * segments — Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart — Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength — The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const texturesPath = '/assets/textures/'\n    const manager = new THREE.LoadingManager()\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(texturesPath)\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n\n\n    map.markers.map((marker, idx) => {\n      let modelName = marker.slug\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath, modelName) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n          objLoader.setPath( objectsPath )\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10) // @TODO change, girl-6 accepts 1,1,1\n              }\n            })\n            object.position.x = Math.random() * 100\n            object.position.y = 10\n            object.position.z = Math.random() * 100\n\n            // object.rotateX( - Math.PI / 2 ) // girl-6 only.\n\n            logg(object, 'loaded obj')\n\n            scene.add( object )\n            markerObjects.push( object )\n            markerObjectsIdxs.push({ uuid: object.uuid, name: modelName })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath, modelName))\n    })\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default ThreePanelV4\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  Metaline,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\nimport {\n  ThreePanelMobile,\n} from \"$components/3d_locations\"\nimport {\n  MarkersList,\n} from '$resources/markers'\nimport {\n  C, Collapsible, CollapsibleContext,\n  inflector,\n  Loading, logg,\n  request,\n  S,\n  TwofoldContext,\n  useApi, useWindowSize,\n  ZoomContext,\n} from \"$shared\"\n\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n  padding: 10px;\n`;\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\nconst W = styled.div`\n  // border: 1px solid yellow;\n`;\n\n\n/**\n * LocationsShowMobile3d\n * Simplified, full-screen, cannot scroll outside canvas\n * _vp_ 2022-09-02\n *\n */\nconst LocationsShowMobile3d = (props) => {\n  logg(props, 'LocationsShowMobile3d')\n  const {\n    match,\n  } = props\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    location, setLocation,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [loading, setLoading] = useState(false)\n  const api = useApi()\n\n  const mountedRef = useRef('init')\n  const mapPanelRef = useRef(null)\n  const history = useHistory()\n\n  // Get the location data\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) return null\n      if (!res.data.map) {\n        setLoading(false)\n        showToast('could not get Location')\n        return null\n      }\n      setLocation(res.data.map)\n      setLoading(false)\n    }).catch((e) => {\n      logg(e, 'e13')\n      history.push('/')\n    }).finally(() => {\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  return (<W className='LocationsShowMobile3d' >\n\n    { location && <ThreePanelMobile\n      map={location.map || location}\n      ref={mapPanelRef}\n      slug={match.params.slug}\n    />}\n\n    { loading  && <Loading /> }\n\n  </W>)\n}\n\nexport default LocationsShowMobile3d\n\n","import PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { logg, TwofoldContext } from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 3px solid green;\n\n  text-align: center;\n  display: block;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\n/* Same size as the map image.\n * What scrolls is this div, not the image inside it.\n */\nconst Img = styled.div`\n  // border: 2px solid cyan;\n  display: inline-block;\n  position: relative;\n`;\n\nconst Root = styled.div`\n  border: ${p=>p.debug?'1':'0'}px solid red;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <div style={{\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    zIndex: 1,\n    background: 'white',\n    padding: '5px',\n\n    display: 'flex',\n    flexDirection: 'column',\n  }} >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </div>\n}\n\nconst MapPanel = (props) => {\n  // logg(props, 'MapPanel')\n  const { map, withZoom=true } = props\n\n  const {\n    bottomDrawerOpen, setBottomDrawerOpen,\n    showUrl, setShowUrl,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n\n  const div1Ref = useRef(null)\n\n  const history = useHistory()\n\n  useEffect(() => {\n    // div1Ref.current.scrollIntoView({ block: 'end', inline: 'center' })\n    div1Ref.current.scroll({\n      top: 200,\n      left: 200,\n      behavior: 'smooth',\n     })\n  }, [])\n\n  const markers = []\n  map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => m.url ? setShowUrl(m.url) : history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: ((m.y- m.centerOffsetY )/zoom),\n        left: ((m.x- m.centerOffsetX )/zoom),\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w/zoom}px`,\n        maxHeight: `${m.h/zoom}px`,\n        width: `${m.w/zoom}px`, height: `${m.h/zoom}px`,\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <Root {...{ bottomDrawerOpen }} debug={config.debug} className='MapPanel' >\n    { withZoom && <ZoomCtrl /> }\n\n    <Div1 {...{ bottomDrawerOpen }} >\n      <Img ref={div1Ref} style={{\n        width: `${map.w/zoom}px`,\n        height: `${map.h/zoom}px`,\n      }} >\n        <img\n          src={map.img_path}\n          style={{\n            width: `${map.w/zoom}px`,\n            height: `${map.h/zoom}px`,\n          }}\n        />\n        { markers }\n      </Img>\n    </Div1>\n\n  </Root>\n}\n\nMapPanel.propTypes = {\n  map: PropTypes.object.isRequired,\n  withZoom: PropTypes.bool, // @TODO: I don't like it, I'd like it to be inside a config obj.\n}\nexport default MapPanel\n\n\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  MarkerContext,\n} from '$resources/markers'\nimport {\n  C, Card,\n  logg, logg4,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\nconst Actions = styled.div`\n  border: 1px solid red;\n\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  z-index: 2;\n`;\n\n// W\nconst W0 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.background};\n\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n`;\n\nconst W1 = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n  height: 100%;\n`;\n\n\n/**\n * MapPanelNoZoom\n *\n * _vp_ 2021-09 @TODO: merge this into MapPanel, have zoom={false} as a prop\n * But I couldn't do it in 10 mins... It's a bit complicated?\n *\n * _vp_ 2021-10-29 But actually this component is getting more work than the zoom one right now...\n**/\nconst MapPanelNoZoom = (props) => {\n  // logg(props, 'MapPanelNoZoom')\n  const { map } = props\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'MapPanelNoZoomUsedContext')\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n\n  const history = useHistory()\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  // logg(useWindowSize(), 'usedWindowSize')\n\n\n  /*\n   * Sets the zoom (in panelNoZoom) to full-panel _vp_ 2021-10-29\n   * w: 1184 h: 819\n   */\n  useEffect(() => {\n    // logg([windowWidth, windowHeight, map.w, map.h], 'MapPanelNoZoom setting zoom')\n    if (windowWidth === 0) { return; }\n\n    let nextZoomByWidth = windowWidth/map.w // .3 mobile // 1.94 desktop\n    let nextZoomByHeight = windowHeight/map.h // .9 mobile // .82 desktop\n    // logg4([nextZoomByWidth, nextZoomByHeight], 'nextZoomOptions')\n\n    let nextZoom = Math.min(nextZoomByWidth, nextZoomByHeight)\n    const slack = 0.01 // image should not overlap with the border... 1% slack added.\n    nextZoom = nextZoom + slack\n\n    setZoom(nextZoom)\n  }, [\n    mapPanelWidth, mapPanelHeight, map.id,\n    windowWidth, windowHeight,\n  ])\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  /*\n   * @TODO: need to get the ACL from api, and use it to determine what to display or not.\n  **/\n\n  return <W0 className=\"W0 MapPanelNoZoom\" >\n\n    { editorMode && <Actions>\n      <Card onClick={() => setMarkerModalOpen(true)} >\n        + Marker\n      </Card>\n    </Actions> }\n\n    <W1 className=\"W1\" >\n      <img\n        src={map.img_path}\n        style={{\n          maxWidth: '100%',\n          maxHeight: '100%',\n          width: 'auto',\n          height: 'auto',\n\n          position: 'relative',\n          zIndex: 0,\n        }}\n      />\n      { markers }\n    </W1>\n  </W0>\n}\n\nexport default MapPanelNoZoom\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\n/**\n * RatedRestrictionModal\n */\nconst RatedRestrictionModal = (props) => {\n  // logg(props, 'RatedRestrictionModal')\n  const { ratedConfirmation, setRatedConfirmation } = props\n\n  return <Modal isOpen={!ratedConfirmation} >\n    <p>You must be 18 years of age or older to view this content.</p>\n    <button onClick={() => setRatedConfirmation(true) } >I am over 18</button>\n    &nbsp; &nbsp;\n    <button onClick={() => window.location = 'https://disney.com' } >I am NOT over 18</button>\n  </Modal>\n};\nRatedRestrictionModal.propTypes = {\n  // ratedConfirmation, setRatedConfirmation - but maybe from a context instead?\n};\nexport default RatedRestrictionModal\n","\nimport * as React from \"react\"\nimport * as ReactDom from \"react-dom\"\nimport { Wrapper, Status } from \"@googlemaps/react-wrapper\"\n\nimport {\n  logg,\n} from '$shared'\n\nlet API_KEY\n// API_KEY = 'AIzaSyDTM7RYKAlUS84jN1pCmydwEKxUTAMAn6c'\nAPI_KEY = 'AIzaSyB8kkxbSgjmUpGmpigro-N7uXKiQmpBoyE'\n\nconst App = (props) => {\n  // logg(props, 'GoogleMaps2')\n  const {\n    map,\n  } = props\n\n  const [clicks, setClicks] = React.useState([]);\n  const [zoom, setZoom] = React.useState(12); // initial zoom\n  const [center, setCenter] = React.useState({ lat: map.x, lng: map.y })\n\n  const onClick = (e) => {\n    // avoid directly mutating state\n    // setClicks([...clicks, e.latLng]);\n  };\n\n  const onIdle = (m) => {\n    // console.log(\"onIdle\");\n    m.getZoom() && setZoom(m.getZoom());\n    m.getCenter() && setCenter(m.getCenter().toJSON());\n  };\n\n  const form = (\n    <div\n      style={{\n        display: 'none',\n\n        padding: \"1rem\",\n        flexBasis: \"250px\",\n        height: \"100%\",\n        overflow: \"auto\",\n      }}\n    >\n      <label htmlFor=\"zoom\">Zoom</label>\n      <input\n        type=\"number\"\n        id=\"zoom\"\n        name=\"zoom\"\n        value={zoom}\n        onChange={(event) => setZoom(Number(event.target.value))}\n      />\n      <br />\n      <label htmlFor=\"lat\">Latitude</label>\n      <input\n        type=\"number\"\n        id=\"lat\"\n        name=\"lat\"\n        value={center.lat}\n        onChange={(event) =>\n          setCenter({ ...center, lat: Number(event.target.value) })\n        }\n      />\n      <br />\n      <label htmlFor=\"lng\">Longitude</label>\n      <input\n        type=\"number\"\n        id=\"lng\"\n        name=\"lng\"\n        value={center.lng}\n        onChange={(event) =>\n          setCenter({ ...center, lng: Number(event.target.value) })\n        }\n      />\n      <h3>{clicks.length === 0 ? \"Click on map to add markers\" : \"Clicks\"}</h3>\n      {clicks.map((latLng, i) => (\n        <pre key={i}>{JSON.stringify(latLng.toJSON(), null, 2)}</pre>\n      ))}\n      <button onClick={() => setClicks([])}>Clear</button>\n    </div>\n  );\n\n  return (\n    <div style={{ display: \"flex\", height: \"100%\" }}>\n      <Wrapper apiKey={API_KEY} >\n        <Map\n          center={center}\n          onClick={onClick}\n          onIdle={onIdle}\n          zoom={zoom}\n          style={{ flexGrow: \"1\", height: \"100%\" }}\n        >\n          {map.markers.map((m, i) =>\n            <Marker key={i} position={{lat: m.x, lng: m.y}} />\n          ) }\n        </Map>\n      </Wrapper>\n      {/* Basic form for controlling center and zoom of map. */}\n      {form}\n    </div>\n  );\n};\n\nconst Map = ({\n  onClick,\n  onIdle,\n  children,\n  style,\n  ...options\n}) => {\n  const ref = React.useRef(null);\n  const [map, setMap] = React.useState();\n\n  React.useEffect(() => {\n    if (ref.current && !map) {\n      setMap(new window.google.maps.Map(ref.current, {}));\n    }\n  }, [ref, map]);\n\n  // because React does not do deep comparisons, a custom hook is used\n  // see discussion in https://github.com/googlemaps/js-samples/issues/946\n  useDeepCompareEffectForMaps(() => {\n    if (map) {\n      map.setOptions(options);\n    }\n  }, [map, options]);\n\n  React.useEffect(() => {\n    if (map) {\n      [\"click\", \"idle\"].forEach((eventName) =>\n        google.maps.event.clearListeners(map, eventName)\n      );\n\n      if (onClick) {\n        map.addListener(\"click\", onClick);\n      }\n\n      if (onIdle) {\n        map.addListener(\"idle\", () => onIdle(map));\n      }\n    }\n  }, [map, onClick, onIdle]);\n\n  return (\n    <>\n      <div ref={ref} style={style} />\n      {React.Children.map(children, (child) => {\n        if (React.isValidElement(child)) {\n          // set the map prop on the child component\n          return React.cloneElement(child, { map });\n        }\n      })}\n    </>\n  );\n};\n\nconst Marker = (options) => {\n  const [marker, setMarker] = React.useState();\n\n  React.useEffect(() => {\n    if (!marker) {\n      setMarker(new google.maps.Marker());\n    }\n\n    // remove marker from map on unmount\n    return () => {\n      if (marker) {\n        marker.setMap(null);\n      }\n    };\n  }, [marker]);\n\n  React.useEffect(() => {\n    if (marker) {\n      marker.setOptions(options);\n    }\n  }, [marker, options]);\n\n  return null;\n};\n\nfunction useDeepCompareMemoize(value) {\n  const ref = React.useRef();\n\n  if (value !== ref.current) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}\n\nconst useDeepCompareEffectForMaps = (callback, dependencies) => {\n  React.useEffect(callback, dependencies.map(useDeepCompareMemoize));\n}\n\nexport default App","\n\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport { ChevronLeft, ChevronRight, Menu as MenuIcon, } from '@material-ui/icons'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  // GoogleMaps,\n  MapPanel, MapPanelNoZoom,\n} from \"./\"\nimport GoogleMaps from './GoogleMaps2'\nimport {\n  Equirectangular4,\n  TabiversePlanet, ThreePanelV1, ThreePanelV2, ThreePanelV3, ThreePanelV4, ThreePanelDesktop,\n} from \"$components/3d_locations\"\nimport {\n  C, Collapsible,\n  logg,\n  request,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\n/* W */\nconst W0 = styled.div`\n  overflow: hidden;\n\n  flex-grow: 1;\n\n  // max-height: 100vh;\n  // min-height: 50vh;\n\n`;\n\n/**\n * Renders either MapPanel (W really, a simple wrapper), MapPanelNoZoom, or ThreePanelV1\n * or some other MapPanel.\n */\nconst WrappedMapPanel = React.forwardRef((props, ref) => {\n  // logg(props, 'WrappedMapPanel')\n  // const { map } = props\n\n  switch (props.map.config.map_panel_type) {\n\n    case C.map_panel_types.Equirectangular:\n      return <W0 ref={ref} className=\"Equirectangular4\" ><Equirectangular4 {...props} /></W0>\n\n    case C.map_panel_types.MapPanelNoZoom:\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanelNoZoom withZoom={false} {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV1:\n      switch (props.slug) {\n\n        // legacy, remove all three: _vp_ 2022-08-13\n        case 'threev1':\n          return <W0><ThreePanelV1 {...props} /></W0>\n        case 'threev2':\n          return <W0><ThreePanelV2 {...props} /></W0>\n        case 'threev3':\n          return <W0><ThreePanelV3 {...props} /></W0>\n\n        default:\n          return <W0><ThreePanelDesktop {...props} /></W0>\n      }\n\n    case C.map_panel_types.TabiversePlanet: // markers are objects\n      return <W0><TabiversePlanet {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV4: // markers are objects\n      return <W0><ThreePanelV4 {...props} /></W0>\n\n    case C.map_panel_types.GoogleMaps:\n      return <W0><GoogleMaps {...props} /></W0>\n\n    default:\n      logg(null, `This map_panel_type is not implemented! ${props.map.config.map_panel_type}`)\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanel {...props} /></W0>\n  }\n})\nexport default WrappedMapPanel\n\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst W = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 1;\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * ZoomCtrl\n */\nconst ZoomCtrl = (props) => {\n  logg(props, 'ZoomCtrl')\n\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <W className='ZoomCtrl' >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </W>\n}\n\nexport default ZoomCtrl\n","\nimport PropTypes from 'prop-types'\nimport { Grid } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\n\nconst Label = styled.div``;\n\nconst Features = ({ features, label, ...props }) => {\n  // logg(props, 'Features')\n\n  const out = []\n  features.map((f) => {\n    if (f.inner_html) {\n      out.push(<Grid item sm={3} dangerouslySetInnerHTML={{ __html: f.inner_html }} />)\n    }\n  })\n\n  return <F>\n    {label && <Label>{label}</Label>}\n    <Grid style={{ marginBottom: '1em' }} container spacing={2}>\n      { out }\n    </Grid>\n  </F>\n}\n\nFeatures.propTypes = {\n  features: PropTypes.arrayOf(PropTypes.shape({\n    inner_html: PropTypes.string,\n  }) ),\n  label: PropTypes.string,\n}\nexport default Features","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  MainHeader,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\nconst SitesShow = (props) => {\n  // logg(props, 'SitesShow')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ loading, setLoading ] = useState(false)\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    api.applicationHome().then(data => {\n      if (!mountedRef.current) { return null }\n      setSite(data)\n      setLoading(false)\n    })\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n      { /* <Hero /> */ }\n      <MainHeader />\n\n      <Features features={site.features} />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow\n","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  BottomDrawer,\n  MainHeader, Menu, MenuBottom, MenuLeft,\n  UnlockModal\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\n// Currently a homepage, like a wp page.\nconst SitesShow1 = (props) => {\n  // logg(props, 'SitesShow1')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ artTag, setArtTag ] = useState({ features: [] })\n  let [ homeRow1Tag, setHomeRow1Tag ] = useState({ features: [] })\n  let [ interestingLocationsTag, setInterestingLocationsTag ] = useState({ features: [] })\n  let [ loading, setLoading ] = useState(false)\n\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  // loads all data\n  useEffect(() => {\n    // setLoading(true)\n\n    const fn = async () => {\n\n      if (!mountedRef.current) { return }\n      const data = await api.applicationHome()\n      logg(data, 'zeDataZ')\n      setSite(data)\n\n      // @TODO: this was here before, but not anymore. Check it out. _vp_ 2022-03-19\n\n      // api.getTag({ slug: 'interesting-locations' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   logg(data, 'setInterestingLocations')\n      //   setInterestingLocationsTag(data)\n      //   // setLoading(false)\n      // })\n\n      // api.getTag({ slug: 'home-row-1' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   setHomeRow1Tag(data)\n      // })\n\n      // api.getTag({ slug: 'art' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   setArtTag(data)\n      // })\n\n    }\n    fn()\n\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n\n      <MainHeader />\n      { /* <Hero /> */ }\n\n      <Features features={interestingLocationsTag.features} label=\"Interesting Locations\" />\n      <Features features={homeRow1Tag.features} label=\"Interesting Tags\" />\n      <Features features={artTag.features} label=\"art\" />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow1\n","import { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react';\nimport { Container, Grid, GridList } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport config from \"config\";\n\nimport { useApi, logg, request } from \"$shared\";\n\nconst useStyles = makeStyles((theme) => ({\n\n  paper: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n    color: theme.palette.text.secondary,\n  },\n  redBorder: {\n    border: '1px solid red',\n  },\n  root: {\n    flexGrow: 1,\n    overflow: 'scroll',\n    height: '100vh',\n  },\n\n}));\n\nconst VideoItem = styled.div`\n  border-bottom: 1px solid red;\n`;\n\nconst Video = (props) => {\n  logg(props, 'Video');\n  const api = useApi()\n\n  const { item: video } = props;\n\n  return <VideoItem key={props.idx} >\n    <h5>Video {video.name}</h5>\n    <p>created {video.created_at}</p>\n    <video controls preload=\"metadata\" type=\"video/mp4\" src={video.video_url}\n      style={{ maxWidth: '500px', maxHeight: '90vh' }} ></video>\n  </VideoItem>;\n};\n\nconst Videos = () => {\n  logg(config, 'Videos component');\n  console.log(JSON.stringify(config));\n\n  const [videos, setVideos] = useState([]);\n\n  const jwtToken = localStorage.getItem(\"jwtToken\");\n\n  const classes = useStyles();\n  const api = useApi()\n\n  useEffect(() => {\n    logg('posting...');\n    request.post(api.myVideosPath, { jwtToken: jwtToken }).then(r => r.data\n      ).then(({ videos }) => {\n        logg(videos, 'data')\n        setVideos(videos);\n      })\n  }, []);\n\n  return <Container maxWidth=\"md\">\n    <Grid container className={classes.root} >\n      <Grid item xs={12} >\n        <h2>My Videos</h2>\n      </Grid>\n      <Grid item xs={12}>\n        { videos && videos.map((v, idx) => <Video key={idx} item={v} ></Video> ) }\n      </Grid>\n    </Grid>\n  </Container>;\n\n};\n\nexport default Videos;\n","\nimport { Container as _Container, } from '@material-ui/core'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport {\n  Switch, BrowserRouter as Router, Redirect, Route as _Route,\n  useRouteMatch,\n} from 'react-router-dom'\n\nimport styled from 'styled-components'\n\nimport config from \"config\"\nimport {\n  AuthContextProvider,\n} from 'ishlibjs'\n\nimport {\n  BottomDrawer,\n  UnlockModal,\n} from \"$components/application\"\nimport MapuiLayout from \"$components/application/MapuiLayout\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\n// @TODO: MyGalleries doesn't look right...\nimport { GalleriesShow, MyGalleries } from \"$components/galleries\"\nimport { LocationsShowDesktop } from \"$components/locations\"\nimport { ReportsShow } from \"$resources/reports\"\nimport SitesShow from '$components/sites/SitesShow1'\nimport {\n  Account,\n} from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport {\n  C, CollapsibleContextProvider,\n  logg,\n  TwofoldContextProvider,\n  useApi,\n} from \"$shared\"\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n\n// import './theme/variables.css' // removed due to next_js _vp_ 2022-08-15\n\n\nconst Root = styled.div`\n  // border: 1px solid #741741;\n\n  background: ${p => p.theme.colors.background};\n  height: 100vh;\n  overflow: auto;\n`;\n\n\n/**\n * AppDesktop\n**/\nconst AppDesktop = (props) => {\n  // logg(props, 'AppDesktop')\n  // const {} = props\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n\n  const Container = (props) => {\n    switch(layout) {\n      case C.layout_onecol:\n        // main case\n        return <_Container maxWidth=\"md\" {...props} />\n      case C.layout_mapui:\n        return <MapuiLayout {...props} />\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  return <Router>\n    { /* @TODO: move AuthContext up to AppWrapper. _vp_ 2022-09-04 */ }\n    <AuthContextProvider {...{ useApi, }} >\n      <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n        <CollapsibleContextProvider >\n          <Root>\n\n            <Container >\n              <Switch id=\"main\" main >\n\n                <Redirect exact from=\"/\" to={config.homePath} />\n                <Route exact path=\"/en\" ><SitesShow /></Route>\n\n                <Route exact path=\"/en/account\" component={Account} />\n                <Route exact path=\"/en/account/my/videos\" component={Videos} />\n                <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n                <Route exact path=\"/en/cities\"                 component={CitiesList} />\n                <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n                <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n                <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n                <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowDesktop} layout={C.layout_mapui} />\n                <Route exact path=\"/en/locations/show/:slug/:item_type/show/:item_slug\" component={LocationsShowDesktop} layout={C.layout_mapui} />\n\n              </Switch>\n            </Container>\n          </Root>\n\n          <BottomDrawer />\n\n        </CollapsibleContextProvider>\n      </TwofoldContextProvider>\n    </AuthContextProvider>\n  </Router>\n}\n\nexport default AppDesktop\n","import { Container as _Container, Grid, GridList } from '@material-ui/core'\n\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport Modal from \"react-modal\"\nimport {\n  Switch, BrowserRouter as Router, Redirect, Route as _Route,\n} from 'react-router-dom'\nimport styled, { useTheme } from 'styled-components'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n// import './theme/variables.css' // removed due to next_js _vp_ 2022-08-15\n\nimport config from \"config\"\nimport {\n  AuthContextProvider,\n  LoginModal,\n  RegisterModal,\n} from 'ishlibjs'\n\n\nimport { BottomDrawer,\n  Menu, MenuBottom, MenuLeft,\n  MapuiMobileLayout,\n  UnlockModal } from \"$components/application\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\nimport {\n  GalleriesShow, Galleries, MyGalleries,\n} from \"$components/galleries\"\nimport {\n  LocationsShowMobile, LocationsShowMobile3d,\n} from \"$components/locations\"\nimport { ReportsShow } from \"$resources/reports\"\nimport { SitesShow } from '$components/sites'\nimport {\n  Account,\n} from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport {\n  C, CollapsibleContextProvider,\n  logg,\n  TwofoldContext, TwofoldContextProvider,\n  useApi,\n} from \"$shared\"\n\nconst Root = styled.div`\n  background: ${p => p.theme.colors.background};\n  height: 100vh;\n  overflow: auto;\n`;\n\nconst __Container = styled(_Container)`\n  padding: 0;\n  height: 100vh;\n  overflow: scroll;\n`;\n\n/**\n * AppMobile\n**/\nconst AppMobile = (props) => {\n  // logg(props, 'AppMobile')\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n  // const [ bottomDrawerOpen, setBottomDrawerOpen ] = React.useState(false)\n  // const [ itemToUnlock, setItemToUnlock ] = React.useState(false)\n  // const [ zoom, setZoom ] = useState(1)\n  const theme = useTheme()\n\n  // @TODO: move into its own component!\n  const Container = ({ children, ...props }) => {\n    // logg(props, 'Container')\n\n    const {\n      bottomDrawerOpen,\n    } = useContext(TwofoldContext)\n\n    const style = {\n      paddingBottom: bottomDrawerOpen ? theme.bottomDrawerOpenHeight : null\n    }\n\n    switch(layout) {\n      case C.layout_onecol:\n        return <__Container style={style} maxWidth=\"md\" {...props} >{ children }</__Container>\n      case C.layout_mapui:\n        // This is true right now (2021-10-20) for mobile even when it's one column\n        return <MapuiMobileLayout style={style} {...props} >{ children }</MapuiMobileLayout>\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  // const doUnlock = async () => {\n  //   // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n  //   const path = api.doUnlock({ kind: 'Report', id: itemToUnlock.report_id })\n  //   const result = await request.post(`${config.apiOrigin}${path}`)\n  //   logg(result, 'result of unlocking')\n  // }\n\n  return (<Router>\n    { /* @TODO: move AuthContext up to AppWrapper. _vp_ 2022-09-04 */ }\n    <AuthContextProvider {...{ useApi, }} >\n    <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n      <CollapsibleContextProvider >\n        { layout === C.layout_onecol && <MenuLeft variant={C.variants.floating} /> }\n        <Root className=\"Root\" >\n\n          <Container className=\"Container\" >\n            <Switch id=\"main\" main >\n\n              <Redirect exact from=\"/\" to={config.homePath} />\n              <Route exact path=\"/en\" ><SitesShow /></Route>\n\n              <Route exact path=\"/en/account\" component={Account} />\n              <Route exact path=\"/en/account/my/videos\" component={Videos} />\n              <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n              <Route exact path=\"/en/cities\"                 component={CitiesList} />\n              <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n              <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n              <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n              <Route exact path=\"/en/locations/show3d/:slug\" component={LocationsShowMobile3d} layout={C.layout_mapui} />\n              <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowMobile} layout={C.layout_mapui} />\n              <Route exact path=\"/en/locations/show/:slug/:item_type/show/:item_slug\" component={LocationsShowMobile} layout={C.layout_mapui} />\n\n            </Switch>\n          </Container>\n\n        </Root>\n\n        <BottomDrawer />\n        <UnlockModal />\n        <LoginModal />\n        <RegisterModal />\n\n      </CollapsibleContextProvider>\n    </TwofoldContextProvider>\n    </AuthContextProvider>\n  </Router>)\n}\n\nexport default AppMobile\n","\nimport { Device } from '@capacitor/device'\nimport React, { useEffect, useState, } from 'react'\nimport { ThemeProvider } from 'styled-components'\nimport { ToastContainer } from 'react-toastify'\n\nimport config from 'config'\n\nimport {\n  C, logg, request, S, useApi\n} from \"$shared\"\nimport AppDesktop from './AppDesktop'\nimport AppMobile from './AppMobile'\n\n\n/**\n * Chooses mobile vs desktop\n */\nconst AppWrapper = (props) => {\n  // logg(props, 'AppWrapper')\n\n  const [ os, setOs ] = useState(null)\n  // info.operatingSystem === 'ios' || 'android'\n  const fn = async () => {\n    let info = await Device.getInfo()\n    setOs(info.operatingSystem)\n  }\n  fn()\n\n  const [theme, setTheme] = useState(window.localStorage.getItem(C.theme) || C.themes.light)\n  const toggleTheme = (e) => {\n    if (theme === C.themes.light) {\n      window.localStorage.setItem(C.theme, C.themes.dark)\n      setTheme(C.themes.dark)\n    } else {\n      window.localStorage.setItem(C.theme, C.themes.light)\n      setTheme(C.themes.light)\n    }\n  }\n\n  const childProps = {\n    theme, toggleTheme,\n  }\n\n  if (!os) { return null }\n  return <ThemeProvider theme={theme == C.themes.light ? S.lightTheme: S.darkTheme} >\n    { \"ios android\".includes(os) ?\n      <AppMobile {...childProps} />\n      : <AppDesktop {...childProps} /> }\n    <ToastContainer position=\"bottom-left\" />\n  </ThemeProvider>\n}\n\nexport default AppWrapper\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppWrapper from './AppWrapper'\nimport * as serviceWorker from './serviceWorker'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\n\nimport 'react-toastify/dist/ReactToastify.css'\nimport styles from 'ishlibjs/dist/index.css'\n\nReactDOM.render(<AppWrapper />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n\n\n\n"],"sourceRoot":""}