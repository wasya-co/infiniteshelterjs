{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","shared/Api.jsx","components/users/Account.jsx","components/users/LoginModal.jsx","components/users/MyAccountWidget.jsx","components/users/index.js","shared/AppRouter.jsx","shared/Collapsible.jsx","shared/request.jsx","shared/index.jsx","components/application/BottomDrawer.jsx","components/application/Menu.jsx","components/application/MenuBottom.jsx","components/application/MenuLeft.jsx","components/application/Metaline.jsx","components/application/Rating.jsx","components/application/UnlockModal.jsx","components/application/MapuiLayout.jsx","components/cities/CitiesList.jsx","components/newsitems/NewsitemGallery.jsx","components/newsitems/NewsitemReport.jsx","components/newsitems/NewsitemVideo.jsx","components/newsitems/Newsitems.jsx","components/newsitems/ItemIcon.jsx","components/newsitems/NewsitemContainer.jsx","components/venues/Venues.jsx","components/cities/CitiesShow.jsx","components/galleries/GalleriesShow.jsx","components/galleries/MyGalleries.jsx","components/locations/Breadcrumbs.jsx","components/reports/ReportsShow.jsx","components/locations/ItemModal.jsx","components/locations/LocationsShow.jsx","components/locations/MapPanel.jsx","components/locations/LocationsShowMobile.jsx","components/locations/MarkersList.jsx","components/sites/SitesShow.jsx","components/videos/Videos.jsx","App.jsx","serviceWorker.js","index.jsx","../config/environments/production/config.js"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","useApi","useContext","TwofoldContext","token","currentUser","setCurrentUser","localStorage","getItem","C","jwt_token","doUnlock","kind","getMyAccount","request","post","loginPath","longTermTokenPath","myAccount","myVideosPath","paymentsPath","reportsGet","a","JSON","parse","jwt","config","apiOrigin","getCities","get","r","data","getCity","slug","applicationHome","domain","params","out","useStyles","makeStyles","theme","paper","padding","spacing","textAlign","color","palette","text","secondary","root","flexGrow","overflow","height","Account","props","classes","Grid","container","className","item","xs","src","alt","email","to","onClick","history","push","LoginModal","logg","loginModalOpen","setLoginModalOpen","style","zIndex","isOpen","stripePromise","loadStripe","Login","Root","styled","div","p","borderWidth","W","MyAccountWidget","api","stripe","useStripe","elements","useElements","useState","purchaseModalIsOpen","setPurchaseModalIsOpen","handleSubmit","event","preventDefault","getElement","CardElement","jwtToken","client_secret","confirmCardPayment","payment_method","card","result","error","message","paymentIntent","status","response","S","n_unlocks","ariaHideApp","width","onSubmit","type","disabled","WrappedMyAccountWidget","FacebookLogin","Plugins","FACEBOOK_PERMISSIONS","FbLogin","doFbLogin","login","permissions","accessToken","resp","setItem","current_user","stringify","err","Btn","Logout","removeItem","PasswordLogin","setEmail","password","setPassword","doPasswordLogin","toast","value","onChange","target","onKeyDown","key","AppRouter","cityPath","settings","baseURL","axios","create","Box","_Box","cursor","item_types","gallery","report","video","layout_onecol","layout_mapui","inflector","m","toLowerCase","b","c","replace","length","window","console","log","bottomDrawerHeight","React","createContext","Wrapper","BottomWrapper","ButtonWrapper","BottomDrawer","bottomDrawerOpen","layout","setBottomDrawerOpen","IconButton","aria-label","edge","fontSize","Drawer","anchor","elevation","open","onClose","BackdropProps","invisible","variant","position","left","bottom","appPages","title","icon","newspaperOutline","url","bus","person","powerOutline","Menu","contentId","appPage","index","autoHide","routerLink","routerDirection","lines","detail","slot","ios","md","MenuBottom","LeftWrapper","W1","W2","MenuLeft","drawerOpen","setDrawerOpen","loading","useHistory","List","ListItem","button","bookmarks","idx","name","n_stars","withRouter","created_at","username","city","tags","substring","tag","i","Rating","rate","rating","setRating","iconMapping","0","starOutline","1","starHalf","2","star","useEffect","Array","fill","Btn0","BtnRow","Header","modalStyle","overlay","content","margin","UnlockModal","itemToUnlock","setItemToUnlock","path","item_type","mountedRef","useRef","current","fn","MapuiContainer","MapuiLayout","Cities","cities","setCities","filteredCities","setFilteredCities","showLoading","setShowLoading","res","ev","filter","indexOf","trim","funnel","checked","bookmark","photo","n_reports","image","n_galleries","videocam","n_videos","onDidDismiss","duration","Images","ImageLarge","img","ImageThumb1","ImageThumb2","NewsitemGallery","photos","thumb_url","NewsitemReport","NewsitemVideo","youtube_id","frameBorder","allow","allowFullScreen","preload","controls","Newsitems","newsitems","newsitem","premium_tier","ItemIcon","is_purchased","Col","Row","Title","h2","NewsitemContainer","children","setShowItem","showItem","boxShadow","is_premium","dangerouslySetInnerHTML","__html","subhead","Venues","filteredVenues","setFilteredVenues","venues","venue","includes","CitiesShow","match","location","useLocation","setCity","backgroundImage","hero_img","backgroundSize","pin","pathname","exact","render","GalleriesShow","setGallery","getGallery","ph","large_url","MyGalleries","galleries","setGalleries","g","B","B1","Breadcrumbs","breadcrumbs","textDecoration","ReportsShow","getReport","description","ItemModal","reportname","Left","_Description","Description","IframeModal","showUrl","setShowUrl","scrolling","allowtransparency","Right","LocationsShow","setLoading","setLocation","markers","Div1","Div3","ZoomCtrl","zoom","setZoom","top","background","display","flexDirection","MapPanel","div1Ref","scrollIntoView","block","y","centerOffsetY","x","centerOffsetX","img_path","maxWidth","w","maxHeight","h","ref","MarkersList","goto","title_img_path","_Hero","Hero","SitesShow","setNewsitems","redBorder","border","VideoItem","Video","video_url","Videos","videos","setVideos","v","__Container","_Container","App","_setItemToUnlock","setLayout","Container","Route","Provider","main","from","component","CitiesList","Boolean","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"mKAAA,IAAIA,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBP,EAAM,KAEjD,MADAM,EAAEE,KAAO,mBACHF,KAIR,IAAIG,EAAMX,EAAIE,GAAMU,EAAKD,EAAI,GAC7B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","file":"static/js/main.1d43c89e.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t202,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t203,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t204,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t205,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t206,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t207,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t208,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t209,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t210,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t211,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t212,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t213,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t214,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t215,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t216,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t217,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t218,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t219,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t220,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t221,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t222,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t223,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t224,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t225,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t226,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t227,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t228,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t229,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t230,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t231,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t232,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t233,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t234,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t235,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t236,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t237,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t238,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t239,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t240,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t241,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t242,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t243,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t244,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 156;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t245,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 158;\nmodule.exports = webpackAsyncContext;","import React, { useContext } from 'react'\n\nimport config from \"config\"\nimport { C, logg, request, TwofoldContext } from \"$shared\"\n\nconst useApi = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const token = localStorage.getItem(C.jwt_token);\n\n  return {\n    doUnlock: ({ kind, id }) => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      return `/api/payments/unlock?kind=${kind}&id=${id}&jwt_token=${jwt_token}`;\n    },\n\n    getMyAccount: () => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      return request.post(`/api/my/account`, {\n        jwt_token: jwt_token,\n      })\n    },\n\n    loginPath: '/api/users/login.json',\n    longTermTokenPath: '/api/users/long_term_token',\n\n    myAccount: () => \"/api/my/account\",\n    myVideosPath: \"/api/my/videos\",\n\n    paymentsPath: \"/api/payments2\",\n\n    reportsGet: (a) => {\n      const currentUser = JSON.parse(localStorage.getItem(\"current_user\")) || {};\n      let jwt = \"\";\n      if (currentUser) {\n        jwt = `jwt_token=${currentUser.jwt_token}`\n      }\n      return `${config.apiOrigin}/api/reports/view/${a}?${jwt}`;\n    },\n\n    getCities: ()   => request.get(`${config.apiOrigin}/api/cities`).then((r) => r.data),\n    getCity: (slug) => request.get(`${config.apiOrigin}/api/cities/view/${slug}`),\n\n    applicationHome: async () => {\n      const out = await request.get(`${config.apiOrigin}/api/sites/view/${config.domain}`, { params: { jwt_token: token } })\n      return out.data\n    }\n  }\n\n}\n\nexport default useApi\n","\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport { IonPage, IonContent } from \"@ionic/react\"\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Link } from 'react-router-dom'\n\nimport { FbLogin, Logout, PasswordLogin } from \"./\"\nimport { C, logg, TwofoldContext } from \"$shared\"\n\nimport \"./users.scss\"\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n    color: theme.palette.text.secondary,\n  },\n  root: {\n    flexGrow: 1,\n    overflow: 'scroll',\n    height: '100vh',\n  },\n\n}));\n\nconst Account = (props) => {\n  const classes = useStyles()\n\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n\n  return (<F>\n\n      <Grid container spacing={2} className={classes.root} >\n        <Grid item xs={12}>\n          <Grid container>\n            <Grid item xs={6}>\n              <img src=\"/assets/accounts/default-avatar.png\" alt=\"profile pic\" />\n            </Grid>\n            <Grid item xs={6}>\n              { !!currentUser\n                && <F>\n                  <h4>{currentUser.email}</h4>\n                  <ul>\n                    <li><Link to={\"/en/account/my/galleries\"} >My Galleries</Link></li>\n                    <li><a onClick={() => props.history.push(\"/en/account/my/videos\")}>My Videos</a></li>\n                    <li><Logout /></li>\n                  </ul>\n                </F>\n                || <F>\n                  <h4>Not logged in</h4>\n                  <FbLogin />\n                  <br /><br />\n                  <PasswordLogin />\n\n                </F> }\n            </Grid>\n          </Grid>\n        </Grid>\n      </Grid>\n\n  </F>);\n}\n\nexport default Account;\n","\nimport { IonPage, IonContent } from \"@ionic/react\"\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from 'react-modal'\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { FbLogin, Logout, PasswordLogin } from \"./\"\nimport { C, logg, TwofoldContext } from \"$shared\"\n\n\nconst LoginModal = (props) => {\n  logg(props, 'LoginModal')\n  const { loginModalOpen, setLoginModalOpen } = useContext(TwofoldContext)\n\n  return <Modal style={{ zIndex: 3 }} isOpen={loginModalOpen} >\n\n    <h1>\n      Please Login\n      <button onClick={() => setLoginModalOpen(false)} >[x]</button>\n    </h1>\n    <FbLogin />\n    <PasswordLogin />\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport React, { Fragment as F, useContext, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { CardElement, Elements, useElements, useStripe, } from '@stripe/react-stripe-js'\nimport { loadStripe } from '@stripe/stripe-js'\nimport styled from 'styled-components'\n\nimport config from \"config\"\n\nimport { logg, S, request, TwofoldContext, useApi } from \"$shared\"\n\nconst stripePromise = loadStripe('pk_test_qr1QPmSpLdBFt1F7itdWJOj3') // @TODO: this is active, but change.\n\nconst Login = (props) => {\n  return (<F>\n    <button>do login</button>\n  </F>)\n};\n\nconst Root = styled.div`\n  // border: 1px solid red;\n\n  background: white;\n  height: 100px;\n  width: calc(100vw - ${p => p.borderWidth*2}px);\n  padding: 1em;\n  margin-bottom: ${p => p.borderWidth}px;\n`;\n\nconst W = styled.div`\n  display: flex;\n  justify-content: center;\n  background: #dedede;\n`;\n\nconst MyAccountWidget = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const stripe = useStripe()\n  const elements = useElements()\n\n  const [purchaseModalIsOpen, setPurchaseModalIsOpen] = useState(false)\n\n  const handleSubmit = async (event) => {\n    event.preventDefault()\n    logg('purchasing...')\n\n    if (!stripe || !elements) { return }\n    const cardElement = elements.getElement(CardElement)\n\n    const jwtToken = localStorage.getItem('jwt_token')\n    let client_secret = await request.get(`${config.apiOrigin}${api.paymentsPath}?jwt_token=${jwtToken}`)\n    client_secret = client_secret.data.client_secret;\n    logg(client_secret, 'client_secret');\n\n    const result = await stripe.confirmCardPayment(client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    })\n    logg(result, 'result')\n\n    if (result.error) {\n      logg(result.error.message, 'error message')\n    } else {\n      if (result.paymentIntent.status === 'succeeded') {\n        let response = await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`)\n        logg(response, 'ze3response')\n      } else {\n        logg('something else');\n      }\n    }\n  }\n\n  const { borderWidth } = S\n\n  if (!currentUser) { return null }\n\n  return <W><Root {...{ borderWidth }} >\n    { currentUser.email ? currentUser.email : <Login /> } &nbsp;\n    [&nbsp;{ typeof currentUser.n_unlocks === 'number' ? currentUser.n_unlocks : '?' } coins&nbsp;]&nbsp; &nbsp;\n    <button onClick={() => setPurchaseModalIsOpen(true) }>buy</button>\n\n    <Modal isOpen={purchaseModalIsOpen} ariaHideApp={false} style={{  width: '500px' }} >\n      <h1>\n        Purchase this\n        <span onClick={() => {\n          logg('clicking...')\n          setPurchaseModalIsOpen(false)\n        } } >[x]</span>\n      </h1>\n\n      <form onSubmit={handleSubmit} >\n        <CardElement />\n        <button type=\"submit\" disabled={!stripe} >Pay</button>\n      </form>\n\n    </Modal>\n  </Root></W>\n}\n\nconst WrappedMyAccountWidget = (props) => <Elements stripe={stripePromise}><MyAccountWidget {...props} /></Elements>;\n\nexport default WrappedMyAccountWidget;\n","/*\n * components / users / index\n */\nimport { Plugins } from '@capacitor/core'\nimport { FacebookLoginResponse } from '@capacitor-community/facebook-login';\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport config from 'config'\nimport { Btn, C, logg, request, TwofoldContext, useApi, } from \"$shared\"\n\nexport { default as Account } from \"./Account\"\n\nconst { FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\nexport const FbLogin = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>FB Login</Btn>\n}\n\nexport { default as LoginModal } from \"./LoginModal\"\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser(null)\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n\nexport const PasswordLogin = (props) => {\n  const api = useApi()\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(TwofoldContext)\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const doPasswordLogin = async (email, password) => {\n    request.post(`${config.apiOrigin}${api.loginPath}`, { email, password }).then((r) => r.data).then((resp) => {\n      setCurrentUser(resp)\n      localStorage.setItem('jwt_token', resp.jwt_token)\n\n      // @TODO: make sure this response has jwt_token.\n      // @TODO: this should be done differently.\n      // delete resp.jwt_token\n      // delete resp.bookmarks\n\n      localStorage.setItem('current_user', JSON.stringify(resp))\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(null)\n    })\n  }\n\n  return <F>\n    <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') { doPasswordLogin(email, password) }\n      }}\n    /><br />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n  </F>\n}\n\n\nexport { default as MyAccountWidget } from \"./MyAccountWidget\";\n","\nconst AppRouter = {\n  cityPath: (slug) => `/en/cities/travel-to/${slug}`,\n};\n\nexport default AppRouter;\n","\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport { CollapsibleContext, logg } from '$shared'\n\nconst Gt = () => <span>&nbsp;&gt;&nbsp;&nbsp;</span>\nconst Lt = () => <span>&nbsp;&lt;&nbsp;&nbsp;</span>\nconst Label = styled.div`\n  display: flex;\n`;\nconst Root = styled.div`\n  background: #dedede;\n  margin: .5em;\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\nconst W1 = styled.div`\n  // border: 2px solid red;\n\n  max-height: 100vh;\n`;\n\nconst Collapsible = ({ children, ...props }) => {\n  logg(props, 'Collapsible')\n  const ctx = useContext(CollapsibleContext);\n  logg(ctx, 'ctx')\n  if (!ctx) { return null; }\n  const { collapsibles, setCollapsibles } = ctx;\n\n  const doToggle = () => {\n    setCollapsibles({ ...collapsibles, [props.slug]: !collapsibles[props.slug] })\n  }\n\n  const folded = !!collapsibles[props.slug]\n\n  return <Root>\n    <Label onClick={doToggle} >{folded ? <Lt /> : <Gt />} {props.label} </Label>\n    { !folded && <W1>{ children }</W1> }\n  </Root>\n}\n\nexport default Collapsible\n","import axios from \"axios\";\nimport config from \"config\";\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings);","/*\n *  $shared / index\n */\nimport _Box from '@material-ui/core/Box'\nimport React, { useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nexport { default as useApi } from \"./Api\"\nexport { default as AppMock } from \"./AppMock\"\nexport { default as AppRouter } from \"./AppRouter\"\n\nexport const Box = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n\n  padding: .3em 1em;\n  cursor: pointer;\n`;\n\nexport const C = {\n  current_user: 'current_user',\n  jwt_token: 'jwt_token',\n\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n}\n\nexport { default as Collapsible } from \"./Collapsible\"\nexport const CollapsibleContext = React.createContext({})\n\nexport const Debug = styled.div`\n`;\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n\nexport { logg };\n\nexport { default as request } from \"./request\";\n\nexport const S = {\n  borderWidth: 10,\n  bottomDrawerHeight: 100,\n}\n\nexport const TwofoldContext = React.createContext({})\n\nexport const ZoomContext = React.createContext({})\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n","\nimport Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { MenuBottom } from \"./\"\nimport { Account, Account2, MyAccountWidget } from \"$components/users\"\nimport { C, logg, TwofoldContext } from \"$shared\"\n\nconst BottomWrapper = styled.div`\n  // height: 100px;\n  // position: absolute;\n  // bottom: 0;\n`\n\nconst ButtonWrapper = styled.div`\n  // border: 1px solid yellow;\n  position: absolute;\n  bottom: -10px;\n  left: 10px;\n`\n\n// @TODO: animate opening it, nicely?\nconst BottomDrawer = (props) => {\n  // logg(props, 'BottomDrawer')\n\n  const { bottomDrawerOpen, layout, setBottomDrawerOpen } = useContext(TwofoldContext)\n\n  if (layout === C.layout_onecol) { return null; }\n\n  return <F>\n    <BottomWrapper>\n      <ButtonWrapper>\n        <IconButton\n          aria-label=\"open drawer\"\n          onClick={() => setBottomDrawerOpen(true)}\n          edge=\"start\"\n          className=\"menu-btn\"\n        ><MenuIcon\n          fontSize=\"small\"\n          style={{ color: 'white' }}\n        /></IconButton>\n      </ButtonWrapper>\n      <MenuBottom />\n    </BottomWrapper>\n\n    <Drawer anchor={\"bottom\"}\n      elevation={1}\n      open={bottomDrawerOpen}\n      onClose={() => setBottomDrawerOpen(false)}\n      BackdropProps={{ invisible: true }}\n      variant={\"persistent\"}\n    >\n      <div >\n        <MyAccountWidget />\n        <div\n          onClick={() => setBottomDrawerOpen(false)}\n          style={{ position: 'absolute', left: 0, bottom: 0 }}\n        >[X]</div>\n      </div>\n    </Drawer>\n  </F>\n}\n\nexport default BottomDrawer\n","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonMenu,\n  IonMenuToggle,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { newspaperOutline, bus, person, powerOutline } from 'ionicons/icons';\nimport './application.scss';\n\nconst appPages = [\n  {\n    title: 'Homefeed',\n    icon: newspaperOutline,\n    url: \"/en\"\n  },\n  {\n    title: 'Cities',\n    icon: bus,\n    url: \"/en/cities\"\n  },\n  {\n    title: 'My Account',\n    icon: person,\n    url: \"/en/account\"\n  },\n  {\n    title: 'Account2',\n    icon: person,\n    url: \"/en/account2\"\n  },\n  {\n    title: 'Login',\n    icon: powerOutline\n  }\n];\n\n/**\n * 20210529 - I think this is obsolete somehow, I'm using MyDrawer in App.jsx\n *\n */\nconst Menu = () => {\n  return (\n    <IonMenu contentId=\"main\" type=\"overlay\">\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Menu</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <img src=\"/assets/hero.png\" />\n        <IonList id=\"inbox-list\">\n          { appPages.map((appPage, index) =>\n            <IonMenuToggle key={index} autoHide={false}>\n              <IonItem\n                routerLink={appPage.url}\n                routerDirection=\"none\"\n                lines=\"none\"\n                detail={false}>\n                <IonIcon\n                  slot=\"start\"\n                  ios={appPage.icon}\n                  md={appPage.icon} />\n                <IonLabel>{appPage.title}</IonLabel>\n              </IonItem>\n            </IonMenuToggle>\n          ) }\n        </IonList>\n      </IonContent>\n    </IonMenu>\n  )\n}\n\nexport default Menu;\n","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonMenu,\n  IonMenuToggle,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { newspaperOutline, bus, person, powerOutline } from 'ionicons/icons';\nimport './application.scss';\n\n\n/**\n * 20210602\n *\n */\nconst MenuBottom = () => {\n  return (\n    <IonMenu type=\"overlay\">\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Menu</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <img src=\"/assets/hero.png\" />\n        <h1>what's here?</h1>\n      </IonContent>\n    </IonMenu>\n  )\n}\n\nexport default MenuBottom;\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Menu } from \"$components/application\"\nimport { Api, C, Debug, logg, TwofoldContext } from \"$shared\"\n\nconst LeftWrapper = styled.div`\n  // border: 1px solid green;\n\n  position: absolute;\n  top: 0;\n  left: 0;\n\n  background: white;\n`;\n\nconst W1 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\nconst W2 = styled.div`\n`;\n\nconst MenuLeft= (props) => {\n  logg(props, 'MenuLeft')\n  const [drawerOpen, setDrawerOpen] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n\n  return <F>\n    <LeftWrapper>\n      <IconButton\n        aria-label=\"open drawer\"\n        onClick={() => setDrawerOpen(true)}\n        edge=\"start\"\n        className=\"menu-btn\"\n      ><MenuIcon /></IconButton>\n      { /* <MyAccountWidget /> */ }\n      <Menu />\n    </LeftWrapper>\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W1>\n        <List>\n          <ListItem button key={'newsfeed'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en\")\n            } } >\n            Newsfeed\n          </ListItem>\n          <ListItem button key={'cities'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/cities\")\n            } }>\n            <span >Cities</span>\n          </ListItem>\n          { /* <ListItem button key={'map 1'} >\n            <span onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations\")\n            } }>The Directory</span>\n          </ListItem> */ }\n          { currentUser && currentUser.bookmarks.map((b, idx) =>\n            <ListItem button key={idx}\n              onClick={() => {\n                setDrawerOpen(false)\n                history.push(`/en/locations/show/${b.slug}`)\n              } } >\n              <span >{b.name}</span>\n            </ListItem>\n          ) }\n          <ListItem button key={'account'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/account\")\n            } } >\n            <span >Account</span>\n          </ListItem>\n        </List>\n        <W2>\n          { loading && 'Loading...' }\n          { currentUser && <F>\n            {currentUser.email}<br />\n            {currentUser.n_stars}<br />\n            some action\n          </F> }\n        </W2>\n      </W1>\n    </Drawer>\n  </F>\n}\n\nexport default MenuLeft\n","import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport \"./application.scss\";\nimport styled from 'styled-components'\n\nimport { Api, logg, request } from \"$shared\"\n\nconst W = styled.div`\n  margin-top: .5em;\n`\n\nconst Metaline = (props) => {\n  // logg(props, 'Metaline')\n\n  const { created_at, username, city, tags = [] } = props;\n\n  function navigateToCity(){\n    props.history.push(`/en/cities/travel-to/${city.slug}/show/newsfeed`);\n  }\n\n  return (\n    <W>\n      <span className=\"date\"> On {(created_at || \"\").substring(0, 10)} </span>\n      { username && <>by <span className=\"user\"> {username} </span></> }\n      { city     && <>in <span className=\"city\" onClick={navigateToCity}> {city.name} </span></> }\n      { tags     && tags.map((tag, i) => <span key={i} className=\"tags\">{tag.name}</span>) }\n    </W>\n  );\n\n}\n\nexport default withRouter(Metaline);","import React, { useEffect, useState } from \"react\";\nimport { IonIcon } from \"@ionic/react\";\nimport { starOutline, starHalf, star } from 'ionicons/icons';\nimport \"./application.scss\";\n\nconst Rating = (props) => {\n\n  let rate = props.rate;\n  let [rating, setRating] = useState([]);\n\n  let iconMapping = {\n    0: starOutline,\n    1: starHalf,\n    2: star\n  };\n\n  useEffect(() => {\n\n    let rating = (new Array(5)).fill(0);\n    let i = 0;\n    while (rate > 0) {\n      if (rate < 1) {\n        rating[i] = 1;\n      } else {\n        rating[i] = 2;\n      }\n      rate--;\n      i++;\n    }\n\n    setRating(rating);\n\n  }, []);\n\n  return (\n    <span className=\"rating\">\n      { rating.map((r, i) => <IonIcon key={i} className=\"stars\" icon={iconMapping[r]} ></IonIcon>) }\n    </span>\n  )\n\n}\n\nexport default Rating;","\nimport Modal from \"react-modal\"\nimport React, { useContext, useEffect, useRef, } from 'react'\nimport styled from 'styled-components'\n\nimport './UnlockModal.scss'\nimport config from 'config'\nimport { Btn, C, logg, request, TwofoldContext, useApi, } from \"$shared\"\n\nconst Btn0 = styled.div`\n  display: inline;\n  cursor: pointer;\n`;\nconst BtnRow = styled.div`\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst modalStyle = {\n  overlay: {},\n  content: {\n    margin: 'auto',\n    width: '400px',\n\n  }\n}\n\nconst UnlockModal = (props) => {\n  logg(props, 'UnlockModal')\n\n  const {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(TwofoldContext)\n  const usedTwofoldContext = useContext(TwofoldContext)\n\n  const api = useApi()\n\n  const doUnlock = async () => {\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    const path = api.doUnlock({ kind: itemToUnlock.item_type, id: itemToUnlock.id })\n    await request.post(`${config.apiOrigin}${path}`).then((r) => {\n      setItemToUnlock({})\n    }).catch((e) => {\n      logg(e, 'e19')\n    })\n  }\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n\n    const fn = async () => {\n      const jwtToken = localStorage.getItem(C.jwt_token)\n      await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`).then((r) => {\n        if (!mountedRef.current) { return }\n        setCurrentUser(r.data)\n      }).catch((e) => {\n        // logg(e, 'e12')\n        // setCurrentUser(null)\n      })\n    }\n    fn()\n    return () => mountedRef.current = null\n  }, [itemToUnlock.id])\n\n  if (!itemToUnlock.id) { return null }\n\n  return (<Modal style={modalStyle} ariaHideApp={false} isOpen={!!itemToUnlock.id} >\n    <Header>\n      <h1>Unlock this item?</h1>\n      <Btn0 onClick={() => setItemToUnlock(false) } >&times;</Btn0>\n    </Header>\n    <p>To access this content, please unlock it first. It costs 1 (one) coin to unlock.</p>\n    { !!currentUser\n      && <p>You have <b>{currentUser.n_unlocks}</b> unlocks.</p>\n      || <p>You have to be logged in to unlock content. <a onClick={() => { setLoginModalOpen(true) ; setItemToUnlock(false) }}>Please login.</a></p> }\n    <BtnRow>\n      { !!currentUser && <Btn onClick={doUnlock} >Unlock</Btn> }\n    </BtnRow>\n  </Modal>)\n\n}\n\nexport default UnlockModal\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst borderWidth = 20\nconst bottomDrawerHeight = 100\nconst MapuiContainer = styled.div`\n  background: white;\n\n  overflow: hidden;\n  margin: 10px;\n  height: calc(100vh - ${p => p.borderWidth*2}px - ${p => p.bottomDrawerOpen ? `${p.bottomDrawerHeight - p.borderWidth/2}px` : '0px' });\n`\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiLayout = (props) => {\n  return <MapuiContainer {...props} {...{ bottomDrawerHeight, borderWidth }} />\n}\n\nexport default MapuiLayout\n","import { IonPage, IonLoading, IonContent, IonIcon } from '@ionic/react';\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons';\nimport React, { Fragment as F, useEffect, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from 'styled-components'\n\nimport { useApi, AppRouter, logg, Wrapper } from \"$shared\"\nimport \"./cities.scss\"\n\n\nconst Cities = (props) => {\n  const [cities, setCities] = useState([]);\n  const [filteredCities, setFilteredCities] = useState([]);\n  const [showLoading, setShowLoading] = useState(false);\n  const api = useApi()\n  const history = useHistory()\n\n  useEffect(() => {\n    setShowLoading(true);\n    api.getCities().then(res => {\n      setShowLoading(false);\n      setFilteredCities(res);\n      setCities(res);\n    });\n  }, [])\n\n  const filterHandler = (ev) => {\n    let filteredCities = cities.filter(city => {\n      return city.name.toLowerCase().indexOf(ev.target.value.trim().toLowerCase()) > -1;\n    });\n    setFilteredCities(filteredCities);\n  }\n\n  return <F>\n    <Wrapper className='cities' >\n      <h1 className=\"heading\" >Cities</h1>\n\n      <Link to={\"/en/account\"} >Account</Link>\n\n      <div className=\"filter-section\">\n        <input className=\"filter-input\" onChange={filterHandler} />\n        <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n      </div>\n\n      <div className=\"bookmark-section\">\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={() => { }} checked />\n          <span className=\"slider round\"></span>\n        </label>\n        <span className=\"bookmark-text\">Show only bookmarked</span>\n      </div>\n\n      <div className=\"container\">\n        { filteredCities.map((city, i) => <div key={i} className=\"cities\" onClick={() => history.push(AppRouter.cityPath(city.slug)) } >\n            <div className=\"img-section\">\n              <span className=\"bookmark\" >\n                <IonIcon className=\"bookmark-icon\" icon={bookmark}></IonIcon>\n              </span>\n              <img className=\"city-img\" src={city.photo} />\n              <span className=\"city-title\">{city.name}</span>\n            </div>\n            <div className=\"content-section\">\n              <div className=\"content-item\">\n                <IonIcon className=\"icon\" icon={newspaperOutline}></IonIcon>\n                <span className=\"count\">{city.n_reports}</span>\n              </div>\n              <div className=\"content-item\">\n                <IonIcon className=\"icon\" icon={image}></IonIcon>\n                <span className=\"count\">{city.n_galleries}</span>\n              </div>\n              <div className=\"content-item\">\n                <IonIcon className=\"icon\" icon={videocam}></IonIcon>\n                <span className=\"count\">{city.n_videos}</span>\n              </div>\n            </div>\n          </div>\n        ) }\n      </div>\n      &nbsp;\n    </Wrapper>\n\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </F>\n}\n\nexport default Cities;\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\nimport { NewsitemContainer } from './'\nimport \"./newsitems.scss\"\n\n\nconst Image = styled.div`\n  position: relative;\n  padding-top: 100%;\n  overflow: hidden;\n  z-index: 10;\n  background-position: center;\n  background-size: cover;\n  background-repeat: no-repeat;\n\n  width: 100px;\n  height: 100px;\n`;\n\nconst Image2 = styled.div`\n`;\n\nconst Images = styled.div`\n  position: relative;\n`;\n\nconst ImageLarge = styled.img`\n  width: 200px;\n`;\n\nconst ImageThumb1 = styled.img`\n  position: absolute;\n  left: 200px;\n  top: 0;\n`;\n\nconst ImageThumb2 = styled.img``;\n\n/**\n * TDD\n */\nconst NewsitemGallery = (props) => {\n  // logg(props, 'NewsitemGallery')\n  const { item } = props\n\n  const history = useHistory()\n\n  return <NewsitemContainer item={item} >\n    <Images >\n      { false && (item.photos || []).slice(0, 3).map((photo, i) =>\n        <Image key={i}\n          style={{ backgroundImage: `url(${photo.large_url})` }}>\n          { i == 2 && <div className=\"number\">+{item.photos.length - 3}</div> }\n        </Image>\n      ) }\n\n      { item.photos[0] && <ImageLarge src={item.photos[0].thumb_url} /> }\n      { item.photos[1] && <ImageThumb1 src={item.photos[1].thumb_url} /> }\n      { item.photos[2] && <ImageThumb2 src={item.photos[2].thumb_url} /> }\n\n      { false && item.photos.map((photo, idx) =>\n        <Image2 key={idx} >\n          <img src={`${photo.thumb_url}`} alt='' />\n        </Image2>\n      ) }\n    </Images>\n  </NewsitemContainer>\n}\n\nNewsitemGallery.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired,\n  }),\n}\nexport default NewsitemGallery\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon, NewsitemContainer } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, C, logg, request, TwofoldContext } from \"$shared\"\n\nimport \"./newsitems.scss\"\n\n\nconst NewsitemReport = (props) => {\n  // logg(props, \"NewsitemReport\");\n  const { item } = props\n  return (<NewsitemContainer item={item} />)\n}\n\nNewsitemReport.propTypes = {\n  item: PropTypes.object.isRequired,\n}\nexport default NewsitemReport\n\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { NewsitemContainer } from \"./\"\nimport \"./newsitems.scss\"\n\n\nconst NewsitemVideo = (props) => {\n  logg(props, 'NewsitemVideo')\n  const { item } = props\n\n  return <NewsitemContainer item={item} >\n    <div className=\"image-section\">\n      { item.youtube_id ?\n          <iframe className=\"iframe\" width=\"100%\" height=\"315\" src={`https://www.youtube.com/embed/${item.youtube_id}`} frameBorder=\"0\" allow=\"autoplay; encrypted-media\" allowFullScreen></iframe>\n          : <video width=\"100%\" preload=\"metadata\" height=\"auto\" controls>\n            <source src={item.url} type=\"video/mp4\" />\n          </video> }\n    </div>\n  </NewsitemContainer>\n\n}\n\nNewsitemVideo.propTypes = {\n  item: PropTypes.object.isRequired,\n}\nexport default NewsitemVideo","import React from \"react\"\nimport styled from 'styled-components'\n\nimport { Api, C, logg } from \"$shared\"\nimport NewsitemGallery from \"$components/newsitems/NewsitemGallery\"\nimport NewsitemReport from \"$components/newsitems/NewsitemReport\"\nimport NewsitemVideo from \"$components/newsitems/NewsitemVideo\"\nimport \"./newsitems.scss\"\n\nconst ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nconst Wrapper = styled.div`\n  margin-bottom: 2em;\n`\n\nconst Newsitems = (props) => {\n  logg(props, 'Newsitems')\n  const { newsitems } = props\n\n  if (!newsitems || !newsitems.length) { return <div>No Newsitems</div> }\n\n  return (\n    <Wrapper>\n      { newsitems.map((newsitem, idx) => {\n        const premium_tier = newsitem.premium_tier || 0\n        const icon = ICONS[premium_tier]\n\n        return (\n          <div key={idx} className={`items premium-${premium_tier}`}>\n            { newsitem.item_type === C.item_types.gallery && <NewsitemGallery item={newsitem} /> }\n            { newsitem.item_type === C.item_types.report  && <NewsitemReport  item={newsitem} /> }\n            { newsitem.item_type === C.item_types.video   && <NewsitemVideo   item={newsitem} /> }\n          </div>\n        )\n      }) }\n    </Wrapper>\n  )\n}\n\nexport default Newsitems\n","\nimport PropTypes from 'prop-types'\nimport React from 'react'\n\nimport { C, logg } from \"$shared\"\n\n/**\n * Displays the appropriate icon.\n *\n * @param [Boolean] props.isPurchased\n * @param [Number] props.premiumTier\n * @param [String] props.kind\n */\n export const ItemIcon = (props) => {\n  // logg(props, \"ItemIcon\")\n  const { is_purchased, item_type, premium_tier } = props\n\n  if (is_purchased) {\n    return <img className=\"icon\" src=\"/assets/icons/glasses.png\" alt='' />\n  }\n  if (premium_tier > 0) {\n    return <img className=\"icon\" src=\"/assets/icons/gem.png\" alt='' />\n  }\n  switch (item_type) {\n    case C.item_types.gallery:\n      return <img className=\"icon\" src=\"/assets/icons/gallery.png\" alt='' />\n    case C.item_types.report:\n      return <img className=\"icon\" src=\"/assets/icons/report.png\" alt='' />\n    case C.item_types.video:\n      return <img className=\"icon\" src=\"/assets/newsfeed/video_icon.svg\" alt='' />\n    default:\n      return \"unknown kind\"\n  }\n}\n\nItemIcon.propTypes = {\n  is_purchased: PropTypes.bool, // .isRequired,\n  item_type: PropTypes.string.isRequired,\n  premium_tier: PropTypes.number,\n}\nexport default ItemIcon\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, Box, C, inflector, logg, request, TwofoldContext } from \"$shared\"\n\n\nconst Col = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  margin-left: 0.5em;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n\n  // padding: 0 1em;\n`;\n\nconst Title = styled.h2`\n`;\n\n/**\n * TDD\n */\nconst NewsitemContainer = ({ children, ...props }) => {\n  // logg(props, 'NewsitemContainer')\n  const { item } = props\n  const { item_type, slug } = item\n\n  const history = useHistory()\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    layout,\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n\n  const navigateToItem = () => {\n    if (item.is_premium && !item.is_purchased) {\n      setItemToUnlock(item)\n    } else {\n      if (layout === C.layout_mapui) {\n        setShowItem(item)\n      } else {\n        history.push(`/en/${inflector.tableize(item_type)}/show/${slug}`)\n      }\n    }\n  }\n\n  return <Box boxShadow={2} {...props} onClick={navigateToItem} cursor=\"pointer\" >\n    { children }\n    <Row>\n      <ItemIcon {...item} />\n      <Col>\n        <Title>{item.name}</Title>\n        <Metaline {...item} />\n      </Col>\n    </Row>\n    <p className=\"subhead\" dangerouslySetInnerHTML={{ __html: item.subhead }} />\n  </Box>\n}\n\nNewsitemContainer.propTypes = {\n  item: PropTypes.object.isRequired,\n}\nexport default NewsitemContainer\n","import React, { useEffect, useState } from \"react\";\nimport { IonPage, IonContent, IonButton, IonImg, IonIcon } from \"@ionic/react\";\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons';\nimport { Rating } from \"$components/application\";\n\nimport \"./venues.scss\";\n\nconst Venues = (props) => {\n\n  const defaultRating = 3.5;\n  const [filteredVenues, setFilteredVenues] = useState(JSON.parse(JSON.stringify(props.data || [])));\n\n  function filterHandler(ev) {\n    let venues = props.data.filter(venue => {\n      return venue.name.toLowerCase().includes(ev.target.value.toLowerCase());\n    })\n    setFilteredVenues(venues);\n  }\n\n  return (\n    <div className=\"venues-section\">\n      <div>\n        <div className=\"filter-section\">\n          <input className=\"filter-input\" onChange={filterHandler} />\n          <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n        </div>\n      </div>\n      <div className=\"container\">\n\n        {\n          filteredVenues.map((venue, i) => {\n            return (\n              <div key={i} className=\"venues\">\n                <div className=\"image-section\">\n                  <img src={venue.photo} />\n                </div>\n                <div className=\"info-section\">\n                  <h4 className=\"title\">{venue.name}</h4>\n                  <div className=\"rating-section\">\n                    <Rating rate={defaultRating}></Rating>\n                    <span className=\"reviews\">5 reviews</span>\n                  </div>\n                  <div className=\"tags-section\">\n                    {\n                      venue.tags.map((tag, i) => {\n                        return (\n                          <span key={i} className=\"tags\">{tag.name}</span>\n                        )\n                      })\n                    }\n                  </div>\n                  <p className=\"description\" dangerouslySetInnerHTML={{ __html: venue.subhead }}></p>\n                  <p className=\"address\">111 N Main St., New York, NY 11223</p>\n                </div>\n                <img className=\"forward-arrow\" src=\"/assets/16x16/arrow-right.png\" />\n              </div>\n            )\n          })\n        }\n\n      </div>\n    </div>\n  );\n}\n\nexport default Venues;","import React, { useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react'\nimport { pin, newspaperOutline, image, videocam } from 'ionicons/icons'\n\nimport { useApi, logg, Wrapper } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { Venues } from \"$components/venues\"\nimport \"./cities.scss\"\n\nconst CitiesShow = (props) => {\n  logg(props, 'CitiesShow')\n  const { match } = props\n\n  const history = useHistory()\n  logg(history, 'production history')\n\n  const location = useLocation()\n\n  const [city, setCity] = useState(null)\n  const [showLoading, setShowLoading] = useState(false)\n\n  const api = useApi()\n\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    setShowLoading(true)\n    api.getCity(match.params.name).then(res => {\n      if (mountedRef.current) {\n        setCity(res.data.city)\n        setShowLoading(false)\n      }\n    })\n    return () => mountedRef.current = false\n  }, [match.params.name])\n\n  // @TODO: remove this!\n  function changeMenuHandler(menu) {\n    // history.push(`${match.url}/${menu}`);\n  }\n\n  return (\n    <Wrapper>\n\n        { city && <div className='wrapper'>\n          <div className='city-show'>\n\n            <header style={{ backgroundImage: `url(${city.hero_img}}`, backgroundSize: \"contain\" }}></header>\n\n            <section className=\"section-one\">\n              <IonIcon icon={pin} className=\"location\"></IonIcon>\n              <h1 className=\"city-name\">{city.name}</h1>\n              <div className=\"status\">\n                <div className=\"status-grid\">\n                  <IonIcon className=\"info-icon\" icon={newspaperOutline}></IonIcon>\n                  <span className=\"numbers\">{city.n_reports}</span>\n                </div>\n                <div className=\"status-grid\">\n                  <IonIcon className=\"info-icon\" icon={image}></IonIcon>\n                  <span className=\"numbers\">{city.n_galleries}</span>\n                </div>\n                <div className=\"status-grid mid\">\n                  <IonIcon className=\"info-icon\" icon={videocam}></IonIcon>\n                  <span className=\"numbers \">{city.n_videos}</span>\n                </div>\n              </div>\n            </section>\n\n            { city.tags && <section className=\"tags-section\">\n              <span className=\"btn delete-btn\" >\n                <IonIcon name=\"close\"> </IonIcon> deselect all\n              </span>\n              { city.tags.map((tag, i) => <span className=\"btn\" key={i} >{tag.name}</span>) }\n            </section> }\n\n            <section className=\"section-three\">\n              <div className=\"menu-option\" onClick={() => changeMenuHandler('newsfeed')}>\n                <img src=\"/assets/newsfeed-icon.svg\" alt=\"Newsfeed\" />\n                <p className={`${location.pathname.includes(\"newsfeed\") ? \"selected\" : \"\"} menu-item`}>Newsfeed</p>\n              </div>\n              <div className=\"menu-option\" onClick={() => changeMenuHandler('venues')}>\n                <img src=\"/assets/venue-icon.svg\" alt=\"Venues\" />\n                <p className={`${location.pathname.includes(\"venues\") ? \"selected\" : \"\"} menu-item`}>Venues</p>\n              </div>\n            </section>\n\n\n            <Switch>\n              <Route exact path={`${match.url}/venues`} render={() => <Venues data={city.venues} />} />\n              <Route exact path={match.url}             render={() => <Newsitems newsitems={city.newsitems} /> } />\n            </Switch>\n\n\n          </div>\n        </div>}\n        <IonLoading\n          isOpen={showLoading}\n          onDidDismiss={() => setShowLoading(false)}\n          message={'Please wait...'}\n          duration={5000}\n        />\n      &nbsp;\n    </Wrapper>\n  )\n}\n\nexport default CitiesShow\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\n\nimport { C, logg, request, TwofoldContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport \"./galleries.scss\"\n\nconst GalleriesShow = (props) => {\n  logg(props, 'GalleriesShow')\n  const { match } = props\n\n  const [showLoading, setShowLoading] = useState(false) // @TODO: hmm could it be moved to TwofoldContext ?\n  const [gallery, setGallery] = useState({})\n\n  const {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(TwofoldContext)\n  const mountedRef = useRef('init')\n\n  const getGallery = async () => {\n    const token = localStorage.getItem(C.jwt_token)\n    await request.get(`/api/galleries/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (!mountedRef.current) { return }\n      const gallery = res.data.gallery\n      if (gallery.is_premium && !gallery.is_purchased) {\n        setItemToUnlock(gallery)\n      } else {\n        setGallery(res.data.gallery)\n      }\n    })\n  }\n\n  useEffect(() => {\n    getGallery()\n    return () => {\n      mountedRef.current = null\n    }\n  }, [gallery.id, itemToUnlock.id] )\n\n  return (<F>\n\n    { <div className=\"gallery-show\">\n      <div className='narrow'>\n        <h1 className=\"heading\">\n          <img src=\"/assets/newsfeed/photos_icon.png\" />\n          <span className=\"title\">{gallery.name}</span>\n        </h1>\n        <Metaline item={gallery} />\n\n        <div className=\"thumbs\">\n          { gallery.photos && gallery.photos.map((ph, i) =>\n            <div className='card' key={i}>\n              <div className='card-inner'>\n                <IonImg src={ph.thumb_url}></IonImg>\n              </div>\n            </div>\n          ) }\n        </div>\n      </div>\n      <div className=\"full-img-section\">\n        { gallery.photos && gallery.photos.map((ph, i) =>\n          <div className='item' key={i}>\n            <img src={ph.large_url} />\n          </div>\n        ) }\n      </div>\n    </div>}\n\n  </F>)\n}\n\nexport default GalleriesShow","import React, { useEffect, useState } from \"react\";\nimport { IonLoading } from \"@ionic/react\";\n\nimport request from \"$shared/request\";\nimport { logg } from \"$shared\";\nimport { Galleries } from \"./\";\nimport { NewsitemGallery } from \"$components/newsitems\";\n\nconst MyGalleries = (props) => {\n  const [galleries, setGalleries] = useState(null);\n  const [showLoading, setShowLoading] = useState(false);\n\n  useEffect(() => {\n    setShowLoading(true);\n    const token = localStorage.getItem(\"jwtToken\");\n    request.get(`/api/my/galleries`, { params: { jwt_token: token } }).then(r => {\n      logg(r.data, 'MyGalleries data')\n      setGalleries(r.data);\n      setShowLoading(false);\n    })\n  }, []);\n\n  return (<>\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n    { galleries && galleries.length && galleries.map((g) => <NewsitemGallery key={g.id} data={g} /> ) }\n  </>);\n}\n\nexport default MyGalleries;","import React from 'react'\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { logg, request, S } from \"$shared\"\n\n// one breadcrumb\nconst B = styled.div`\n  padding: 0.5em;\n`\n// the divider\nconst B1 = styled.div`\n  padding: 0.5em 0;\n`\nconst Root = styled.div`\n  display: flex;\n  z-index: 50;\n\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: white;\n`;\nconst Breadcrumbs = (props) => {\n  logg(props, 'Breakcrumbs')\n\n  const history = useHistory()\n\n  const out = []\n  props.breadcrumbs.map((b, idx) => {\n    if (idx+1 === props.breadcrumbs.length) {\n      // last one\n      out.push(<B key={idx} >{b.name}</B>)\n    } else {\n      out.push(<B\n        key={idx}\n        style={{ textDecoration: 'underline' }}\n        onClick={() => history.push(`/en/locations/show/${b.slug}`) }\n      >{b.name}</B>)\n      out.push(<B1 key={`${idx}-divider`} >&gt;</B1>)\n    }\n  })\n  return <Root>{out}</Root>\n}\n\nexport default Breadcrumbs\n","\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\n\nimport config from \"config\";\nimport { useApi, Box, logg, request } from \"$shared\";\n\nconst W = styled.div`\n  padding: 2em 0;\n`\n\nconst ReportsShow = (props) => {\n  logg(props, \"ReportsShow\");\n\n  let [ item, setItem ] = useState({});\n  let api = useApi()\n\n  // @TODO: refactor\n  const currentUser = JSON.parse(localStorage.getItem(\"current_user\")) || {};\n\n  // @TODO: not logged in and has access\n  const getReport = async () => {\n    logg(null, 'getting report...')\n\n    request.get(api.reportsGet(props.match.params.slug)).then(r => r.data).then(data => {\n      logg(data, 'got report')\n      setItem(data.report);\n    });\n  };\n\n  useEffect(() => {\n    getReport();\n  }, []);\n\n  // @TODO: logged in and no access\n\n  // @TODO: logged in and access\n\n  return (<W>\n    <Box boxShadow={2}>\n      <h1>Report {item.name}</h1>\n      <div className=\"description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n    </Box>\n  </W>)\n}\n\n// @TODO: wrap in login HOC\nexport default ReportsShow;\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { ReportsShow } from \"$components/reports\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst ItemModal = (props) => {\n  logg(props, 'ItemModal')\n  const { item } = props\n\n  const { showItem, setShowItem } = useContext(TwofoldContext)\n\n  return <Modal isOpen={!!showItem} >\n    <h1 onClick={() => setShowItem(false)} >[x]</h1>\n    { item.item_type === 'report' && <ReportsShow match={{ params: { slug: item.reportname } }} /> }\n  </Modal>\n}\n\nexport default ItemModal\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Breadcrumbs, ItemModal, MapPanel, MarkersList } from \"./\"\nimport { logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst Left = styled.div`\n  // border: 1px solid blue;\n\n  background: #dedede;\n  flex: 50%;\n  overflow: scroll;\n  height: calc(100vh - 40px - ${p => p.bottomDrawerOpen ? `${p.bottomDrawerHeight-p.borderWidth}px` : '0px' });\n`;\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n\n  padding: 10px;\n`;\n\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\nconst B = styled.div`\n  padding: 0.5em;\n`;\n\n// the divider\nconst B1 = styled.div`\n  padding: 0.5em 0;\n`;\n\n\n\nconst IframeModal = (props) => {\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  return (<Modal ariaHideApp={false} isOpen={!!showUrl} >\n    <span onClick={() => {  setShowUrl(false) }} >[x]</span>\n\n    <iframe height=\"100%\" style={{ width: \"100%\", height: \"100%\" }} scrolling={\"yes\"} src={props.src}\n      frameBorder=\"no\" allowtransparency=\"true\" allowFullScreen={true} >\n    </iframe>\n  </Modal>)\n}\n\nconst Right = styled.div`\n  // border: 1px solid green;\n\n  background: #dedede;\n\n  padding: 1em;\n  flex: 50%;\n  overflow: scroll;\n  height: calc(100vh - ${p => p.bottomDrawerOpen ? p.bottomDrawerHeight : p.borderWidth}px - ${p => 3*p.borderWidth}px);\n`;\n\nconst Row = styled.div`\n  display: flex;\n  position: relative;\n`;\n\nconst LocationsShow = (props) => {\n  logg(props, 'LocationsShow')\n  const { match } = props;\n\n  const [ loading, setLoading ] = useState(false)\n  const [ location, setLocation ] = useState(null)\n  const {\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n  } = useContext(TwofoldContext)\n\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    setLoading(true);\n    const token = localStorage.getItem(\"jwt_token\")\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) return null;\n      setLocation(res.data.map)\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    }).finally(() => {\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n  const { borderWidth, bottomDrawerHeight } = S\n  const { bottomDrawerOpen } = useContext(TwofoldContext)\n\n  return (<Row>\n    <Left {...{ borderWidth, bottomDrawerOpen, bottomDrawerHeight }} >\n\n      { loading && <i>Loading Left...</i> }\n      { location && <Breadcrumbs {...location} /> }\n      { location && <MapPanel map={location.map ? location.map : location} /> }\n    </Left>\n    <Right {...{ borderWidth, bottomDrawerOpen, bottomDrawerHeight }} >\n      { loading && <i>Loading Right...</i> }\n      { location && <F>\n        <MarkersList markers={location.markers} />\n        <Description item={location} />\n        { location.newsitems && location.newsitems.length && <Newsitems newsitems={location.newsitems} /> || null }\n      </F> }\n    </Right>\n    { showUrl && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n  </Row>)\n}\n\nexport default LocationsShow\n","import React, { useContext, useEffect, useRef } from 'react'\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { logg, TwofoldContext } from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 3px solid green;\n\n  text-align: center;\n  display: block;\n\n  position: relative;\n`;\n\nconst Div3 = styled.div`\n`;\n\nconst W1 = styled.div`\n  // position: relative;\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <div style={{\n    position: 'absolute',\n    top: 0,\n    left: 'calc(50% - 20px)',\n    zIndex: 1,\n    background: 'white',\n    padding: '5px',\n\n    display: 'flex',\n    flexDirection: 'column',\n  }} >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </div>\n}\n\nconst MapPanel = (props) => {\n  // logg(props, 'MapPanel')\n  const { map } = props\n\n  const {\n    showUrl, setShowUrl,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n\n  const div1Ref = useRef(null)\n  const history = useHistory()\n\n  useEffect(() => {\n    div1Ref.current.scrollIntoView({ block: 'end' })\n  }, [])\n\n  const markers = []\n  map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => m.url ? setShowUrl(m.url) : history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: zoom > 1 ? ((m.y- m.centerOffsetY )/zoom) : ((m.y )/zoom- m.centerOffsetY),\n        left: zoom > 1 ? ((m.x- m.centerOffsetX )/zoom) : ((m.x )/zoom- m.centerOffsetX),\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w/zoom}px`,\n        maxHeight: `${m.h/zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return (<W1>\n    <ZoomCtrl />\n\n      <Div1 ref={div1Ref} >\n        <Div3 style={{\n            // border: '2px solid cyan',\n\n            display: 'inline-block',\n            position: 'relative',\n            width: `${map.w/zoom}px`,\n            height: `${map.h/zoom}px`,\n        }} >\n          <img\n            src={map.img_path}\n            style={{\n              width: `${map.w/zoom}px`,\n              height: `${map.h/zoom}px`,\n            }}\n          />\n          { markers }\n        </Div3>\n      </Div1>\n\n  </W1>)\n}\n\nexport default MapPanel\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Breadcrumbs } from \"./\"\nimport {\n  Collapsible, CollapsibleContext,\n  logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n\n  padding: 10px;\n`\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n\nconst W1 = styled.div`\n  position: relative;\n`\nconst ZoomCtrlRoot = styled.div`\n  // border: 1px solid orange;\n\n  position: absolute;\n  top: 0;\n  left: calc(100vw - 80px);\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n  z-index: 10;\n`;\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <ZoomCtrlRoot >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </ZoomCtrlRoot>\n}\nconst Div1 = styled.div`\n  // border: 2px solid brown;\n\n  text-align: center;\n  display: block;\n\n  position: relative; /* required for mobile, so that zoomCtrl, etc are inside the collapsible div */\n\n  overflow: scroll;\n  max-height: 80vh;\n`\nconst Div3 = styled.div``\nconst Map2 = (props) => {\n  logg(props, 'Map2')\n  const { location } = props\n\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const div1Ref = useRef(null)\n  const history = useHistory()\n\n  useEffect(() => {\n    div1Ref.current.scrollIntoView({ block: 'end' })\n  }, [])\n\n  const markers = []\n  props.location.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y/zoom,\n        left: m.x/zoom,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w/zoom}px`,\n        maxHeight: `${m.h/zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return (<W1>\n    <ZoomCtrl />\n    <Div1 ref={div1Ref} >\n      <Div3 style={{\n          // border: '2px solid cyan',\n\n          display: 'inline-block',\n          position: 'relative',\n          width: `${location.w/zoom}px`,\n          height: `${location.h/zoom}px`,\n      }} >\n        <img\n          src={location.img_path}\n          style={{\n            width: `${location.w/zoom}px`,\n            height: `${location.h/zoom}px`,\n          }}\n        />\n        { markers }\n      </Div3>\n    </Div1>\n  </W1>)\n}\n\nconst Markers = (props) => {\n  const out = []\n  props.markers.map((m, idx) => {\n    out.push(<div key={idx} style={{ margin: '10px' }} >\n      <img src={m.title_img_path} /><br />\n      {m.name}\n    </div>)\n  })\n  return <div style={{ display: 'flex' }} >{out}</div>\n}\n\nconst Row = styled.div`\n  // border: 2px solid cyan;\n\n  display: flex;\n  flex-direction: column;\n\n  overflow: scroll;\n  height: calc(100vh - 40px); /* @TODO: why 40px?! */\n`\n\n\nconst LocationsShow = (props) => {\n  logg(props, 'LocationsShow')\n\n  const { match } = props;\n\n  const [loading, setLoading] = useState(false)\n  const [location, setLocation] = useState(null)\n\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    setLoading(true);\n    const token = localStorage.getItem(\"jwt_token\");\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (!mountedRef.current) return null;\n      setLocation(res.data.map)\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    }).finally(() => {\n    })\n\n    return () => {\n      // mountedRef.current = false;\n    }\n  }, [ match.params.slug ])\n\n  return (<Row>\n\n    { loading && <i>Loading...</i> }\n    { location && <Breadcrumbs {...location} /> }\n    <Collapsible slug=\"map-sec\" label=\"Map\" >\n      { location && <Map2 location={location} /> }\n    </Collapsible>\n    <Collapsible slug=\"descr-sec\" label=\"Description\" >\n      { location && <Description item={location} /> }\n    </Collapsible>\n    { location && location.markers.length && <Collapsible slug=\"markers-sec\" label=\"Markers\">\n      <Markers markers={location.markers} />\n    </Collapsible> || null }\n    { location && location.newsitems.length && <Collapsible slug=\"news-sec\" label=\"Newsitems\">\n      <Newsitems newsitems={location.newsitems} />\n    </Collapsible> || null }\n\n  </Row>)\n}\n\nexport default LocationsShow;","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\n\nconst MarkersList = (props) => {\n  logg(props, 'Markers')\n\n  const history = useHistory()\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  const goto = (m) => {\n    if (m.url) {\n      setShowUrl(m.url)\n    }\n    else {\n      history.push(`/en/locations/show/${m.slug}`)\n    }\n  }\n\n  const out = []\n  props.markers.map((m, idx) => {\n    out.push(<div\n        key={idx}\n        style={{ margin: '10px' }}\n        onClick={() => goto(m)} >\n      <img src={m.title_img_path} /><br />\n      {m.name}\n    </div>)\n  })\n  return <div style={{ display: 'flex' }} >{out}</div>\n}\n\nexport default MarkersList\n","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { useApi, Debug, logg, request } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport \"./sites.scss\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  padding: 0;\n  margin: 0;\n  height: 100vh;\n`\n\nconst SitesShow = (props) => {\n  // logg(props, 'SitesShow')\n\n  let [newsitems, setNewsitems] = useState([])\n  let [showLoading, setShowLoading] = useState(false)\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    // setShowLoading(true)\n    api.applicationHome().then(data => {\n      if (!mountedRef.current) return null;\n      setNewsitems(data.newsitems)\n      setShowLoading(false)\n    })\n\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n      <Hero />\n      <Newsitems newsitems={newsitems} />\n      &nbsp;\n    </Root>\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow\n","import { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react';\nimport { Container, Grid, GridList } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport config from \"config\";\n\nimport { useApi, logg, request } from \"$shared\";\n\nconst useStyles = makeStyles((theme) => ({\n\n  paper: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n    color: theme.palette.text.secondary,\n  },\n  redBorder: {\n    border: '1px solid red',\n  },\n  root: {\n    flexGrow: 1,\n    overflow: 'scroll',\n    height: '100vh',\n  },\n\n}));\n\nconst VideoItem = styled.div`\n  border-bottom: 1px solid red;\n`;\n\nconst Video = (props) => {\n  logg(props, 'Video');\n  const api = useApi()\n\n  const { item: video } = props;\n\n  return <VideoItem key={props.idx} >\n    <h5>Video {video.name}</h5>\n    <p>created {video.created_at}</p>\n    <video controls preload=\"metadata\" type=\"video/mp4\" src={video.video_url}\n      style={{ maxWidth: '500px', maxHeight: '90vh' }} ></video>\n  </VideoItem>;\n};\n\nconst Videos = () => {\n  logg(config, 'Videos component');\n  console.log(JSON.stringify(config));\n\n  const [videos, setVideos] = useState([]);\n\n  const jwtToken = localStorage.getItem(\"jwtToken\");\n\n  const classes = useStyles();\n  const api = useApi()\n\n  useEffect(() => {\n    logg('posting...');\n    request.post(api.myVideosPath, { jwtToken: jwtToken }).then(r => r.data\n      ).then(({ videos }) => {\n        logg(videos, 'data')\n        setVideos(videos);\n      })\n  }, []);\n\n  return <Container maxWidth=\"md\">\n    <Grid container className={classes.root} >\n      <Grid item xs={12} >\n        <h2>My Videos</h2>\n      </Grid>\n      <Grid item xs={12}>\n        { videos && videos.map((v, idx) => <Video key={idx} item={v} ></Video> ) }\n      </Grid>\n    </Grid>\n  </Container>;\n\n};\n\nexport default Videos;\n","import { Container as _Container, Grid, GridList } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useRef, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n\nimport './theme/variables.css'\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport config from \"config\"\nimport { C, CollapsibleContext, Debug, logg, request, TwofoldContext, useApi, } from \"$shared\"\nimport { BottomDrawer, Menu, MenuBottom, MenuLeft, UnlockModal } from \"$components/application\"\nimport MapuiLayout from \"$components/application/MapuiLayout\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\n// @TODO: MyGalleries doesn't look right...\nimport { GalleriesShow, MyGalleries } from \"$components/galleries\"\nimport { LocationsShow as LocationsShow } from \"$components/locations\"\nimport { ReportsShow } from \"$components/reports\"\nimport { SitesShow } from '$components/sites'\nimport { Account, LoginModal } from \"$components/users\"\nimport { Videos } from \"$components/videos\"\n\nconst Root = styled.div`\n  background: #dedede;\n  height: 100vh;\n  overflow: auto;\n`;\n\nconst __Container = styled(_Container)`\n  height: 100vh;\n  overflow: scroll;\n`;\n\nconst App = () => {\n  logg(null, 'App renders')\n\n  const [ bottomDrawerOpen, setBottomDrawerOpen ] = useState(false)\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n  const [ currentUser, setCurrentUser ] = useState(false) // localStorage.getItem('current_user') ? JSON.parse(localStorage.getItem('current_user')) : null)\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n  const [ zoom, setZoom ] = useState(1)\n  const api = useApi()\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    logg('this shoudl not run')\n\n    const fn = async () => {\n      // check jwt\n      const jwtToken = localStorage.getItem('jwt_token')\n      await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`).then((r) => {\n        if (!mountedRef.current) { return }\n        setCurrentUser(r.data)\n      }).catch((e) => {\n        logg(e, 'e12')\n        if (e.message === \"Request failed with status code 401\") {\n          setLoginModalOpen(true)\n        }\n      })\n    }\n    fn()\n    return () => mountedRef.current = null\n  }, [currentUser]) // @TODO: currentUser here is appropriate?\n\n  const Container = (props) => {\n    switch(layout) {\n      case C.layout_onecol:\n        // main case\n        return <__Container maxWidth=\"md\" {...props}/>\n      case C.layout_mapui:\n        return <MapuiLayout {...props} {...{ bottomDrawerOpen, setBottomDrawerOpen }} />\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  return (<Router>\n    <ToastContainer />\n    <TwofoldContext.Provider value={{\n        bottomDrawerOpen, setBottomDrawerOpen,\n        currentUser, setCurrentUser,\n        itemToUnlock, setItemToUnlock,\n        layout, setLayout,\n        loginModalOpen, setLoginModalOpen,\n        showItem, setShowItem,\n        showUrl, setShowUrl,\n        zoom, setZoom,\n    }} >\n\n      <MenuLeft />\n      <Root>\n        <Container >\n          <Switch id=\"main\" main >\n\n            <Redirect exact from=\"/\" to=\"/en\" />\n            <Route exact path=\"/en\" ><SitesShow /></Route>\n\n            <Route exact path=\"/en/account\" component={Account} />\n            <Route exact path=\"/en/account/my/videos\" component={Videos} />\n            <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n            <Route exact path=\"/en/cities\"                 component={CitiesList} />\n            <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n            <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n            <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n            <Route exact path=\"/en/locations/show/:slug\" component={LocationsShow} layout={C.layout_mapui} />\n\n          </Switch>\n        </Container>\n      </Root>\n      <BottomDrawer />\n      <UnlockModal />\n      <LoginModal />\n\n    </TwofoldContext.Provider>\n  </Router>)\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n\n\n\n","\n\nmodule.exports = {\n  \"apiOrigin\": \"https://manager.piousbox.com\",\n  \"domain\": \"tgm.piousbox.com\", // required! 20210831\n  \"appIndexPath\": \"src/index\",\n};\n"],"sourceRoot":""}