{"version":3,"sources":["components/galleries/Galleries.module.scss","components/application/DayNightToggle.module.scss","components/newsitems/Newsitems.module.scss","components/application/Application.module.scss","../config/environments/production_ish/config.js","components/cities/Cities.module.scss","resources/markers/Markers.module.scss","components/locations/ItemModal.module.scss","../config/environments/default.js","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../../ishlibjs/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../../ishlibjs/node_modules/@ionic/core/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","components/application/UnlockModal.module.scss","components/venues/Venues.module.scss","shared/C.jsx","shared/TwofoldContext.jsx","../../src/shared/C.jsx","../../src/shared/request.jsx","../../src/shared/index.jsx","../../src/components/users/AuthWidget.jsx","../../src/components/users/LoginModal.jsx","../../src/components/users/RegisterModal.jsx","../../src/components/users/index.jsx","../../src/TestApp.jsx","../../src/components/users/JwtContext.jsx","../../src/components/users/PasswordLogin.jsx","../../src/components/users/Scratchpad.jsx","../../src/components/SideMenu/index.jsx","../../src/index.jsx","shared/Api.jsx","components/TwofoldLayout/index.jsx","components/application/BottomDrawer.jsx","components/application/Breadcrumbs.jsx","components/application/DayNightToggle.jsx","components/application/MainHeader.jsx","components/application/MapuiLayout.jsx","components/application/MapuiMobileLayout.jsx","components/application/Menu.jsx","components/application/MenuLeft.jsx","components/application/Metaline.jsx","components/application/PurchaseModal.jsx","components/application/Rating.jsx","components/application/UnlockModal.jsx","components/users/Account.jsx","components/users/MyAccountWidget.jsx","components/users/index.jsx","shared/AppMock.jsx","shared/AppRouter.jsx","shared/Collapsible.jsx","shared/request.jsx","shared/S.jsx","shared/useWindowSize.jsx","shared/index.jsx","components/cities/CitiesList.jsx","components/newsitems/NewsitemGallery.jsx","components/newsitems/NewsitemPhoto.jsx","components/newsitems/NewsitemReport.jsx","components/newsitems/NewsitemVideo.jsx","components/newsitems/Newsitems.jsx","components/Votable/Votable.jsx","components/Votable/index.jsx","components/newsitems/NewsitemContainer.jsx","components/newsitems/ItemIcon.jsx","components/newsitems/index.js","components/venues/Venues.jsx","components/cities/CitiesShow.jsx","components/galleries/GalleriesShow.jsx","components/galleries/MyGalleries.jsx","resources/markers/MarkerModal.jsx","resources/markers/MarkersList.jsx","resources/markers/MarkerForm.jsx","resources/markers/index.jsx","components/locations/GoogleMaps.jsx","resources/reports/ReportsForm.jsx","resources/reports/ReportsShow.jsx","components/locations/ItemModal.jsx","components/locations/LocationsShowDesktop.jsx","components/locations/LocationsShowMobile.jsx","components/locations/MapPanel.jsx","components/locations/MapPanelNoZoom.jsx","components/locations/RatedRestrictionModal.jsx","components/locations/GoogleMaps2.jsx","components/3d_locations/Blocker.jsx","components/3d_locations/Crosshair.jsx","components/3d_locations/PointerLockControls.js","components/3d_locations/TouchControls.jsx","components/3d_locations/RotationPad.jsx","components/3d_locations/Equirectangular2.jsx","components/3d_locations/Equirectangular4.jsx","components/3d_locations/TabiversePlanet.jsx","components/3d_locations/ThreePanelDefault.jsx","components/3d_locations/ThreePanelV1.jsx","components/3d_locations/ThreePanelV2.jsx","components/3d_locations/ThreePanelV3.jsx","components/3d_locations/ThreePanelV4.jsx","components/locations/WrappedMapPanel.jsx","components/locations/ZoomCtrl.jsx","components/sites/Features.jsx","components/sites/SitesShow.jsx","components/sites/SitesShow1.jsx","components/videos/Videos.jsx","AppDesktop.jsx","AppMobile.jsx","AppWrapper.jsx","serviceWorker.js","index.jsx"],"names":["module","exports","defaultSettings","require","APP_ENV","appIndexPath","router","locationPath","a","loginPath","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","webpackEmptyAsyncContext","C","actions","new","show","anonUser","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","report","photo","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","Equirectangular","GoogleMaps","MapPanel","MapPanelNoZoom","TabiversePlanet","ThreePanelV1","ThreePanelV4","names","editorMode","rated","nc17","ratedConfirmation","theme","themes","dark","light","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","vote_values","up","down","TwofoldContext","React","createContext","TwofoldContextProvider","children","props","_currentUser","currentUser","_setCurrentUser","setCurrentUser","itemToUnlock","setItemToUnlock","layout","setLayout","_showItem","showItem","_setShowItem","setShowItem","toggleTheme","zoom","setZoom","api","useApi","useState","JSON","parse","localStorage","getItem","_setBottomDrawerOpen","mountedRef","useRef","useEffect","current","getMyAccount","r","fn","closure","setTimeout","clearTimeout","is_purchasing","_setEditorMode","folded","setFolded","_itemToUnlock","_setItemToUnlock","location","setLocation","loginModalOpen","setLoginModalOpen","mapPanelWidth","setMapPanelWidth","mapPanelHeight","setMapPanelHeight","purchaseModalOpen","setPurchaseModalOpen","_setRatedConfirmation","registerModalOpen","setRegisterModalOpen","tmp","showUrl","setShowUrl","err","logg","setTwofoldPercent","localZoom","setLocalZoom","Provider","value","setBottomDrawerOpen","m","setItem","stringify","setEditorMode","t","setRatedConfirmation","which","scratchpad","axios","Actions","styled","Btn","CloseBtn","p","style","cursor","onClick","PropTypes","isRequired","_FlexCol","FlexCol","className","FlexRow","b","c","window","console","RegisterWithEmailBtn","LoginWithEmailBtn","IconLogout","w","h","xmlns","width","height","viewBox","enableBackground","d","AuthWidget","useContext","Header","LoginModal","email","setEmail","password","setPassword","doPasswordLogin","toast","Modal","styles","isOpen","overlayClassName","portalClassName","LoginModalPortal","Notice","htmlFor","name","type","onChange","onKeyDown","flexDirection","justifyContent","marginTop","margin","borderWidth","RegisterModal","setPassword2","out","doRegister","password2","AuthContext","AuthContextProvider","_registerModalOpen","_setRegisterModalOpen","defaultUser","localCurrentUser","user","_loginModalOpen","_setLoginModalOpen","moreProps","config","TestApp","request","position","JwtContext","JwtContextProvider","maybeUser","object","string","process","ReactDOM","document","token","deleteNewsitem","apiOrigin","data","post","doUnlock","kind","path","getCities","get","getCity","slug","getGallery","getPayments","getReport","getTag","tag","longTermTokenPath","postLogin","resp","myVideosPath","applicationHome","domain","params","vote","voter_id","votee_id","votee_class_name","unvote","LongLine","div","thinBorder","thinBorderRadius","orientation","colors","background","propTypes","Drawer","_Drawer","getLibrary","provider","Web3","Inner0","text","Inner1","bottomDrawerOpenHeight","borderHeight","Inner2","cardBackground","WClosed","BottomDrawer","IconButton","aria-label","fontSize","anchor","elevation","open","onClose","BackdropProps","invisible","variant","paddingRight","B0","B1","W0","debug","breadcrumbsHeight","WBreadcrumbs","Breadcrumbs","breadcrumbs","history","useHistory","idx","length","push","key","textDecoration","MenuLeft","arrayOf","shape","DayNightToggle","container","readOnly","checked","sunMoon","dots","stars1","stars2","Root","MainHeader","MapuiContainer","bottomDrawerHeight","MapuiLayout","bottomDrawerClosedHeight","MapuiMobileLayout","S","newspaperOutline","bus","person","powerOutline","SideMenu","drawerOpen","setDrawerOpen","top","left","button","homePath","bookmarks","W","withRouter","created_at","username","city","tags","pp_date","loadStripe","Rating","rate","rating","setRating","iconMapping","0","starOutline","1","starHalf","2","star","Array","fill","i","icon","Btn0","BtnRow","modalStyle","overlay","content","maxWidth","UnlockModal","item_type","closable","cost","premium_tier","ariaHideApp","n_unlocks","isPushNotificationsAvailable","Capacitor","isPluginAvailable","greeterAddress","tokenAddress","PasswordLogin","LoginRow","Account","greeting","setGreetingValue","notifications","setNotifications","setScratchpad","register","PushNotifications","addListener","showToast","error","alert","_n","n","logg2","ns","nofitication","msg","Toast","requestAccount","ethereum","method","fetchGreeting","ethers","providers","Web3Provider","contract","Contract","Greeter","abi","greet","log","account","Token","balanceOf","balance","toString","signer","getSigner","setGreeting","transaction","wait","transfer","userAccount","amount","transation","checkPermissions","res","receive","requestPermissions","Grid","spacing","item","xs","src","alt","target","placeholder","setUserAccount","setAmount","to","notif","title","body","color","expand","span","_Img","Img","InjectedConnector","MyAccountWidget","avatar","useWeb3React","active","library","connector","activate","deactivate","profile_photo_url","FacebookLogin","Plugins","FACEBOOK_PERMISSIONS","FbLogin","doFbLogin","login","permissions","result","accessToken","BuyBtn","Logout","removeItem","AppRouter","cityVenuesPath","cityPath","Gt","Inner","Label","WTransparent","Collapsible","ctx","CollapsibleContext","setCollapsibles","label","bool","settings","baseURL","create","smallWidth","mediumWidth","thinBorderWidth","lightTheme","border","blue","cyan","darkGrey","gold","lightGrey","red","darkTheme","useWindowSize","size","setSize","useLayoutEffect","updateSize","innerWidth","innerHeight","addEventListener","removeEventListener","BackIcon","IonIcon","BackBtn","arrowBack","goBack","ChevronLeft","_ChevronLeft","ChevronRight","_ChevronRight","_Card","_Box","Card","_props","navigateToItem","CollapsibleContextProvider","defaultCollapsibles","descr","_setCollapsibles","inflector","slice","ms","split","charAt","toUpperCase","join","toLowerCase","_Circle","Loading","replace","MenuIcon","_MenuIcon","PurchasedIcon","substring","_WBordered","WBordered","_WBorderedItem","WBorderedItem","WidgetContainer","Wrapper","Counts","Count","_IonIcon","Number","Cities","cities","setCities","filteredCities","setFilteredCities","showLoading","setShowLoading","ev","filter","indexOf","trim","funnel","bookmark","n_reports","n_galleries","image","n_videos","videocam","onDidDismiss","message","duration","Images","Thumb0","Thumb1","_Thumb2","Thumb2","NewsitemGallery","photos","thumb_url","n_photos","array","ImageLarge","img","NewsitemPhoto","large_url","NewsitemReport","NewsitemVideo","display","youtube_id","frameBorder","allow","allowFullScreen","maxHeight","preload","controls","url","W1","_EditModeActions","EditModeActions","confirm","newsitem_id","Newsitems","newsitems","newsitem","IconUp","version","x","y","IconDown","WCount","Votable","votes_score","votesScore","setVotesScore","upFill","setUpFill","downFill","setDownFill","current_user_vote_value","currentUserVoteValue","setCurrentUserVoteValue","Col","_Row","Row","RowInline","Title","h2","boxShadow","NewsitemContainer","is_premium","is_purchased","alignItems","overflowWrap","subhead","dangerouslySetInnerHTML","__html","_Icon","IconGallery","useTheme","IconGem","IconGlasses","IconReport","IconVideo","fillRule","clipRule","_W0","ItemIcon","number","GenericNewsitem","Address","_Ra","RightArrow","Venue","Venues","venues","filteredVenues","setFilteredVenues","venue","includes","address","CitiesShow","match","thisPath","useLocation","setCity","backgroundImage","hero_img","backgroundSize","pin","pathname","exact","render","GalleriesShow","setGallery","narrow","heading","thumbs","ph","card","full_img_section","MyGalleries","galleries","setGalleries","g","MarkerModal","MarkerContext","markerModalOpen","setMarkerModalOpen","_Marker","Marker","_W","MarkersList","goto","title_img_path","MarkerForm","MarkerContextProvider","marker","setMarker","ReportForm","ReportsShow","ItemModal","useParams","action","setAppElement","reportname","ReportsForm","_D","Description","WH","Handle","offsetX","setOffsetX","dragging","setDragging","onMouseUp","onMouseMove","clientX","movedBy","movedByPercent","prev","onMouseDown","pageX","onMouseLeave","pointer","IframeModal","scrolling","allowtransparency","Left","Right","LocationsShowDesktop","windowWidth","windowHeight","loading","setLoading","setMarkers","mapPanelRef","offsetWidth","offsetHeight","itemType","item_slug","ref","marginBottom","flexWrap","labels","_Description","LocationsShowMobile","map_panel_type","withZoom","Div1","ZoomCtrl","right","zIndex","padding","div1Ref","scroll","behavior","centerOffsetY","centerOffsetX","img_path","nextZoomByWidth","nextZoomByHeight","nextZoom","Math","min","RatedRestrictionModal","Map","onIdle","options","setMap","google","maps","useDeepCompareEffectForMaps","setOptions","forEach","eventName","event","clearListeners","child","useDeepCompareMemoize","callback","dependencies","App","clicks","setClicks","lat","lng","center","setCenter","form","flexBasis","overflow","latLng","toJSON","apiKey","getZoom","getCenter","flexGrow","_Blocker","Crosshair","_euler","Euler","_vector","Vector3","_changeEvent","_lockEvent","_unlockEvent","_PI_2","PI","PointerLockControls","camera","domElement","undefined","warn","isLocked","minPolarAngle","maxPolarAngle","scope","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","max","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","connect","disconnect","dispose","this","getObject","getDirection","direction","v","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","addScaledVector","moveRight","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","TouchControls","THREE","RotationPad","self","$","extend","speedFactor","delta","rotationFactor","maxPitch","hitTest","hitTestDistance","isRightMouseDown","rotationMatrices","hitObjects","moveBackward","moveLeft","lockMoveForward","lockMoveBackward","lockMoveLeft","lockMoveRight","ztouch","xtouch","velocity","cameraHolder","Object3D","calculateCameraRotation","dx","dy","factor","ry","fpsBody","rotation","rx","add","scene","enabled","mouse","Vector2","rotationPad","on","detail","deltaX","deltaY","setRotation","movementPad","MovementPad","abs","middle","preventDefault","stopPropagation","keyCode","clientY","originalEvent","rotationMatrixF","Matrix4","makeRotationY","rotationMatrixB","rotationMatrixL","rotationMatrixR","prepareRotationMatrices","update","z","translateX","translateY","translateZ","unlockAllDirections","index","cameraDirection","getDirection2","clone","applyMatrix4","intersects","Raycaster","intersectObject","getObjectByName","set","applyEuler","boolean","prototype","addToScene","setPosition","stopMouseMoving","camHolder","getHitObjects","eventRepeatTimeout","newLeft","newTop","angle","mouseDown","handleRef","handleEl","regionRef","regionEl","regionData","handleData","resetHandlePosition","animate","centerY","radius","centerX","opacity","pageY","offset","pow","atan2","cos","sin","round","css","parseInt","sendEvent","moveEvent","Event","bubbles","trigger","targetTouches","touches","Blocker","Equirectangular2","renderer","texture","markerObjects","blockerRef","wContainerRef","instructionsRef","fog","canJump","axes","wContainer","floorGeometry","rotateX","loadTexture","wrapS","wrapT","repeat","floorMaterial","floor","textureLoader","assetPath","load","rt","fromEquirectangularTexture","antialias","setPixelRatio","devicePixelRatio","clientWidth","clientHeight","appendChild","onWindowResize","init","prevTime","performance","now","canvas","needResize","resizeRendererToDisplaySize","aspect","updateProjectionMatrix","requestAnimationFrame","time","intersections","intersectObjects","onObject","normalize","geometry","material","planet","loader","asset3d_path","gltf","worldOctree","fromGraphNode","traverse","isMesh","castShadow","receiveShadow","anisotropy","GLTFLoader","Octree","Loc","raycaster","objects","attributes","l","count","vertex","fromBufferAttribute","random","setXYZ","toNonIndexed","colorsFloor","setHSL","setAttribute","vertexColors","manager","scale","onProgress","loaded","total","OBJLoader","obj","xhr","lengthComputable","percentComplete","cube","ray","origin","markerObjectsIdxs","pMat","uniforms","main_color","border_color","thickness","vertexShader","fragmentShader","texturePath","modelPath","modelPath2","onError","mtlLoader","MTLLoader","setPath","materials","objLoader","setMaterials","uuid","Location","clock","directionalLight","fillLight1","plc","sphereGeometry","sphereMaterial","spheres","sphereIdx","playerCollider","Capsule","playerVelocity","playerDirection","playerOnFloor","mouseTime","keyStates","vector1","vector2","vector3","order","shadow","near","far","bottom","mapSize","bias","sphere","mesh","collider","shadowMap","outputEncoding","toneMapping","getWorldDirection","end","impulse","exp","multiplyScalar","throwBall","updateSpheres","deltaTime","sphereIntersect","normal","dot","depth","damping","addVectors","start","sphere_center","r2","point","d2","distanceToSquared","subVectors","v1","v2","sub","sqrt","playerSphereCollision","s1","j","s2","spheresCollisions","getForwardVector","getSideVector","cross","updatePlayer","deltaPosition","translate","capsuleIntersect","playerCollisions","speedDelta","getDelta","modelName","wrappedOnLoad","WrappedMapPanel","forwardRef","Equirectangular4","ThreePanelV2","ThreePanelV3","ThreePanelDefault","Features","features","f","inner_html","sm","SitesShow","site","setSite","SitesShow1","artTag","homeRow1Tag","interestingLocationsTag","useStyles","makeStyles","paper","textAlign","palette","secondary","redBorder","root","VideoItem","Video","video_url","Videos","videos","setVideos","jwtToken","classes","AppDesktop","Container","Route","main","from","component","CitiesList","__Container","_Container","AppMobile","paddingBottom","AppWrapper","os","setOs","Device","getInfo","info","operatingSystem","setTheme","childProps","Boolean","hostname","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"uGACAA,EAAOC,QAAU,CAAC,cAAgB,iCAAiC,QAAU,2BAA2B,MAAQ,yBAAyB,OAAS,0BAA0B,OAAS,0BAA0B,KAAO,wBAAwB,iBAAmB,oCAAoC,KAAO,0B,oBCA5SD,EAAOC,QAAU,CAAC,UAAY,kCAAkC,OAAS,+BAA+B,KAAO,6BAA6B,WAAa,mCAAmC,OAAS,+BAA+B,OAAS,+BAA+B,QAAU,gCAAgC,KAAO,+B,oBCA7TD,EAAOC,QAAU,CAAC,KAAO,wBAAwB,UAAY,6BAA6B,SAAW,4BAA4B,UAAY,6BAA6B,MAAQ,yBAAyB,MAAQ,yBAAyB,gBAAgB,iCAAiC,SAAW,4BAA4B,YAAc,+BAA+B,gBAAgB,iCAAiC,YAAY,6BAA6B,YAAY,6BAA6B,YAAY,6BAA6B,YAAY,6BAA6B,aAAa,8BAA8B,OAAS,4B,oBCA1nBD,EAAOC,QAAU,CAAC,aAAa,gCAAgC,SAAW,8BAA8B,KAAO,0BAA0B,KAAO,0BAA0B,KAAO,0BAA0B,OAAS,4BAA4B,MAAQ,6B,iunBCalPC,EAAkBC,EAAQ,KAChCH,EAAOC,QAAP,OAAsBC,GAdL,CACf,UAAa,+BAEb,OAAU,mBAEV,OAAS,EAETE,QAAS,kBACT,SAAY,0BAEZ,cAAgB,K,oBCVlBJ,EAAOC,QAAU,CAAC,OAAS,uBAAuB,QAAU,wBAAwB,YAAY,0BAA0B,iBAAiB,+BAA+B,eAAe,6BAA6B,cAAc,4BAA4B,mBAAmB,iCAAiC,gBAAgB,8BAA8B,UAAY,0BAA0B,cAAc,4BAA4B,WAAW,yBAAyB,aAAa,2BAA2B,SAAW,yBAAyB,gBAAgB,8BAA8B,OAAS,uBAAuB,OAAS,uBAAuB,MAAQ,sBAAsB,cAAc,4BAA4B,SAAW,yBAAyB,OAAS,uBAAuB,cAAc,4BAA4B,QAAU,wBAAwB,IAAM,oBAAoB,iBAAiB,+BAA+B,IAAM,oBAAoB,YAAY,0BAA0B,YAAY,0BAA0B,aAAa,2BAA2B,OAAS,uBAAuB,YAAY,0BAA0B,gBAAgB,8BAA8B,cAAc,4BAA4B,SAAW,yBAAyB,cAAc,4BAA4B,eAAe,+B,6+zDCA3zCD,EAAOC,QAAU,CAAC,YAAc,6BAA6B,mBAAqB,sC,oBCAlFD,EAAOC,QAAU,CAAC,UAAY,6BAA6B,aAAa,gC,wDCAxED,EAAOC,QAAU,CACfI,aAAc,YAEdC,OAAQ,CACNC,aAAc,SAACC,GAAD,mCAA6BA,IAC3CC,UAAW,sB,oBCNf,IAAIC,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAI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","file":"static/js/main.22bdf83b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"GalleriesShow\":\"Galleries_GalleriesShow__eB0J9\",\"heading\":\"Galleries_heading__i_svo\",\"title\":\"Galleries_title__3tmwS\",\"narrow\":\"Galleries_narrow__1LN1G\",\"thumbs\":\"Galleries_thumbs__bq4Ur\",\"card\":\"Galleries_card__vP3-g\",\"full_img_section\":\"Galleries_full_img_section__1V5cq\",\"item\":\"Galleries_item__3uUTi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"DayNightToggle_container__3SXTK\",\"switch\":\"DayNightToggle_switch__2IqQw\",\"fill\":\"DayNightToggle_fill__Bgb5K\",\"background\":\"DayNightToggle_background__3k8xs\",\"stars1\":\"DayNightToggle_stars1__tkZmJ\",\"stars2\":\"DayNightToggle_stars2__3Bruk\",\"sunMoon\":\"DayNightToggle_sunMoon__12mN8\",\"dots\":\"DayNightToggle_dots__2ECIQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"Newsitems_icon__2m8Yx\",\"Newsitems\":\"Newsitems_Newsitems__28DCM\",\"Newsitem\":\"Newsitems_Newsitem__1YV1X\",\"newsitems\":\"Newsitems_newsitems__2__cT\",\"items\":\"Newsitems_items__1vDXi\",\"image\":\"Newsitems_image__XooGU\",\"title-heading\":\"Newsitems_title-heading__3SnV-\",\"routable\":\"Newsitems_routable__3F6RC\",\"description\":\"Newsitems_description__Quuc5\",\"image-section\":\"Newsitems_image-section__3_ISy\",\"play-icon\":\"Newsitems_play-icon__2n6oc\",\"premium-0\":\"Newsitems_premium-0__2W-9I\",\"premium-1\":\"Newsitems_premium-1__1sKSC\",\"premium-2\":\"Newsitems_premium-2__1e7dc\",\"image-item\":\"Newsitems_image-item__JlSoP\",\"number\":\"Newsitems_number__WsUI_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item-inner\":\"Application_item-inner__3N6Hp\",\"metaline\":\"Application_metaline__3gOIl\",\"user\":\"Application_user__1xsl8\",\"city\":\"Application_city__1DWKA\",\"tags\":\"Application_tags__1G31y\",\"rating\":\"Application_rating__1H0OR\",\"stars\":\"Application_stars__3Lbga\"};","\nconst settings = {\n  \"apiOrigin\": \"https://manager.piousbox.com\",\n\n  \"domain\": \"tgm.piousbox.com\", // required! 20210831\n\n  \"debug\": false,\n\n  APP_ENV: 'development_web',\n  \"homePath\": \"/en/locations/show/root\",\n\n  \"requireLogin\": false,\n};\n\nconst defaultSettings = require('../default.js')\nmodule.exports = { ...defaultSettings, ...settings }\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cities\":\"Cities_cities__2jyZa\",\"heading\":\"Cities_heading__1Y4L0\",\"city-show\":\"Cities_city-show__3p8O5\",\"filter-section\":\"Cities_filter-section__QkWYj\",\"filter-input\":\"Cities_filter-input__2qrNk\",\"filter-icon\":\"Cities_filter-icon__2RFrY\",\"bookmark-section\":\"Cities_bookmark-section__WbPmK\",\"bookmark-text\":\"Cities_bookmark-text__3pldy\",\"container\":\"Cities_container__pdWN1\",\"img-section\":\"Cities_img-section__2XiwK\",\"city-img\":\"Cities_city-img__JuCos\",\"city-title\":\"Cities_city-title__39j3v\",\"bookmark\":\"Cities_bookmark__5911O\",\"bookmark-icon\":\"Cities_bookmark-icon__25eUJ\",\"switch\":\"Cities_switch__2FFHz\",\"slider\":\"Cities_slider__2HQAT\",\"round\":\"Cities_round__NaUgd\",\"section-one\":\"Cities_section-one__2Ual1\",\"location\":\"Cities_location__2PNVH\",\"status\":\"Cities_status__1Joy3\",\"status-grid\":\"Cities_status-grid__E_QYt\",\"numbers\":\"Cities_numbers__3AaL3\",\"mid\":\"Cities_mid__-Ei45\",\"tags-container\":\"Cities_tags-container__1O8GT\",\"btn\":\"Cities_btn__3AZfF\",\"city-name\":\"Cities_city-name__2cKBL\",\"menu-item\":\"Cities_menu-item__LuXCf\",\"delete-btn\":\"Cities_delete-btn__3a5p9\",\"random\":\"Cities_random__8loYT\",\"info-icon\":\"Cities_info-icon__3crMF\",\"section-three\":\"Cities_section-three__3wkyz\",\"menu-option\":\"Cities_menu-option__3NgIq\",\"selected\":\"Cities_selected__3LwuR\",\"section-two\":\"Cities_section-two__SNgaW\",\"tags-section\":\"Cities_tags-section__k90Gs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MarkerModal\":\"Markers_MarkerModal__3oYjU\",\"MarkerModalOverlay\":\"Markers_MarkerModalOverlay__2qeYq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ItemModal\":\"ItemModal_ItemModal__n2Ttj\",\"plt-mobile\":\"ItemModal_plt-mobile__2YguR\"};","\nmodule.exports = {\n  appIndexPath: \"src/index\",\n\n  router: {\n    locationPath: (a) => `/en/locations/show/${a}`,\n    loginPath: '/api/users/login',\n  },\n};\n\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t927,\n\t\t6\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t928,\n\t\t7\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t929,\n\t\t8\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t930,\n\t\t18\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t931,\n\t\t19\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t932,\n\t\t47\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t933,\n\t\t20\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t934,\n\t\t21\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t935,\n\t\t22\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t936,\n\t\t23\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t937,\n\t\t48\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t938,\n\t\t11\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t939,\n\t\t24\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t940,\n\t\t49\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t941,\n\t\t50\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t942,\n\t\t25\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t943,\n\t\t26\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t944,\n\t\t27\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t945,\n\t\t28\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t946,\n\t\t29\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t947,\n\t\t9\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t948,\n\t\t15\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t949,\n\t\t10\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t950,\n\t\t30\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t951,\n\t\t31\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t952,\n\t\t32\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t953,\n\t\t12\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t954,\n\t\t17\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t955,\n\t\t51\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t956,\n\t\t33\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t957,\n\t\t34\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t958,\n\t\t35\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t959,\n\t\t36\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t960,\n\t\t52\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t961,\n\t\t14\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t962,\n\t\t53\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t963,\n\t\t37\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t964,\n\t\t16\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t965,\n\t\t38\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t966,\n\t\t39\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t967,\n\t\t40\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t968,\n\t\t13\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t969,\n\t\t54\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 489;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t970,\n\t\t61\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 491;\nmodule.exports = webpackAsyncContext;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 522;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 523;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ReactModal__Overlay\":\"UnlockModal_ReactModal__Overlay__1d8v7\",\"ReactModal__Overlay--after-open\":\"UnlockModal_ReactModal__Overlay--after-open__SJ6oC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"venues-section\":\"Venues_venues-section__1Cg8m\",\"filter-section\":\"Venues_filter-section__3uQ4r\",\"filter-input\":\"Venues_filter-input__2ykRc\",\"filter-icon\":\"Venues_filter-icon__3VaeF\",\"container\":\"Venues_container__2SioC\",\"venues\":\"Venues_venues__3j85M\",\"info-section\":\"Venues_info-section__1E-6x\",\"reviews\":\"Venues_reviews__1Bh8Y\",\"description\":\"Venues_description__2oWIo\",\"tags\":\"Venues_tags__eZTOS\",\"forward-arrow\":\"Venues_forward-arrow__38w3n\",\"image-section\":\"Venues_image-section__gaKYX\"};","\n/**\n * Constants\n */\nconst C = {\n\n  // A\n  actions: { // CRUD\n    new: 'new',\n    show: 'show',\n  },\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    photo: 'Photo',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    GoogleMaps: \"GoogleMaps\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    TabiversePlanet: \"TabiversePlanet\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: { // for localStorage\n    editorMode: 'editorMode',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n  vote_values: {\n    up: 'up',\n    down: 'down',\n  },\n}\nexport default C\n","\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useEffect, useRef, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  C,\n  logg,\n  request,\n  useApi,\n} from \"$shared\"\n\n/**\n * ishjs has a newer version of this. _vp_ 2022-03-05\n*/\nconst TwofoldContext = React.createContext({})\nconst TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  let {\n    currentUser: _currentUser, setCurrentUser: _setCurrentUser, // for testing only. _vp_ 2022-03-18\n    itemToUnlock, setItemToUnlock,\n    layout, setLayout,\n    showItem: _showItem, setShowItem: _setShowItem,\n    theme, toggleTheme,\n    zoom, setZoom, // it's a prop for testing only. _vp_ 2022-03-18\n  } = props\n\n  const api = useApi()\n\n  /* B */\n\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n\n  /* C */\n  let [ currentUser, setCurrentUser ] = useState(C.anonUser)\n  if (_setCurrentUser) {\n    [ currentUser, setCurrentUser ] = [ _currentUser, _setCurrentUser ]\n  }\n\n  /* Get the current_user on load */\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    if (!mountedRef.current) { return } // @TODO: hmmm do I need this?\n\n    const fn = async () => {\n      const r = await api.getMyAccount()\n      setCurrentUser(r)\n    }\n    fn()\n\n    return () => mountedRef.current = null\n  }, [currentUser])\n\n  // Refresh current_user if is_purchasing\n  useEffect(() => {\n    let closure = setTimeout(() => {\n\n      const fn = async () => {\n        const r = await api.getMyAccount()\n        setCurrentUser(r)\n      }\n      fn()\n\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* E */\n  const [ editorMode, _setEditorMode ] = useState(JSON.parse(localStorage.getItem(C.names.editorMode)))\n  const setEditorMode = (t) => {\n    localStorage.setItem(C.names.editorMode, t)\n    _setEditorMode(t)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ _itemToUnlock, _setItemToUnlock ] = useState({})\n  if (!itemToUnlock) {\n    itemToUnlock = _itemToUnlock\n    setItemToUnlock = _setItemToUnlock\n  }\n  /* why is this here? remove. _vp_ 2022-03-18 */\n  // const setItemToUnlock = (item) => {\n  //   if (itemToUnlock.id !== item.id && !loginModalOpen) {\n  //     _setItemToUnlock(item)\n  //   }\n  // }\n\n  /* L */\n  const [ location, setLocation ] = useState(null)\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalOpen, setPurchaseModalOpen ] = useState(false)\n\n  /* R */\n\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n\n  /* S */\n  let [ showItem, setShowItem ] = useState(false)\n  if (!!_setShowItem) { setShowItem = _setShowItem }\n  if (!!_showItem) { showItem = _showItem }\n\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ localZoom, setLocalZoom ] = useState(1)\n  if (!zoom) {\n    zoom = localZoom\n    setZoom = setLocalZoom\n  }\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser,\n\n    editorMode, setEditorMode,\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    location, setLocation,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalOpen, setPurchaseModalOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n    registerModalOpen, setRegisterModalOpen,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\n\nexport default TwofoldContext\nexport {\n  TwofoldContextProvider,\n}\n","\n/**\n * Constants\n *\n * * C.anonUser\n * * C.current_user\n * * C.jwt_token\n * * C.item_types\n *\n */\nconst C = {\n\n  // A\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: {\n    scratchpad: 'Scratchpad',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","\nimport axios from \"axios\"\n\n/*\nimport config from \"config\"\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings)\n*/\n\nexport default axios.create({})\n","/*\n *  $shared / index\n */\nimport { arrowBack, closeOutline, } from 'ionicons/icons'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport {\n  ChevronLeft as _ChevronLeft,\n  ChevronRight as _ChevronRight,\n  Close as _Close,\n  Menu as _MenuIcon,\n} from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\nimport {\n  Route as _Route, useHistory,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport C from './C'\n\n/* A */\n\nconst Actions = styled.div`\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n`;\nexport { Actions }\n\n/* B */\n\n/**\n * Back Button\n */\n// const BackIcon = styled(IonIcon)\n// @TODO: reintroduce IonIcon maybe?\nconst BackIcon = styled.div`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n`;\n\n\n/* C */\nexport { default as C } from './C'\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * CloseBtn\n**/\nexport const CloseBtn = ({ children, ...props }) => {\n  return <_Close style={{ cursor: 'pointer', ...props.style }} {...props} />\n};\nCloseBtn.propTypes = {\n  onClick: PropTypes.func.isRequired,\n}\n\n/* D */\n\n/* F */\n\n/**\n * FlexCol\n**/\nconst _FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n`;\nexport const FlexCol = ({ children, ...props }) => <_FlexCol className=\"FlexCol\" {...props} >{children}</_FlexCol>\n\n/**\n * FlexRow\n**/\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n`;\n\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0 && typeof window !== \"undefined\") {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport const TwofoldContext = React.createContext({})\nexport const TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    currentUser, setCurrentUser,\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n    theme, toggleTheme,\n    useApi,\n  } = props\n\n  const api = useApi()\n\n  useEffect(() => {\n    let closure = setTimeout(async () => {\n      const result = await api.getMyAccount()\n      setCurrentUser(result)\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalIsOpen, setPurchaseModalIsOpen ] = useState(false)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser, // @TODO: move this to an AppWrapper context\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalIsOpen, setPurchaseModalIsOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    useApi,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\nTwofoldContextProvider.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  setCurrentUser: PropTypes.func.isRequired,\n\n  useApi: PropTypes.func.isRequired,\n}\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n * Used in collapsibles and MarkersList\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","\nimport React, { Fragment as F, useContext, } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext, AuthContextProvider,\n  FacebookLogin,\n  LoginModal, LoginWithEmail,\n  RegisterModal, RegisterWithEmail,\n} from \"$components/users\"\n\nimport {\n  Btn,\n  C,\n  FlexCol, FlexRow,\n  logg,\n} from \"$shared\"\n\n\nconst RegisterWithEmailBtn = (props) => {\n  return <Btn {...props} >Register with Email</Btn>\n}\nconst LoginWithEmailBtn = (props) => {\n  return <Btn {...props} >Login with Email</Btn>\n}\n\nconst IconLogout = ({ fill, w, h, ...props }) => {\n  // const theme = useTheme()\n\n  w = w ? w : '12px'\n  h = h ? h : '12px'\n  // fill = fill ? fill : theme.colors.text // @TODO: implement theme in ishlibjs\n  fill = fill ? fill : '#333333'\n\n  return <span {...props} >\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h}\n      viewBox=\"0 0 96.943 96.943\" style={{ enableBackground: 'new 0 0 96.943 96.943' }}\n    ><g><g><path d=\"M61.168,83.92H11.364V13.025H61.17c1.104,0,2-0.896,2-2V3.66c0-1.104-0.896-2-2-2H2c-1.104,0-2,0.896-2,2v89.623 c0,1.104,0.896,2,2,2h59.168c1.105,0,2-0.896,2-2V85.92C63.168,84.814,62.274,83.92,61.168,83.92z\"/> <path d=\"M96.355,47.058l-26.922-26.92c-0.75-0.751-2.078-0.75-2.828,0l-6.387,6.388c-0.781,0.781-0.781,2.047,0,2.828 l12.16,12.162H19.737c-1.104,0-2,0.896-2,2v9.912c0,1.104,0.896,2,2,2h52.644L60.221,67.59c-0.781,0.781-0.781,2.047,0,2.828 l6.387,6.389c0.375,0.375,0.885,0.586,1.414,0.586c0.531,0,1.039-0.211,1.414-0.586l26.922-26.92 c0.375-0.375,0.586-0.885,0.586-1.414C96.943,47.941,96.73,47.433,96.355,47.058z\"/> </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g></g><g></g><g></g>\n    </svg>\n  </span>\n}\n\n/**\n * If user is logged in, display the email/handle and allow logout.\n * If user is not logged in, allow registration and login via Fb, and email+passwd.\n**/\nconst AuthWidget = (props) => {\n  // logg(props, 'AuthWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n    setRegisterModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'AuthWidgetUsedAuthContext')\n\n  // @TODO: does this belong here?\n  const doLogout = () => {\n    setCurrentUser(JSON.stringify(C.anonUser))\n  }\n\n  if (currentUser?.email) {\n    return <FlexRow>\n      [&nbsp;{currentUser.email}&nbsp;<IconLogout onClick={doLogout} >Logout</IconLogout>&nbsp;]\n    </FlexRow>\n  }\n\n  return <F>\n    <FlexCol>\n      {/* <FacebookLogin /> */}\n      <RegisterWithEmailBtn onClick={() => { setRegisterModalOpen(true) }} />\n      <LoginWithEmailBtn    onClick={() => { setLoginModalOpen(true) }} />\n    </FlexCol>\n\n    <RegisterModal />\n    <LoginModal />\n\n  </F>\n};\nAuthWidget.propTypes = {\n  // none so far\n}\n\nexport default AuthWidget\n","\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthContext, AuthContextProvider,\n} from './'\n\n\nimport styles from './LoginModal.module.scss'\n\n// copy-pasted in RegisterModal\nexport const Header = styled.div`\n  flex-grow: 1;\n  text-align: center;\n  font-size: 1.2rem;\n`;\n\n/**\n * LoginModal\n**/\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal, ishlibjs')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LoginModalUsedAuthContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const api = useApi()\n\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((r) => {\n      setLoginModalOpen(false)\n      toast('Login Successful.')\n    }).catch((err) => {\n      logg(err, 'e323 - cannot postLogin()')\n      setCurrentUser(C.anonUser)\n      toast(\"Login failed\")\n    })\n  }\n\n  Modal.setAppElement('body')\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={!!loginModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <FlexRow >\n      <Header>Login</Header>\n      <CloseBtn onClick={() => setLoginModalOpen(false)} />\n    </FlexRow>\n    { 'string' === typeof loginModalOpen && <FlexRow>\n      <div className={styles.Notice} >{ loginModalOpen }</div>\n    </FlexRow> }\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input name='email' type='email' value={email} onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input name='password' type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n        onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n      />\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n      </FlexRow>\n    </FlexCol>\n    <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n    <FlexRow style={{ justifyContent: 'center' }} >\n      <a onClick={() => setLoginModalOpen(false) || setRegisterModalOpen(true) }>Register Instead</a>\n    </FlexRow>\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport React, { useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n} from '$shared'\nimport {\n  AuthContext,\n} from '$components/users'\n\nimport { Header } from './LoginModal'\nimport styles from './LoginModal.module.scss'\n\n\n/**\n * RegisterModal\n *\n * Uses LoginModal styling\n**/\nconst RegisterModal = (props) => {\n  // logg(props, 'RegisterModal')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'registerModalUsedContext')\n\n  const api = useApi()\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const [ password2, setPassword2 ] = useState('')\n\n  const doRegister = async (email, password, password2) => {\n    if (password !== password2) {\n      toast('Passwords do not match')\n      return\n    }\n    const out = api.doRegister({ email, password })\n\n    out.then((r) => {\n      setRegisterModalOpen(false)\n      setLoginModalOpen(r.message)\n    }).catch((e) => {\n      toast(\"Registration failed\")\n    })\n  }\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={registerModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <FlexRow >\n      <Header>Register</Header>\n      <CloseBtn onClick={() => setRegisterModalOpen(false)} />\n    </FlexRow>\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input type='email'    name='email'     value={email}    onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input type='password' name='password'  value={password} onChange={(e) => setPassword(e.target.value) } />\n\n      <label htmlFor='password2'>Confirm Password</label>\n      <input type='password' name='password2' value={password2} onChange={(e) => setPassword2(e.target.value) } />\n\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn className=\"Submit\" onClick={() => doRegister(email, password, password2) }>Register</Btn>\n      </FlexRow>\n      <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n      <FlexRow style={{ justifyContent: 'center' }} >\n        <a onClick={() => setLoginModalOpen(true) || setRegisterModalOpen(false) }>Login Instead</a>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\nRegisterModal.propTypes = {} // None so far\n\nexport default RegisterModal\n","\nimport { Plugins } from '@capacitor/core'\nimport React, { createContext, useContext, useState } from 'react'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\n// export { default as loginModalStyles } from './LoginModal.scss'\n\n/* A */\nconst AuthContext = createContext({})\nconst AuthContextProvider = ({children, ...props }) => {\n  let {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen: _registerModalOpen, setRegisterModalOpen: _setRegisterModalOpen,\n  } = props\n  // logg(props, 'AuthContextProvider')\n\n  let defaultUser = localStorage.getItem(C.current_user)\n  defaultUser = defaultUser ? JSON.parse(defaultUser) : C.anonUser\n\n  const [ localCurrentUser, _setCurrentUser ] = useState(defaultUser)\n  const setLocalCurrentUser = (user) => {\n    localStorage.setItem(C.jwt_token, user.jwt_token)\n    localStorage.setItem(C.current_user, JSON.stringify(user))\n    _setCurrentUser(user)\n  }\n  if (!setCurrentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n\n  const [ _loginModalOpen, _setLoginModalOpen ] = useState(false)\n  if (typeof loginModalOpen === 'undefined') {\n    loginModalOpen = _loginModalOpen\n    setLoginModalOpen = _setLoginModalOpen\n  }\n\n\n  let [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n  if (_registerModalOpen) {\n    registerModalOpen = _registerModalOpen\n    setRegisterModalOpen = _setRegisterModalOpen\n  }\n  const moreProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n  }\n\n  return <AuthContext.Provider value={{ ...props, ...moreProps }} >\n    { children }\n  </AuthContext.Provider>\n}\n\nexport {\n  AuthContext, AuthContextProvider,\n}\nexport { default as AuthWidget } from './AuthWidget'\n\n/* F */\nconst { FacebookLogin: _FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\n/* J */\n\n\n\n/* L */\nexport { default as LoginModal } from \"./LoginModal\"\n\n/* R */\nexport { default as RegisterModal } from \"./RegisterModal\"\n\n\n","\nimport React, { useState, } from 'react'\nimport { toast, ToastContainer } from 'react-toastify'\n\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport {\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthWidget,\n  AuthContextProvider,\n  LoginModal,\n } from './components/users'\n\nconst config = {\n  apiOrigin: 'http://localhost:3001',\n}\n\nconst TestApp = () => {\n\n  const useApi = () => ({\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users`, { email, password }).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n  })\n\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false) // useState(\"Please login!\")\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(true) // useState(\"Please register\")\n\n  return <AuthContextProvider {...{\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  }} >\n\n    {/* <LoginModal /> */}\n    <AuthWidget />\n\n    <ToastContainer position=\"bottom-left\" />\n  </AuthContextProvider>\n}\nexport default TestApp\n","/**\n * ishjs / jwt_manager\n */\n\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Btn, C, logg, request } from \"$shared\" // @TODO: alias $shared\n\n\n\n// @TODO: testdrive this context,\n// @TODO: replace TwofoldContext in guydme with the one from ishjs.\nexport const JwtContext = React.createContext({})\nconst JwtContextProvider = ({ children, ...props }) => {\n  // logg(props, 'JwtContextProvider')\n  const {\n    api,\n  } = props\n\n  const maybeUser = JSON.parse(localStorage.getItem(C.current_user)) || C.anonUser\n  const [ currentUser, setCurrentUser ] = useState(maybeUser)\n  const [ loginModalOpen, setLoginModalOpen ] = useState({})\n\n  // call to verify creds\n  useEffect(() => {\n    // request.get(`${config.apiOrigin}${config.routes.myAccountPath}`).then((r) => r.data).then((resp) => {\n    api.getMyAccount().then((resp) => {\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n    }).catch((e) => {\n      logg(e, 'e322')\n      // toast(\"Login failed\") // @TODO: re-add toast\n      setCurrentUser(C.anonUser)\n      localStorage.removeItem(C.current_user)\n      localStorage.removeItem(C.jwt_token)\n    })\n  }, [])\n\n  return <JwtContext.Provider value={{\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }} >{ children }</JwtContext.Provider>\n}\nJwtContextProvider.props = {\n  api: PropTypes.object,\n}\nexport { JwtContextProvider }\n\n// @TODO: move to shared?\nconst FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst W1 = styled.div`\n  border: 1px solid red;\n`;\n\nconst W2 = styled.div`\n  display: flex;\n`;\n\nexport const SimpleJwtRow = () => {\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  // logg(useContext(JwtContext), 'SimpleJwtRowUsedJwtContext')\n\n  return <W1>\n    <FlexRow>\n      { /* <FbLogin /> */ }\n      { currentUser.email && <W2>\n        <i>{currentUser.email}</i>\n        <Logout />\n      </W2>}\n      { !currentUser.email && <LoginWithPassword /> }\n    </FlexRow>\n  </W1>\n}\n\n\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n// @TODO: is this obsolete and unused?\n// _vp_ 2022-09-01\nexport const LoginWithPassword = (props) => {\n  // logg(useContext(JwtContext), 'useContext(JwtContext)')\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const doPasswordLogin = async (email, password) => {\n    // logg(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, 'doPasswordLogin')\n    // request.post(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, { email, password }).then((r) => r.data\n    api.postLoginWithPassword({ email, password }).then((resp) => {\n      localStorage.setItem(C.jwt_token, resp.jwt_token)\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      // toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') { doPasswordLogin(email, password) }\n      }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n  </_W>\n}\n\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(JwtContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n","/*\n * ishjs / components / users / PasswordLogin\n */\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  Btn, C, logg, request,\n} from \"$shared\"\nimport {\n  AuthContext,\n} from './'\n\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/**\n * Exchange your email and password for a jwt token.\n * api.doLogin() must be present.\n * Requires being wrapped in TwofoldContext, which should have:\n * * currentUser, setCurrentUser,\n * * useApi\n *\n * Sets `C.current_user` and `C.jwt_token` in local storage.\n *\n * Allows logout. (@TODO: not implemented)\n */\nconst PasswordLogin = (props) => {\n  // logg(props, 'PasswordLogin')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(SimpleContext), 'PasswordLoginUsedContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const api = useApi()\n\n  // api.doLogin = `${config.apiOrigin}${api.loginPath}`\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((resp) => {\n      // localStorage.setItem(C.jwt_token, resp.jwt_token)\n      // localStorage.setItem(C.current_user, JSON.stringify(resp))\n      // setCurrentUser(resp) // must be done *after* setting C.jwt_token\n\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email'    value={email}    onChange={(e) => setEmail(e.target.value)    } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n  </_W>\n}\nPasswordLogin.propTypes = {\n  // None so far\n}\n\nexport default PasswordLogin\n","\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n} from '$components/users'\nimport {\n  Actions,\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nconst W0 = styled.div`\n`;\n\n\n/**\n * A single text area that saves locally and in the cloud.\n */\nconst Scratchpad = (props) => {\n  // logg(props, 'Scratchpad')\n\n  const {\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const [ txt, setTxt ] = useState(localStorage.getItem(C.names.scratchpad) || '')\n\n  const doSave = () => {\n    localStorage.setItem(C.names.scratchpad, txt)\n    api.postProfile({ scratchpad: txt }).then((data) => {\n      // toast('Updated profile.')\n    }).catch((err) => {\n      logg('Cannot update profile:', err)\n      // toast('e54 - Cannot update profile.')\n    })\n  }\n\n  return <W0>\n    <textarea name='scratchpad' rows='20' cols='40'\n      onChange={(e) => setTxt(e.target.value) }\n      value={txt}\n    / >\n    <Actions>\n      <Btn onClick={doSave}>Save</Btn>\n    </Actions>\n  </W0>\n}\nScratchpad.propTypes = {\n  // none so far\n}\n\nexport default Scratchpad\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = ({ children, ...props }) => {\n  const { listItems } = props\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em', zIndex: 1 }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          { listItems.map( ({ label, key, path }) => <ListItem button key={key}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(path())\n            } } >{ label }\n          </ListItem> )}\n\n        </List>\n\n        { children }\n      </W0>\n    </Drawer>\n\n  </F>\n}\n\nSideMenu.propTypes = {\n  listItems: PropTypes.array.isRequired, // @TODO: specify: key, label, path\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport {\n  logg,\n} from \"./shared\"\nimport App from './TestApp'\n\n// @TODO: rename\nimport * as jwtManager from './components/users/JwtContext' // this syntax is correct\n\n/* A */\nexport { Actions, } from './shared'\nexport { AuthContext, AuthContextProvider, } from './components/users'\nexport { default as AuthWidget } from \"./components/users/AuthWidget\"\n\n/* C */\nexport { CloseBtn } from './shared'\n\n/* F */\nexport { FlexCol, FlexRow } from \"./shared\"\n\n/* J */\nexport { jwtManager }\n\n/* L */\nexport { logg }\nexport { default as LoginModal } from './components/users/LoginModal'\n// export { default as loginModalStyles } from './components/users/LoginModal.scss'\n\n/* P */\nexport { default as PasswordLogin } from \"./components/users/PasswordLogin\"\n\n/* R */\nexport { RegisterModal } from './components/users'\n\n/* S */\nexport { default as Scratchpad } from \"./components/users/Scratchpad\"\nexport { default as SideMenu } from './components/SideMenu'\n\nif (process.env.REACT_APP_SERVE) {\n  ReactDOM.render(<App />, document.getElementById('root'))\n}\n","import React, { useContext } from 'react'\n\nimport config from \"config\"\nimport {\n  AuthContext,\n} from 'ishlibjs'\n\nimport {\n  C,\n  logg, // eslint-disable-line no-unused-vars\n  request,\n} from \"$shared\"\n\nconst useApi = () => {\n  const {\n    setCurrentUser,\n    setLoginModalOpen,\n  } = useContext(AuthContext)\n\n  const token = localStorage.getItem(C.jwt_token)\n\n  return {\n\n    deleteNewsitem: ({ id }) => {\n      return request.delete(`${config.apiOrigin}/api/newsitems/${id}?jwt_token=${token}`).then((r) => r.data).then((r) => {\n        return r\n      })\n    },\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users/register`, { user: { email, password }} ).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n    /* Returns current user */\n    doUnlock: ({ kind, id }) => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      const path = `/api/payments/unlock?kind=${kind}&id=${id}&jwt_token=${jwt_token}`\n      return request.post(`${config.apiOrigin}${path}`).then((r) => r.data)\n    },\n\n    getCities: ()   => request.get(`${config.apiOrigin}/api/cities`).then((r) => r.data),\n    getCity: (slug) => request.get(`${config.apiOrigin}/api/cities/view/${slug}`),\n    getGallery: (slug) => request.get(`${config.apiOrigin}/api/galleries/view/${slug}?jwt_token=${token}`).then((r) => r.data.gallery),\n\n    // @TODO: test: upon 401, return anon user. _vp_ 2022-08-15\n    getMyAccount: () => {\n      return request.post(`/api/my/account`, { jwt_token: token, }).then((r) => r.data).catch((err) => {\n        logg(err, 'Cannot #getMyAccount')\n        return C.anonUser\n      })\n    },\n\n    getPayments: () => request.get(`${config.apiOrigin}/api/payments2?jwt_token=${token}`).then((r) => r.data),\n\n    getReport: (slug) => request.get(`${config.apiOrigin}/api/reports/view/${slug}?jwt_token=${token}`).then((r) => r.data.report),\n\n    getTag: (tag) => request.get(`${config.apiOrigin}/api/tags/view/${tag.slug}`).then((r) => r.data),\n\n    loginPath: '/api/users/login',\n    longTermTokenPath: '/api/users/long_term_token',\n\n    postLogin: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}${config.router.loginPath}.json`,\n        { user: { email, password }}\n      ).then((r) => r.data).then((resp) => {\n        logg(resp, 'got this resp')\n\n        localStorage.setItem(C.jwt_token, resp.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp))\n        setCurrentUser(resp) // must be done *after* setting C.jwt_token\n        setLoginModalOpen(false)\n      }).catch((e) => {\n        logg(e, 'e322')\n        toast(\"Login failed\")\n        setCurrentUser(C.anonUser)\n      })\n    },\n\n    myVideosPath: \"/api/my/videos\", // @TODO: remove\n\n    applicationHome: () => {\n      request.get(`${config.apiOrigin}/api/sites/view/${config.domain}`, { params: { jwt_token: token } }).then((r) => {\n        return r.data\n      })\n    },\n\n    vote: (props) => {\n      const { value, voter_id, votee_id, votee_class_name } = props\n      return request.post(\n        `${config.apiOrigin}/api/v1/vote/${votee_class_name}/${votee_id}/${voter_id}/${value}`,\n        { params: { jwt_token: token } }\n      ).then((r) => {\n        logg(r, 'voted')\n        return r\n      })\n    },\n\n    unvote: () => {\n      logg('Unvote is not implemented!')\n    },\n  }\n\n}\n\nexport default useApi\n","/*\n * components / TwofoldLayout / index.jsx\n */\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\n/**\n * LongLine\n *\n * Turns out I need this still - part of the layout.\n */\nconst LongLine = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  flex-grow: 1;\n\n  width: ${p => p.orientation === C.horizontal ? 'auto' : '10px'};\n  height: ${p => p.orientation === C.horizontal ? '10px' : 'auto'};\n\n  padding: 2px;\n  background: ${p => p.theme.colors.background};\n`;\nLongLine.propTypes = {\n  orientation: PropTypes.string, // 'horizontal' or 'vertical'\n}\n\nexport { LongLine }\n","\nimport _Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport { MyAccountWidget } from \"$components/users\"\nimport { C, logg, MenuIcon, S, TwofoldContext, } from \"$shared\"\n\nconst Drawer = styled(_Drawer)`\n  .MuiDrawer-paper {\n    // border: 1px solid cyan;\n\n    background: ${p=>p.theme.colors.background};\n    z-index: 0;\n  }\n\n  .MuiDrawer-paperAnchorDockedBottom {\n    border-top: 0;\n  }\n`;\n\nfunction getLibrary(provider) {\n  return new Web3(provider)\n}\n\nconst Inner0 = styled.div`\n  display: flex;\n  align-items: flex-start;\n  color: ${p => p.theme.colors.text};\n`;\n\nconst Inner1 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  background: ${p=>p.theme.colors.background};\n  height: calc(${p=>p.theme.bottomDrawerOpenHeight} + 1*${p=>p.theme.borderHeight});\n  margin: ${p=>p.theme.borderWidth};\n\n  flex-grow: 1;\n`;\n\n// TODO: I may not need this\nconst Inner2 = styled.div`\n  // border: 1px solid green;\n\n  background: ${p=>p.theme.colors.cardBackground};\n  height: 100px;\n  display: flex;\n`;\n\nconst WClosed = styled.div`\n  // border: 1px solid yellow;\n\n  position: absolute;\n  bottom: -10px;\n  // left: 10px;\n\n  width: calc(100% - 2*${p=>p.theme.borderWidth});\n\n  display: flex;\n  align-items: center;\n`;\n\n/**\n * BottomDrawer\n */\nconst BottomDrawer = (props) => {\n  // logg(props, 'BottomDrawer')\n\n  const { bottomDrawerOpen, layout, setBottomDrawerOpen } = useContext(TwofoldContext)\n\n  // @TODO: move the component to layout_onecol then\n  if (layout === C.layout_onecol) { return null; }\n\n  return <F>\n\n    <WClosed>\n      <IconButton\n        aria-label=\"open drawer\"\n        onClick={() => setBottomDrawerOpen(true)}\n      ><MenuIcon\n        fontSize=\"small\"\n      /></IconButton>\n      <LongLine orientation={C.horizontal} />\n    </WClosed>\n\n\n    <Drawer anchor={\"bottom\"}\n      elevation={1}\n      open={bottomDrawerOpen}\n      onClose={() => setBottomDrawerOpen(false)}\n      BackdropProps={{ invisible: true }}\n      variant={\"persistent\"}\n    >\n      <Inner0 >\n        <IconButton\n          aria-label=\"open drawer\"\n          onClick={() => setBottomDrawerOpen(false)}\n          style={{ paddingRight: 0 }}\n        ><MenuIcon\n          fontSize=\"small\"\n        /></IconButton>\n\n        <Inner1 >\n          <Inner2 >\n\n            {/* @TODO: move this upstream */}\n            <Web3ReactProvider getLibrary={getLibrary}>\n              <MyAccountWidget />\n            </Web3ReactProvider>\n\n          </Inner2>\n        </Inner1>\n      </Inner0>\n    </Drawer>\n  </F>\n}\nBottomDrawer.propTypes = {} // none so far\n\nexport default BottomDrawer\n\n\n","\nimport {\n  IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonToggle, IonList, IonItem,\n  IonLabel, IonItemDivider,\n} from '@ionic/react'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  DayNightToggle,\n} from './'\nimport { MenuLeft } from \"$components/application\"\nimport {\n  C, logg, request, S, TwofoldContext,\n} from \"$shared\"\n\n\n\n/* B */\n\n// One breadcrumb\nconst B0 = styled.div`\n  color: ${p=> p.theme.colors.text};\n  // padding-right: 0.5em;\n`;\n\n// The divider\nconst B1 = styled.div`\n  padding: 0.5em;\n  color: ${p => p.theme.colors.text};\n`;\n\n/* W */\nconst W0 = styled.div`\n  background: ${p => p.theme.colors.cardBackground};\n  border: ${p=>p.debug?'1':'0'}px solid cyan;\n\n  display: flex;\n  align-items: center;\n  justify-content: stretch;\n\n  z-index: 0;\n\n  // height: ${p => p.theme.breadcrumbsHeight};\n`;\n\nconst WBreadcrumbs = styled.div`\n  display: block;\n  flex-grow: 1;\n  // flex-direction: row;\n  // flex-grow: 1;\n  // flex-wrap: wrap;\n\n  > * {\n    // border: 1px solid red;\n    display: inline;\n  }\n`;\n\n\n/**\n * Breadcrumbs\n */\nconst Breadcrumbs = (props) => {\n  // logg(props, 'Breakcrumbs')\n  const { breadcrumbs=[] } = props\n  const { layout, toggleTheme, theme } = useContext(TwofoldContext)\n  const history = useHistory()\n\n  const out = []\n  breadcrumbs.map((b, idx) => {\n    if (idx+1 === props.breadcrumbs.length) {\n      // last one\n      out.push(<B0 key={idx} >{b.name}</B0>)\n    } else {\n      out.push(<B0\n        key={idx}\n        style={{ textDecoration: 'underline', cursor: 'pointer' }}\n        onClick={() => history.push(`/en/locations/show/${b.slug}`) }\n      >{b.name}</B0>)\n      out.push(<B1 key={`${idx}-divider`} >&gt;</B1>)\n    }\n  })\n\n  return <W0 debug={config.debug} className=\"Breadcrumbs\" >\n    { layout === C.layout_mapui && <MenuLeft variant={C.variants.inline} /> }\n    <WBreadcrumbs className='WBreadcrumbs' >{ out }</WBreadcrumbs>\n    <DayNightToggle toggleTheme={toggleTheme} theme={theme} />\n  </W0>\n}\nBreadcrumbs.propTypes = {\n  breadcrumbs: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      slug: PropTypes.string.isRequired,\n    }),\n  ),\n}\nexport default Breadcrumbs\n","\nimport React from 'react'\n\nimport {\n  C,\n  logg,\n} from '$shared'\n\nimport styles from './DayNightToggle.module.scss'\n\n/**\n * DayNightToggle\n * From: https://codepen.io/fagnanm/pen/RpWNyb\n * From: https://devbeep.com/css-day-night-toggle-switch/\n**/\nconst DayNightToggle = (props) => {\n  // logg(props, 'DayNightToggle')\n  const { toggleTheme, theme } = props\n\n  return (\n    <div className={styles.container} onClick={toggleTheme} >\n      <div className={styles.switch} >\n        <label htmlFor=\"toggle\">\n          <input id=\"toggle\" readOnly={true} type=\"checkbox\" checked={theme === C.themes.light} ></input>\n          <div className={styles.sunMoon} ><div className={styles.dots} ></div></div>\n          <div className={styles.background} ><div className={styles.stars1}></div><div className={styles.stars2}></div></div>\n          {/* <div className={styles.fill}></div> */}\n        </label>\n      </div>\n    </div>\n  );\n}\n\nexport default DayNightToggle\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { logg, C, } from \"$shared\"\nimport { MenuLeft, } from \"$components/application\"\n\nconst Header = styled.div`\n  // border: 1px solid red;\n\n  flex-grow: 1;\n\n  text-align: center;\n  font-size: 2em;\n\n\n`;\n\nconst Root = styled.div`\n  // border: 1px solid blue;\n\n  display: flex;\n  justify-content: center;\n  line-height: 2em;\n  padding: 2em 0;\n`;\n\n/*\n * @TODO: likely destroy this file\n */\nconst MainHeader = (props) => {\n  // logg(props, 'MainMenu')\n\n  return <Root>\n    <MenuLeft variant={C.variants.inline} />\n    <Header>My Local Guide</Header>\n  </Root>\n}\n\nexport default MainHeader\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid purple;\n\n  background: white;\n\n  overflow: hidden;\n  margin: 10px;\n  height: calc(100vh - ${p => p.borderWidth*2}px - ${p => p.bottomDrawerOpen ? `${p.bottomDrawerHeight - p.borderWidth/2}px` : '0px' });\n`\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiLayout = (props) => {\n  return <MapuiContainer {...props} />\n}\n\nexport default MapuiLayout\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid cyan;\n  // background: white;\n\n  overflow-y: auto;\n\n  height: calc(100vh\n    - ${p => p.bottomDrawerOpen ? p.bottomDrawerOpenHeight : p.bottomDrawerClosedHeight });\n`;\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiMobileLayout = (props) => {\n  const { bottomDrawerOpen } = useContext(TwofoldContext)\n  return <MapuiContainer {...props} {...{ bottomDrawerOpen }} {...S} />\n}\n\nexport default MapuiMobileLayout\n","\n\n/*\n * @TODO: Likely destroy this file\n */\n\nimport {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonMenu,\n  IonMenuToggle,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { newspaperOutline, bus, person, powerOutline } from 'ionicons/icons';\nimport './Application.module.scss';\n\nconst appPages = [\n  {\n    title: 'Homefeed',\n    icon: newspaperOutline,\n    url: \"/en\"\n  },\n  {\n    title: 'Cities',\n    icon: bus,\n    url: \"/en/cities\"\n  },\n  {\n    title: 'My Account',\n    icon: person,\n    url: \"/en/account\"\n  },\n  {\n    title: 'Account2',\n    icon: person,\n    url: \"/en/account2\"\n  },\n  {\n    title: 'Login',\n    icon: powerOutline\n  }\n];\n\n/**\n * 20210529 - I think this is obsolete somehow, I'm using MyDrawer in App.jsx\n *\n */\nconst Menu = () => {\n  return (\n    <IonMenu contentId=\"main\" type=\"overlay\">\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Menu</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <img src=\"/assets/hero.png\" />\n        <IonList id=\"inbox-list\">\n          { appPages.map((appPage, index) => <IonMenuToggle key={index} autoHide={false}>\n            <IonItem\n              routerLink={appPage.url}\n              routerDirection=\"none\"\n              lines=\"none\"\n              detail={false}>\n              <IonIcon\n                slot=\"start\"\n                ios={appPage.icon}\n                md={appPage.icon} />\n              <IonLabel>{appPage.title}</IonLabel>\n            </IonItem>\n          </IonMenuToggle>) }\n        </IonList>\n      </IonContent>\n    </IonMenu>\n  )\n}\n\nexport default Menu\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { Menu } from \"$components/application\"\nimport { Api, C, Debug, logg, MenuIcon, TwofoldContext, } from \"$shared\"\n\nconst _LeftWrapper = styled.div`\n  // border: 1px solid green;\n`;\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = (props) => {\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  return <F>\n\n    { /* <Menu /> */ }\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em' }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          <ListItem button key={'newsfeed'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(config.homePath)\n            } } >Home\n          </ListItem>\n\n          { /* <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/threev1\")\n            } } >Three\n          </ListItem>\n\n          <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/construct03d\")\n            } } >Construct0 3D\n          </ListItem>\n\n          <ListItem button key={'cities'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/cities\")\n            } }>\n            <span >Cities</span>\n          </ListItem>\n\n          <ListItem button key={'map 1'} >\n            <span onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations\")\n            } }>The Directory</span>\n          </ListItem> */ }\n\n          { currentUser && currentUser.bookmarks?.map((b, idx) =>\n            <ListItem button key={idx}\n              onClick={() => {\n                setDrawerOpen(false)\n                history.push(`/en/locations/show/${b.slug}`)\n              } } >\n              <span >{b.name}</span>\n            </ListItem>\n          ) }\n\n          <ListItem button key={'account'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(`/en/locations/show/${currentUser.id}`)\n            } } >\n            <span >Account</span>\n          </ListItem>\n\n          <ListItem>\n            Version 0.0.0\n          </ListItem>\n\n        </List>\n        { /* <W2>\n          { loading && 'Loading...' }\n          { currentUser && <F>\n            {currentUser.email}<br />\n            {currentUser.n_stars}<br />\n            some action\n          </F> }\n        </W2> */ }\n      </W0>\n    </Drawer>\n  </F>\n}\n\nSideMenu.propTypes = {\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from \"react\"\nimport { withRouter } from \"react-router-dom\"\nimport \"./Application.module.scss\"\nimport styled from 'styled-components'\n\nimport { Api, logg, request, pp_date } from \"$shared\"\n\nconst W = styled.div`\n  margin: .5em 0;\n  color: ${p=>p.theme.colors.text};\n`\n\nconst Metaline = (props) => {\n  // logg(props, 'Metaline')\n\n  const { created_at, username, city, tags = [] } = props;\n\n  function navigateToCity(){\n    props.history.push(`/en/cities/travel-to/${city.slug}/show/newsfeed`);\n  }\n\n  return (\n    <W>\n      { created_at && <span className=\"date\">On {pp_date(created_at)}&nbsp;</span>}\n      { username && <>by <span className=\"user\" style={{ textDecoration: 'underline' }} >{username}</span>&nbsp;</> }\n      {/* { city     && <>in <span className=\"city\" onClick={navigateToCity}> {city.name} </span>&nbsp;</> } */}\n      {/* { tags     && tags.map((tag, i) => <span key={i} className=\"tags\">{tag.name}</span>) } */}\n    </W>\n  );\n\n}\n\nexport default withRouter(Metaline);","\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { CardElement, Elements, useElements, useStripe, } from '@stripe/react-stripe-js'\nimport { loadStripe } from '@stripe/stripe-js'\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  logg,\n  request,\n  S,\n  TwofoldContext,\n} from \"$shared\"\n\nconst stripePromise = loadStripe('pk_test_qr1QPmSpLdBFt1F7itdWJOj3') // @TODO: this is active, but change.\n\nconst _PurchaseModal = (props) => {\n\n  const {\n    purchaseModalOpen, setPurchaseModalOpen,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'PurchaseModalUsedTwofoldContext')\n\n  const stripe = useStripe()\n  const elements = useElements()\n\n  // buy unlocks (coins)\n  // @TODO: rename\n  const handleSubmit = async (event) => {\n    event.preventDefault()\n\n    if (!stripe || !elements) { return }\n    const cardElement = elements.getElement(CardElement)\n    let client_secret = await api.getPayments()\n\n    const result = await stripe.confirmCardPayment(client_secret.client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    })\n\n    if (result.error) {\n      logg(result.error.message, 'error message')\n    } else {\n      if (result.paymentIntent.status === 'succeeded') {\n        let response = await api.getMyAccount()\n        logg(response, 'tr2')\n        setCurrentUser(response)\n        setPurchaseModalOpen(false)\n      }\n    }\n  }\n\n  return <F>\n\n    <Btn>Spend $</Btn>\n\n    <Modal isOpen={purchaseModalOpen} ariaHideApp={false} >\n      <h1>\n        Buy unlocks\n        <span onClick={() => { setPurchaseModalOpen(false) } } >[x]</span>\n      </h1>\n      <form onSubmit={handleSubmit} >\n        <CardElement />\n        <button type=\"submit\" disabled={!stripe} >Pay</button>\n      </form>\n    </Modal>\n  </F>\n}\nconst PurchaseModal = (props) => <Elements stripe={stripePromise}><_PurchaseModal {...props} /></Elements>;\nexport default PurchaseModal\n","import React, { useEffect, useState } from \"react\"\nimport { IonIcon } from \"@ionic/react\"\nimport { starOutline, starHalf, star } from 'ionicons/icons'\nimport \"./Application.module.scss\"\n\nconst Rating = (props) => {\n\n  let rate = props.rate;\n  let [rating, setRating] = useState([]);\n\n  let iconMapping = {\n    0: starOutline,\n    1: starHalf,\n    2: star\n  };\n\n  useEffect(() => {\n\n    let rating = (new Array(5)).fill(0);\n    let i = 0;\n    while (rate > 0) {\n      if (rate < 1) {\n        rating[i] = 1;\n      } else {\n        rating[i] = 2;\n      }\n      rate--;\n      i++;\n    }\n\n    setRating(rating);\n\n  }, []);\n\n  return (\n    <div className=\"rating\">\n      { rating.map((r, i) => <IonIcon key={i} className=\"stars\" icon={iconMapping[r]} ></IonIcon>) }\n    </div>\n  )\n\n}\n\nexport default Rating;","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, } from 'react'\nimport Modal from \"react-modal\"\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport './UnlockModal.module.scss'\nimport { Btn, C, logg, request, TwofoldContext, useApi, } from \"$shared\"\n\nconst Btn0 = styled.div`\n  display: inline;\n  cursor: pointer;\n`;\nconst BtnRow = styled.div`\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst modalStyle = {\n  overlay: {},\n  content: {\n    margin: 'auto',\n    maxWidth: '400px',\n\n  }\n}\n\n/**\n * UnlockModal\n */\nconst UnlockModal = (props) => {\n  // logg(props, 'UnlockModal')\n\n  const {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n    purchaseModalOpen, setPurchaseModalOpen,\n    ratedConfirmation, setRatedConfirmation,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'unlockModalUsedTwofoldContext')\n\n  const history = useHistory()\n  const api = useApi()\n\n  const doUnlock = async () => {\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    await api.doUnlock({ kind: itemToUnlock.item_type, id: itemToUnlock.id }).then((r) => {\n      setItemToUnlock({})\n\n      // @TODO: fix this mess\n\n      setCurrentUser(r)\n      // refresh the newsfeed?\n    }).catch((e) => {\n      logg(e, 'e19')\n    })\n  }\n\n  /* @TODO: this was here before, but should not be, right? _vp_ 2022-03-19 */\n  // const mountedRef = useRef('init')\n  // useEffect(() => {\n  //   const fn = async () => {\n  //     const r = await api.getMyAccount()\n  //     if (r) {\n  //       setCurrentUser(r)\n  //     }\n  //   }\n  //   fn()\n  //   return () => mountedRef.current = null\n  // }, [itemToUnlock.id])\n\n  if (!itemToUnlock.id) { return null }\n\n  let closable = typeof itemToUnlock.closable === 'undefined' ? true : itemToUnlock.closable\n\n  // @TODO: this is messy\n  let gohome = () => {\n    setItemToUnlock({})\n    setRatedConfirmation(true)\n    history.push(config.homePath)\n  }\n\n  const cost = itemToUnlock.premium_tier\n\n  return (<Modal style={modalStyle} ariaHideApp={false} isOpen={!!itemToUnlock.id} >\n    <Header>\n      <h1>Unlock this item?</h1>\n      { closable && <Btn0 onClick={() => closable && setItemToUnlock(false) } >&times;</Btn0> }\n    </Header>\n    <p>To access this content, please unlock it first. It costs {cost} coin(s) to unlock.</p>\n    { currentUser && <F>\n      <p>You have <b>{currentUser.n_unlocks}</b> unlocks.</p>\n      { currentUser.n_unlocks >= cost && <Btn onClick={doUnlock} >Unlock</Btn> }\n      { currentUser.n_unlocks < cost && <F>\n        <p>You don't have enough unlocks.</p>\n        <Btn onClick={() => { setPurchaseModalOpen(true) ; setItemToUnlock(false)} } >Purchase more.</Btn>\n      </F> }\n    </F> }\n    { !currentUser && <F>\n      <p>You have to be logged in to unlock content. <a onClick={() => { setLoginModalOpen(true) ; setItemToUnlock(false) }}>Please login.</a></p>\n    </F> }\n    <BtnRow>\n      { !closable && <Btn onClick={gohome} >Go Home</Btn> }\n    </BtnRow>\n  </Modal>)\n\n}\n\nexport default UnlockModal\n","\nimport { Capacitor } from '@capacitor/core'\nimport { PushNotifications } from '@capacitor/push-notifications'\nimport { Toast } from \"@capacitor/toast\"\nimport { ethers } from 'ethers'\nimport {\n  IonButton, IonButtons,\n  IonCard, IonCardContent, IonContent,\n  IonFooter,\n  IonHeader,\n  IonItem,\n  IonLabel, IonListHeader, IonList,\n  IonMenuButton,\n  IonPage,\n  IonText, IonTitle, IonToolbar,\n} from '@ionic/react'\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport React, {\n  Fragment as F,\n  useContext, useEffect, useState,\n} from \"react\"\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { FbLogin, Logout, } from \"./\"\nimport { C, logg, logg2, TwofoldContext } from \"$shared\"\nimport { MenuLeft } from \"$components/application\"\nimport Greeter from '$src/artifacts/contracts/Greeter.sol/Greeter.json'\nimport Token from '$src/artifacts/contracts/Token.sol/Token.json'\n\nconst isPushNotificationsAvailable = Capacitor.isPluginAvailable('PushNotifications')\n\n// Update with the contract address logged out to the CLI when it was deployed\nconst greeterAddress = \"0x4bE9765Ca063E73E0aaEd227fd6731473508DbE0\"\nconst tokenAddress = \"0xffa52d00685aC60e65457922aEae2c2783c0cB0E\"\n\nexport const PasswordLogin = () => {\n  return <div>PasswordLogin - @TODO: remove</div>\n}\n\nconst LoginRow = styled.div`\n  display: flex;\n  // border: 1px solid yellow;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst Account = (props) => {\n  // logg(props, 'Account')\n\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const [ greeting, setGreetingValue ] = useState(\"\")\n  const [notifications, setNotifications] = useState([])\n  const [ scratchpad, setScratchpad ] = useState(\"\")\n  const saveScratchpad = () => {}\n\n  // push notifications\n  const register = () => {\n    // Register with Apple / Google to receive push via APNS/FCM\n    PushNotifications.register()\n\n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration', (token) => {\n      showToast('Push registration success')\n    })\n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError', (error) => {\n      alert('Error on registration: ' + JSON.stringify(error))\n    })\n\n    // Show us the notification payload if the app is open on our device\n    PushNotifications.addListener('pushNotificationReceived', (_n) => {\n      const n = _n\n      logg2(n, 'pushNotificationReceived')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'foreground' }]\n      })\n    })\n\n    // Method called when tapping on a notification\n    PushNotifications.addListener('pushNotificationActionPerformed', ({ nofitication: n }) => {\n      logg2(n, 'pushNotificationActionPerformed')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'action' }]\n      })\n    })\n  }\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // push notifications\n  useEffect(() => {\n    if (!isPushNotificationsAvailable) { return }\n\n    PushNotifications.checkPermissions().then((res) => {\n        if (res.receive === 'granted') {\n          register()\n        } else {\n          PushNotifications.requestPermissions().then((res) => {\n            if (res.receive === 'denied') {\n              showToast('Push Notification permission denied')\n            } else {\n              showToast('Push Notification permission granted')\n              register()\n            }\n          })\n        }\n      })\n  }, [])\n\n  // request access to the user's MetaMask account\n  async function requestAccount() {\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n  }\n\n  // call the smart contract, read the current greeting value\n  async function fetchGreeting() {\n    if (typeof window.ethereum !== 'undefined') {\n      const provider = new ethers.providers.Web3Provider(window.ethereum)\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, provider)\n      try {\n        const data = await contract.greet()\n        setGreetingValue(data)\n        // console.log('data: ', data)\n      } catch (err) {\n        console.log(\"Error: \", err)\n      }\n    }\n  }\n\n  async function getBalance() {\n    if (typeof window.ethereum !== 'undefined') {\n      const [account] = await window.ethereum.request({ method: 'eth_requestAccounts' })\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const contract = new ethers.Contract(tokenAddress, Token.abi, provider)\n      const balance = await contract.balanceOf(account);\n      console.log(\"Balance: \", balance.toString());\n    }\n  }\n\n  // call the smart contract, send an update\n  async function setGreeting() {\n    if (!greeting) return\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner()\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, signer)\n      const transaction = await contract.setGreeting(greeting)\n      await transaction.wait()\n      fetchGreeting()\n    }\n  }\n\n  async function sendCoins() {\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(tokenAddress, Token.abi, signer);\n      const transation = await contract.transfer(userAccount, amount);\n      await transation.wait();\n      console.log(`${amount} Coins successfully sent to ${userAccount}`);\n    }\n  }\n\n  return <IonPage>\n    <Grid container>\n      <MenuLeft variant={C.variants.inline} />\n      <h1>Account</h1>\n    </Grid>\n    <IonContent className=\"ion-padding\">\n\n      <Grid container spacing={2} >\n        <Grid item xs={12}>\n          <Grid container>\n            <Grid item xs={6}>\n              <img src=\"/assets/accounts/default-avatar.png\" alt=\"profile pic\" />\n\n              { /* NFT */ }\n              <div>\n                <button onClick={fetchGreeting}>Fetch Greeting</button>\n                <br />\n                <button onClick={setGreeting}>Set Greeting</button>\n                <br />\n                <input value={greeting} onChange={e => setGreetingValue(e.target.value)} placeholder=\"Set greeting\" />\n              </div>\n              <hr />\n              <div>\n                <button onClick={getBalance}>Get Balance</button>\n                <br />\n                <button onClick={sendCoins}>Send Coins</button>\n                <br />\n                <input onChange={e => setUserAccount(e.target.value)} placeholder=\"Account ID\" />\n                <br />\n                <input onChange={e => setAmount(e.target.value)} placeholder=\"Amount\" />\n              </div>\n\n            </Grid>\n            <Grid item xs={6}>\n              { !!currentUser\n                && <F>\n                  <h4>{currentUser.email}</h4>\n                  <ul>\n                    <li><Link to={\"/en/account/my/galleries\"} >My Galleries</Link></li>\n                    <li><a onClick={() => props.history.push(\"/en/account/my/videos\")}>My Videos</a></li>\n                    <li><Logout /></li>\n                  </ul>\n                </F>\n                || <F>\n                  <h4>Not logged in</h4>\n\n                  <LoginRow>\n                    <FbLogin />\n                    <PasswordLogin />\n                  </LoginRow>\n\n                </F> }\n            </Grid>\n          </Grid>\n          <Grid container spacing={2}>\n            <Grid item xs={6} >\n              <textarea value={scratchpad} onChange={setScratchpad} />\n              <button type='submit' onClick={saveScratchpad}>Save Scratchpad</button>\n            </Grid>\n          </Grid>\n        </Grid>\n      </Grid>\n\n      <hr />\n      { /* push notifications */ }\n      { notifications.length && <IonList>\n        { notifications.map((notif) => <IonItem key={notif.id}>\n          <IonLabel>\n            <IonText><h3 className=\"notif-title\">{ notif.title }</h3></IonText>\n            <p>{ notif.body }</p>\n            { notif.type==='foreground' && <p>This data was received in foreground</p> }\n            { notif.type==='action' && <p>This data was received on tap</p> }\n          </IonLabel>\n        </IonItem>) }\n      </IonList> || 'no notifications so far' }\n\n    </IonContent>\n    <IonFooter>\n      <IonToolbar>\n        { isPushNotificationsAvailable && <IonButton\n          color=\"success\" expand=\"full\" onClick={register}>Register for Push</IonButton>\n          || <div><h1>Push notifications not available</h1></div> }\n      </IonToolbar>\n    </IonFooter>\n  </IonPage>\n}\n\nexport default Account\n","\nimport { ethers } from 'ethers'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Toggle from 'react-toggle'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport config from \"config\"\nimport {\n  AuthContext, AuthWidget,\n  FlexCol, FlexRow,\n} from 'ishlibjs'\n// import styles from 'ishlibjs/dist/index.css' // @TODO: re-add!\n\nimport {\n  PurchaseModal,\n} from '$components/application'\nimport {\n  FbLogin2,\n} from \"./\"\nimport {\n  Btn,\n  Card,\n  logg,\n  request,\n  S,\n  TwofoldContext,\n} from \"$shared\"\n\nimport \"react-toggle/style.css\"\n\nimport bodyNFT from '$src/artifacts/contracts/Body.sol/BodyNFT.json'\n\n/*\n * ropsten, _vp_ 2021-10-26\n * Dana, nude 1 (nude 3)\n */\nconst bodyAddress = '0x3e1a03a9e1682f4dd95413e0be69e5b7bccaf15d'\n\nconst BuyBtn = styled.span`\n  border: 1px solid ${p => p.theme.colors.text};\n\n  padding: 5px;\n  cursor: pointer;\n`;\n\nconst Cell = styled.div`\n  // display: flex;\n`;\n\nconst _Img = styled.div`\n  border: 1px solid red;\n  background: white;\n\n  max-width: 100px;\n  max-height: 100px;\n  width: 100px;\n  height: 100px;\n`;\nconst Img = ({ src }) => {\n  return <_Img><img src={src} alt='' /></_Img>\n}\n\nconst injected = new InjectedConnector() // { supportedChainIds: [1, 3, 4, 5, 42], })\n\nconst W0 = styled.div`\n  // border: 1px solid cyan;\n\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n`;\n\nconst W1 = styled.div``;\n\nconst AuthedWidget = (props) => {\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n\n  const {\n    editorMode, setEditorMode,\n  } = useContext(TwofoldContext)\n\n  return <F>\n    <Cell>[ { typeof currentUser.n_unlocks === 'undefined' ? '?' : currentUser.n_unlocks} coins\n      <BuyBtn onClick={() => setPurchaseModalOpen(true) }>Add</BuyBtn> ]</Cell>\n\n    <Card>\n      <label>\n      <Toggle\n        defaultChecked={editorMode}\n        icons={false}\n        onChange={() => setEditorMode(!editorMode) } />\n      <span>Editor mode</span>\n    </label>\n    </Card>\n\n  </F>\n}\n\n/**\n * MyAccountWidget\n**/\nconst MyAccountWidget = (props) => {\n  // logg(props, 'MyAccountWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n\n  // const {\n  // } = useContext(TwofoldContext)\n  // // logg(useContext(TwofoldContext), 'MyAccountWidget#usedTwofoldContext')\n\n  /*\n   * @TODO: avatar would be an object s.t. multiple styles/sizes are there,\n   * and it should be in a context - shared across threemap, and accountWidget.\n   */\n  const [ avatar, setAvatar ] = useState(\"\")\n  const api = useApi()\n  const { active, account, library, connector, activate, deactivate } = useWeb3React()\n\n  async function connect() {\n    try {\n      await activate(injected)\n    } catch (ex) {\n      logg(ex, 'could not connect')\n    }\n  }\n\n  async function disconnect() {\n    try {\n      deactivate()\n    } catch (ex) {\n      console.log(ex)\n    }\n  }\n\n  // request access to the user's MetaMask account\n  const requestAccount = async () => {\n    await window.ethereum.request({ method: 'eth_requestAccounts' })\n  }\n\n  const myBodies = async () => {\n    if (window.ethereum) {\n      await requestAccount()\n      if (account) {\n        const provider = new ethers.providers.Web3Provider(window.ethereum)\n        const signer = provider.getSigner()\n        const contract = new ethers.Contract(bodyAddress, bodyNFT.abi, signer)\n        const tokensOfOwner = await contract.tokensOfOwner(account)\n\n        // @TODO: this is only first, I need to support unlimited number of bodies connected to the account.\n        const i = 0\n        const result = await contract.tokenURI(tokensOfOwner[i])\n        request.get(result).then(r => r.data.image).then(r => {\n          setAvatar(r)\n        })\n      }\n    }\n  }\n\n  return <W0 className=\"MyAccountWidget\" >\n\n    { /* currentUser.profile_photo_url && <Img src={currentUser.profile_photo_url} /> */ }\n    <Img src={avatar || currentUser?.profile_photo_url} />\n\n    <FlexRow>\n\n      { /* currentUser.email && <AuthedWidget /> */ }\n      <AuthWidget />\n\n    </FlexRow>\n\n    { /* @TODO: this is confusing, it's not a modal, it's also the button. */ }\n    {/* <PurchaseModal /> */}\n  </W0>\n}\nMyAccountWidget.propTypes = {\n  // no props\n};\n\n// const WrappedMyAccountWidget = (props) => <Elements stripe={stripePromise}><MyAccountWidget {...props} /></Elements>;\n// export default WrappedMyAccountWidget\nexport default MyAccountWidget\n\n\n\n// { active && <W1> [\n//   <span>Connected with <b>{account}</b></span>\n//   <button onClick={disconnect} >Disconnect</button>\n//   <button onClick={myBodies} >myBodies</button> ]</W1> }\n// { !active && <W1>\n// <span>Not Connected</span>\n// <button onClick={connect} >Connect to MetaMask</button>\n// </W1> }","/*\n * components / users / index\n */\nimport { Plugins } from '@capacitor/core'\nimport { FacebookLoginResponse } from '@capacitor-community/facebook-login'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport config from 'config'\nimport {\n  Btn,\n  C,\n  FlexCol,\n  logg, request, TwofoldContext, useApi,\n} from \"$shared\"\n\n/* A */\nexport { default as Account } from \"./Account\"\n\n\n/* F */\n// @deprecated below, use ishlibjs\nconst { FacebookLogin } = Plugins\nconst FACEBOOK_PERMISSIONS = ['email']\nexport const FbLogin = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>FB Login</Btn>\n}\nexport const FbLogin2 = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>Login or Register with Facebook</Btn>\n}\n// ^ @deprecated above\n\n\n\n/* L */\n\nconst BuyBtn = styled.span`\n  border: 1px solid ${p => p.theme.colors.text};\n\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <BuyBtn onClick={doLogout}>X</BuyBtn>\n}\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/* M */\nexport { default as MyAccountWidget } from \"./MyAccountWidget\"\n\n/* P */\n\n\n/* R */\n\n","\n/*\n *  $shared / AppMock\n */\n\nimport { createMemoryHistory } from 'history'\nimport _Box from '@material-ui/core/Box'\nimport React, { useState } from 'react'\nimport {\n  Link, Switch, Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\nimport { ThemeProvider } from 'styled-components'\n\nimport {\n  C,\n  logg,\n  S,\n  TwofoldContext, TwofoldContextProvider,\n} from \"$shared\"\nimport { LoginModal } from \"$components/users\"\n\nconst AppMock = (props) => {\n  // logg(props, 'AppMock')\n  let {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n    purchaseModalOpen, setPurchaseModalOpen,\n    zoom, setZoom,\n  } = props\n  const history = createMemoryHistory()\n  history.push(\"/en/cities/travel-to/chicago\") // @TODO: move where appropriate\n\n  const [ localItemToUnlock, setLocalItemToUnlock ] = useState({})\n  const [ localCurrentUser, setLocalCurrentUser ] = useState(C.anonUser)\n  const [ localLoginModalOpen, setLocalLoginModalOpen ] = useState(false)\n  const [ localPurchaseModalOpen, setLocalPurchaseModalOpen ] = useState(false)\n  const [ localZoom, setLocalZoom ] = useState(1)\n  if (!currentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n  if (!itemToUnlock) {\n    itemToUnlock = localItemToUnlock\n    setItemToUnlock = setLocalItemToUnlock\n  }\n  if ('undefined' === typeof loginModalOpen) {\n    logg('it was undefined')\n    loginModalOpen = localLoginModalOpen\n    setLoginModalOpen = setLocalLoginModalOpen\n  }\n  if ('undefined' === typeof purchaseModalOpen) {\n    purchaseModalOpen = localPurchaseModalOpen\n    setPurchaseModalOpen = setLocalPurchaseModalOpen\n  }\n  if ('undefined' === typeof zoom) {\n    // logg('no props.zoom?!')\n    zoom = localZoom\n    setZoom = setLocalZoom\n  }\n\n  return <ThemeProvider theme={S.lightTheme}>\n    <Router history={history} >\n      <TwofoldContextProvider {...{\n        // bottomDrawerOpen, setBottomDrawerOpen,\n        currentUser, setCurrentUser,\n        itemToUnlock, setItemToUnlock,\n        // layout, setLayout,\n        loginModalOpen, setLoginModalOpen,\n        purchaseModalOpen, setPurchaseModalOpen,\n        // showUrl, setShowUrl,\n        zoom, setZoom,\n      }} >\n        { props.children }\n        {/* <LoginModal /> */}\n      </TwofoldContextProvider>\n    </Router>\n  </ThemeProvider>\n}\n\nexport default AppMock\n","\nconst AppRouter = {\n\n  cityVenuesPath: (slug) => `/en/cities/travel-to/${slug}/venues`,\n  cityPath: (slug) => `/en/cities/travel-to/${slug}`,\n\n};\n\nexport default AppRouter;\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport {\n  C, CollapsibleContext,\n  logg,\n  S,\n  WBordered, WBorderedItem,\n} from '$shared'\n\nconst Gt = () => <span>&nbsp;&gt;&nbsp;&nbsp;</span>\n\nconst Inner = styled.div`\n  // border: 2px solid red;\n  // max-height: 100vh;\n\n  clear: left;\n`;\n\nconst Lt = () => <span>&nbsp;&lt;&nbsp;&nbsp;</span>\n\nconst Label = styled.div`\n  display: flex;\n  margin-bottom: ${p => p.theme.borderWidth};\n  color: ${p => p.theme.colors.text};\n`;\n\nconst WTransparent = styled.div`\n  background: ${p => p.theme.colors.background};\n  padding: 0 .5em .5em .5em;\n`;\nconst W = ({ children, variant, ...props }) => {\n  switch (variant) {\n    case C.variants.bordered:\n      return <WBordered {...props} >{children}</WBordered>\n    default:\n      return <WTransparent {...props} >{children}</WTransparent>\n  }\n}\n\n\n/**\n * Collapsible\n *\n * @TODO: test-driven _vp_ 2021-10-29\n */\nconst Collapsible = ({ children, ...props }) => {\n  // logg(props, 'Collapsible')\n  const {\n    className='', config, variant,\n  } = props\n\n  const ctx = useContext(CollapsibleContext)\n  if (!ctx) { return null }\n  const { collapsibles, setCollapsibles } = ctx\n\n  const doToggle = () => setCollapsibles({ ...collapsibles, [props.slug]: !collapsibles[props.slug] })\n\n  const collapsible = typeof config === 'undefined' ? true\n    : typeof config.collapsible === 'undefined' ? true\n      : config.collapsible\n  const folded = false // collapsible ? !!collapsibles[props.slug] : false\n\n  return <W variant={variant} className={`Collapsible ${className}`} >\n    { props.label &&  collapsible && <Label onClick={doToggle} >{folded ? <Lt /> : <Gt />} {props.label}</Label> }\n    { props.label && !collapsible && <Label >{props.label}</Label> }\n    { !folded && <Inner>{ children }</Inner> }\n  </W>\n}\n\nCollapsible.propTypes = {\n  className: PropTypes.string,\n  config: PropTypes.shape({\n    collapsible: PropTypes.bool,\n  }),\n  label: PropTypes.string,\n  slug: PropTypes.string.isRequired,\n  variant: PropTypes.string,\n}\nexport default Collapsible\n","import axios from \"axios\";\nimport config from \"config\";\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings);","\n/**\n * Style Constants\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  smallWidth: '10px',\n  mediumWidth: '20px',\n\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    border: 'black',\n    blue: '#6aa3e9',\n    cardBackground: 'white',\n    cyan: \"#49bcc6\",\n    darkGrey: '#605d5d',\n    gold: '#ffe100',\n    lightGrey: '#988b8b',\n    red: 'red',\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    border: 'white',\n    blue: '#73b0fa',\n    cardBackground: '#1a1a1a',\n    cyan: \"#49bcc6\",\n    darkGrey: '#b3afaf',\n    gold: '#ffe100',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}\n","import { useLayoutEffect, useState, } from 'react'\n\n/**\n * useWindowSize\n */\nconst useWindowSize = () => {\n  const [size, setSize] = useState([0, 0]);\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    window.addEventListener('resize', updateSize);\n    updateSize();\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n  return size;\n}\n\nexport default useWindowSize\n","/*\n *  $shared / index\n */\n// alphabetized\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useContext, useEffect, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport C from \"./C\"\nimport { default as TwofoldContext } from './TwofoldContext'\nimport { TwofoldContextProvider } from './TwofoldContext'\n\n/* A */\nimport useApi from \"./Api\"\nexport { default as useApi } from \"./Api\"\nexport { default as AppMock } from \"./AppMock\"\nexport { default as AppRouter } from \"./AppRouter\"\n\n/* B */\n\n/**\n * Back Button\n */\nconst BackIcon = styled(IonIcon)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'BackBtn usedContext')\n\n  const onClick = () => {\n    setShowItem(null)\n    history.goBack()\n  }\n\n  return <BackIcon className=\"BackBtn\"\n    icon={arrowBack}\n    onClick={onClick}\n  ></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n\n  padding: .3em 1em;\n  cursor: pointer;\n`;\n\n\n/* C */\n\nexport { C }\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * A Card\n */\nconst _Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: ${p => p.theme.smallWidth};\n  background: ${p => p.theme.colors.cardBackground};\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\nexport const Card = ({ children, ..._props }) => {\n  logg(_props, 'Card')\n  const { navigateToItem, ...props } = _props\n  return <_Card className=\"Card\" {...props}>{ children }</_Card>\n}\n\nexport { default as Collapsible } from \"./Collapsible\"\nexport const CollapsibleContext = React.createContext({})\n/**\n * @TODO: test-driven\n */\nexport const CollapsibleContextProvider = ({ children, ...props }) => {\n  // logg(props, 'CollapsibleContextProvider')\n\n  let defaultCollapsibles = {\n    [C.collapsible.descr]: true,\n  }\n  let tmp\n  if (tmp = localStorage.getItem(C.collapsibles)) {\n    try {\n      defaultCollapsibles = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'Could not parse collapsibles from localStorage')\n    }\n  }\n  const [ collapsibles, _setCollapsibles ] = useState(defaultCollapsibles)\n  const setCollapsibles = (m) => {\n    localStorage.setItem(C.collapsibles, JSON.stringify(m))\n    _setCollapsibles(m)\n  }\n\n  return <CollapsibleContext.Provider value={{\n    collapsibles, setCollapsibles,\n  }} >{ children }</CollapsibleContext.Provider>\n}\n\n/* D */\n\n/* F */\n\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  classify: (m) => {\n    if (m.slice(-3)==='ies') {\n      m = m.slice(0, -3) + 'y'\n    }\n    if (m.slice(-1)==='s') {\n      m = m.slice(0, -1)\n    }\n    const ms = m.split('_')\n    for (var i = 0; i < ms.length; i++) {\n      ms[i] = ms[i].charAt(0).toUpperCase() + ms[i].slice(1)\n    }\n    return ms.join(\"\")\n  },\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg_android = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nconst logg2 = logg\nconst logg4 = logg\nconst logga = logg_android\nexport {\n  logg,\n  logg2,\n  logg4,\n  logga,\n};\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* P */\nexport const PurchasedIcon = () => {\n  return <div className=\"PurchasedIcon\">[purchased]</div>\n}\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\nexport { TwofoldContext, TwofoldContextProvider }\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered.\n * Used in collapsibles and MarkersList\n *\n * This expects a list? _vp_ 2021-11-02\n */\nconst _WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n\n  margin-bottom: 1em;\n  padding: .5em;\n\n  cursor: ${p => p.onClick ? 'pointer' : null};\n`;\nexport const WBordered = ({ children, ...props }) => {\n  return <_WBordered {...props} >{children}</_WBordered>\n}\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nconst _WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\nexport const WBorderedItem = ({children, ...props}) => {\n  return <_WBorderedItem className=\"WBorderedItem\" {...props}>{children}</_WBorderedItem>\n}\n\n\nexport const WidgetContainer = ({ children, ..._props }) => {\n  const { className='', ...props } = _props\n  return <WBordered className={`${className} WidgetContainer`} {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","import { IonPage, IonLoading, IonContent, IonIcon as _IonIcon } from '@ionic/react';\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons';\nimport React, { Fragment as F, useEffect, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from 'styled-components'\n\nimport { useApi, AppRouter,\n  logg, // eslint-disable-line no-unused-vars\n  Wrapper } from \"$shared\"\nimport \"./Cities.module.scss\"\n\nconst Counts = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  margin: 1em 0px;\n`;\n\nconst Count = styled.div`\n  // border: 1px solid red;\n\n  display: flex;\n  justify-content: center;\n\n  width: 50%;\n  text-align: center;\n  position: relative;\n  padding: 0.1em;\n`;\n\nconst IonIcon = styled(_IonIcon)`\n  font-size: 2em;\n  color: ${p=>p.theme.darkGrey};\n`;\n\nconst Number = styled.div`\n  // border: 1px solid green;\n\n  padding: 0.5em;\n\n  color: ${p=>p.theme.lightGrey};\n  font-size: 0.9em;\n  font-weight: 600;\n`;\n\nconst Cities = (props) => {\n  const [cities, setCities] = useState([]);\n  const [filteredCities, setFilteredCities] = useState([]);\n  const [showLoading, setShowLoading] = useState(false);\n  const api = useApi()\n  const history = useHistory()\n\n  useEffect(() => {\n    setShowLoading(true);\n    api.getCities().then(res => {\n      setShowLoading(false);\n      setFilteredCities(res);\n      setCities(res);\n    });\n  }, [])\n\n  const filterHandler = (ev) => {\n    let filteredCities = cities.filter(city => {\n      return city.name.toLowerCase().indexOf(ev.target.value.trim().toLowerCase()) > -1;\n    });\n    setFilteredCities(filteredCities);\n  }\n\n  return <F>\n    <Wrapper className='cities' >\n      <h1 className=\"heading\" >Cities</h1>\n\n      <div className=\"filter-section\">\n        <input className=\"filter-input\" onChange={filterHandler} />\n        <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n      </div>\n\n      { /* @TODO: re-add! */ }\n      { /* <div className=\"bookmark-section\">\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={() => { }} checked />\n          <span className=\"slider round\"></span>\n        </label>\n        <span className=\"bookmark-text\">Show only bookmarked</span>\n      </div> */ }\n\n      <div className=\"container\">\n        { filteredCities.map((city, i) => <div key={i} className=\"cities\" onClick={() => history.push(AppRouter.cityPath(city.slug)) } >\n            <div className=\"img-section\">\n              <span className=\"bookmark\" >\n                <IonIcon className=\"bookmark-icon\" icon={bookmark}></IonIcon>\n              </span>\n              <img className=\"city-img\" src={city.photo} />\n              <span className=\"city-title\">{city.name}</span>\n            </div>\n            <Counts>\n              <Count>\n                { /* @TODO: wire in theme provider */ }\n                <Number >{city.n_reports}</Number>\n                <IonIcon icon={newspaperOutline}></IonIcon>\n\n              </Count>\n              <Count>\n\n                <Number >{city.n_galleries}</Number>\n                <IonIcon icon={image}></IonIcon>\n              </Count>\n              <Count>\n\n                <Number >{city.n_videos}</Number>\n                <IonIcon icon={videocam}></IonIcon>\n              </Count>\n            </Counts>\n          </div>\n        ) }\n      </div>\n      &nbsp;\n    </Wrapper>\n\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </F>\n}\n\nexport default Cities;\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\nimport { NewsitemContainer } from './'\n\nimport \"./Newsitems.module.scss\"\n\nconst Images = styled.div`\n  // border: 1px solid red;\n\n  position: relative;\n  width: 100%;\n  max-width: 600px;\n  height: 0;\n  padding-bottom: min( 400px, 66.66% );\n\n  margin: auto;\n`;\n\nconst Thumb0 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 1px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n\n  width: 66.66%;\n  height: 0;\n  padding-bottom: 66.66%;\n\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst Thumb1 = styled.div`\n  // background: #660000;\n\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 0 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 0;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  background-color: #dedede; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst _Thumb2 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 50%;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n\n  background-color: #c4c4c4; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\nconst Thumb2 = ({ children, src, ...props }) => {\n  return <_Thumb2\n    style={{ background: src }}\n  ><div style={{ marginTop: 'calc( 50% - 0.5em )' }} >{children}</div></_Thumb2>\n}\n\n/**\n * NewsitemGallery\n */\nconst NewsitemGallery = (props) => {\n  // logg(props, 'NewsitemGallery')\n  const { item, variant } = props\n\n  const navigateToItem = () => {\n    toast('this click is not implemented!')\n    logg('not implemented')\n  }\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <Images className='Images' onClick={navigateToItem} >\n      <Thumb0 src={item.photos[0] && item.photos[0].thumb_url} />\n      <Thumb1 src={item.photos[1] && item.photos[1].thumb_url} />\n      <Thumb2 src={item.photos[2] && item.photos[2].thumb_url} >({item.n_photos} photos)</Thumb2>\n    </Images>\n  </NewsitemContainer>\n}\nNewsitemGallery.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired,\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemGallery\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { NewsitemContainer } from './'\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\nconst ImageLarge = styled.img`\n  max-width: 100%;\n`;\n\nconst W = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\n/**\n * default\n */\nconst NewsitemPhoto = (props) => {\n  // logg(props, 'NewsitemPhoto')\n  const { item, variant } = props\n\n  return <NewsitemContainer className='Newsitem NewsitemPhoto' {...{ item, variant }} >\n    <W>\n      { item.photos[0] && <ImageLarge src={item.photos[0].large_url} /> }\n    </W>\n  </NewsitemContainer>\n}\n\nNewsitemPhoto.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired, // @TODO: this is wrong, just show one photo\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemPhoto\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon, NewsitemContainer } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, C, logg, request, TwofoldContext } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\n\nconst NewsitemReport = (props) => {\n  // logg(props, \"NewsitemReport\");\n  const { item, variant, } = props\n  return (<NewsitemContainer item={item} variant={variant} />)\n}\n\nNewsitemReport.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemReport\n\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { NewsitemContainer } from \"./\"\n\nimport \"./Newsitems.module.scss\"\n\n/**\n * NewsitemVideo\n *\n**/\nconst NewsitemVideo = (props) => {\n  // logg(props, 'NewsitemVideo')\n  const { item, variant } = props\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <div style={{ display: 'flex', justifyContent: 'center' }} >\n      { item.youtube_id ?\n          <iframe className=\"iframe\" width=\"100%\" height=\"315\" src={`https://www.youtube.com/embed/${item.youtube_id}`} frameBorder=\"0\" allow=\"autoplay; encrypted-media\" allowFullScreen></iframe>\n          : <video style={{ maxWidth: '100%', maxHeight: '50vh' }}  preload=\"metadata\" height=\"auto\" controls><source src={item.url} type=\"video/mp4\" /></video>\n      }\n    </div>\n  </NewsitemContainer>\n}\n\nNewsitemVideo.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemVideo","\nimport PropTypes from 'prop-types'\nimport React, { useContext, } from \"react\"\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport { GenericNewsitem } from \"./\"\nimport NewsitemGallery from \"$components/newsitems/NewsitemGallery\"\nimport NewsitemReport from \"$components/newsitems/NewsitemReport\"\nimport NewsitemPhoto from \"$components/newsitems/NewsitemPhoto\"\nimport NewsitemVideo from \"$components/newsitems/NewsitemVideo\"\nimport {\n  Btn,\n  C,\n  logg,\n  TwofoldContext,\n  useApi,\n} from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\nconst ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nconst W0 = styled.div`\n`;\n\nconst W1 = styled.div`\n  position: relative;\n`;\n\nconst _EditModeActions = styled.div`\n  position: absolute;\n  right: 1em;\n  top: 1em;\n  z-index: 2;\n`;\nconst EditModeActions = ({ children, ...props }) => {\n  // logg(props, 'EditModeActions')\n  const { item } = props\n\n  const {\n    editorMode,\n  } = useContext(TwofoldContext)\n\n  if (!editorMode) { return null }\n\n  const api = useApi()\n\n  const removeStory = (e) => {\n    if (!confirm('Are you sure?')) { return }\n    api.deleteNewsitem({ id: item.newsitem_id }).then((resp) => {\n      toast('Removed the story')\n    }).catch((err) => {\n      logg('320 - cannot delete newsitem')\n    })\n  }\n\n  return <_EditModeActions>\n\n    <Btn onClick={removeStory} >\n      Remove Story\n    </Btn>\n\n  </_EditModeActions>\n}\n\n/**\n * Newsitems\n**/\nconst Newsitems = (props) => {\n  // logg(props, 'Newsitems')\n  const { newsitems=[], variant } = props\n\n  if (!newsitems.length) { return <div>No Newsitems</div> }\n\n  return (\n    <W0 className=\"Newsitems\" {...{ variant }} >\n      { newsitems.map((newsitem, idx) => {\n        const premium_tier = newsitem.premium_tier || 0\n        const icon = ICONS[premium_tier]\n        let item\n\n        switch (newsitem.item_type) {\n          case C.item_types.gallery:\n            item = <NewsitemGallery item={newsitem} variant={variant} />\n            break\n          case C.item_types.report:\n            item = <NewsitemReport  item={newsitem} variant={variant} />\n            break\n          case C.item_types.video:\n            item = <NewsitemVideo   item={newsitem} variant={variant} />\n            break\n          case C.item_types.photo:\n            item = <NewsitemPhoto   item={newsitem} variant={variant} />\n            break\n          default:\n            item = <GenericNewsitem item={newsitem} />\n        }\n\n        return (\n          <W1 key={idx} className={`premium-${premium_tier}`} >\n            <EditModeActions item={newsitem} />\n            { item }\n          </W1>\n        )\n      }) }\n    </W0>\n  )\n}\n\nNewsitems.propTypes = {\n  newsitems: PropTypes.array.isRequired,\n  variant: PropTypes.string,\n}\nexport default Newsitems\n","\nimport React, { useContext, useEffect, useState } from 'react'\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  FlexCol, FlexRow,\n  logg,\n} from 'ishlibjs'\n\nimport {\n  C,\n  TwofoldContext,\n  useApi,\n} from \"$shared\"\n\nconst _IconUp = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n      width=\"20px\" height=\"20px\" viewBox=\"0 0 124.138 124.138\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.138 124.138' }}\n    >\n      <g><path d=\"M50.569,124.138h23.1c4.7,0,9-3.8,9-8.601V81.138c0-4.7,3.5-9,8.2-9h14.699c7.2,0,11.2-8.101,6.801-13.8l-44.101-55\n     c-3.5-4.5-10.2-4.4-13.6,0l-42.9,55c-4.4,5.699-0.4,13.8,6.8,13.8h14.8c4.7,0,8.3,4.2,8.3,9v34.399\n     C41.669,120.338,45.769,124.138,50.569,124.138z\"/></g>\n      <g></g><g></g><g></g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n   </svg>\n </div>\n}\nconst IconUp = styled(_IconUp)`\n  cursor: pointer;\n`;\n\n\nconst _IconDown = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n\t    width=\"20px\" height=\"20px\" viewBox=\"0 0 124.075 124.075\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.075 124.075' }}\n\t  >\n      <g><path d=\"M54.628,120.7c3.5,4.5,10.2,4.5,13.601,0l44.1-54.9c4.4-5.7,0.4-13.8-6.8-13.8h-14.7c-4.7,0-8.2-4.2-8.2-9V8.6\n\t\tc0-4.8-4.2-8.6-9-8.6h-23.1c-4.8,0-8.9,3.8-8.9,8.6V43c0,4.7-3.6,9-8.3,9h-14.8c-7.1,0-11.2,8-6.8,13.7L54.628,120.7z\"/>\n      </g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </div>\n}\nconst IconDown = styled(_IconDown)`\n  cursor: pointer;\n`;\n\nconst WCount = styled.div`\n  text-align: center;\n`;\n\n/**\n * Votable\n *\n**/\nconst Votable = (props) => {\n  // logg(props, 'Votable')\n  const { item } = props\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'Votable Used AuthContext')\n\n  const api = useApi()\n\n  const [ votesScore, setVotesScore ] = useState('undefined' === typeof item.votes_score ? '-' : item.votes_score)\n  const [ upFill, setUpFill ] = useState(\"#cecece\")\n  const [ downFill, setDownFill ] = useState(\"#cecece\")\n\n  const [ currentUserVoteValue, setCurrentUserVoteValue ] = useState(item.current_user_vote_value)\n  useEffect(() => {\n\n    // logg(currentUserVoteValue, 'currentUserVoteValue')\n    // logg(C.vote_values.up, 'one?')\n    // logg(C.vote_values.down, 'two?')\n    // logg(currentUserVoteValue === C.vote_values.up, 'three?')\n    // logg(currentUserVoteValue === C.vote_values.down, 'four?')\n\n\n    if (currentUserVoteValue === C.vote_values.up) {\n      setUpFill('#cc3333')\n      setDownFill('#cecece')\n    }\n    if (currentUserVoteValue === C.vote_values.down) {\n      setUpFill('#cecece')\n      setDownFill('#cc3333')\n    }\n  }, [currentUserVoteValue])\n\n\n  const voteUp = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.up) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n\n      api.vote({\n        value: C.vote_values.up,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'upvoted')\n        setUpFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.up)\n        if (currentUserVoteValue === C.vote_values.down) {\n          setDownFill('#cecece')\n          setVotesScore(votesScore + 2)\n        } else {\n          setVotesScore(votesScore + 1)\n        }\n      })\n\n      // api.vote({\n      //   value: C.vote_values.up,\n      //   votee_class_name: item.item_type, // eg Video\n      //   votee_id: item.id,\n      //   voter_id: currentUser.id,\n      // })\n    }\n  }\n  const voteDown = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.down) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n      api.vote({\n        value: C.vote_values.down,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'downvoted')\n        setDownFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.down)\n        if (currentUserVoteValue === C.vote_values.up) {\n          setUpFill('#cecece')\n          setVotesScore(votesScore - 2)\n        } else {\n          setVotesScore(votesScore - 1)\n        }\n      })\n    }\n  }\n\n  return <FlexCol>\n    <IconUp onClick={voteUp} width={20} height={20} fill={upFill} />\n    <WCount>{ votesScore}</WCount>\n    <IconDown onClick={voteDown} width={20} height={20} fill={downFill} />\n  </FlexCol>\n}\nVotable.propTypes = {\n\n};\n\nexport default Votable\n","\nimport Votable from './Votable'\nexport default Votable\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory, } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport {\n  ItemIcon,\n} from \"./\"\nimport {\n  Metaline,\n} from \"$components/application\"\nimport Votable from \"$components/Votable\"\nimport {\n  C, Card,\n  inflector,\n  logg,\n  request,\n  TwofoldContext,\n  WidgetContainer,\n} from \"$shared\"\n\n// alphabetized\n\nconst Col = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst _Row = styled.div`\n  display: flex;\n  align-items: flex-start;\n\n  margin-top: ${p=>p.theme.smallWidth};\n`;\nconst Row = ({ children, ...props }) => <_Row className='Row' {...props}>{children}</_Row>\n\nconst RowInline = styled.div`\n  > * {\n    display: inline;\n  }\n`;\n\nconst Title = styled.h2`\n  margin-top: 0;\n  margin-bottom: 0;\n  color: ${p=>p.theme.colors.text};\n`;\n\n// @TODO: better management of navigateToItem\nconst W0 = (props) => {\n  // logg(props, 'W0')\n  const { children, navigateToItem, variant } = props\n\n  switch (variant) {\n    case C.variants.bordered:\n      return <WidgetContainer {...props} cursor=\"pointer\" >{ children }</WidgetContainer>\n    default:\n      return <Card boxShadow={2} {...props} onClick={navigateToItem} cursor=\"pointer\" ></Card>\n  }\n}\n\n\n\n/**\n * NewsitemContainer\n *\n * @TODO: should be config with variants: standard container, container for a single photo, etc.\n * but for now I'll use item.item_type\n * _vp_ 2022-03-13\n *\n**/\nconst NewsitemContainer = ({ children, ...props }) => {\n  // logg(props, 'NewsitemContainer')\n  const {\n    className,\n    item,\n    variant,\n  } = props\n  const { item_type, slug } = item\n\n  const history = useHistory()\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    layout,\n    location,\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'NewsitemContainerUsedContext')\n\n  // @TODO: move this elsewhere - make generic, remember there are two routers, internal and external.\n  // move this to internal router\n  // @TODO: for Photo, navigateToItem can show full-screen pic. _vp_ 2022-04-17\n  const navigateToItem = () => {\n    if (item.is_premium && !item.is_purchased) {\n      setItemToUnlock(item)\n    } else {\n      if (layout === C.layout_mapui) {\n        history.push(`/en/locations/show/${location.slug}/${inflector.tableize(item_type)}/show/${slug}`)\n      } else {\n        history.push(`/en/${inflector.tableize(item_type)}/show/${slug}`)\n      }\n    }\n  }\n\n  if (item.item_type === C.item_types.photo) {\n\n    return <W0 {...{ className, navigateToItem: () => {}, variant }} >\n      <Col>\n        <Title>{item.name}</Title>\n        <Metaline {...item} />\n      </Col>\n      { children }\n    </W0>\n\n  } else {\n    return <W0 {...{ className, navigateToItem, variant }} >\n      { children }\n      <Row >\n        <Col style={{ alignItems: 'center' }} >\n          <Votable item={item} />\n        </Col>\n        <Col style={{ overflowWrap: 'break-word' }} >\n          <RowInline>\n            <ItemIcon {...item} />\n            <Title onClick={navigateToItem} >{item.name}</Title>\n          </RowInline>\n          <Metaline {...item} />\n        </Col>\n      </Row>\n      { item.subhead && item.subhead.length && <p className=\"subhead\" dangerouslySetInnerHTML={{ __html: item.subhead }} /> }\n    </W0>\n  }\n}\nNewsitemContainer.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemContainer\n","\nimport * as Ic from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport styled, { useTheme } from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\nconst ReportIcon = () => <div>@TODO: ReportIcon</div>\n\nconst _Icon = styled.span`\n  margin: 0 ${p => p.theme.smallWidth} 0 0;\n`;\n\nconst IconGallery = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n      viewBox=\"0 0 45.964 45.964\" style={{ enableBackground: 'new 0 0 45.964 45.964' }}\n    ><g><g><path d=\"M7.071,30.834V11.062H4.042C1.803,11.062,0,12.893,0,15.13v26.732c0,2.24,1.803,4.051,4.042,4.051h26.733    c2.238,0,4.076-1.811,4.076-4.051v-2.92H15.179C10.733,38.943,7.071,35.281,7.071,30.834z\"/>   <path d=\"M41.913,0.05H15.179c-2.238,0-4.066,1.813-4.066,4.051v26.733c0,2.241,1.829,4.067,4.066,4.067h26.734    c2.237,0,4.051-1.826,4.051-4.067V4.102C45.964,1.862,44.15,0.05,41.913,0.05z M41.363,28.589    c-0.223,0.412-0.652,0.656-1.12,0.656H17.336c-0.403,0-0.782-0.18-1.022-0.502c-0.24-0.324-0.313-0.736-0.197-1.123l3.277-10.839    c0.216-0.713,0.818-1.24,1.554-1.361c0.736-0.12,1.476,0.19,1.908,0.797l4.582,6.437c0.617,0.867,1.812,1.082,2.689,0.484    l4.219-2.865c0.434-0.295,0.967-0.402,1.48-0.299c0.515,0.102,0.966,0.408,1.253,0.848l4.229,6.472    C41.564,27.687,41.585,28.179,41.363,28.589z\"/>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\nconst IconGem = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.gold\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg viewBox=\"0 -32 576 576\" xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n    ><path d=\"M485.5 0L576 160H474.9L405.7 0h79.8zm-128 0l69.2 160H149.3L218.5 0h139zm-267 0h79.8l-69.2 160H0L90.5 0zM0 192h100.7l123 251.7c1.5 3.1-2.7 5.9-5 3.3L0 192zm148.2 0h279.6l-137 318.2c-1 2.4-4.5 2.4-5.5 0L148.2 192zm204.1 251.7l123-251.7H576L357.3 446.9c-2.3 2.7-6.5-.1-5-3.2z\"/>\n    </svg>\n  </_Icon>\n}\n\nconst IconGlasses = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.cyan\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGlasses'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 297 297\"\n      style={{ enableBackground: 'new 0 0 297 297' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M115.167,101.47H24.012C10.751,101.469,0,112.22,0,125.482v43.477c0,14.674,11.896,26.57,26.57,26.57h39.67     c21.977,0,41.223-14.737,46.954-35.953l10.297-45.336c0.633-3.567-0.276-7.232-2.431-9.804     C120.132,103.328,118.132,101.47,115.167,101.47z M24.542,138.106c-1.945,0-3.888-0.742-5.373-2.225     c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747     l-5.428,5.428C28.432,137.364,26.487,138.106,24.542,138.106z M64.111,130.453l-21.71,21.71     c-1.484,1.483-3.429,2.225-5.374,2.225c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71     c2.968-2.966,7.779-2.966,10.747,0C67.078,122.674,67.078,127.485,64.111,130.453z\"/>    <path d=\"M160.885,106.524h-26.517c0.575,3.345,0.587,6.828-0.021,10.307l-2.22,12.693h31l-2.22-12.693     C160.299,113.352,160.311,109.868,160.885,106.524z\"/>    <path d=\"M272.988,101.47h-94.649c-2.965,0-4.965,1.858-5.893,2.966c-2.155,2.572-3.064,6.236-2.43,9.804l10.296,45.336     c5.731,21.216,24.977,35.954,46.954,35.954h43.164c14.674-0.001,26.57-11.897,26.57-26.571v-43.477     C297,112.22,286.249,101.47,272.988,101.47z M192.422,135.881c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428     c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747l-5.428,5.428c-1.484,1.483-3.429,2.225-5.374,2.225     C195.851,138.106,193.906,137.364,192.422,135.881z M237.363,130.453l-21.71,21.71c-1.484,1.483-3.429,2.225-5.374,2.225     c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71c2.968-2.966,7.779-2.966,10.747,0     C240.33,122.674,240.33,127.485,237.363,130.453z\"/>   </g>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\n\nconst IconReport = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconReport'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 184.153 184.153\" style={{ enableBackground: 'new 0 0 184.153 184.153' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M129.318,0H26.06c-1.919,0-3.475,1.554-3.475,3.475v177.203c0,1.92,1.556,3.475,3.475,3.475h132.034 c1.919,0,3.475-1.554,3.475-3.475V34.131C161.568,22.011,140.771,0,129.318,0z M154.62,177.203H29.535V6.949h99.784 c7.803,0,25.301,18.798,25.301,27.182V177.203z\"/><path d=\"M71.23,76.441c15.327,0,27.797-12.47,27.797-27.797c0-15.327-12.47-27.797-27.797-27.797 c-15.327,0-27.797,12.47-27.797,27.797C43.433,63.971,55.902,76.441,71.23,76.441z M71.229,27.797 c11.497,0,20.848,9.351,20.848,20.847c0,0.888-0.074,1.758-0.183,2.617l-18.071-2.708L62.505,29.735    C65.162,28.503,68.112,27.797,71.229,27.797z M56.761,33.668l11.951,19.869c0.534,0.889,1.437,1.49,2.462,1.646l18.669,2.799    c-3.433,6.814-10.477,11.51-18.613,11.51c-11.496,0-20.847-9.351-20.847-20.847C50.381,42.767,52.836,37.461,56.761,33.668z\"/>   <rect x=\"46.907\" y=\"90.339\" width=\"73.058\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"107.712\" width=\"48.644\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"125.085\" width=\"62.542\" height=\"6.949\"/>  </g></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </_Icon>\n}\n\nconst IconVideo = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconVideo' >\n    <svg width={w} height={h} viewBox=\"0 0 33 33\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path fillRule=\"evenodd\" clipRule=\"evenodd\"\n        fill={fill}\n        d=\"M9.89989 0H29.6999C31.5149 0 32.9999 1.485 32.9999 3.3V23.1C32.9999 24.915 31.5149 26.4 29.6999 26.4H9.89989C8.08489 26.4 6.59989 24.915 6.59989 23.1V3.3C6.59989 1.485 8.08489 0 9.89989 0ZM0 6.6H3.3V29.7H26.4V33H3.3C1.485 33 0 31.515 0 29.7V6.6ZM29.7 23.1H9.89997V3.3H29.7V23.1ZM16.5001 20.625V5.775L26.4001 13.2L16.5001 20.625Z\" />\n    </svg>\n  </_Icon>\n}\n\nconst _W0 = styled.div`\n  // border: 1px solid red;\n\n  display: inline;\n  box-sizing: border-box;\n`;\nconst W0 = ({ children, ...props }) => <_W0 className='ItemIcon' {...props}>{children}</_W0>\n\n/**\n * Displays the appropriate icon.\n *\n * @param [Boolean] props.isPurchased\n * @param [Number] props.premiumTier\n * @param [String] props.kind\n */\n export const ItemIcon = (props) => {\n  // logg(props, \"ItemIcon\")\n  const { is_purchased, item_type, premium_tier } = props\n\n  const out = []\n\n  if (premium_tier > 0) {\n    if (is_purchased) {\n      out.push(<IconGlasses key='IconGlasses' />)\n    } else {\n      out.push(<IconGem key='IconGem' />)\n    }\n  }\n  switch (item_type) {\n    case C.item_types.gallery:\n      out.push(<IconGallery key='IconGallery' />)\n      break\n    case C.item_types.report:\n      out.push(<IconReport key='IconReport' />)\n      break\n    case C.item_types.video:\n      out.push(<IconVideo key='IconVideo' />)\n      break\n    default:\n      out.push(<span key='unknown-kind'>[&nbsp;?&nbsp;]</span>)\n  }\n  return <W0>{out}</W0>\n}\nItemIcon.propTypes = {\n  is_purchased: PropTypes.bool, // .isRequired,\n  item_type: PropTypes.string.isRequired,\n  premium_tier: PropTypes.number,\n}\nexport default ItemIcon\n","/*\n * $components / newsitems / index.jsx\n */\nimport React, { Fragment as F, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { Box, inflector, logg } from \"$shared\"\n\n/* G */\n\nexport const GenericNewsitem = (props) => {\n  // logg(props, 'GenericNewsitem')\n  const { item } = props\n\n  return <F>\n    generic newsitem\n    <div dangerouslySetInnerHTML={{ __html: item.description }} />\n  </F>\n}\n\n/* N */\nexport { default as NewsitemGallery } from \"./NewsitemGallery\"\nexport { default as NewsitemPhoto } from \"./NewsitemPhoto\"\nexport { default as NewsitemReport } from \"./NewsitemReport\"\nexport { default as Newsitems } from \"./Newsitems\"\nexport { default as NewsitemContainer } from \"./NewsitemContainer\"\n\n\n\n/* I */\nexport const ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nexport { default as ItemIcon } from \"./ItemIcon\"\n\n/* V */\n\n","import { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport { IonPage, IonContent, IonButton, IonImg, IonIcon } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Rating } from \"$components/application\"\n\nimport \"./Venues.module.scss\"\n\nconst Address = styled.p`\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: ${p => p.theme.darkGrey };\n  font-size: 14px;\n`;\n\nconst Col = styled.div``;\n\n// right arrow container\nconst _Ra = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\nconst RightArrow = () => <_Ra><img className=\"forward-arrow\" src=\"/assets/16x16/arrow-right.png\" /></_Ra>\n\nconst Row = styled.div`\n  display: flex;\n`;\n\nconst Title = styled.div`\n  font-size: 1.5em;\n`;\n\nconst Venue = styled.div`\n  width: 100vw;\n  padding: 1em;\n  margin-bottom: 0.5em;\n  border-bottom: 1px solid #e3d3d3;\n  box-shadow: 0px 1px 5px 1px #b3aeae;\n  background-color: white;\n  position: relative;\n\n  display: flex;\n  justify-content: space-between;\n\n  img.thumb {\n    border-radius: 10px;\n  }\n\n  > div {\n    // border: 1px solid red;\n  }\n`;\n\nconst Venues = (props) => {\n  logg(props, 'Venues')\n\n  const defaultRating = 3.5\n  const [filteredVenues, setFilteredVenues] = useState(props.venues)\n\n  function filterHandler(ev) {\n    let venues = props.venues.filter(venue => {\n      return venue.name.toLowerCase().includes(ev.target.value.toLowerCase())\n    })\n    setFilteredVenues(venues)\n  }\n\n  return (\n    <div className=\"venues-section\">\n      <div>\n        <div className=\"filter-section\">\n          <input className=\"filter-input\" onChange={filterHandler} />\n          <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n        </div>\n      </div>\n      <div className=\"container\">\n\n        { filteredVenues.map((venue, idx) => <Venue key={idx} >\n          <Row>\n            <Col><img style={{ paddingRight: '1em' }} className='thumb' src={venue.photo} /></Col>\n            <Col>\n              <Title>{venue.name}</Title>\n              <div className=\"rating-section\">\n                <Rating rate={defaultRating}></Rating>\n                <span className=\"reviews\">5 reviews</span>\n              </div>\n              <div className=\"tags-section\">\n                { venue.tags.map((tag, idx) => <span key={idx} className=\"tags\">{tag.name}</span> )}\n              </div>\n              <p className=\"description\" dangerouslySetInnerHTML={{ __html: venue.subhead }}></p>\n              { venue.address && <Address>{venue.address}</Address> }\n            </Col>\n\n          </Row>\n          <RightArrow />\n        </Venue> )}\n\n      </div>\n    </div>\n  )\n}\n\nVenues.propTypes = {\n  venues: PropTypes.array.isRequired,\n}\nexport default Venues\n","import React, { useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react'\nimport { pin, newspaperOutline, image, videocam } from 'ionicons/icons'\n\nimport { AppRouter, useApi, logg, Wrapper } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { Venues } from \"$components/venues\"\nimport \"./Cities.module.scss\"\n\nconst CitiesShow = (props) => {\n  logg(props, 'CitiesShow')\n  const { match } = props\n\n  const api = useApi()\n  const history = useHistory()\n  const thisPath = AppRouter.cityPath(match.params.name)\n\n  const location = useLocation()\n\n  const [city, setCity] = useState(null)\n  const [showLoading, setShowLoading] = useState(false)\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    setShowLoading(true)\n    api.getCity(match.params.name).then(res => {\n      if (mountedRef.current) {\n        setCity(res.data.city)\n        setShowLoading(false)\n      }\n    })\n    return () => mountedRef.current = false\n  }, [match.params.name])\n\n  // @TODO: remove this!\n  function changeMenuHandler(menu) {\n    // history.push(`${match.url}/${menu}`);\n  }\n\n  return <Wrapper>\n\n    { city && <div className='wrapper'>\n      <div className='city-show'>\n\n        <header style={{ backgroundImage: `url(${city.hero_img}}`, backgroundSize: \"contain\" }}></header>\n\n        <section className=\"section-one\">\n          <IonIcon icon={pin} className=\"location\"></IonIcon>\n          <h1 className=\"city-name\">{city.name}</h1>\n          <div className=\"status\">\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={newspaperOutline}></IonIcon>\n              <span className=\"numbers\">{city.n_reports}</span>\n            </div>\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={image}></IonIcon>\n              <span className=\"numbers\">{city.n_galleries}</span>\n            </div>\n            <div className=\"status-grid mid\">\n              <IonIcon className=\"info-icon\" icon={videocam}></IonIcon>\n              <span className=\"numbers \">{city.n_videos}</span>\n            </div>\n          </div>\n        </section>\n\n        { /* @TODO: re-add tags here! */ }\n        { /* city.tags && <section className=\"tags-section\">\n          <span className=\"btn delete-btn\" >\n            <IonIcon name=\"close\"> </IonIcon> deselect all\n          </span>\n          { city.tags.map((tag, i) => <span className=\"btn\" key={i} >{tag.name}</span>) }\n        </section> */ }\n\n        <section className=\"section-three\">\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityPath(match.params.name))} >\n            <img src=\"/assets/newsfeed-icon.svg\" alt=\"Newsfeed\" />\n            <p className={`${location.pathname == thisPath ? \"selected\" : \"\"} menu-item`}>Newsfeed</p>\n          </div>\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityVenuesPath(match.params.name))} >\n            <img src=\"/assets/venue-icon.svg\" alt=\"Venues\" />\n            <p className={`${location.pathname.includes(\"venues\") ? \"selected\" : \"\"} menu-item`}>Venues</p>\n          </div>\n        </section>\n\n\n        <Switch>\n          <Route exact path={`${match.url}/venues`} render={() => <Venues    venues={city.venues} />} />\n          <Route exact path={match.url}             render={() => <Newsitems newsitems={city.newsitems} /> } />\n        </Switch>\n\n\n      </div>\n    </div>}\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n    <br /><br /><br />\n  </Wrapper>\n}\n\nexport default CitiesShow\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport {\n  C, logg, request, TwofoldContext, BackBtn,\n} from \"$shared\"\n\nimport styles from \"./Galleries.module.scss\"\n\nconst W0 = styled.div`\n  // border: 1px solid blue;\n  height: auto;\n`;\n\n/**\n * GalleriesShow\n *\n**/\nconst GalleriesShow = (props) => {\n  // logg(props, 'GalleriesShow')\n  const { match } = props // @TODO: this doesnt look like a prop, remove\n\n  const [showLoading, setShowLoading] = useState(false) // @TODO: hmm could it be moved to TwofoldContext ?\n  const [gallery, setGallery] = useState({})\n\n  const mountedRef = useRef('init')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n  } = useContext(TwofoldContext)\n\n  // @TODO: move this into api\n  let getGallery = async () => {\n    const token = localStorage.getItem(C.jwt_token)\n    await request.get(`/api/galleries/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (!mountedRef.current) { return }\n      const gallery = res.data.gallery\n      if (gallery.is_premium && !gallery.is_purchased) {\n        setItemToUnlock(gallery)\n      } else {\n        setGallery(res.data.gallery)\n      }\n    }).catch((err) => {\n      logg(err, 'e65')\n    })\n  }\n\n  useEffect(() => {\n    getGallery()\n    return () => {\n      mountedRef.current = null\n    }\n  }, [gallery.id, itemToUnlock.id] )\n\n  return <W0 className={styles.GalleriesShow} >\n\n    <div className={styles.narrow} >\n      <h1 className={styles.heading} >\n        <BackBtn />\n        <span className={styles.title} >{gallery.name}</span>\n      </h1>\n      <Metaline {...gallery} />\n\n      <div className={styles.thumbs} >\n        { gallery.photos && gallery.photos.map((ph, i) =>\n          <div className={styles.card} key={i}>\n            <div>\n              <IonImg src={ph.thumb_url}></IonImg>\n            </div>\n          </div>\n        ) }\n      </div>\n\n      <div dangerouslySetInnerHTML={{ __html: gallery.description }}></div>\n\n    </div>\n    <div className={styles.full_img_section} >\n\n      { gallery.photos && gallery.photos.map((ph, i) =>\n        <div className={styles.item} key={i}>\n          <img src={ph.large_url} />\n        </div>\n      ) }\n\n    </div>\n\n  </W0>\n}\n\nexport default GalleriesShow","import React, { useEffect, useState } from \"react\";\nimport { IonLoading } from \"@ionic/react\";\n\nimport request from \"$shared/request\";\nimport { logg } from \"$shared\";\nimport { Galleries } from \"./\";\nimport { NewsitemGallery } from \"$components/newsitems\";\n\nconst MyGalleries = (props) => {\n  const [galleries, setGalleries] = useState(null);\n  const [showLoading, setShowLoading] = useState(false);\n\n  useEffect(() => {\n    setShowLoading(true);\n    const token = localStorage.getItem(\"jwtToken\");\n    request.get(`/api/my/galleries`, { params: { jwt_token: token } }).then(r => {\n      logg(r.data, 'MyGalleries data')\n      setGalleries(r.data);\n      setShowLoading(false);\n    })\n  }, []);\n\n  return (<>\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n    { galleries && galleries.length && galleries.map((g) => <NewsitemGallery key={g.id} data={g} /> ) }\n  </>);\n}\n\nexport default MyGalleries;","\nimport React, {\n  useContext, useState,\n} from 'react'\nimport Modal from 'react-modal'\n\nimport {\n  MarkerContext, MarkerContextProvider,\n  MarkerForm,\n} from './'\nimport {\n  logg,\n} from '$shared'\n\nimport styles from './Markers.module.scss'\n\n/**\n * MarkerModal\n *\n * For editing/adding markers.\n**/\nconst MarkerModal = (props) => {\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n  // logg(useContext(MarkerContext), 'MarkerModalUsedContext')\n\n  return <Modal\n    className={`MarkerModal ${styles.MarkerModal}`}\n    isOpen={markerModalOpen}\n  >\n    <h1>\n      marker modal\n      <span onClick={() => setMarkerModalOpen(false)}>[x]</span>\n    </h1>\n    <MarkerForm />\n  </Modal>\n}\n\nexport default MarkerModal\nexport {\n  MarkerContext,\n  MarkerContextProvider,\n  MarkerModal,\n}\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg, S, TwofoldContext,\n  PurchasedIcon,\n  WBordered, WBorderedItem,\n} from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\n/* M */\nconst _Marker = styled.div`\n  color: ${p => p.theme.colors.text};\n\n  margin-bottom: 10px;\n  max-width: 33%;\n  min-width: 100px;\n\n  text-align: center;\n\n  width: min(33%, 100px);\n`;\nconst Marker = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBorderedItem {...props} >{children}</WBorderedItem>\n  } else {\n    return <_Marker className=\"Marker\" {...props} >{children}</_Marker>\n  }\n}\n\n/* W */\nconst _W = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  // justify-content: flex-start;\n\n  ::after {\n    content: \"\";\n    flex: auto;\n  }\n`;\nconst W = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBordered {...props}>{children}</WBordered>\n  } else {\n    return <_W {...props}>{children}</_W>\n  }\n}\n\n/**\n * Default\n */\nconst MarkersList = (props) => {\n  // logg(props, 'MarkersList')\n  const { variant } = props\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    showUrl, setShowUrl,\n  } = useContext(TwofoldContext)\n\n  const history = useHistory()\n\n  const goto = (m) => {\n    if (m.premium_tier && !m.is_purchased) {\n      setItemToUnlock({ ...m })\n    } else {\n      if (m.url) {\n        setShowUrl(m.url)\n      }\n      else {\n        history.push(`/en/locations/show/${m.slug}`)\n      }\n    }\n  }\n\n  const out = []\n  props.markers.map((m, idx) => {\n    out.push(<Marker className=\"Marker\" key={idx} variant={variant}\n      onClick={() => goto(m) }\n    >\n      <img src={m.title_img_path} /><br />\n      { m.is_purchased && <PurchasedIcon /> }\n      { m.name }\n    </Marker>)\n  })\n\n  return <W className=\"MarkersList\" >\n    {out}\n  </W>\n}\n\nMarkersList.propTypes = {\n  variant: PropTypes.string,\n}\nexport default MarkersList\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * MarkerForm\n**/\nconst MarkerForm = (props) => {\n  // logg(props, 'MarkerForm')\n  const { item } = props\n\n  return <W0>\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='name' /> destination\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        map image\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        title image\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_active' /> active?\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_public' /> public?\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='url' /> url\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nMarkerForm.propTypes = {\n};\nexport default MarkerForm\n","\nimport React, {\n  useContext, useState,\n} from 'react'\nimport Modal from 'react-modal'\n\nconst MarkerContext = React.createContext({})\nconst MarkerContextProvider = ({ children, ...props }) => {\n\n  const [ marker, setMarker ] = useState()\n  const [ markerModalOpen, setMarkerModalOpen ] = useState(false)\n\n  return <MarkerContext.Provider value={{ marker, setMarker, markerModalOpen, setMarkerModalOpen, }}\n  >{children}</MarkerContext.Provider>\n}\n\n\nexport { default as MarkerModal } from './MarkerModal'\nexport {\n  MarkerContext,\n  MarkerContextProvider,\n}\nexport { default as MarkersList } from \"./MarkersList\"\nexport { default as MarkerForm } from './MarkerForm'\n","\nimport { Wrapper, Status } from \"@googlemaps/react-wrapper\"\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  MarkerContext,\n} from '$resources/markers'\nimport {\n  C, Card,\n  logg, logg4,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\nconst Actions = styled.div`\n  border: 1px solid red;\n\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  z-index: 2;\n`;\n\n// W\nconst W0 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.background};\n\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n`;\n\nconst W1 = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n  height: 100%;\n`;\n\nconst Marker = (options) => {\n  const [marker, setMarker] = React.useState();\n\n  React.useEffect(() => {\n    if (!marker) {\n      setMarker(new google.maps.Marker());\n    }\n\n    // remove marker from map on unmount\n    return () => {\n      if (marker) {\n        marker.setMap(null);\n      }\n    };\n  }, [marker]);\n  React.useEffect(() => {\n    if (marker) {\n      marker.setOptions(options);\n    }\n  }, [marker, options]);\n  return null;\n};\n\nconst MyMap = (props) => {\n  const {\n    center, zoom,\n  } = props\n\n  const ref = useRef()\n  const [map, setMap] = React.useState()\n\n  React.useEffect(() => {\n    if (map) {\n      [\"click\", \"idle\"].forEach((eventName) =>\n        google.maps.event.clearListeners(map, eventName)\n      );\n      if (onClick) {\n        map.addListener(\"click\", onClick);\n      }\n\n      if (onIdle) {\n        map.addListener(\"idle\", () => onIdle(map));\n      }\n    }\n  }, [map, onClick, onIdle]);\n\n  useEffect(() => {\n    if (ref.current && !map) {\n      setMap(new window.google.maps.Map(ref.current, { center, zoom, }));\n    }\n  }, [ref, map]);\n\n  return <div ref={ref} id=\"GoogleMaps\" />\n}\n\nconst Spinner = () => <h1>Loading...</h1>\nconst ErrorComponent = () => <h1>No luck loading GoogleMaps</h1>\nconst render = (status) => {\n  switch (status) {\n    case Status.LOADING:\n      return <Spinner />;\n    case Status.FAILURE:\n      return <ErrorComponent />;\n    case Status.SUCCESS:\n      return <MyMap />;\n  }\n};\n\n/**\n * GoogleMaps\n *\n**/\nconst GoogleMaps = (props) => {\n  // logg(props, 'GoogleMaps')\n  const { map } = props\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'GoogleMapsUsedContext')\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n\n  const history = useHistory()\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  // logg(useWindowSize(), 'usedWindowSize')\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <W0 className=\"GoogleMaps\" >\n\n    { editorMode && <Actions>\n      <Card onClick={() => setMarkerModalOpen(true)} >\n        + Marker\n      </Card>\n    </Actions> }\n\n    <Wrapper apiKey={\"AIzaSyDTM7RYKAlUS84jN1pCmydwEKxUTAMAn6c\"} render={render} >\n\n    </Wrapper>\n  </W0>\n}\n\nexport default GoogleMaps\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * ReportForm\n**/\nconst ReportForm = (props) => {\n  // logg(props, 'ReportForm')\n  const { item } = props\n\n  return <W0>\n\n    <h1>Report Form (@TODO: remove)</h1>\n\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <textarea name='name' /> subhead\n      </FlexRow>\n\n      <FlexRow>\n        item_type: default? longscroll?\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: editable slug, the fucking slug hasn't been solved in 10 years!\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: premium tier\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: tags\n      </FlexRow>\n\n      <FlexRow>\n        public?\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nReportForm.propTypes = {\n};\nexport default ReportForm\n","\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport PropTypes from 'prop-types'\n\nimport {\n  useApi, Card as Box, logg, request\n} from \"$shared\"\n\nconst W0 = styled.div``;\n\n/**\n * ReportsShow\n**/\nconst ReportsShow = (props) => {\n  // logg(props, \"ReportsShow\")\n\n  let [ item, setItem ] = useState({})\n  let api = useApi()\n\n  useEffect(() => {\n    api.getReport(props.match.params.slug).then((data) => {\n      setItem(data)\n    }).catch((err) => {\n      logg(err, 'cannot getReport')\n    })\n  }, [])\n\n  // @TODO: logged in and no access\n\n  // @TODO: logged in and access\n\n  return (<W0>\n    {/* <Box boxShadow={2}> */}\n      <h1>{item.name}</h1>\n      <div className=\"description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n    {/* </Box> */}\n  </W0>)\n}\nReportsShow.propTypes = {\n  // none?\n};\n\n// @TODO: wrap in login HOC\nexport default ReportsShow\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useHistory, useLocation, useParams } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  Actions,\n  CloseBtn,\n} from 'ishlibjs'\n\nimport { C, logg, TwofoldContext } from \"$shared\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport {\n  ReportsForm,\n  ReportsShow,\n} from \"$resources/reports\"\n\nimport styles from './ItemModal.module.scss'\n\n/**\n * ItemModal\n * @TODO: move to $components/application ?\n * shows items, but also I use it to create reports\n *\n**/\nconst ItemModal = (props) => {\n  // logg(props, 'ItemModal')\n  const { item } = props\n\n  const params = useParams()\n  const history = useHistory()\n\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n\n  const onClose = () => {\n    history.push(config.router.locationPath(params.slug))\n    setShowItem(null)\n  }\n\n  if (!item) { return }\n  if (!item.action) { item.action = C.actions.show } // set default\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`ItemModal ${styles.ItemModal}`}\n    isOpen={!!showItem}\n    // overlayClassName={styles.LoginModalOverlay}\n    // portalClassName={styles.LoginModalPortal}\n  >\n    <Actions >\n      <CloseBtn onClick={onClose} />\n    </Actions>\n    { item.item_type === C.item_types.report && item.action === C.actions.show && <ReportsShow match={{ params: { slug: item.reportname } }} /> }\n    { item.item_type === C.item_types.report && item.action === C.actions.new && <ReportsForm /> }\n    { item.item_type === C.item_types.gallery && <GalleriesShow match={{ params: { slug: item.slug } }} /> }\n    .^.\n  </Modal>\n}\n\nexport default ItemModal\n","\nimport { Toast } from \"@capacitor/toast\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  ItemModal,\n  MapPanel, MapPanelNoZoom,\n  RatedRestrictionModal,\n  WrappedMapPanel,\n} from \"./\"\nimport {\n  Breadcrumbs,\n} from \"$components/application\"\nimport {\n  MarkersList,\n  MarkerModal, MarkerContext, MarkerContextProvider,\n} from '$resources/markers'\nimport {\n  ReportForm,\n} from '$resources/reports'\nimport { CitiesList } from \"$components/cities\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport {\n  C, Card, ChevronLeft, ChevronRight, Collapsible,\n  FlexCol, FlexRow,\n  inflector,\n  Loading, logg,\n  MenuIcon,\n  request,\n  TwofoldContext,\n  useApi, useWindowSize,\n} from \"$shared\"\n\n/* C */\n\n/* D */\n\n// @TODO: move Description into shared ?\nconst _D = styled.div`\n`;\nconst Description = ({ item={} }) => {\n  if (!item.description) { return }\n\n  return <_D className=\"Description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n/* H */\nconst WH = styled.div`\n  // border: 1px solid cyan;\n\n  position: fixed;\n  top: 5px;\n  left: ${p => p.foldedLeft\n    ? '10px'\n    : p.foldedRight\n    ? '98%'\n    : `calc(${p.twofoldPercent*100}% - 10px)` };\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  width: 30px;\n  height: 95%; /* @TODO: this needs to account for bottom being open */\n`;\nconst Handle = (props) => {\n  const [ w ] = useWindowSize()\n\n  const [ offsetX, setOffsetX ] = useState()\n  const [ dragging, setDragging ] = useState(false)\n\n  const foldLeft = () => {\n    if (folded === C.foldedRight) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedLeft)\n    }\n  }\n\n  const foldRight = () => {\n    if (folded === C.foldedLeft) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedRight)\n    }\n  }\n\n  const {\n    folded, setFolded,\n    twofoldPercent, setTwofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const onMouseDown = (e) => {\n    setDragging(true)\n    setOffsetX(e.pageX)\n  }\n\n  const onMouseMove = (e) => {\n    if (!dragging) { return }\n    if (e.clientX === 0) { return }\n    const movedBy = e.clientX - offsetX\n    if (movedBy === 0) { return }\n    const movedByPercent = movedBy/w\n    setTwofoldPercent(prev => prev + movedByPercent)\n  }\n\n  const onMouseUp = (e) => {\n    setDragging(false)\n    // document.removeEventListener('mousemove', onMouseMove)\n    // document.removeEventListener('mousedown', onMouseDown)\n  }\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  // draggable=\"true\"\n  return <WH className=\"Handle\" {...{ foldedLeft, foldedRight, twofoldPercent }}\n    onMouseMove={onMouseMove}\n    onMouseDown={onMouseDown}\n    onMouseLeave={onMouseUp}\n    onMouseUp={onMouseUp}\n    style={{\n      pointer: 'cursor',\n    }}\n  >\n    {/* <MenuIcon /> */}\n    <ChevronLeft onClick={foldLeft} />\n    <ChevronRight onClick={foldRight} />\n    { [C.foldedRight, C.foldedLeft].indexOf(folded) !== -1  && <LongLine orientation={C.vertical} /> }\n  </WH>\n}\n\n/* I */\nconst IframeModal = (props) => {\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  return (<Modal ariaHideApp={false} isOpen={!!showUrl} >\n    <span onClick={() => {  setShowUrl(false) }} >[x]</span>\n\n    <iframe height=\"100%\" style={{ width: \"100%\", height: \"100%\" }} scrolling={\"yes\"} src={props.src}\n      frameBorder=\"no\" allowtransparency=\"true\" allowFullScreen={true} >\n    </iframe>\n  </Modal>)\n}\n\n/* L */\nconst Left = styled.div`\n  background: ${p => p.theme.colors.background};\n  flex: ${p => p.foldedRight ? '99%' : `${p.twofoldPercent*100}%` };\n  overflow: hidden;\n\n  display: flex;\n  flex-direction: column;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\n\n/* R */\n\nconst Right = styled.div`\n  background: ${p => p.theme.colors.background};\n  position: relative;\n\n  padding: 0 0 0 1em;\n  flex: ${p => p.foldedRight ? '2%' : `${(1-p.twofoldPercent)*100}%` };\n  overflow-x: hidden;\n  overflox-y: auto;\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\nconst Row = styled.div`\n  // border: 1px solid magenta;\n\n  display: flex;\n  position: relative;\n`;\n\n\n/**\n * LocationsShowDesktop\n *\n * @TODO: re-introduce MenuIcon in Handle. _vp_ 2022-09-01\n**/\nconst LocationsShowDesktop = (props) => {\n  // logg(props, 'LocationsShowDesktop')\n  const { match } = props\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [ loading, setLoading ] = useState(false)\n  const [ markers, setMarkers ] = useState([])\n\n  const mountedRef = useRef('init')\n  const showItemRef = useRef('init')\n  const mapPanelRef = useRef(null)\n  const api = useApi()\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    location, setLocation,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  useEffect(() => {\n    if (location) {\n      setMarkers(location.markers)\n\n      if (location.is_premium && !location.is_purchased) {\n        setItemToUnlock({ closable: false, item_type: 'Location', ...location })\n      }\n    }\n  }, [ location ])\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // Load the map\n  // @TODO: move into api object\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n\n    // @TODO: move to Api _vp_ 2022-08-15\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) { return null }\n      if (!res.data.map) {\n        setLoading(false)\n        showToast('could not get Location')\n        return null\n      }\n\n      setLocation(res.data.map)\n      if (res.data.map.rated === C.rated.nc17 && !ratedConfirmation) { // @TODO: not test-driven, bad!\n        setRatedConfirmation(false)\n      }\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    }).catch((err) => {\n      logg(err, `Cannot get map ${match.params.slug}`)\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  // load showItem if any\n  // @TODO: this makes too many calls, improve performance\n  // @TODO: move to api\n  // @TODO: this is duplicated between LocationsShowDesktop,Mobile - consolidate!\n  useEffect(() => {\n    if (!match.params.item_type) { return }\n\n    const itemType = inflector.classify(match.params.item_type)\n    switch (itemType) {\n      case C.item_types.gallery:\n        api.getGallery(match.params.item_slug).then(setShowItem)\n        break\n      case C.item_types.report:\n        api.getReport(match.params.item_slug).then(setShowItem)\n        break\n      default:\n        logg(itemType, 'cannot get this item type')\n    }\n  }, [ match.params.item_slug, match.params.item_type ])\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  return <Row>\n    <MarkerContextProvider >\n\n    { !foldedLeft && <Left\n        className='Left'\n        {...{ bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      { <Breadcrumbs {...location} /> }\n      { location && <WrappedMapPanel\n        map={location.map ? location.map : location}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n      /> }\n    </Left> }\n\n    <Right\n        className='Right'\n        {...{\n          bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      <Handle />\n      { location && !foldedRight && <F>\n\n        { /* Markers */ }\n        { markers && markers.length && <Collapsible\n            config={{ collapsible: false }}\n            slug={C.collapsible.markers}\n            variant={C.variants.transparent}\n        >\n          <MarkersList markers={markers}\n            variant={C.variants.bordered}\n          />\n        </Collapsible> || null }\n\n        { /* Tags */ }\n        <FlexRow style={{ marginBottom: '1em', flexWrap: 'wrap' }} >\n          { location.tags.map((tag) => <Card >{tag.name}</Card> )}\n        </FlexRow>\n\n        { /* Actions */ }\n        { editorMode && <FlexRow style={{ marginBottom: '1em' }} >\n          <Card onClick={() => setShowItem({ action: C.actions.new, item_type: C.item_types.report }) } >\n            + Report\n          </Card>\n          <Card>\n            + Photo\n          </Card>\n          <Card>\n            + Gallery\n          </Card>\n          <Card>\n            + File\n          </Card>\n          {/* <Card> + Spreadsheet </Card> */}\n          <Card> + Marker </Card>\n        </FlexRow> }\n\n        { /* Description */ }\n        { location.description && <Collapsible\n            label={location.labels.description}\n            slug={C.collapsible.description}\n            variant={C.variants.bordered}\n        >\n          <Description item={location} />\n        </Collapsible> || null }\n\n        { /* Newsitems */ }\n        { location.newsitems && location.newsitems.length && <Newsitems\n            variant={C.variants.bordered} newsitems={location.newsitems}\n        /> || null }\n\n      </F> || null }\n    </Right>\n\n    { showUrl && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading && <Loading /> }\n    { !ratedConfirmation && <RatedRestrictionModal {...{ ratedConfirmation, setRatedConfirmation, }} /> }\n    { <MarkerModal /> }\n\n  </MarkerContextProvider>\n  </Row>\n}\n\nexport default LocationsShowDesktop\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  Metaline,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\nimport {\n  ItemModal,\n  MapPanel, MapPanelNoZoom,\n  WrappedMapPanel,\n} from \"./\"\nimport {\n  MarkersList,\n} from '$resources/markers'\nimport {\n  C, Collapsible, CollapsibleContext,\n  inflector,\n  Loading, logg,\n  request,\n  S,\n  TwofoldContext,\n  useApi, useWindowSize,\n  ZoomContext,\n} from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 2px solid brown;\n\n  text-align: center;\n  display: block;\n\n  position: relative; /* required for mobile, so that zoomCtrl, etc are inside the collapsible div */\n\n  overflow: scroll;\n  max-height: 80vh; // @TODO: huh?\n`;\n\nconst CollapsibleNoMargins = styled(Collapsible)`\n  margin: 0;\n  padding: 0;\n`;\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n\n  padding: 10px;\n`;\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\nconst MapWrapper = styled.div`\n  // border: 1px solid red;\n\n  position: relative;\n`;\n\n\n/* W */\n\nconst W = styled.div`\n  // border: 1px solid yellow;\n`;\n\n/* Z */\n\nconst ZoomCtrlRoot = styled.div`\n  // border: 1px solid orange;\n\n  position: absolute;\n  top: 0;\n  left: calc(100vw - 80px);\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n  z-index: 10;\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <ZoomCtrlRoot >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </ZoomCtrlRoot>\n}\n\n/**\n * LocationsShowMobile\n *\n */\nconst LocationsShowMobile = (props) => {\n  logg(props, 'LocationsShowMobile')\n  const {\n    match,\n  } = props\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    location, setLocation,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [loading, setLoading] = useState(false)\n  const api = useApi()\n\n  const mountedRef = useRef('init')\n  const mapPanelRef = useRef(null)\n  const history = useHistory()\n\n  // Get the location data\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) return null\n\n      if (!res.data.map) {\n        setLoading(false)\n        showToast('could not get Location')\n        return null\n      }\n\n      setLocation(res.data.map)\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    }).catch((e) => {\n      logg(e, 'e13')\n      history.push('/')\n    }).finally(() => {\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n\n  // @TODO: this can probably be much improved. Take either markers of location.map, or location itself.\n  // @TODO: why is this a redirect to /null ?!\n  let markers = []\n  if (location) {\n    markers = location.markers // location ? location.markers.length ? location.markers : location.map.markers : null\n  }\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  // This is to not have MapPanel, only MapPanelNoZoom on mobile _vp_ 2022-03-16\n  let map\n  if (location) {\n    map = location.map || location\n    map = { ...map, config: { ...map.config, map_panel_type: C.map_panel_types.MapPanelNoZoom } }\n  }\n\n  // load showItem if any\n  // @TODO: this makes too many calls, improve performance\n  // @TODO: move to api\n  // @TODO: this is duplicated between LocationsShowDesktop,Mobile - consolidate!\n  useEffect(() => {\n    if (!match.params.item_type) { return }\n\n    const itemType = inflector.classify(match.params.item_type)\n    switch (itemType) {\n      case C.item_types.gallery:\n        api.getGallery(match.params.item_slug).then(setShowItem)\n        break\n      case C.item_types.report:\n        api.getReport(match.params.item_slug).then(setShowItem)\n        break\n      default:\n        logg(itemType, 'cannot get this item type')\n    }\n  }, [ match.params.item_slug, match.params.item_type ])\n\n  return (<W className='LocationsShowMobile' >\n\n    { loading && <i>Loading...</i> }\n\n    { location && <Breadcrumbs {...location} /> }\n    { location && <Collapsible\n        label={location.labels.map}\n        slug={C.collapsible.map}\n    ><WrappedMapPanel\n        map={map}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n        withZoom={false}\n      />\n    </Collapsible> }\n\n    { /* Right-hand side */ }\n\n    { /* @TODO: recursively render map (not location) as appropriate all around in these collapsibles. */ }\n    { markers && markers.length && <Collapsible\n        label={location.labels.markers}\n        slug={C.collapsible.markers}\n    ><MarkersList markers={markers} />\n    </Collapsible> || null }\n\n    { location && location.description && <Collapsible\n        config={location.config.description}\n        label={location.labels.description}\n        slug={C.collapsible.description}\n    ><Description item={location} />\n    </Collapsible> || null }\n\n    { location && location.newsitems.length && <Collapsible\n        label={location.labels.newsitems}\n        slug=\"news-sec\"\n    ><Newsitems newsitems={location.newsitems} />\n    </Collapsible> || null }\n\n    { showUrl  && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading  && <Loading /> }\n\n  </W>)\n}\n\nexport default LocationsShowMobile\n","import PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { logg, TwofoldContext } from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 3px solid green;\n\n  text-align: center;\n  display: block;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\n/* Same size as the map image.\n * What scrolls is this div, not the image inside it.\n */\nconst Img = styled.div`\n  // border: 2px solid cyan;\n  display: inline-block;\n  position: relative;\n`;\n\nconst Root = styled.div`\n  border: ${p=>p.debug?'1':'0'}px solid red;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <div style={{\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    zIndex: 1,\n    background: 'white',\n    padding: '5px',\n\n    display: 'flex',\n    flexDirection: 'column',\n  }} >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </div>\n}\n\nconst MapPanel = (props) => {\n  // logg(props, 'MapPanel')\n  const { map, withZoom=true } = props\n\n  const {\n    bottomDrawerOpen, setBottomDrawerOpen,\n    showUrl, setShowUrl,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n\n  const div1Ref = useRef(null)\n\n  const history = useHistory()\n\n  useEffect(() => {\n    // div1Ref.current.scrollIntoView({ block: 'end', inline: 'center' })\n    div1Ref.current.scroll({\n      top: 200,\n      left: 200,\n      behavior: 'smooth',\n     })\n  }, [])\n\n  const markers = []\n  map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => m.url ? setShowUrl(m.url) : history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: ((m.y- m.centerOffsetY )/zoom),\n        left: ((m.x- m.centerOffsetX )/zoom),\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w/zoom}px`,\n        maxHeight: `${m.h/zoom}px`,\n        width: `${m.w/zoom}px`, height: `${m.h/zoom}px`,\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <Root {...{ bottomDrawerOpen }} debug={config.debug} className='MapPanel' >\n    { withZoom && <ZoomCtrl /> }\n\n    <Div1 {...{ bottomDrawerOpen }} >\n      <Img ref={div1Ref} style={{\n        width: `${map.w/zoom}px`,\n        height: `${map.h/zoom}px`,\n      }} >\n        <img\n          src={map.img_path}\n          style={{\n            width: `${map.w/zoom}px`,\n            height: `${map.h/zoom}px`,\n          }}\n        />\n        { markers }\n      </Img>\n    </Div1>\n\n  </Root>\n}\n\nMapPanel.propTypes = {\n  map: PropTypes.object.isRequired,\n  withZoom: PropTypes.bool, // @TODO: I don't like it, I'd like it to be inside a config obj.\n}\nexport default MapPanel\n\n\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  MarkerContext,\n} from '$resources/markers'\nimport {\n  C, Card,\n  logg, logg4,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\nconst Actions = styled.div`\n  border: 1px solid red;\n\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  z-index: 2;\n`;\n\n// W\nconst W0 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.background};\n\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n`;\n\nconst W1 = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n  height: 100%;\n`;\n\n\n/**\n * MapPanelNoZoom\n *\n * _vp_ 2021-09 @TODO: merge this into MapPanel, have zoom={false} as a prop\n * But I couldn't do it in 10 mins... It's a bit complicated?\n *\n * _vp_ 2021-10-29 But actually this component is getting more work than the zoom one right now...\n**/\nconst MapPanelNoZoom = (props) => {\n  // logg(props, 'MapPanelNoZoom')\n  const { map } = props\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'MapPanelNoZoomUsedContext')\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n\n  const history = useHistory()\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  // logg(useWindowSize(), 'usedWindowSize')\n\n\n  /*\n   * Sets the zoom (in panelNoZoom) to full-panel _vp_ 2021-10-29\n   * w: 1184 h: 819\n   */\n  useEffect(() => {\n    // logg([windowWidth, windowHeight, map.w, map.h], 'MapPanelNoZoom setting zoom')\n    if (windowWidth === 0) { return; }\n\n    let nextZoomByWidth = windowWidth/map.w // .3 mobile // 1.94 desktop\n    let nextZoomByHeight = windowHeight/map.h // .9 mobile // .82 desktop\n    // logg4([nextZoomByWidth, nextZoomByHeight], 'nextZoomOptions')\n\n    let nextZoom = Math.min(nextZoomByWidth, nextZoomByHeight)\n    const slack = 0.01 // image should not overlap with the border... 1% slack added.\n    nextZoom = nextZoom + slack\n\n    setZoom(nextZoom)\n  }, [\n    mapPanelWidth, mapPanelHeight, map.id,\n    windowWidth, windowHeight,\n  ])\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  /*\n   * @TODO: need to get the ACL from api, and use it to determine what to display or not.\n  **/\n\n  return <W0 className=\"MapPanelNoZoom W0\" >\n\n    { editorMode && <Actions>\n      <Card onClick={() => setMarkerModalOpen(true)} >\n        + Marker\n      </Card>\n    </Actions> }\n\n    <W1 className=\"W1\" >\n\n      <img\n        src={map.img_path}\n        style={{\n          // width: `${map.w*zoom}px`,\n          // height: `${map.h*zoom}px`,\n\n          maxWidth: '100%',\n          maxHeight: '100%',\n          width: 'auto',\n          height: 'auto',\n\n          position: 'relative',\n          zIndex: 0,\n        }}\n      />\n      { markers }\n    </W1>\n  </W0>\n}\n\nexport default MapPanelNoZoom\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\n/**\n * RatedRestrictionModal\n */\nconst RatedRestrictionModal = (props) => {\n  // logg(props, 'RatedRestrictionModal')\n  const { ratedConfirmation, setRatedConfirmation } = props\n\n  return <Modal isOpen={!ratedConfirmation} >\n    <p>You must be 18 years of age or older to view this content.</p>\n    <button onClick={() => setRatedConfirmation(true) } >I am over 18</button>\n    &nbsp; &nbsp;\n    <button onClick={() => window.location = 'https://disney.com' } >I am NOT over 18</button>\n  </Modal>\n};\nRatedRestrictionModal.propTypes = {\n  // ratedConfirmation, setRatedConfirmation - but maybe from a context instead?\n};\nexport default RatedRestrictionModal\n","\nimport * as React from \"react\"\nimport * as ReactDom from \"react-dom\"\nimport { Wrapper, Status } from \"@googlemaps/react-wrapper\"\n\nimport {\n  logg,\n} from '$shared'\n\nlet API_KEY\n// API_KEY = 'AIzaSyDTM7RYKAlUS84jN1pCmydwEKxUTAMAn6c'\nAPI_KEY = 'AIzaSyB8kkxbSgjmUpGmpigro-N7uXKiQmpBoyE'\n\nconst App = (props) => {\n  // logg(props, 'GoogleMaps2')\n  const {\n    map,\n  } = props\n\n  const [clicks, setClicks] = React.useState([]);\n  const [zoom, setZoom] = React.useState(12); // initial zoom\n  const [center, setCenter] = React.useState({ lat: map.x, lng: map.y })\n\n  const onClick = (e) => {\n    // avoid directly mutating state\n    // setClicks([...clicks, e.latLng]);\n  };\n\n  const onIdle = (m) => {\n    // console.log(\"onIdle\");\n    m.getZoom() && setZoom(m.getZoom());\n    m.getCenter() && setCenter(m.getCenter().toJSON());\n  };\n\n  const form = (\n    <div\n      style={{\n        display: 'none',\n\n        padding: \"1rem\",\n        flexBasis: \"250px\",\n        height: \"100%\",\n        overflow: \"auto\",\n      }}\n    >\n      <label htmlFor=\"zoom\">Zoom</label>\n      <input\n        type=\"number\"\n        id=\"zoom\"\n        name=\"zoom\"\n        value={zoom}\n        onChange={(event) => setZoom(Number(event.target.value))}\n      />\n      <br />\n      <label htmlFor=\"lat\">Latitude</label>\n      <input\n        type=\"number\"\n        id=\"lat\"\n        name=\"lat\"\n        value={center.lat}\n        onChange={(event) =>\n          setCenter({ ...center, lat: Number(event.target.value) })\n        }\n      />\n      <br />\n      <label htmlFor=\"lng\">Longitude</label>\n      <input\n        type=\"number\"\n        id=\"lng\"\n        name=\"lng\"\n        value={center.lng}\n        onChange={(event) =>\n          setCenter({ ...center, lng: Number(event.target.value) })\n        }\n      />\n      <h3>{clicks.length === 0 ? \"Click on map to add markers\" : \"Clicks\"}</h3>\n      {clicks.map((latLng, i) => (\n        <pre key={i}>{JSON.stringify(latLng.toJSON(), null, 2)}</pre>\n      ))}\n      <button onClick={() => setClicks([])}>Clear</button>\n    </div>\n  );\n\n  return (\n    <div style={{ display: \"flex\", height: \"100%\" }}>\n      <Wrapper apiKey={API_KEY} >\n        <Map\n          center={center}\n          onClick={onClick}\n          onIdle={onIdle}\n          zoom={zoom}\n          style={{ flexGrow: \"1\", height: \"100%\" }}\n        >\n          {map.markers.map((m, i) =>\n            <Marker key={i} position={{lat: m.x, lng: m.y}} />\n          ) }\n        </Map>\n      </Wrapper>\n      {/* Basic form for controlling center and zoom of map. */}\n      {form}\n    </div>\n  );\n};\n\nconst Map = ({\n  onClick,\n  onIdle,\n  children,\n  style,\n  ...options\n}) => {\n  const ref = React.useRef(null);\n  const [map, setMap] = React.useState();\n\n  React.useEffect(() => {\n    if (ref.current && !map) {\n      setMap(new window.google.maps.Map(ref.current, {}));\n    }\n  }, [ref, map]);\n\n  // because React does not do deep comparisons, a custom hook is used\n  // see discussion in https://github.com/googlemaps/js-samples/issues/946\n  useDeepCompareEffectForMaps(() => {\n    if (map) {\n      map.setOptions(options);\n    }\n  }, [map, options]);\n\n  React.useEffect(() => {\n    if (map) {\n      [\"click\", \"idle\"].forEach((eventName) =>\n        google.maps.event.clearListeners(map, eventName)\n      );\n\n      if (onClick) {\n        map.addListener(\"click\", onClick);\n      }\n\n      if (onIdle) {\n        map.addListener(\"idle\", () => onIdle(map));\n      }\n    }\n  }, [map, onClick, onIdle]);\n\n  return (\n    <>\n      <div ref={ref} style={style} />\n      {React.Children.map(children, (child) => {\n        if (React.isValidElement(child)) {\n          // set the map prop on the child component\n          return React.cloneElement(child, { map });\n        }\n      })}\n    </>\n  );\n};\n\nconst Marker = (options) => {\n  const [marker, setMarker] = React.useState();\n\n  React.useEffect(() => {\n    if (!marker) {\n      setMarker(new google.maps.Marker());\n    }\n\n    // remove marker from map on unmount\n    return () => {\n      if (marker) {\n        marker.setMap(null);\n      }\n    };\n  }, [marker]);\n\n  React.useEffect(() => {\n    if (marker) {\n      marker.setOptions(options);\n    }\n  }, [marker, options]);\n\n  return null;\n};\n\nfunction useDeepCompareMemoize(value) {\n  const ref = React.useRef();\n\n  if (value !== ref.current) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}\n\nconst useDeepCompareEffectForMaps = (callback, dependencies) => {\n  React.useEffect(callback, dependencies.map(useDeepCompareMemoize));\n}\n\nexport default App","\n\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nconst _Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst Blocker = ({children, ...props }) => {\n  return <_Blocker className=\"Blocker\" {...props}>{children}</_Blocker>\n}\n\nexport default _Blocker\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst Crosshair = styled.div`\n// border: 2px solid yellow;\n\nwidth: 50px;\nheight: 50px;\n\nposition: absolute;\nleft: 50%;\ntop: 50%;\n\n::before {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n  transform: rotate(90deg);\n\n  // margin-top: -1em;\n\n}\n::after {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n\n  // margin-top: -1em;\n  // width: 0.5em;\n}\n`;\n\nexport default Crosshair\n","import {\n\tEuler, EventDispatcher, Vector3,\n} from \"three\"\n\nconst _euler = new Euler( 0, 0, 0, 'YXZ' );\nconst _vector = new Vector3();\n\nconst _changeEvent = { type: 'change' };\nconst _lockEvent = { type: 'lock' };\nconst _unlockEvent = { type: 'unlock' };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n\n\tconstructor( camera, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\t\tdomElement = document.body;\n\n\t\t}\n\n\t\tthis.domElement = domElement;\n\t\tthis.isLocked = false;\n\n\t\t// Set to constrain the pitch of the camera\n\t\t// Range is 0 to Math.PI radians\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\tconst scope = this;\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.isLocked === false ) return;\n\n\t\t\tconst movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\t\tconst movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\t\t_euler.setFromQuaternion( camera.quaternion );\n\n\t\t\t_euler.y -= movementX * 0.002;\n\t\t\t_euler.x -= movementY * 0.002;\n\n\t\t\t_euler.x = Math.max( _PI_2 - scope.maxPolarAngle, Math.min( _PI_2 - scope.minPolarAngle, _euler.x ) );\n\n\t\t\tcamera.quaternion.setFromEuler( _euler );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t}\n\n\t\tfunction onPointerlockChange() {\n\n\t\t\tif ( scope.domElement.ownerDocument.pointerLockElement === scope.domElement ) {\n\n\t\t\t\tscope.dispatchEvent( _lockEvent );\n\n\t\t\t\tscope.isLocked = true;\n\n\t\t\t} else {\n\n\t\t\t\tscope.dispatchEvent( _unlockEvent );\n\n\t\t\t\tscope.isLocked = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerlockError() {\n\n\t\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t\t}\n\n\t\tthis.connect = function () {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.disconnect = function () {\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.disconnect();\n\n\t\t};\n\n\t\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\t\treturn camera;\n\n\t\t};\n\n\t\tthis.getDirection = function () {\n\n\t\t\tconst direction = new Vector3( 0, 0, - 1 );\n\n\t\t\treturn function ( v ) {\n\n\t\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.moveForward = function ( distance ) {\n\n\t\t\t// move forward parallel to the xz-plane\n\t\t\t// assumes camera.up is y-up\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\t_vector.crossVectors( camera.up, _vector );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.moveRight = function ( distance ) {\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.lock = function () {\n\n\t\t\tthis.domElement.requestPointerLock();\n\n\t\t};\n\n\t\tthis.unlock = function () {\n\n\t\t\tscope.domElement.ownerDocument.exitPointerLock();\n\n\t\t};\n\n\t\tthis.connect();\n\n\t}\n\n}\n\nexport {\n\tPointerLockControls,\n}\n\nconst unlockEvent = _unlockEvent\nexport { unlockEvent }\n","\"use strict\";\n\nfunction TouchControls({ container, camera, options, THREE, RotationPad }) {\n\n\tvar self = this;\n\tself.config = $.extend({\n\t\tspeedFactor: 0.5,\n\t\tdelta: 1,\n\t\trotationFactor: 0.002,\n\t\tmaxPitch: 55,\n\t\thitTest: true,\n\t\thitTestDistance: 40\n\t}, options);\n\n\tvar container = container;\n\tvar isRightMouseDown = false;\n\tvar rotationMatrices = [];\n\tvar hitObjects = [];\n\n\tvar moveForward = false;\n\tvar moveBackward = false;\n\tvar moveLeft = false;\n\tvar moveRight = false;\n\tvar lockMoveForward = false;\n\tvar lockMoveBackward = false;\n\tvar lockMoveLeft = false;\n\tvar lockMoveRight = false;\n\n\tvar ztouch = 1, xtouch = 1;\n\tvar PI_2 = Math.PI / 2;\n\tvar maxPitch = self.config.maxPitch * Math.PI / 180;\n\tvar velocity = new THREE.Vector3(0, 0, 0);\n\n\tvar cameraHolder = new THREE.Object3D();\n\tcameraHolder.name = \"cameraHolder\";\n\tcameraHolder.add(camera);\n\n\tself.scene = null;\n\tself.fpsBody = new THREE.Object3D();\n\tself.fpsBody.add(cameraHolder);\n\tself.enabled = true;\n\n\tself.mouse = new THREE.Vector2();\n\n\t// Creating rotation pad:\n\tself.rotationPad = new RotationPad(container);\n\t$(self.rotationPad).on(\"YawPitch\", function(event) {\n\t\tvar rotation = calculateCameraRotation(event.detail.deltaX, event.detail.deltaY);\n\t\tself.setRotation(rotation.rx, rotation.ry);\n\t});\n\n\t// Creating movement pad:\n\tself.movementPad = new MovementPad(container);\n\t$(self.movementPad).on(\"move\", function(event) {\n\t\tztouch = Math.abs(event.detail.deltaY);\n\t\txtouch = Math.abs(event.detail.deltaX);\n\n\t\tif (event.detail.deltaY == event.detail.middle) {\n\t\t\tztouch = 1;\n\t\t\tmoveForward = moveBackward = false;\n\t\t} else {\n\t\t\tif (event.detail.deltaY > event.detail.middle) {\n\t\t\t\tmoveForward = true;\n\t\t\t\tmoveBackward = false;\n\t\t\t}\n\t\t\telse if (event.detail.deltaY < event.detail.middle) {\n\t\t\t\tmoveForward = false;\n\t\t\t\tmoveBackward = true;\n\t\t\t}\n\t\t}\n\n\t\tif (event.detail.deltaX == event.detail.middle) {\n\t\t\txtouch = 1;\n\t\t\tmoveRight = moveLeft = false;\n\t\t} else {\n\t\t\tif (event.detail.deltaX < event.detail.middle) {\n\t\t\t\tmoveRight = true;\n\t\t\t\tmoveLeft = false;\n\t\t\t}\n\t\t\telse if (event.detail.deltaX > event.detail.middle) {\n\t\t\t\tmoveRight = false;\n\t\t\t\tmoveLeft = true;\n\t\t\t}\n\t\t}\n\t});\n\t$(self.movementPad).on(\"stopMove\", function(event) {\n\t\tztouch = xtouch = 1;\n\t\tmoveForward = moveBackward = moveLeft = moveRight = false;\n\t});\n\n\tcontainer.on(\"contextmenu\", onContextMenu);\n\tcontainer.on(\"mousedown\", onMouseDown);\n\tcontainer.on(\"mouseup\", onMouseUp);\n\n\t$(document).on(\"keydown\", onKeyDown);\n\t$(document).on(\"keyup\", onKeyUp);\n\t$(document).on(\"mousemove\", onMouseMove);\n\t$(document).on(\"mouseout\", onMouseOut);\n\n\tprepareRotationMatrices();\n\n\t//\n\t// Events:\n\t//\n\tfunction onContextMenu(event) {\n\t\tevent.preventDefault();\n\t};\n\n\tfunction onMouseDown(event) {\n\n\t\tif (self.enabled && event.button === 2) {\n\t\t\tisRightMouseDown = true;\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t};\n\n\tfunction onMouseUp(event) {\n\n\t\tif (self.enabled && event.button === 2) {\n\t\t\tisRightMouseDown = false;\n\t\t}\n\t};\n\n\tfunction onMouseMove(event) {\n\n\t\tself.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n\t\tself.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n\n\t\tif (!self.enabled || !isRightMouseDown) return;\n\n\t\tvar movementX = event.originalEvent.movementX || event.originalEvent.mozMovementX || event.originalEvent.webkitMovementX || 0;\n\t\tvar movementY = event.originalEvent.movementY || event.originalEvent.mozMovementY || event.originalEvent.webkitMovementY || 0;\n\t\tvar rotation = calculateCameraRotation(-1 * movementX, -1 * movementY);\n\n\t\t// console.log(self.mouse, \"\\n\", movementX, rotation);\n\n\t\tself.setRotation(rotation.rx, rotation.ry);\n\n\t\t// updateNavPad();\n\t};\n\n\tfunction onMouseOut(e) {\n\t\tisRightMouseDown = false;\n\t\t// self.stopMouseMoving();\n\t};\n\n\tfunction onKeyDown(e) {\n\n\t\tif (!self.enabled) return;\n\n\t\tswitch (e.keyCode) {\n\n\t\t\tcase 38: // up\n\t\t\tcase 87: // w\n\t\t\t\tmoveForward = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 37: // left\n\t\t\tcase 65: // a\n\t\t\t\tmoveLeft = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 40: // down\n\t\t\tcase 83: // s\n\t\t\t\tmoveBackward = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 39: // right\n\t\t\tcase 68: // d\n\t\t\t\tmoveRight = true;\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\tfunction onKeyUp(e) {\n\n\t\tswitch (e.keyCode) {\n\n\t\t\tcase 38: // up\n\t\t\tcase 87: // w\n\t\t\t\tmoveForward = false;\n\t\t\t\tbreak;\n\n\t\t\tcase 37: // left\n\t\t\tcase 65: // a\n\t\t\t\tmoveLeft = false;\n\t\t\t\tbreak;\n\n\t\t\tcase 40: // down\n\t\t\tcase 83: // a\n\t\t\t\tmoveBackward = false;\n\t\t\t\tbreak;\n\n\t\t\tcase 39: // right\n\t\t\tcase 68: // d\n\t\t\t\tmoveRight = false;\n\t\t\t\tbreak;\n\n\t\t}\n\t};\n\n\t//\n\t// Private functions:\n\t//\n\tfunction prepareRotationMatrices() {\n\n\t\tvar rotationMatrixF = new THREE.Matrix4();\n\t\trotationMatrixF.makeRotationY(0);\n\t\trotationMatrices.push(rotationMatrixF); // forward direction.\n\n\t\tvar rotationMatrixB = new THREE.Matrix4();\n\t\trotationMatrixB.makeRotationY(180 * Math.PI / 180);\n\t\trotationMatrices.push(rotationMatrixB);\n\n\t\tvar rotationMatrixL = new THREE.Matrix4();\n\t\trotationMatrixL.makeRotationY(90 * Math.PI / 180);\n\t\trotationMatrices.push(rotationMatrixL);\n\n\t\tvar rotationMatrixR = new THREE.Matrix4();\n\t\trotationMatrixR.makeRotationY((360 - 90) * Math.PI / 180);\n\t\trotationMatrices.push(rotationMatrixR);\n\t};\n\n\tfunction calculateCameraRotation(dx, dy, factor) {\n\t\tvar factor = factor ? factor : self.config.rotationFactor;\n\t\tvar ry = self.fpsBody.rotation.y - (dx * factor);\n\t\tvar rx = cameraHolder.rotation.x - (dy * factor);\n\t\trx = Math.max(-maxPitch, Math.min(maxPitch, rx));\n\n\t\treturn {\n\t\t\trx: rx,\n\t\t\try: ry\n\t\t};\n\t};\n\n\tfunction lockDirectionByIndex(index) {\n\t\tif (index == 0)\n\t\t\tself.lockMoveForward(true);\n\t\telse if (index == 1)\n\t\t\tself.lockMoveBackward(true);\n\t\telse if (index == 2)\n\t\t\tself.lockMoveLeft(true);\n\t\telse if (index == 3)\n\t\t\tself.lockMoveRight(true);\n\t}\n\n\t//\n\t// Public functions:\n\t//\n\tself.update = function() {\n\t\tif (self.config.hitTest)\n\t\t\tself.hitTest();\n\n\t\tvelocity.x += (-1 * velocity.x) * 0.75 * self.config.delta;\n\t\tvelocity.z += (-1 * velocity.z) * 0.75 * self.config.delta;\n\n\t\tif (moveForward && !lockMoveForward) velocity.z -= ztouch * self.config.speedFactor * self.config.delta;\n\t\tif (moveBackward && !lockMoveBackward) velocity.z += ztouch * self.config.speedFactor * self.config.delta;\n\n\t\tif (moveLeft && !lockMoveLeft) velocity.x -= xtouch * self.config.speedFactor * self.config.delta;\n\t\tif (moveRight && !lockMoveRight) velocity.x += xtouch * self.config.speedFactor * self.config.delta;\n\n\t\tself.fpsBody.translateX(velocity.x);\n\t\tself.fpsBody.translateY(velocity.y);\n\t\tself.fpsBody.translateZ(velocity.z);\n\t};\n\n\tself.hitTest = function() {\n\t\tself.unlockAllDirections();\n\t\thitObjects = [];\n\t\tvar cameraDirection = self.getDirection2(new THREE.Vector3(0, 0, 0)).clone();\n\n\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t// Applying rotation for each direction:\n\t\t\tvar direction = cameraDirection.clone();\n\t\t\tdirection.applyMatrix4(rotationMatrices[i]);\n\n\t\t\tvar rayCaster = new THREE.Raycaster(self.fpsBody.position, direction);\n\t\t\tvar intersects = rayCaster.intersectObject(self.scene, true);\n\t\t\tif ((intersects.length > 0 && intersects[0].distance < self.config.hitTestDistance)) {\n\t\t\t\tlockDirectionByIndex(i);\n\t\t\t\thitObjects.push(intersects[0]);\n\t\t\t\t// console.log(intersects[0].object.name, i);\n\t\t\t}\n\t\t}\n\n\t\treturn hitObjects;\n\t};\n\n\tself.getDirection2 = function(v) {\n\t\tvar self = this;\n\t\tvar direction = new THREE.Vector3(0, 0, -1);\n\t\tvar rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n\t\tvar rx = self.fpsBody.getObjectByName(\"cameraHolder\").rotation.x;;\n\t\tvar ry = self.fpsBody.rotation.y;\n\n\t\t// console.log(\"DIRECTION:\", this);\n\t\trotation.set(rx, ry, 0);\n\t\tv.copy(direction).applyEuler(rotation);\n\t\t// console.log(v);\n\t\treturn v;\n\t};\n\n\tself.getDirection = function() {\n\t\tvar self = this;\n\t\tvar rx = 0;\n\t\tvar ry = 0;\n\t\tvar direction = new THREE.Vector3(0, 0, -1);\n\t\tvar rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n\n\t\t// console.log(\"DIRECTION:\", this);\n\t\tif (self != undefined) {\n\t\t\trx = self.fpsBody.getObjectByName(\"cameraHolder\").rotation.x;\n\t\t\try = self.fpsBody.rotation.y;\n\t\t\tconsole.log(rx, ry);\n\t\t}\n\t\t// var camHolder = self.fpsBody.getObjectByName(\"cameraHolder\");\n\n\t\treturn function(v) {\n\t\t\trotation.set(rx, ry, 0);\n\t\t\tv.copy(direction).applyEuler(rotation);\n\t\t\t// console.log(v);\n\t\t\treturn v;\n\t\t}\n\t}();\n\n\tself.moveLeft = function() {\n\t\treturn moveLeft;\n\t};\n\n\tself.moveRight = function() {\n\t\treturn moveRight;\n\t};\n\n\tself.moveForward = function() {\n\t\treturn moveForward;\n\t};\n\n\tself.moveBackward = function() {\n\t\treturn moveBackward;\n\t};\n\n\tself.lockMoveForward = function(boolean) {\n\t\tlockMoveForward = boolean;\n\t};\n\n\tself.lockMoveBackward = function(boolean) {\n\t\tlockMoveBackward = boolean;\n\t};\n\n\tself.lockMoveLeft = function(boolean) {\n\t\tlockMoveLeft = boolean;\n\t};\n\n\tself.lockMoveRight = function(boolean) {\n\t\tlockMoveRight = boolean;\n\t};\n\n\tself.unlockAllDirections = function() {\n\t\tself.lockMoveForward(false);\n\t\tself.lockMoveBackward(false);\n\t\tself.lockMoveLeft(false);\n\t\tself.lockMoveRight(false);\n\t};\n};\n\nTouchControls.prototype = {\n\taddToScene: function(scene) {\n\t\tthis.scene = scene;\n\t\tscene.add(this.fpsBody);\n\t},\n\n\tsetPosition: function(x, y, z) {\n\t\tthis.fpsBody.position.set(x, y, z);\n\t},\n\n\tstopMouseMoving: function() {\n\t\tisRightMouseDown = false;\n\t},\n\n\tsetRotation: function(x, y) {\n\t\tvar camHolder = this.fpsBody.getObjectByName(\"cameraHolder\");\n\n\t\tif (x !== null)\n\t\t\tcamHolder.rotation.x = x;\n\n\t\tif (y !== null)\n\t\t\tthis.fpsBody.rotation.y = y;\n\t},\n\n\tgetHitObjects: function() {\n\t\treturn hitObjects;\n\t}\n\n};\n\nexport default TouchControls\n","import React, { useRef, } from 'react'\nimport styled from 'styled-components'\n\nconst RotationPad = (props) => {\n\t// logg(props, 'RotationPad')\n\n\tvar mouseDown = false;\n\tvar mouseStopped = false;\n\tvar mouseStopTimeout, eventRepeatTimeout;\n\tvar newLeft, newTop, distance, angle;\n\n\tconst handleRef = useRef(null)\n\tconst handleEl = handleRef.current\n\tconst regionRef = useRef(null)\n\tconst regionEl = regionRef.current\n\n\t/* Aligning pad: */\n\t// rotationPadEl.css({\n\t// \ttop: container.find(\"canvas\").height() + container.position().top - regionEl.outerHeight() - 10,\n\t// \tleft: container.find(\"canvas\").width() - regionEl.outerWidth() - 20\n\t// });\n\n\n\n\tconst regionData = {};\n\tconst handleData = {};\n\n\t// regionData.width = regionEl.outerWidth();\n\t// regionData.height = regionEl.outerHeight();\n\t// regionData.position = regionEl.position();\n\t// regionData.offset = regionEl.offset();\n\t// regionData.radius = regionData.width / 2;\n\t// regionData.centerX = regionData.position.left + regionData.radius;\n\t// regionData.centerY = regionData.position.top + regionData.radius;\n\n\t// handleData.width = handleEl.outerWidth();\n\t// handleData.height = handleEl.outerHeight();\n\t// handleData.radius = handleData.width / 2;\n\n\t// regionData.radius = regionData.width / 2 - handleData.radius;\n\n\tconst resetHandlePosition = () => {\n\t\thandleEl.animate({\n\t\t\ttop: this.regionData.centerY - handleData.radius,\n\t\t\tleft: this.regionData.centerX - handleData.radius,\n\t\t\topacity: 0.1\n\t\t}, \"fast\");\n\t}\n\n\t// Mouse events:\n\tregionEl && regionEl.on(\"mousedown\", function (event) {\n\t\tmouseDown = true;\n\t\thandleEl.css(\"opacity\", \"1.0\");\n\t\tupdate(event.pageX, event.pageY);\n\t});\n\n\t$(document).on(\"mouseup\", function () {\n\t\tmouseDown = false;\n\t\thandleEl && resetHandlePosition();\n\t});\n\n\t$(document).on(\"mousemove\", function(event) {\n\t\tif (!mouseDown) return;\n\t\tupdate(event.pageX, event.pageY);\n\t});\n\n\t//Touch events:\n\tregionEl && regionEl.on(\"touchstart\", function (event) {\n\t\tmouseDown = true;\n\t\thandleEl.css(\"opacity\", \"1.0\");\n\t\tupdate(event.originalEvent.targetTouches[0].pageX, event.originalEvent.targetTouches[0].pageY);\n\t});\n\n\t$(document).on(\"touchend touchcancel\", function () {\n\t\tmouseDown = false;\n\t\thandleEl && resetHandlePosition();\n\t});\n\n\t$(document).on(\"touchmove\", function(event) {\n\t\tif (!mouseDown) return;\n\t\tupdate(event.originalEvent.touches[0].pageX, event.originalEvent.touches[0].pageY);\n\t});\n\n\n\tfunction update(pageX, pageY) {\n\t\tnewLeft = (pageX - regionData.offset.left);\n\t\tnewTop = (pageY - regionData.offset.top);\n\n\t\t// If handle reaches the pad boundaries.\n\t\tdistance = Math.pow(regionData.centerX - newLeft, 2) + Math.pow(regionData.centerY - newTop, 2);\n\t\tif (distance > Math.pow(regionData.radius, 2)) {\n\t\t\tangle = Math.atan2((newTop - regionData.centerY), (newLeft - regionData.centerX));\n\t\t\tnewLeft = (Math.cos(angle) * regionData.radius) + regionData.centerX;\n\t\t\tnewTop = (Math.sin(angle) * regionData.radius) + regionData.centerY;\n\t\t}\n\t\tnewTop = Math.round(newTop * 10) / 10;\n\t\tnewLeft = Math.round(newLeft * 10) / 10;\n\n\t\thandleEl.css({\n\t\t\ttop: newTop - handleData.radius,\n\t\t\tleft: newLeft - handleData.radius\n\t\t});\n\t\t// console.log(newTop , newLeft);\n\n\t\t// Providing event and data for handling camera movement.\n\t\tvar deltaX = regionData.centerX - parseInt(newLeft);\n\t\tvar deltaY = regionData.centerY - parseInt(newTop);\n\t\t// Normalize x,y between -2 to 2 range.\n\t\tdeltaX = -2 + (2+2) * (deltaX - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n\t\tdeltaY = -2 + (2+2) * (deltaY - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n\t\tdeltaX = -1 * Math.round(deltaX * 10) / 10;\n\t\tdeltaY = -1 * Math.round(deltaY * 10) / 10;\n\t\t// console.log(deltaX, deltaY);\n\n\t\tsendEvent(deltaX, deltaY);\n\t}\n\n\tfunction sendEvent(dx, dy) {\n\t\tif (!mouseDown) {\n\t\t\tclearTimeout(eventRepeatTimeout);\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(eventRepeatTimeout);\n\t\teventRepeatTimeout = setTimeout(function() {\n\t\t\tsendEvent(dx, dy);\n\t\t}, 5);\n\n\t\tvar moveEvent = $.Event(\"YawPitch\", {\n\t\t\tdetail: {\n\t\t\t\t\"deltaX\": dx,\n\t\t\t\t\"deltaY\": dy\n\t\t\t},\n\t\t\tbubbles: false\n\t\t});\n\t\t$(self).trigger(moveEvent);\n\t}\n\n\thandleEl && resetHandlePosition();\n\n\treturn \t<div className=\"rotation-pad\">\n\t  <div className=\"region\" ref={regionRef} ></div>\n\t  <div className=\"handle\" ref={handleRef} ></div>\n\t</div>\n}\n\nexport default RotationPad\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { PointerLockControls } from './PointerLockControls'\nimport TouchControls from \"./TouchControls\"\nimport RotationPad from \"./RotationPad\"\nimport {\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst Blocker = styled.div`\n  border: 1px dashed red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n\n  #Crosshair {\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst W = styled.div`\n  border: 1px solid blue;\n  height: 90vh;\n`;\n\n/**\n * Equirectangular2\n * _vp_ 2021-11-15\n * Let's wire in a simple floor and full-window sizing.\n *\n * Threejs units of measure are centimeters (cm).\n *\n */\nconst Equirectangular2 = (props) => {\n  logg(props, 'Equirectangular2')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene;\n\n  var width, height;\n  var viewAngle = 45,\n    near = 1,\n    far = 10000;\n  var aspect;\n  var stats;\n  var sceneObject, intersected;\n\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const blockerRef = useRef(null)\n  const wContainerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 ) // @TODO: what this?\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 ) // @TODO: what this?\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Origin: axis helper\n     */\n    var axes = new THREE.AxisHelper(700)\n\t\tscene.add(axes)\n\n    const wContainer = wContainerRef.current\n\n    function addControls() {\n      var options = {\n        speedFactor: 0.5,\n        delta: 1,\n        rotationFactor: 0.002,\n        maxPitch: 55,\n        hitTest: true,\n        hitTestDistance: 40\n      };\n      controls = new TouchControls({\n        container: wContainer, camera,\n        options,\n        RotationPad: rotationPad,\n        THREE,\n      });\n      controls.setPosition(0, 35, 400);\n      controls.addToScene(scene);\n      // controls.setRotation(0.15, -0.15);\n    }\n    addControls()\n\n    /*\n     * Floor\n     */\n\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.PlaneGeometry( 100, 100, 10, 10 ) // width, height, w segments, h segments\n    // let floorGeometry = new THREE.CircleGeometry(100, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/100x100_lazer-floor.png`)\n    texture.wrapS = THREE.RepeatWrapping\n    texture.wrapT = THREE.RepeatWrapping\n    texture.repeat.set( 10, 10 )\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      map: texture,\n      // transparent: true,\n    })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    // const texturePath = `${modelName}/${modelName}.mtl`\n    // const modelPath = `${modelName}/${modelName}.obj`\n    // const manager = new THREE.LoadingManager()\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n    // const onLoad = (materials) => {\n    //   materials.preload()\n    //   const objLoader = new OBJLoader( manager )\n    //   objLoader.setMaterials( materials )\n    //   objLoader.setPath( scenesPath)\n    //   objLoader.load( modelPath, ( object ) => {\n    //     object.traverse((child) => {\n    //       if (child.isMesh) {\n    //         child.geometry.scale(0.10, 0.10, 0.10) // @TODO: change?\n    //       }\n    //     })\n    //     object.position.x = Math.random() * 500\n    //     object.position.y = 10\n    //     object.position.z = Math.random() * 500\n\n    //     logg(object, '1st object')\n    //     scene.add( object )\n    //     markerObjects.push( object )\n    //     markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' }) // @TODO: change!\n\n    //   }, onProgress, onError )\n    // }\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(scenesPath)\n    // mtlLoader.load(texturePath, onLoad)\n\n\n    /*\n     * Skybox\n     */\n    const textureLoader = new THREE.TextureLoader()\n    const assetPath = map.img_path\n    texture = textureLoader.load(assetPath, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  /* From: https://threejsfundamentals.org/threejs/lessons/threejs-responsive.html */\n  function resizeRendererToDisplaySize() {\n    const canvas = renderer.domElement\n    const width = blockerRef.current.clientWidth\n    const height = blockerRef.current.clientHeight\n    const needResize = canvas.width !== width || canvas.height !== height\n    if (needResize) {\n      renderer.setSize(width, height)\n    }\n    return needResize\n  }\n\n  function onWindowResize() {\n    if (resizeRendererToDisplaySize()) {\n      const width = blockerRef.current.clientWidth\n      const height = blockerRef.current.clientHeight\n      camera.aspect = width / height\n      camera.updateProjectionMatrix()\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <W ref={wContainerRef} >\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n\n      <RotationPad />\n    </Blocker>\n  </W>\n}\n\nexport default Equirectangular2\n","\n/*\n * @TODO: this is just a copy of equirectangular2, discard\n */\n\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { PointerLockControls } from './PointerLockControls'\nimport TouchControls from \"./TouchControls\"\nimport RotationPad from \"./RotationPad\"\nimport {\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst Blocker = styled.div`\n  border: 1px dashed red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n\n  #Crosshair {\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst W = styled.div`\n  border: 1px solid blue;\n  height: 90vh;\n`;\n\n/**\n * Equirectangular2\n * _vp_ 2021-11-15\n * Let's wire in a simple floor and full-window sizing.\n *\n * Threejs units of measure are centimeters (cm).\n *\n */\nconst Equirectangular2 = (props) => {\n  logg(props, 'Equirectangular2')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene;\n\n  var width, height;\n  var viewAngle = 45,\n    near = 1,\n    far = 10000;\n  var aspect;\n  var stats;\n  var sceneObject, intersected;\n\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const blockerRef = useRef(null)\n  const wContainerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 ) // @TODO: what this?\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 ) // @TODO: what this?\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Origin: axis helper\n     */\n    var axes = new THREE.AxisHelper(700)\n\t\tscene.add(axes)\n\n    const wContainer = wContainerRef.current\n\n    function addControls() {\n      var options = {\n        speedFactor: 0.5,\n        delta: 1,\n        rotationFactor: 0.002,\n        maxPitch: 55,\n        hitTest: true,\n        hitTestDistance: 40\n      };\n      controls = new TouchControls({\n        container: wContainer, camera,\n        options,\n        RotationPad: rotationPad,\n        THREE,\n      });\n      controls.setPosition(0, 35, 400);\n      controls.addToScene(scene);\n      // controls.setRotation(0.15, -0.15);\n    }\n    addControls()\n\n    /*\n     * Floor\n     */\n\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.PlaneGeometry( 100, 100, 10, 10 ) // width, height, w segments, h segments\n    // let floorGeometry = new THREE.CircleGeometry(100, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/100x100_lazer-floor.png`)\n    texture.wrapS = THREE.RepeatWrapping\n    texture.wrapT = THREE.RepeatWrapping\n    texture.repeat.set( 10, 10 )\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      map: texture,\n      // transparent: true,\n    })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    // const texturePath = `${modelName}/${modelName}.mtl`\n    // const modelPath = `${modelName}/${modelName}.obj`\n    // const manager = new THREE.LoadingManager()\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n    // const onLoad = (materials) => {\n    //   materials.preload()\n    //   const objLoader = new OBJLoader( manager )\n    //   objLoader.setMaterials( materials )\n    //   objLoader.setPath( scenesPath)\n    //   objLoader.load( modelPath, ( object ) => {\n    //     object.traverse((child) => {\n    //       if (child.isMesh) {\n    //         child.geometry.scale(0.10, 0.10, 0.10) // @TODO: change?\n    //       }\n    //     })\n    //     object.position.x = Math.random() * 500\n    //     object.position.y = 10\n    //     object.position.z = Math.random() * 500\n\n    //     logg(object, '1st object')\n    //     scene.add( object )\n    //     markerObjects.push( object )\n    //     markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' }) // @TODO: change!\n\n    //   }, onProgress, onError )\n    // }\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(scenesPath)\n    // mtlLoader.load(texturePath, onLoad)\n\n\n    /*\n     * Skybox\n     */\n    const textureLoader = new THREE.TextureLoader()\n    const assetPath = map.img_path\n    texture = textureLoader.load(assetPath, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  /* From: https://threejsfundamentals.org/threejs/lessons/threejs-responsive.html */\n  function resizeRendererToDisplaySize() {\n    const canvas = renderer.domElement\n    const width = blockerRef.current.clientWidth\n    const height = blockerRef.current.clientHeight\n    const needResize = canvas.width !== width || canvas.height !== height\n    if (needResize) {\n      renderer.setSize(width, height)\n    }\n    return needResize\n  }\n  function onWindowResize() {\n    if (resizeRendererToDisplaySize()) {\n      const width = blockerRef.current.clientWidth\n      const height = blockerRef.current.clientHeight\n      camera.aspect = width / height\n      camera.updateProjectionMatrix()\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <W ref={wContainerRef} >\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n\n      <RotationPad />\n    </Blocker>\n  </W>\n}\n\nexport default Equirectangular2\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  Blocker,\n} from './'\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\n/**\n * TabiversePlanet\n */\nconst TabiversePlanet = (props) => {\n\n  let camera\n  let geometry\n  let material\n  let planet\n  let renderer\n  let texture\n  let scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  function init() {\n\n    camera = new THREE.PerspectiveCamera( 75, 2, 0.1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n    camera.position.z = -10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0x31231f )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    /*\n     * Floor\n     */\n    // texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    // let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    // floorGeometry.rotateX( - Math.PI / 2 )\n    // const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    /*\n     * Planet\n    **/\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/2k_mercury.jpeg`)\n    geometry = new THREE.SphereBufferGeometry(1, 32, 32)\n    // geometry = new THREE.BoxGeometry( 1, 1, 1 );\n    // material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\n    material = new THREE.MeshBasicMaterial({ map: texture })\n    planet = new THREE.Mesh(geometry, material)\n    planet.position.y = 10\n    planet.position.z = -12\n    scene.add(planet)\n\n    /*\n     * Render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n\n    // camera.rotation.x += 0.01\n    // camera.rotation.y += 0.01\n\n    planet.rotation.y += 0.00035\n\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <Blocker {...S} ref={blockerRef} >\n    </Blocker>\n  </F>\n}\n\nexport default TabiversePlanet\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\n// @TODO: make its own component. _vp_ 2022-08-13\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * ThreePanelDefault\n * Markers are obejcts _vp_ 2021-11-14\n * Continue.           _vp_ 2022-08-13\n *\n */\nconst ThreePanelV4 = (props) => {\n  logg(props, 'ThreePanelV4')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n  const loader = new GLTFLoader()\n  const worldOctree = new Octree()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // const texturesPath = '/assets/textures/'\n    // const manager = new THREE.LoadingManager()\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(texturesPath)\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n\n\n    map.markers.map((marker, idx) => {\n\n      loader.load( marker.asset3d_path, ( gltf ) => {\n        scene.add( gltf.scene );\n        worldOctree.fromGraphNode( gltf.scene );\n        gltf.scene.traverse( child => {\n          if ( child.isMesh ) {\n            child.castShadow = true;\n            child.receiveShadow = true;\n            if ( child.material.map ) {\n              child.material.map.anisotropy = 4;\n            }\n          }\n        } )\n      })\n\n    })\n\n\n\n    /*\n     * Skybox\n    **/\n    const textureLoader = new THREE.TextureLoader()\n    texture = textureLoader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default ThreePanelV4\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  height: calc(100% - ${p => p.breadcrumbsHeight});\n`;\n\n/**\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\n\n\nconst Loc = (props) => {\n  let camera, controls,\n    object, objects = [],\n    raycaster, renderer,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n    /*\n    // PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n    // fov  Camera frustum vertical field of view.\n    // aspect  Camera frustum aspect ratio.\n    // near  Camera frustum near plane.\n    // far  Camera frustum far plane.\n    */\n    // camera = new THREE.PerspectiveCamera( 75, 2, 1, 100 )\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 300 )\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    // floor\n    // @TODO: it's not aligned to parcels the way I want\n    let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n\n    // vertex displacement\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      vertex.fromBufferAttribute( position, i )\n      vertex.x += Math.random() * 20 - 10\n      vertex.y += Math.random() * 2\n      vertex.z += Math.random() * 20 - 10\n      position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    floorGeometry.x = -200\n    floorGeometry.y = -200\n    floorGeometry.z = -200\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    // objects\n    /*\n    const boxGeometry = new THREE.BoxGeometry( 20, 20, 20 ).toNonIndexed()\n    position = boxGeometry.attributes.position\n    const colorsBox = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsBox.push( color.r, color.g, color.b )\n    }\n    boxGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsBox, 3 ) )\n    for ( let i = 0; i < 500; i ++ ) {\n      const boxMaterial = new THREE.MeshPhongMaterial( { specular: 0xffffff, flatShading: true, vertexColors: true } )\n      boxMaterial.color.setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n\n      const box = new THREE.Mesh( boxGeometry, boxMaterial )\n      box.position.x = Math.floor( Math.random() * 20 - 10 ) * 20\n      box.position.y = Math.floor( Math.random() * 20 ) * 20 + 10\n      box.position.z = Math.floor( Math.random() * 20 - 10 ) * 20\n      scene.add( box )\n      objects.push( box )\n    }\n    */\n\n    // load OBJ\n\n    // manager\n\n    // this is specifically for tiny-house-1\n    const loadModel = () => {\n      object.traverse((child) => {\n        if ( child.isMesh ) {\n          child.material.map = texture\n          child.geometry.scale(10, 10, 10)\n        }\n      })\n      object.position.x = 100\n      object.position.y = 10\n      object.position.z = 100\n\n      scene.add( object )\n    }\n    const manager = new THREE.LoadingManager( loadModel )\n    manager.onProgress = function ( item, loaded, total ) {\n      console.log( item, loaded, total )\n    }\n\n    // texture\n\n    const textureLoader = new THREE.TextureLoader( manager )\n    const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n    // model\n\n    // tiny-house-1\n    const loader = new OBJLoader( manager )\n    loader.load( '/assets/scenes/tiny-house-1/tiny-house-1.obj', ( obj ) => {\n      object = obj\n    }, ( xhr ) => {\n      if ( xhr.lengthComputable ) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }, (e) => {\n      logg(e, 'onError')\n    } )\n\n\n    // some delimiters for the first 6 parcels!\n    let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    let cube = new THREE.Mesh( geometry, material )\n    cube.position.x = 0\n    cube.position.y = 5\n    cube.position.z = 0\n    scene.add( cube )\n    const items = [\n      { color: 0xff0000, x: 1, y: 0, z: 0 },\n      { color: 0x00ff00, x: 0, y: 1, z: 0 },\n      { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    ]\n    items.map((item, idx) => {\n      logg(item, 'item')\n      const { color, x, y, z } = item\n      geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n      material = new THREE.MeshBasicMaterial({ color: color })\n      cube = new THREE.Mesh( geometry, material )\n      cube.position.x = x*5\n      cube.position.y = 10+y*5\n      cube.position.z = z*5\n      scene.add( cube )\n    })\n\n    const parcels = [\n      { color: 0xff0000, x: 100, y: 1, z: 100 },\n      { color: 0x00ff00, x: 100, y: 1, z: 320 },\n      { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n      { color: 0x660000, x: -120, y: 1, z: 100 },\n      { color: 0x006600, x: -120, y: 1, z: -120 },\n      { color: 0x000066, x: 100, y: 1, z: -120 },\n    ]\n    parcels.map((item, idx) => {\n      const { color, x, y, z } = item\n      const g = new THREE.BoxGeometry( 200, 2, 200 )\n      const m = new THREE.MeshBasicMaterial({color: color})\n      const p = new THREE.Mesh( g, m )\n      p.position.x = x\n      p.position.y = y\n      p.position.z = z\n      scene.add( p )\n    })\n\n    //\n\n\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    // renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setPixelRatio(1)\n    renderer.setSize( 800, 400 )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n      raycaster.ray.origin.copy( controls.getObject().position )\n      raycaster.ray.origin.y -= 10\n      const intersections = raycaster.intersectObjects( objects, false )\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} />\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * Loc = Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\nconst Loc = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    let modelName2 = 'girl'\n    const texturePath = `${modelName}/${modelName}.mtl`\n    const modelPath = `${modelName}/${modelName}.obj`\n    const modelPath2 = `${modelName2}/${modelName2}.obj`\n    const manager = new THREE.LoadingManager()\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    // onProgress = function ( item, loaded, total ) {\n    //   console.log( item, loaded, total )\n    // }\n    const onError = () => {}\n    const onLoad = (materials) => {\n      materials.preload()\n      const objLoader = new OBJLoader( manager )\n      objLoader.setMaterials( materials )\n      objLoader.setPath( scenesPath)\n      objLoader.load( modelPath, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(0.10, 0.10, 0.10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '1st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' })\n\n      }, onProgress, onError )\n    }\n    const onLoad2 = (materials) => {\n      // materials.preload()\n      const objLoader = new OBJLoader( manager )\n      // objLoader.setMaterials( materials )\n      objLoader.setPath( objectsPath )\n      objLoader.load( modelPath2, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(10, 10, 10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '2st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'girl', slug: 'demmitv' })\n\n      }, onProgress, onError )\n    }\n    const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setBaseUrl(scenesPath)\n    mtlLoader.setPath(scenesPath)\n    mtlLoader.load(texturePath, onLoad)\n    mtlLoader.load(texturePath, onLoad2)\n\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\nimport * as THREE from \"three\"\nimport Stats from 'three/examples/jsm/libs/stats.module'\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport { Capsule } from 'three/examples/jsm/math/Capsule'\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\n\nimport { Crosshair } from \"./\"\nimport { PointerLockControls, } from './PointerLockControls'\nimport {\n  C,\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst Blocker = styled.div`\n  // border: 2px solid red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n`;\n\n/**\n * Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n *\n * Octree! From: https://threejs.org/examples/games_fps.html\n * @TODO: let's load the map, and collision player on map. _vp_ 202-04-20\n *\n**/\nconst Location = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  let camera, clock,\n    directionalLight,\n    fillLight1,\n    glow,\n    markerObjects = [],\n    pickedObject, plc,\n    raycaster, removedObject, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n\n\n\n  function init_old() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    const aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera = new THREE.PerspectiveCamera( 75, aspect, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    // scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    const onClick = (event) => {\n      // logg(event, 'onCLick')\n      // logg(pickedObject, 'pickedObject')\n\n      // @TODO: prevent lock-outs!\n      if (pickedObject) {\n        // plc.unlock()\n        // history.push(`/en/locations/show/${pickedObject.slug}`)\n      }\n    }\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n    document.addEventListener( 'click', onClick )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n\n    /*\n     * Floor\n     */\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const manager = new THREE.LoadingManager()\n\n    let importModels = [\n      // { modelName: 'wasyaco-reception-2', slug: 'construct1' },\n\n      { modelName: 'camaro75', slug: 'construct1' },\n      { modelName: 'girl',     slug: 'demmitv' },\n\n      // { modelName: 'girl-5',     slug: 'demmitv' },\n    ]\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(objectsPath)\n\n    importModels.map(({ modelName, slug }) => {\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n\n          objLoader.setPath(objectsPath)\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10)\n              }\n            })\n            object.position.x = Math.random() * 200\n            object.position.y = 10\n            object.position.z = Math.random() * 200\n\n            scene.add( object )\n            markerObjects.push({ uuid: object.uuid, name: 'camaro75', object, slug: 'construct1', })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath))\n    })\n\n\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n  }\n\n\n  const GRAVITY = 30;\n\n  const NUM_SPHERES = 100;\n  const SPHERE_RADIUS = 0.2;\n\n  const STEPS_PER_FRAME = 5;\n\n  const sphereGeometry = new THREE.IcosahedronGeometry( SPHERE_RADIUS, 5 );\n  const sphereMaterial = new THREE.MeshLambertMaterial( { color: 0xbbbb44 } );\n\n  const spheres = [];\n  let sphereIdx = 0;\n\n  const worldOctree = new Octree();\n\n  const playerCollider = new Capsule( new THREE.Vector3( 0, 0.35, 0 ), new THREE.Vector3( 0, 1, 0 ), 0.35 );\n\n  const playerVelocity = new THREE.Vector3();\n  const playerDirection = new THREE.Vector3();\n\n  let playerOnFloor = false;\n  let mouseTime = 0;\n\n  const keyStates = {};\n\n  const vector1 = new THREE.Vector3();\n  const vector2 = new THREE.Vector3();\n  const vector3 = new THREE.Vector3();\n\n  const init = () => {\n    clock = new THREE.Clock();\n\n    scene = new THREE.Scene();\n    scene.background = new THREE.Color( 0x88ccee );\n    scene.fog = new THREE.Fog( 0x88ccee, 0, 50 );\n\n    camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n    camera.rotation.order = 'YXZ';\n\n    fillLight1 = new THREE.HemisphereLight( 0x4488bb, 0x002244, 0.5 );\n    fillLight1.position.set( 2, 1, 1 );\n    scene.add( fillLight1 );\n\n    directionalLight = new THREE.DirectionalLight( 0xffffff, 0.8 );\n    directionalLight.position.set( - 5, 25, - 1 );\n    directionalLight.castShadow = true;\n    directionalLight.shadow.camera.near = 0.01;\n    directionalLight.shadow.camera.far = 500;\n    directionalLight.shadow.camera.right = 30;\n    directionalLight.shadow.camera.left = - 30;\n    directionalLight.shadow.camera.top\t= 30;\n    directionalLight.shadow.camera.bottom = - 30;\n    directionalLight.shadow.mapSize.width = 1024;\n    directionalLight.shadow.mapSize.height = 1024;\n    directionalLight.shadow.radius = 4;\n    directionalLight.shadow.bias = - 0.00006;\n    scene.add( directionalLight );\n\n    for ( let i = 0; i < NUM_SPHERES; i ++ ) {\n      const sphere = new THREE.Mesh( sphereGeometry, sphereMaterial );\n      sphere.castShadow = true;\n      sphere.receiveShadow = true;\n\n      scene.add( sphere );\n\n      spheres.push( {\n        mesh: sphere,\n        collider: new THREE.Sphere( new THREE.Vector3( 0, - 100, 0 ), SPHERE_RADIUS ),\n        velocity: new THREE.Vector3()\n      } );\n    }\n\n    /*\n     * controls\n    **/\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer( { antialias: true } )\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    renderer.shadowMap.enabled = true\n    renderer.shadowMap.type = THREE.VSMShadowMap\n    renderer.outputEncoding = THREE.sRGBEncoding\n    renderer.toneMapping = THREE.ACESFilmicToneMapping\n\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n    /*\n     * GLFT Loader\n    **/\n    const loader = new GLTFLoader().setPath( './assets/objects/gltf/' );\n\n    loader.load( 'collision-world.glb', ( gltf ) => {\n      scene.add( gltf.scene );\n      worldOctree.fromGraphNode( gltf.scene );\n      gltf.scene.traverse( child => {\n        if ( child.isMesh ) {\n          child.castShadow = true;\n          child.receiveShadow = true;\n          if ( child.material.map ) {\n            child.material.map.anisotropy = 4;\n          }\n        }\n      } );\n\n      // const helper = new OctreeHelper( worldOctree );\n      // helper.visible = false;\n      // scene.add( helper );\n\n      animate();\n    } );\n\n    /*\n     * keyboard control, event listeners\n    **/\n    document.addEventListener( 'keydown', ( event ) => {\n      keyStates[ event.code ] = true;\n    } );\n\n    document.addEventListener( 'keyup', ( event ) => {\n      keyStates[ event.code ] = false;\n    } );\n\n    document.addEventListener( 'mouseup', () => {\n      if ( document.pointerLockElement !== null ) throwBall();\n    } );\n\n    // document.body.addEventListener( 'mousemove', ( event ) => {\n    //   if ( document.pointerLockElement === document.body ) {\n    //     camera.rotation.y -= event.movementX / 500;\n    //     camera.rotation.x -= event.movementY / 500;\n    //   }\n    // } );\n\n    document.addEventListener( 'mousedown', () => {\n      document.body.requestPointerLock();\n      mouseTime = performance.now();\n    } );\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function playerCollisions() {\n    const result = worldOctree.capsuleIntersect( playerCollider );\n    playerOnFloor = false;\n    if ( result ) {\n      playerOnFloor = result.normal.y > 0;\n      if ( ! playerOnFloor ) {\n        playerVelocity.addScaledVector( result.normal, - result.normal.dot( playerVelocity ) );\n      }\n      playerCollider.translate( result.normal.multiplyScalar( result.depth ) );\n    }\n  }\n\n  function updateSpheres( deltaTime ) {\n    spheres.forEach( sphere => {\n      sphere.collider.center.addScaledVector( sphere.velocity, deltaTime );\n      const result = worldOctree.sphereIntersect( sphere.collider );\n      if ( result ) {\n        sphere.velocity.addScaledVector( result.normal, - result.normal.dot( sphere.velocity ) * 1.5 );\n        sphere.collider.center.add( result.normal.multiplyScalar( result.depth ) );\n      } else {\n        sphere.velocity.y -= GRAVITY * deltaTime;\n      }\n      const damping = Math.exp( - 1.5 * deltaTime ) - 1;\n      sphere.velocity.addScaledVector( sphere.velocity, damping );\n      playerSphereCollision( sphere );\n    } );\n    spheresCollisions();\n    for ( const sphere of spheres ) {\n      sphere.mesh.position.copy( sphere.collider.center );\n    }\n  }\n\n  function throwBall() {\n    const sphere = spheres[ sphereIdx ];\n    camera.getWorldDirection( playerDirection );\n    sphere.collider.center.copy( playerCollider.end ).addScaledVector( playerDirection, playerCollider.radius * 1.5 );\n    // throw the ball with more force if we hold the button longer, and if we move forward\n    const impulse = 15 + 30 * ( 1 - Math.exp( ( mouseTime - performance.now() ) * 0.001 ) );\n    sphere.velocity.copy( playerDirection ).multiplyScalar( impulse );\n    sphere.velocity.addScaledVector( playerVelocity, 2 );\n    sphereIdx = ( sphereIdx + 1 ) % spheres.length;\n  }\n\n  function getForwardVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    return playerDirection;\n  }\n\n  function getSideVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    playerDirection.cross( camera.up );\n    return playerDirection;\n  }\n\n  function updatePlayer( deltaTime ) {\n    let damping = Math.exp( - 4 * deltaTime ) - 1;\n    if ( ! playerOnFloor ) {\n      playerVelocity.y -= GRAVITY * deltaTime;\n      // small air resistance\n      damping *= 0.1;\n    }\n    playerVelocity.addScaledVector( playerVelocity, damping );\n    const deltaPosition = playerVelocity.clone().multiplyScalar( deltaTime );\n    playerCollider.translate( deltaPosition );\n    playerCollisions();\n    camera.position.copy( playerCollider.end );\n  }\n\n  function spheresCollisions() {\n    for ( let i = 0, length = spheres.length; i < length; i ++ ) {\n      const s1 = spheres[ i ];\n      for ( let j = i + 1; j < length; j ++ ) {\n        const s2 = spheres[ j ];\n\n        const d2 = s1.collider.center.distanceToSquared( s2.collider.center );\n        const r = s1.collider.radius + s2.collider.radius;\n        const r2 = r * r;\n\n        if ( d2 < r2 ) {\n          const normal = vector1.subVectors( s1.collider.center, s2.collider.center ).normalize();\n          const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( s1.velocity ) );\n          const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( s2.velocity ) );\n\n          s1.velocity.add( v2 ).sub( v1 );\n          s2.velocity.add( v1 ).sub( v2 );\n\n          const d = ( r - Math.sqrt( d2 ) ) / 2;\n\n          s1.collider.center.addScaledVector( normal, d );\n          s2.collider.center.addScaledVector( normal, - d );\n        }\n      }\n    }\n  }\n\n  function playerSphereCollision( sphere ) {\n    const center = vector1.addVectors( playerCollider.start, playerCollider.end ).multiplyScalar( 0.5 );\n    const sphere_center = sphere.collider.center;\n    const r = playerCollider.radius + sphere.collider.radius;\n    const r2 = r * r;\n\n    // approximation: player = 3 spheres\n    for ( const point of [ playerCollider.start, playerCollider.end, center ] ) {\n      const d2 = point.distanceToSquared( sphere_center );\n\n      if ( d2 < r2 ) {\n        const normal = vector1.subVectors( point, sphere_center ).normalize();\n        const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( playerVelocity ) );\n        const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( sphere.velocity ) );\n\n        playerVelocity.add( v2 ).sub( v1 );\n        sphere.velocity.add( v1 ).sub( v2 );\n\n        const d = ( r - Math.sqrt( d2 ) ) / 2;\n        sphere_center.addScaledVector( normal, - d );\n      }\n    }\n  }\n\n  function teleportPlayerIfOob() {\n    if ( camera.position.y <= - 25 ) {\n      playerCollider.start.set( 0, 0.35, 0 );\n      playerCollider.end.set( 0, 1, 0 );\n      playerCollider.radius = 0.35;\n      camera.position.copy( playerCollider.end );\n      camera.rotation.set( 0, 0, 0 );\n    }\n  }\n\n  function controls( deltaTime ) {\n    // gives a bit of air control\n    const speedDelta = deltaTime * ( playerOnFloor ? 25 : 8 );\n\n    if ( keyStates[ 'KeyW' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyS' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyA' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyD' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( playerOnFloor ) {\n      if ( keyStates[ 'Space' ] ) {\n        playerVelocity.y = 15;\n      }\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( plc.isLocked === true ) {\n\n      const deltaTime = Math.min( 0.05, clock.getDelta() ) / STEPS_PER_FRAME;\n\n      // we look for collisions in substeps to mitigate the risk of\n      // an object traversing another too quickly for detection.\n\n      for ( let i = 0; i < STEPS_PER_FRAME; i ++ ) {\n        controls( deltaTime );\n        updatePlayer( deltaTime );\n        updateSpheres( deltaTime );\n        teleportPlayerIfOob();\n      }\n\n    }\n    prevTime = time\n\n    // @TODO: add stats\n    // @TODO: add OctreeHelper\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <Crosshair />\n    </Blocker>\n  </F>\n}\n\nexport default Location\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * ThreePanelV4\n * Markers are obejcts _vp_ 2021-11-14\n *\n */\nconst ThreePanelV4 = (props) => {\n  logg(props, 'ThreePanelV4')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const texturesPath = '/assets/textures/'\n    const manager = new THREE.LoadingManager()\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(texturesPath)\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n\n\n    map.markers.map((marker, idx) => {\n      let modelName = marker.slug\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath, modelName) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n          objLoader.setPath( objectsPath )\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10) // @TODO change, girl-6 accepts 1,1,1\n              }\n            })\n            object.position.x = Math.random() * 100\n            object.position.y = 10\n            object.position.z = Math.random() * 100\n\n            // object.rotateX( - Math.PI / 2 ) // girl-6 only.\n\n            logg(object, 'loaded obj')\n\n            scene.add( object )\n            markerObjects.push( object )\n            markerObjectsIdxs.push({ uuid: object.uuid, name: modelName })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath, modelName))\n    })\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default ThreePanelV4\n","\n\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport { ChevronLeft, ChevronRight, Menu as MenuIcon, } from '@material-ui/icons'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  // GoogleMaps,\n  MapPanel, MapPanelNoZoom,\n} from \"./\"\nimport GoogleMaps from './GoogleMaps2'\nimport {\n  Equirectangular, Equirectangular2, Equirectangular4,\n  TabiversePlanet, ThreePanelV1, ThreePanelV2, ThreePanelV3, ThreePanelV4, ThreePanelDefault,\n} from \"$components/3d_locations\"\nimport {\n  C, Collapsible,\n  logg,\n  request,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\n/* W */\nconst W0 = styled.div`\n  overflow: hidden;\n\n  flex-grow: 1;\n\n  // max-height: 100vh;\n  // min-height: 50vh;\n\n`;\n\n/**\n * Renders either MapPanel (W really, a simple wrapper), MapPanelNoZoom, or ThreePanelV1\n * or some other MapPanel.\n */\nconst WrappedMapPanel = React.forwardRef((props, ref) => {\n  // logg(props.map, 'WrappedMapPanel')\n\n  switch (props.map.config.map_panel_type) {\n\n    case C.map_panel_types.Equirectangular:\n      // return <W0 ref={ref} className=\"Equirectangular\" ><Equirectangular {...props} /></W0>\n      // return <W0 ref={ref} className=\"Equirectangular2\" ><Equirectangular2 {...props} /></W0>\n      return <W0 ref={ref} className=\"Equirectangular4\" ><Equirectangular4 {...props} /></W0>\n\n    case C.map_panel_types.MapPanelNoZoom:\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanelNoZoom withZoom={false} {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV1:\n      switch (props.slug) {\n\n        // legacy, remove all three: _vp_ 2022-08-13\n        case 'threev1':\n          return <W0><ThreePanelV1 {...props} /></W0>\n        case 'threev2':\n          return <W0><ThreePanelV2 {...props} /></W0>\n        case 'threev3':\n          return <W0><ThreePanelV3 {...props} /></W0>\n\n        default:\n          return <W0><ThreePanelDefault {...props} /></W0>\n      }\n\n    case C.map_panel_types.TabiversePlanet: // markers are objects\n      return <W0><TabiversePlanet {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV4: // markers are objects\n      return <W0><ThreePanelV4 {...props} /></W0>\n\n    case C.map_panel_types.GoogleMaps:\n      return <W0><GoogleMaps {...props} /></W0>\n\n    default:\n      logg(null, `This map_panel_type is not implemented! ${props.map.config.map_panel_type}`)\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanel {...props} /></W0>\n  }\n})\nexport default WrappedMapPanel\n\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  logg,\n  TwofoldContext,\n} from \"$shared\"\n\nconst W = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 1;\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * ZoomCtrl\n */\nconst ZoomCtrl = (props) => {\n  logg(props, 'ZoomCtrl')\n\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <W className='ZoomCtrl' >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </W>\n}\n\nexport default ZoomCtrl\n","\nimport PropTypes from 'prop-types'\nimport { Grid } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\n\nconst Label = styled.div``;\n\nconst Features = ({ features, label, ...props }) => {\n  // logg(props, 'Features')\n\n  const out = []\n  features.map((f) => {\n    if (f.inner_html) {\n      out.push(<Grid item sm={3} dangerouslySetInnerHTML={{ __html: f.inner_html }} />)\n    }\n  })\n\n  return <F>\n    {label && <Label>{label}</Label>}\n    <Grid style={{ marginBottom: '1em' }} container spacing={2}>\n      { out }\n    </Grid>\n  </F>\n}\n\nFeatures.propTypes = {\n  features: PropTypes.arrayOf(PropTypes.shape({\n    inner_html: PropTypes.string,\n  }) ),\n  label: PropTypes.string,\n}\nexport default Features","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  MainHeader,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\nconst SitesShow = (props) => {\n  // logg(props, 'SitesShow')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ loading, setLoading ] = useState(false)\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    api.applicationHome().then(data => {\n      if (!mountedRef.current) { return null }\n      setSite(data)\n      setLoading(false)\n    })\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n      { /* <Hero /> */ }\n      <MainHeader />\n\n      <Features features={site.features} />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow\n","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  BottomDrawer,\n  MainHeader, Menu, MenuBottom, MenuLeft,\n  UnlockModal\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\n// Currently a homepage, like a wp page.\nconst SitesShow1 = (props) => {\n  // logg(props, 'SitesShow1')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ artTag, setArtTag ] = useState({ features: [] })\n  let [ homeRow1Tag, setHomeRow1Tag ] = useState({ features: [] })\n  let [ interestingLocationsTag, setInterestingLocationsTag ] = useState({ features: [] })\n  let [ loading, setLoading ] = useState(false)\n\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  // loads all data\n  useEffect(() => {\n    // setLoading(true)\n\n    const fn = async () => {\n\n      if (!mountedRef.current) { return }\n      const data = await api.applicationHome()\n      logg(data, 'zeDataZ')\n      setSite(data)\n\n      // @TODO: this was here before, but not anymore. Check it out. _vp_ 2022-03-19\n\n      // api.getTag({ slug: 'interesting-locations' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   logg(data, 'setInterestingLocations')\n      //   setInterestingLocationsTag(data)\n      //   // setLoading(false)\n      // })\n\n      // api.getTag({ slug: 'home-row-1' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   setHomeRow1Tag(data)\n      // })\n\n      // api.getTag({ slug: 'art' }).then(data => {\n      //   if (!mountedRef.current) { return null }\n      //   setArtTag(data)\n      // })\n\n    }\n    fn()\n\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n\n      <MainHeader />\n      { /* <Hero /> */ }\n\n      <Features features={interestingLocationsTag.features} label=\"Interesting Locations\" />\n      <Features features={homeRow1Tag.features} label=\"Interesting Tags\" />\n      <Features features={artTag.features} label=\"art\" />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow1\n","import { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react';\nimport { Container, Grid, GridList } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport config from \"config\";\n\nimport { useApi, logg, request } from \"$shared\";\n\nconst useStyles = makeStyles((theme) => ({\n\n  paper: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n    color: theme.palette.text.secondary,\n  },\n  redBorder: {\n    border: '1px solid red',\n  },\n  root: {\n    flexGrow: 1,\n    overflow: 'scroll',\n    height: '100vh',\n  },\n\n}));\n\nconst VideoItem = styled.div`\n  border-bottom: 1px solid red;\n`;\n\nconst Video = (props) => {\n  logg(props, 'Video');\n  const api = useApi()\n\n  const { item: video } = props;\n\n  return <VideoItem key={props.idx} >\n    <h5>Video {video.name}</h5>\n    <p>created {video.created_at}</p>\n    <video controls preload=\"metadata\" type=\"video/mp4\" src={video.video_url}\n      style={{ maxWidth: '500px', maxHeight: '90vh' }} ></video>\n  </VideoItem>;\n};\n\nconst Videos = () => {\n  logg(config, 'Videos component');\n  console.log(JSON.stringify(config));\n\n  const [videos, setVideos] = useState([]);\n\n  const jwtToken = localStorage.getItem(\"jwtToken\");\n\n  const classes = useStyles();\n  const api = useApi()\n\n  useEffect(() => {\n    logg('posting...');\n    request.post(api.myVideosPath, { jwtToken: jwtToken }).then(r => r.data\n      ).then(({ videos }) => {\n        logg(videos, 'data')\n        setVideos(videos);\n      })\n  }, []);\n\n  return <Container maxWidth=\"md\">\n    <Grid container className={classes.root} >\n      <Grid item xs={12} >\n        <h2>My Videos</h2>\n      </Grid>\n      <Grid item xs={12}>\n        { videos && videos.map((v, idx) => <Video key={idx} item={v} ></Video> ) }\n      </Grid>\n    </Grid>\n  </Container>;\n\n};\n\nexport default Videos;\n","\nimport { Container as _Container, } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useState } from 'react'\nimport {\n  Switch, BrowserRouter as Router, Redirect, Route as _Route,\n} from 'react-router-dom'\nimport { ToastContainer, toast } from 'react-toastify'\nimport 'react-toastify/dist/ReactToastify.css'\nimport styled from 'styled-components'\n\nimport config from \"config\"\nimport {\n  AuthContextProvider,\n} from 'ishlibjs'\n\nimport {\n  BottomDrawer,\n  UnlockModal,\n} from \"$components/application\"\nimport MapuiLayout from \"$components/application/MapuiLayout\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\n// @TODO: MyGalleries doesn't look right...\nimport { GalleriesShow, MyGalleries } from \"$components/galleries\"\nimport { LocationsShowDesktop } from \"$components/locations\"\nimport { ReportsShow } from \"$resources/reports\"\nimport SitesShow from '$components/sites/SitesShow1'\nimport {\n  Account,\n} from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport {\n  C, CollapsibleContextProvider,\n  logg,\n  TwofoldContextProvider,\n  useApi,\n} from \"$shared\"\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n\n// import './theme/variables.css' // removed due to next_js _vp_ 2022-08-15\n\n\nconst Root = styled.div`\n  // border: 1px solid #741741;\n\n  background: ${p => p.theme.colors.background};\n  height: 100vh;\n  overflow: auto;\n`;\n\n/**\n * AppDesktop\n**/\nconst AppDesktop = (props) => {\n  // logg(props, 'AppDesktop')\n  // const {} = props\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n\n  const Container = (props) => {\n    switch(layout) {\n      case C.layout_onecol:\n        // main case\n        return <_Container maxWidth=\"md\" {...props} />\n      case C.layout_mapui:\n        return <MapuiLayout {...props} />\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  return (<Router>\n    <AuthContextProvider {...{ useApi, }} >\n      <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n        <CollapsibleContextProvider >\n          <Root>\n\n            <Container >\n              <Switch id=\"main\" main >\n\n                <Redirect exact from=\"/\" to={config.homePath} />\n                <Route exact path=\"/en\" ><SitesShow /></Route>\n\n                <Route exact path=\"/en/account\" component={Account} />\n                <Route exact path=\"/en/account/my/videos\" component={Videos} />\n                <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n                <Route exact path=\"/en/cities\"                 component={CitiesList} />\n                <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n                <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n                <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n                <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowDesktop} layout={C.layout_mapui} />\n                <Route exact path=\"/en/locations/show/:slug/:item_type/show/:item_slug\" component={LocationsShowDesktop} layout={C.layout_mapui} />\n\n              </Switch>\n            </Container>\n          </Root>\n\n          <BottomDrawer />\n          <UnlockModal />\n\n        </CollapsibleContextProvider>\n      </TwofoldContextProvider>\n    </AuthContextProvider>\n  </Router>)\n}\n\nexport default AppDesktop\n","import { Container as _Container, Grid, GridList } from '@material-ui/core'\n\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport Modal from \"react-modal\"\nimport {\n  Switch, BrowserRouter as Router, Redirect, Route as _Route,\n} from 'react-router-dom'\nimport styled, { useTheme } from 'styled-components'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n// import './theme/variables.css' // removed due to next_js _vp_ 2022-08-15\n\nimport config from \"config\"\nimport {\n  AuthContextProvider,\n  LoginModal,\n  RegisterModal,\n} from 'ishlibjs'\n\n\nimport { BottomDrawer,\n  Menu, MenuBottom, MenuLeft,\n  MapuiMobileLayout,\n  UnlockModal } from \"$components/application\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\nimport {\n  GalleriesShow, Galleries, MyGalleries,\n} from \"$components/galleries\"\nimport { LocationsShowMobile } from \"$components/locations\"\nimport { ReportsShow } from \"$resources/reports\"\nimport { SitesShow } from '$components/sites'\nimport {\n  Account,\n} from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport {\n  C, CollapsibleContextProvider,\n  logg,\n  TwofoldContext, TwofoldContextProvider,\n  useApi,\n} from \"$shared\"\n\nconst Root = styled.div`\n  background: ${p => p.theme.colors.background};\n  height: 100vh;\n  overflow: auto;\n`;\n\nconst __Container = styled(_Container)`\n  padding: 0;\n  height: 100vh;\n  overflow: scroll;\n`;\n\n/**\n * AppMobile\n**/\nconst AppMobile = (props) => {\n  logg(props, 'AppMobile')\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n  // const [ bottomDrawerOpen, setBottomDrawerOpen ] = React.useState(false)\n  // const [ itemToUnlock, setItemToUnlock ] = React.useState(false)\n  // const [ zoom, setZoom ] = useState(1)\n  const theme = useTheme()\n\n  // @TODO: move into its own component!\n  const Container = ({ children, ...props }) => {\n    // logg(props, 'Container')\n\n    const {\n      bottomDrawerOpen,\n    } = useContext(TwofoldContext)\n\n    const style = {\n      paddingBottom: bottomDrawerOpen ? theme.bottomDrawerOpenHeight : null\n    }\n\n    switch(layout) {\n      case C.layout_onecol:\n        return <__Container style={style} maxWidth=\"md\" {...props} >{ children }</__Container>\n      case C.layout_mapui:\n        // This is true right now (2021-10-20) for mobile even when it's one column\n        return <MapuiMobileLayout style={style} {...props} >{ children }</MapuiMobileLayout>\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  // const doUnlock = async () => {\n  //   // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n  //   const path = api.doUnlock({ kind: 'Report', id: itemToUnlock.report_id })\n  //   const result = await request.post(`${config.apiOrigin}${path}`)\n  //   logg(result, 'result of unlocking')\n  // }\n\n  return (<Router>\n    <AuthContextProvider {...{ useApi, }} >\n    <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n      <CollapsibleContextProvider >\n        { layout === C.layout_onecol && <MenuLeft variant={C.variants.floating} /> }\n        <Root className=\"Root\" >\n\n          <Container className=\"Container\" >\n            <Switch id=\"main\" main >\n\n              <Redirect exact from=\"/\" to={config.homePath} />\n              <Route exact path=\"/en\" ><SitesShow /></Route>\n\n              <Route exact path=\"/en/account\" component={Account} />\n              <Route exact path=\"/en/account/my/videos\" component={Videos} />\n              <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n              <Route exact path=\"/en/cities\"                 component={CitiesList} />\n              <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n              <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n              <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n              <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowMobile} layout={C.layout_mapui} />\n              <Route exact path=\"/en/locations/show/:slug/:item_type/show/:item_slug\" component={LocationsShowMobile} layout={C.layout_mapui} />\n\n            </Switch>\n          </Container>\n\n        </Root>\n\n        <BottomDrawer />\n        <UnlockModal />\n        <LoginModal />\n        <RegisterModal />\n\n      </CollapsibleContextProvider>\n    </TwofoldContextProvider>\n    </AuthContextProvider>\n  </Router>)\n}\n\nexport default AppMobile\n","\nimport { Device } from '@capacitor/device'\nimport React, { useContext, useEffect, useRef, useState, } from 'react'\nimport { ThemeProvider } from 'styled-components'\nimport { ToastContainer } from 'react-toastify'\n\nimport config from 'config'\n\nimport { C, logg, request, S, useApi } from \"$shared\"\nimport AppDesktop from './AppDesktop'\nimport AppMobile from './AppMobile'\n\n\n/**\n * Chooses mobile vs desktop\n */\nconst AppWrapper = (props) => {\n  // logg(props, 'AppWrapper')\n\n  const [ os, setOs ] = useState(null)\n  // info.operatingSystem === 'ios' || 'android'\n  const fn = async () => {\n    let info = await Device.getInfo()\n    setOs(info.operatingSystem)\n  }\n  fn()\n\n  const [theme, setTheme] = useState(window.localStorage.getItem(C.theme) || C.themes.light)\n  const toggleTheme = (e) => {\n    if (theme === C.themes.light) {\n      window.localStorage.setItem(C.theme, C.themes.dark)\n      setTheme(C.themes.dark)\n    } else {\n      window.localStorage.setItem(C.theme, C.themes.light)\n      setTheme(C.themes.light)\n    }\n  }\n\n  const childProps = {\n    theme, toggleTheme,\n  }\n\n  if (!os) { return null }\n  return <ThemeProvider theme={theme == C.themes.light ? S.lightTheme: S.darkTheme} >\n    { \"ios android\".includes(os) ?\n      <AppMobile {...childProps} />\n      : <AppDesktop {...childProps} /> }\n    <ToastContainer position=\"bottom-left\" />\n  </ThemeProvider>\n}\n\nexport default AppWrapper\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppWrapper from './AppWrapper'\nimport * as serviceWorker from './serviceWorker'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\n\nimport 'react-toastify/dist/ReactToastify.css'\nimport styles from 'ishlibjs/dist/index.css'\n\nReactDOM.render(<AppWrapper />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n\n\n\n"],"sourceRoot":""}