{"version":3,"sources":["components/newsitems/Newsitems.module.scss","components/ItemModal/ItemModal.module.scss","components/application/PurchaseModal.module.scss","components/application/UnlockModal.module.scss","components/cities/Cities.module.scss","components/markers/Markers.module.scss","components/locations3d/vendor/MovementPadBg.png","components/locations3d/vendor/aim.svg","components/application/Metaline.module.scss","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../config/environments/production_ish/config.js","../../ishlibjs/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../../ishlibjs/node_modules/@ionic/core/node_modules/@stencil/core/internal/client lazy /^/.//.*$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../config/environments/default.js","components/venues/Venues.module.scss","shared/C.jsx","../../src/shared/C.jsx","../../src/shared/request.jsx","../../src/shared/S.jsx","../../src/shared/TwofoldContext.jsx","../../src/shared/index.jsx","../../src/components/users/AuthWidget.jsx","../../src/components/users/LoginModal.jsx","../../src/components/users/RegisterModal.jsx","../../src/components/users/index.jsx","../../src/TestApp.jsx","../../src/components/users/JwtContext.jsx","../../src/components/users/Scratchpad.jsx","../../src/components/SideMenu/index.jsx","../../src/index.jsx","shared/AppProvider.jsx","shared/Api.jsx","components/cities/CitiesList.jsx","components/locations/GoogleMaps.jsx","components/locations/LocationProvider.jsx","components/locations/LocationsRestricted.jsx","components/photos/PhotosShow.jsx","components/galleries/GalleriesShow.jsx","components/reports/ReportsForm.jsx","components/reports/ReportsShow.jsx","components/ItemModal/ItemModal.jsx","components/markers/Marker.jsx","components/markers/MarkersList.jsx","components/markers/MarkerForm.jsx","components/markers/index.jsx","components/locations/LocationsShow.jsx","components/locations/LocationsShowAsync.jsx","components/locations3d/Blocker.jsx","components/locations3d/Crosshair.jsx","components/locations3d/vendor/PointerLockControls.js","components/locations3d/vendor/RotationPad.jsx","components/locations3d/ThreePanelMobile.jsx","components/locations3d/vendor/MovementPad.jsx","components/locations3d/vendor/TouchControls.jsx","components/locations3d/Equirectangular4.jsx","components/locations3d/TabiversePlanet.jsx","components/locations3d/vendor/CSS2DRenderer.js","components/locations3d/ThreePanelDesktop.jsx","components/locations3d/ThreePanelV1.jsx","components/locations3d/ThreePanelV2.jsx","components/locations3d/ThreePanelV3.jsx","components/locations3d/ThreePanelV4.jsx","components/locations/LocationsShowMobile3d.jsx","components/locations/MapPanel.jsx","components/locations/WrappedMapPanel.jsx","components/locations/ZoomCtrl.jsx","components/newsitems/NewsitemGallery.jsx","components/newsitems/NewsitemPhoto.jsx","components/newsitems/NewsitemReport.jsx","components/newsitems/NewsitemVideo.jsx","components/newsitems/Newsitems.jsx","components/Votable/Votable.jsx","components/Votable/index.jsx","components/newsitems/NewsitemContainer.jsx","components/newsitems/ItemIcon.jsx","components/newsitems/index.js","components/venues/Rating.jsx","components/venues/Venues.jsx","components/cities/CitiesShow.jsx","components/users/Account.jsx","components/users/MyAccountWidget.jsx","components/users/index.jsx","AppRouter.jsx","shared/request.jsx","shared/S.jsx","shared/SsrProvider.jsx","shared/ThemeProvider.jsx","shared/useWindowSize.jsx","shared/index.jsx","components/TwofoldLayout/Collapsible.jsx","components/TwofoldLayout/LongLine.jsx","components/TwofoldLayout/TwofoldContext.jsx","components/application/BottomDrawer.jsx","components/application/Breadcrumbs.jsx","components/application/DayNightToggle.jsx","components/application/Metaline.jsx","components/application/PurchaseModal.jsx","components/application/RatedRestrictionModal.jsx","components/application/SideMenu.jsx","components/application/UnlockModal.jsx","WrappedApp.jsx","serviceWorker.js","index.jsx","components/galleries/Galleries.module.scss","components/application/DayNightToggle.module.scss"],"names":["module","exports","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","defaultSettings","require","GOOGLE_MAPS_KEY","APP_ENV","homePath","REACT_ENV","requireLogin","stripePublicKey","webpackEmptyAsyncContext","appIndexPath","apiOrigin","domain","debug","siteTitle","C","actions","new","show","anonUser","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","newsitems","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","location","report","photo","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","Equirectangular","GoogleMaps","MapPanel","MapPanelNoZoom","TabiversePlanet","ThreePanelV1","ThreePanelV1Fullscreen","ThreePanelV4","names","editorMode","rated","nc17","ratedConfirmation","ref","init","loading","theme","themes","dark","light","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","vote_values","up","down","scratchpad","axios","S","borderWidth","bottomDrawerClosedHeight","bottomDrawerOpenHeight","breadcrumbsHeight","thinBorderWidth","thinBorderRadius","thinBorder","colors","text","background","blue","darkGrey","lightGrey","red","border","cardBackground","React","Btn","styled","CloseBtn","p","props","style","cursor","onClick","PropTypes","isRequired","_FlexCol","FlexCol","children","className","FlexRow","logg","a","b","c","window","console","_Header","ModalHeader","onClose","RegisterWithEmailBtn","LoginWithEmailBtn","IconLogout","w","h","xmlns","width","height","viewBox","enableBackground","d","AuthWidget","useContext","currentUser","setCurrentUser","setLoginModalOpen","setRegisterModalOpen","localStorage","onError","inn","toast","onSuccess","LoginModal","loginModalOpen","useApi","useState","email","setEmail","password","setPassword","api","doPasswordLogin","err","Modal","styles","isOpen","overlayClassName","portalClassName","LoginModalPortal","Notice","htmlFor","name","type","value","onChange","onKeyDown","flexDirection","justifyContent","marginTop","margin","func","RegisterModal","registerModalOpen","password2","setPassword2","out","r","doRegister","AuthContext","createContext","AuthContextProvider","_currentUser","_setCurrentUser","_loginModalOpen","_setLoginModalOpen","_registerModalOpen","_setRegisterModalOpen","moreProps","config","TestApp","request","position","JwtContext","JwtContextProvider","useEffect","resp","object","string","process","ReactDOM","document","WLoginModal","AppContext","AppProvider","useHistory","ReactRouterDOM","os","setOs","Device","getInfo","info","operatingSystem","fn","Provider","propTypes","token","getItem","deleteNewsitem","data","post","user","doUnlock","kind","path","getCities","get","getCity","slug","getGallery","getLocation","_npg","newsitems_page","getMyAccount","getPhoto","getReport","getTag","tag","initPayment","amount_cents","amountCents","longTermTokenPath","postLogin","setItem","myVideosPath","applicationHome","params","vote","voter_id","votee_id","votee_class_name","unvote","Counts","div","Count","IonIcon","_IonIcon","Number","W0","CitiesList","cities","setCities","filteredCities","setFilteredCities","showLoading","setShowLoading","res","ev","filter","city","toLowerCase","indexOf","target","trim","icon","funnel","i","key","bookmark","src","n_reports","newspaperOutline","n_galleries","image","n_videos","videocam","onDidDismiss","message","duration","Map","onIdle","options","setMap","current","google","maps","useDeepCompareEffectForMaps","setOptions","forEach","eventName","event","clearListeners","addListener","child","Marker","marker","setMarker","useDeepCompareMemoize","callback","dependencies","App","clicks","setClicks","zoom","setZoom","lat","x","lng","y","center","setCenter","form","display","padding","flexBasis","overflow","length","latLng","JSON","stringify","toJSON","apiKey","m","getZoom","getCenter","flexGrow","LocationContext","LocationProvider","Page","PhotosShow","item","original_url","alt","subhead","GalleriesShow","match","setGallery","mountedRef","useRef","TwofoldContext","itemToUnlock","setItemToUnlock","_gallery","is_premium","is_purchased","narrow","heading","title","thumbs","photos","ph","card","thumb_url","dangerouslySetInnerHTML","__html","full_img_section","large_url","Actions","ReportForm","ReportsShow","descr","raw_json","content","rendered","ItemModal","useParams","history","setShowItem","showItem","action","setAppElement","ItemModalOverlay","ItemModalPortal","push","appPaths","item_type","reportname","ReportsForm","_W0","MarkerEmpty","_props","setShowUrl","showUrl","href","destination_slug","preventDefault","premium_tier","url","title_img_path","variant","MarkersList","idx","times","arrayOf","shape","MarkerForm","MarkerContext","_MoveLeftRightIcon","fill","version","stroke","strokeWidth","fillRule","transform","MoveLeftRightIcon","_D","Description","_Handle","Handle","folded","setFolded","setTwofoldPercent","useWindowSize","orientation","IframeModal","ariaHideApp","scrolling","frameBorder","allowtransparency","allowFullScreen","_Left","Left","_Right","Right","LocationsShow","setMapPanelWidth","mapPanelWidth","setMapPanelHeight","mapPanelHeight","setRatedConfirmation","windowWidth","windowHeight","mapPanelRef","closable","offsetWidth","offsetHeight","label","labels","LocationsShowAsync","setLocation","q","search","useLocation","useMemo","URLSearchParams","useQuery","chain","itemType","inflector","classify","item_slug","all","rs","LocationsRestricted","_Blocker","forwardRef","_euler","Euler","_vector","Vector3","_changeEvent","_lockEvent","_unlockEvent","_PI_2","Math","PI","PointerLockControls","camera","domElement","undefined","warn","body","isLocked","minPolarAngle","maxPolarAngle","scope","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","max","min","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","error","connect","addEventListener","disconnect","removeEventListener","dispose","this","getObject","getDirection","direction","v","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","addScaledVector","moveRight","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","RotationPad","container","eventRepeatTimeout","newLeft","newTop","angle","mouseDown","self","regionData","handleData","rotationPad","region","onMouseDown","handle","css","pageX","pageY","offset","left","top","pow","centerX","centerY","radius","atan2","cos","sin","round","deltaX","parseInt","deltaY","sendEvent","dx","dy","clearTimeout","setTimeout","moveEvent","$","Event","detail","bubbles","trigger","update","_C","epsilon","events","move","stopMove","gotoPosition","origin","Loc","renderer","scene","texture","canJump","prevTime","performance","now","velocity","THREE","loader","GLTFLoader","worldOctree","Octree","blockerRef","instructionsRef","set","fog","add","axesHelper","normalize","multiplyScalar","loadTexture","floorGeometry","rotateX","floorMaterial","floor","load","asset3d_path","gltf","fromGraphNode","traverse","isMesh","castShadow","receiveShadow","material","anisotropy","textureLoader","rt","fromEquirectangularTexture","cameraHolder","antialias","setPixelRatio","devicePixelRatio","setSize","appendChild","onWindowResize","animate","aspect","clientWidth","clientHeight","updateProjectionMatrix","requestAnimationFrame","time","delta","abs","z","translateX","translateZ","render","Blocker","thresh","_Pad","Pad","MovementPad","eventStopTimeout","regionRef","getBoundingClientRect","onTouchEnd","resetHandlePosition","stopEvent","CustomEvent","middle","bgImg","onTouchCancel","onTouchStart","persist","targetTouches","onTouchMove","touches","right","aimSvg","TouchControls","speedFactor","rotationFactor","maxPitch","hitTest","hitTestDistance","isRightMouseDown","rotationMatrices","fpsBody","mouse","calculateCameraRotation","factor","ry","rotation","rx","on","setRotation","enabled","button","stopPropagation","keyCode","clientX","innerWidth","clientY","innerHeight","originalEvent","rotationMatrixF","makeRotationY","rotationMatrixB","rotationMatrixL","rotationMatrixR","prepareRotationMatrices","prototype","addToScene","setPosition","stopMouseMoving","getHitObjects","hitObjects","W","Equirectangular2","controls","markerObjects","wContainerRef","moveLeft","moveBackward","axes","wContainer","wrapS","wrapT","repeat","assetPath","img_path","canvas","needResize","resizeRendererToDisplaySize","cameraDirection","clone","intersections","intersectObjects","onObject","geometry","planet","Object3D","Matrix4","ThreePanelDesktop","markers2destinationSlugs","pickingObjects","playerCtl","playerCollider","playerBody","playerColliderHelper","shadowLight","shadow","bottom","near","far","helper","playerVelocity","pickedObject","uuid","translate","side","gltfLoader","scale","shadowMap","helperMaterial","color","wireframeMaterial","wireframe","deltaPosition","pickedObjectSavedColor","Capsule","playerOnFloor","playerDirection","colliderCenter","playerCtlGeometry","playerBodyGeometry","updateMatrixWorld","getWorldDirection","cameraPosition","applyMatrix4","matrixWorld","pickingIntersections","emissive","setHex","getHex","damping","exp","collisionIntersections","capsuleIntersect","result","normal","dot","depth","markerObjectsIdxs","pMat","uniforms","main_color","g","border_color","thickness","opacity","vertexShader","fragmentShader","manager","mtlLoader","MTLLoader","setPath","onProgress","xhr","lengthComputable","percentComplete","loaded","total","log","modelName","texturePath","modelPath","materials","preload","objLoader","OBJLoader","setMaterials","random","wrappedOnLoad","LocationsShowMobile3d","ThreePanelMobile","W1","setMarkerModalOpen","markerModalOpen","nextZoomByWidth","nextZoomByHeight","nextZoom","zIndex","maxWidth","maxHeight","FW","WrappedMapPanel","map_panel_type","Equirectangular4","withZoom","Images","Thumb0","Thumb1","_Thumb2","Thumb2","NewsitemGallery","location_slug","n_photos","array","ImageLarge","img","NewsitemPhoto","NewsitemReport","NewsitemVideo","youtube_id","allow","Pagination","CurrentPageNum","PageNum","_key","_EditModeActions","EditModeActions","confirm","newsitem_id","Newsitems","newsitems_pagination","newsitem","previous","next","IconUp","IconDown","WCount","Votable","votes_score","votesScore","setVotesScore","upFill","setUpFill","downFill","setDownFill","current_user_vote_value","currentUserVoteValue","setCurrentUserVoteValue","Col","_Row","smallWidth","Row","RowInline","A","TitleA","NewsitemContainer","layout","navigateToItem","alignItems","overflowWrap","_Icon","span","IconGallery","useTheme","IconGem","gold","IconGlasses","cyan","IconReport","IconVideo","clipRule","ItemIcon","bool","number","GenericNewsitem","Rating","rate","rating","setRating","iconMapping","0","starOutline","1","starHalf","2","star","Array","Address","_Ra","RightArrow","Title","Venue","Venues","venues","filteredVenues","setFilteredVenues","venue","includes","paddingRight","tags","address","CitiesShow","thisPath","cityPath","setCity","backgroundImage","hero_img","backgroundSize","pin","pathname","cityVenuesPath","exact","isPushNotificationsAvailable","Capacitor","isPluginAvailable","greeterAddress","tokenAddress","PasswordLogin","LoginRow","Account","greeting","setGreetingValue","notifications","setNotifications","setScratchpad","register","PushNotifications","showToast","alert","_n","n","ns","nofitication","msg","Toast","requestAccount","ethereum","method","fetchGreeting","provider","ethers","providers","Web3Provider","contract","Contract","Greeter","abi","greet","account","Token","balanceOf","balance","toString","signer","getSigner","setGreeting","transaction","wait","transfer","userAccount","amount","transation","checkPermissions","receive","requestPermissions","Grid","spacing","xs","placeholder","setUserAccount","setAmount","to","notif","expand","Edit","EditIcon","_Img","Img","_CoinManager","InjectedConnector","CoinManager","MyAccountWidget","setPurchaseModalOpen","setEditorMode","purchaseModalOpen","avatar","useWeb3React","active","library","connector","activate","deactivate","profile_photo_url","n_unlocks","FacebookLogin","Plugins","FACEBOOK_PERMISSIONS","FbLogin","doFbLogin","login","permissions","accessToken","BuyBtn","Logout","removeItem","tableize","newsitems_page_str","AppRouter","main","from","component","settings","baseURL","create","mediumWidth","lightTheme","darkTheme","SsrContext","SsrProvider","_location","ThemeContext","ThemeProvider","defaultTheme","setTheme","positive","negative","classList","remove","toggleTheme","size","useLayoutEffect","updateSize","BackIcon","BackBtn","arrowBack","goBack","ChevronLeft","_ChevronLeft","ChevronRight","_ChevronRight","_Card","_Box","Card","slice","ms","split","charAt","toUpperCase","join","_Circle","Loading","replace","MenuIcon","_MenuIcon","_WBordered","WBordered","CollapsibleContext","CollapsibleProvider","tmp","defaultCollapsibles","parse","_setCollapsibles","setCollapsibles","Gt","Inner","Lt","Label","WTransparent","Collapsible","LongLine","TwofoldContextProvider","setLayout","_showItem","_setShowItem","_setBottomDrawerOpen","_itemToUnlock","_setItemToUnlock","resizeCount","setResizeCount","_tfp","_setTwofoldPercent","_zoom","_setZoom","setBottomDrawerOpen","touchResize","Drawer","_Drawer","getLibrary","Web3","Inner0","Inner1","borderHeight","Inner2","WClosed","BottomDrawer","IconButton","aria-label","fontSize","anchor","elevation","open","BackdropProps","invisible","B0","B1","WBreadcrumbs","Breadcrumbs","breadcrumbs","DayNightToggle","readOnly","checked","sunMoon","dots","stars1","stars2","Metaline","created_at","username","substring","textDecoration","stripePromise","loadStripe","_PurchaseModal","stripe","useStripe","elements","useElements","setAmountCents","buyUnlocks","client_secret","confirmCardPayment","payment_method","getElement","CardElement","paymentIntent","status","setInterval","response","is_purchasing","clearInterval","LoginModalOverlay","onSubmit","disabled","PurchaseModal","RatedRestrictionModal","SideMenu","drawerOpen","setDrawerOpen","bookmarks","BtnRow","UnlockModal","cost","Root","WrappedApp","Boolean","hostname","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a92aaf5d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"icon\":\"Newsitems_icon__2m8Yx\",\"Newsitems\":\"Newsitems_Newsitems__28DCM\",\"Newsitem\":\"Newsitems_Newsitem__1YV1X\",\"newsitems\":\"Newsitems_newsitems__2__cT\",\"items\":\"Newsitems_items__1vDXi\",\"image\":\"Newsitems_image__XooGU\",\"title-heading\":\"Newsitems_title-heading__3SnV-\",\"routable\":\"Newsitems_routable__3F6RC\",\"description\":\"Newsitems_description__Quuc5\",\"image-section\":\"Newsitems_image-section__3_ISy\",\"play-icon\":\"Newsitems_play-icon__2n6oc\",\"premium-0\":\"Newsitems_premium-0__2W-9I\",\"premium-1\":\"Newsitems_premium-1__1sKSC\",\"premium-2\":\"Newsitems_premium-2__1e7dc\",\"image-item\":\"Newsitems_image-item__JlSoP\",\"number\":\"Newsitems_number__WsUI_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"plt-mobile\":\"ItemModal_plt-mobile__1MSjz\",\"ItemModal\":\"ItemModal_ItemModal___XHBt\",\"ItemModalOverlay\":\"ItemModal_ItemModalOverlay__2Va0-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LoginModal\":\"PurchaseModal_LoginModal__XwjI2\",\"LoginModalOverlay\":\"PurchaseModal_LoginModalOverlay__2J_Pd\",\"Notice\":\"PurchaseModal_Notice__3s00H\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"UnlockModal\":\"UnlockModal_UnlockModal__2msqx\",\"UnlockModalOverlay\":\"UnlockModal_UnlockModalOverlay__zVJbv\",\"Notice\":\"UnlockModal_Notice__2mk2J\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cities\":\"Cities_cities__2jyZa\",\"heading\":\"Cities_heading__1Y4L0\",\"city-show\":\"Cities_city-show__3p8O5\",\"filter-section\":\"Cities_filter-section__QkWYj\",\"filter-input\":\"Cities_filter-input__2qrNk\",\"filter-icon\":\"Cities_filter-icon__2RFrY\",\"bookmark-section\":\"Cities_bookmark-section__WbPmK\",\"bookmark-text\":\"Cities_bookmark-text__3pldy\",\"container\":\"Cities_container__pdWN1\",\"img-section\":\"Cities_img-section__2XiwK\",\"city-img\":\"Cities_city-img__JuCos\",\"city-title\":\"Cities_city-title__39j3v\",\"bookmark\":\"Cities_bookmark__5911O\",\"bookmark-icon\":\"Cities_bookmark-icon__25eUJ\",\"switch\":\"Cities_switch__2FFHz\",\"slider\":\"Cities_slider__2HQAT\",\"round\":\"Cities_round__NaUgd\",\"section-one\":\"Cities_section-one__2Ual1\",\"location\":\"Cities_location__2PNVH\",\"status\":\"Cities_status__1Joy3\",\"status-grid\":\"Cities_status-grid__E_QYt\",\"numbers\":\"Cities_numbers__3AaL3\",\"mid\":\"Cities_mid__-Ei45\",\"tags-container\":\"Cities_tags-container__1O8GT\",\"btn\":\"Cities_btn__3AZfF\",\"city-name\":\"Cities_city-name__2cKBL\",\"menu-item\":\"Cities_menu-item__LuXCf\",\"delete-btn\":\"Cities_delete-btn__3a5p9\",\"random\":\"Cities_random__8loYT\",\"info-icon\":\"Cities_info-icon__3crMF\",\"section-three\":\"Cities_section-three__3wkyz\",\"menu-option\":\"Cities_menu-option__3NgIq\",\"selected\":\"Cities_selected__3LwuR\",\"section-two\":\"Cities_section-two__SNgaW\",\"tags-section\":\"Cities_tags-section__k90Gs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MarkerModal\":\"Markers_MarkerModal__Pp6QQ\",\"MarkerModalOverlay\":\"Markers_MarkerModalOverlay__Nt0gt\"};","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDUwMy42MDcgNTAzLjYwNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTAzLjYwNyA1MDMuNjA3OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIj4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkNDMzA5OyIgZD0iTTQ3Ny40MjYsMjUwLjgwM2MwLTEzNC4yOTUtMTAxLjU2MS0yNDMuNDEtMjI2LjYyMy0yNDMuNDFTMjQuMTgsMTE2LjUwOCwyNC4xOCwyNTAuODAzDQoJCXMxMDEuNTYxLDI0My40MSwyMjYuNjIzLDI0My40MVM0NzcuNDI2LDM4NS45MzgsNDc3LjQyNiwyNTAuODAzIi8+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yNC4xOCwyNTAuODAzYzAtMTM0LjI5NSwxMDEuNTYxLTI0My40MSwyMjYuNjIzLTI0My40MWMtMTM0LjI5NSwwLTI0My40MSwxMDkuMTE1LTI0My40MSwyNDMuNDENCgkJczEwOS4xMTUsMjQzLjQxLDI0My40MSwyNDMuNDFDMTI1Ljc0MSw0OTQuMjEzLDI0LjE4LDM4NS45MzgsMjQuMTgsMjUwLjgwMyIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRDk4MDg7IiBkPSJNMjUwLjgwMyw3LjM5M2MxMjUuMDYyLDAsMjI2LjYyMywxMDkuMTE1LDIyNi42MjMsMjQzLjQxcy0xMDEuNTYxLDI0My40MS0yMjYuNjIzLDI0My40MQ0KCQljMTM0LjI5NSwwLDI0My40MS0xMDkuMTE1LDI0My40MS0yNDMuNDFTMzg1LjA5OCw3LjM5MywyNTAuODAzLDcuMzkzIi8+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGREQwOTsiIGQ9Ik0yMzguMjEzLDQ2MC42MzljLTEwOS4xMTUsMC0xOTcuMjQ2LTk0LjAwNy0xOTcuMjQ2LTIwOS44MzZTMTI5LjA5OCw0MC45NjcsMjM4LjIxMyw0MC45NjcNCgkJczE5Ny4yNDYsOTQuMDA3LDE5Ny4yNDYsMjA5LjgzNlMzNDcuMzI4LDQ2MC42MzksMjM4LjIxMyw0NjAuNjM5Ii8+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZEOTgwODsiIGQ9Ik0yNTAuODAzLDQwLjk2N2MtMi41MTgsMC00LjE5NywwLTYuNzE1LDBjMTA1Ljc1Nyw0LjE5NywxOTEuMzcsOTYuNTI1LDE5MS4zNywyMDkuODM2DQoJCXMtODUuNjEzLDIwNi40NzktMTkxLjM3LDIwOS44MzZjMi41MTgsMCw0LjE5NywwLDYuNzE1LDBjMTE1LjgyOSwwLDIwOS44MzYtOTQuMDA3LDIwOS44MzYtMjA5LjgzNlMzNjYuNjMzLDQwLjk2NywyNTAuODAzLDQwLjk2Nw0KCQkiLz4NCgk8cGF0aCBkPSJNMjUwLjgwMyw1MDIuNjA3QzExMi4zMTEsNTAyLjYwNy0xLDM5MC4xMzQtMSwyNTAuODAzYzAtNTcuMDc1LDE4LjQ2Ni0xMTEuNjMzLDU0LjU1Ny0xNTYuMTE4DQoJCWMyLjUxOC0zLjM1Nyw4LjM5My00LjE5NywxMS43NTEtMS42NzljMy4zNTcsMi41MTgsNC4xOTcsOC4zOTMsMS42NzksMTEuNzUxYy0zMy41NzQsNDEuOTY3LTUwLjM2MSw5Mi4zMjgtNTAuMzYxLDE0Ni4wNDYNCgkJYzAsMTI5LjI1OSwxMDUuNzU3LDIzNS4wMTYsMjM1LjAxNiwyMzUuMDE2czIzNS4wMTYtMTA1Ljc1NywyMzUuMDE2LTIzNS4wMTZTMzgwLjA2MiwxNS43ODcsMjUwLjgwMywxNS43ODcNCgkJYy00OS41MjEsMC05Ny4zNjQsMTUuMTA4LTEzNy42NTIsNDQuNDg1Yy0zLjM1NywyLjUxOC05LjIzMywxLjY3OS0xMS43NTEtMS42NzljLTIuNTE4LTMuMzU3LTEuNjc5LTkuMjMzLDEuNjc5LTExLjc1MQ0KCQlDMTQ2LjcyNSwxNS43ODcsMTk3LjA4NS0xLDI1MC44MDMtMWMxMzguNDkyLDAsMjUxLjgwMywxMTMuMzExLDI1MS44MDMsMjUxLjgwM1MzODkuMjk1LDUwMi42MDcsMjUwLjgwMyw1MDIuNjA3eiIvPg0KCTxwYXRoIGQ9Ik05MS4zMjgsNzQuNTQxYzAtNS4wMzYtMy4zNTctOC4zOTMtOC4zOTMtOC4zOTNjLTUuMDM2LDAtOC4zOTMsNC4xOTctOC4zOTMsOC4zOTNjMCw0LjE5NywzLjM1Nyw4LjM5Myw4LjM5Myw4LjM5Mw0KCQlDODcuOTcsODIuOTM0LDkxLjMyOCw3OS41NzcsOTEuMzI4LDc0LjU0MSIvPg0KCTxwYXRoIGQ9Ik0yNTAuODAzLDQ2OS4wMzNjLTEyMC4wMjYsMC0yMTguMjI5LTk3LjM2NC0yMTguMjI5LTIxOC4yM2MwLTEyMC4wMjYsOTguMjAzLTIxOC4yMjksMjE4LjIyOS0yMTguMjI5DQoJCXMyMTguMjMsOTguMjAzLDIxOC4yMywyMTguMjI5QzQ2OS4wMzMsMzcxLjY2OSwzNzAuODI5LDQ2OS4wMzMsMjUwLjgwMyw0NjkuMDMzeiBNMjUwLjgwMyw0OS4zNjENCgkJYy0xMTAuNzkzLDAtMjAxLjQ0Myw5MC42NDktMjAxLjQ0MywyMDEuNDQzczkwLjY0OSwyMDEuNDQzLDIwMS40NDMsMjAxLjQ0M3MyMDEuNDQzLTkwLjY0OSwyMDEuNDQzLTIwMS40NDMNCgkJUzM2MS41OTcsNDkuMzYxLDI1MC44MDMsNDkuMzYxeiIvPg0KCTxwYXRoIGQ9Ik0yNTAuODAzLDM2OC4zMTFjLTY0LjYzLDAtMTE3LjUwOC01Mi44NzktMTE3LjUwOC0xMTcuNTA4czUyLjg3OS0xMTcuNTA4LDExNy41MDgtMTE3LjUwOHMxMTcuNTA4LDUyLjg3OSwxMTcuNTA4LDExNy41MDgNCgkJUzMxNS40MzMsMzY4LjMxMSwyNTAuODAzLDM2OC4zMTF6IE0yNTAuODAzLDE1MC4wODJjLTU1LjM5NywwLTEwMC43MjEsNDUuMzI1LTEwMC43MjEsMTAwLjcyMXM0NS4zMjUsMTAwLjcyMSwxMDAuNzIxLDEwMC43MjENCgkJUzM1MS41MjUsMzA2LjIsMzUxLjUyNSwyNTAuODAzUzMwNi4yLDE1MC4wODIsMjUwLjgwMywxNTAuMDgyeiIvPg0KCTxwYXRoIGQ9Ik0yNTAuODAzLDE5Mi4wNDljLTUuMDM2LDAtOC4zOTMtMy4zNTctOC4zOTMtOC4zOTNWOTkuNzIxYzAtNS4wMzYsMy4zNTctOC4zOTMsOC4zOTMtOC4zOTNzOC4zOTMsMy4zNTcsOC4zOTMsOC4zOTMNCgkJdjgzLjkzNEMyNTkuMTk3LDE4OC42OTIsMjU1LjgzOSwxOTIuMDQ5LDI1MC44MDMsMTkyLjA0OXoiLz4NCgk8cGF0aCBkPSJNMjUwLjgwMyw0MTAuMjc5Yy01LjAzNiwwLTguMzkzLTMuMzU3LTguMzkzLTguMzkzdi04My45MzRjMC01LjAzNiwzLjM1Ny04LjM5Myw4LjM5My04LjM5M3M4LjM5MywzLjM1Nyw4LjM5Myw4LjM5Mw0KCQl2ODMuOTM0QzI1OS4xOTcsNDA2LjkyMSwyNTUuODM5LDQxMC4yNzksMjUwLjgwMyw0MTAuMjc5eiIvPg0KCTxwYXRoIGQ9Ik00MDEuODg1LDI1OS4xOTdoLTgzLjkzNGMtNS4wMzYsMC04LjM5My0zLjM1Ny04LjM5My04LjM5M3MzLjM1Ny04LjM5Myw4LjM5My04LjM5M2g4My45MzQNCgkJYzUuMDM2LDAsOC4zOTMsMy4zNTcsOC4zOTMsOC4zOTNTNDA2LjkyMSwyNTkuMTk3LDQwMS44ODUsMjU5LjE5N3oiLz4NCgk8cGF0aCBkPSJNMTgzLjY1NiwyNTkuMTk3SDk5LjcyMWMtNS4wMzYsMC04LjM5My0zLjM1Ny04LjM5My04LjM5M3MzLjM1Ny04LjM5Myw4LjM5My04LjM5M2g4My45MzQNCgkJYzUuMDM2LDAsOC4zOTMsMy4zNTcsOC4zOTMsOC4zOTNTMTg4LjY5MiwyNTkuMTk3LDE4My42NTYsMjU5LjE5N3oiLz4NCgk8cGF0aCBkPSJNMjY3LjU5LDI1MC44MDNjMC05LjIzMy03LjU1NC0xNi43ODctMTYuNzg3LTE2Ljc4N2MtOS4yMzMsMC0xNi43ODcsNy41NTQtMTYuNzg3LDE2Ljc4Nw0KCQljMCw5LjIzMyw3LjU1NCwxNi43ODcsMTYuNzg3LDE2Ljc4N0MyNjAuMDM2LDI2Ny41OSwyNjcuNTksMjYwLjAzNiwyNjcuNTksMjUwLjgwMyIvPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Metaline\":\"Metaline_Metaline__1zzRp\",\"user\":\"Metaline_user__38_o0\",\"city\":\"Metaline_city__XLu48\",\"tags\":\"Metaline_tags__2nkCA\"};","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t393,\n\t\t6\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t394,\n\t\t7\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t395,\n\t\t8\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t396,\n\t\t18\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t397,\n\t\t19\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t398,\n\t\t47\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t399,\n\t\t20\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t400,\n\t\t21\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t401,\n\t\t22\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t402,\n\t\t23\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t403,\n\t\t48\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t404,\n\t\t11\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t405,\n\t\t24\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t406,\n\t\t49\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t407,\n\t\t50\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t408,\n\t\t25\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t409,\n\t\t26\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t410,\n\t\t27\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t411,\n\t\t28\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t412,\n\t\t29\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t413,\n\t\t9\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t414,\n\t\t15\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t415,\n\t\t10\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t416,\n\t\t30\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t417,\n\t\t31\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t418,\n\t\t32\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t419,\n\t\t12\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t420,\n\t\t17\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t421,\n\t\t51\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t422,\n\t\t33\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t423,\n\t\t34\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t424,\n\t\t35\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t425,\n\t\t36\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t426,\n\t\t52\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t427,\n\t\t14\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t428,\n\t\t53\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t429,\n\t\t37\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t430,\n\t\t16\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t431,\n\t\t38\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t432,\n\t\t39\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t433,\n\t\t40\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t434,\n\t\t13\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t435,\n\t\t54\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 272;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t436,\n\t\t61\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 274;\nmodule.exports = webpackAsyncContext;","\n\nconst settings = {\n  \"apiOrigin\": \"https://manager.piousbox.com\",\n\n  \"domain\": \"tgm.piousbox.com\", // required! 2021-08-31\n\n  \"debug\": false,\n\n  GOOGLE_MAPS_KEY: 'AIzaSyCPzonnRCpTIUJauMMQcL3k69Vm5O8vz3M',\n\n  APP_ENV: 'development_web',\n  homePath: \"/en/locations/show/root\",\n\n  REACT_ENV: 'production_ish',\n  requireLogin: false,\n\n  stripePublicKey: 'pk_live_xQX97vdZNe11A3HBVZc1GX6H',\n};\n\nconst defaultSettings = require('../default.js')\nmodule.exports = { ...defaultSettings, ...settings }\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 305;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 306;","\nmodule.exports = {\n  appIndexPath: \"src/index\", // used in webpack\n  apiOrigin: \"\",\n  domain: \"tgm.piousbox.com\", // required! 2021-08-31\n  debug: false,\n  // homePath: \"<some-path>\",\n  REACT_ENV: 'N/A',\n  requireLogin: true,\n  siteTitle: 'Infinite Shelter - Location Discovery Guide',\n  stripePublicKey: '',\n}\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"venues-section\":\"Venues_venues-section__1Cg8m\",\"filter-section\":\"Venues_filter-section__3uQ4r\",\"filter-input\":\"Venues_filter-input__2ykRc\",\"filter-icon\":\"Venues_filter-icon__3VaeF\",\"container\":\"Venues_container__2SioC\",\"venues\":\"Venues_venues__3j85M\",\"info-section\":\"Venues_info-section__1E-6x\",\"reviews\":\"Venues_reviews__1Bh8Y\",\"description\":\"Venues_description__2oWIo\",\"tags\":\"Venues_tags__eZTOS\",\"forward-arrow\":\"Venues_forward-arrow__38w3n\",\"image-section\":\"Venues_image-section__gaKYX\"};","\n/**\n * Constants\n */\nconst C = {\n\n  // A\n  actions: { // CRUD\n    new: 'new',\n    show: 'show',\n  },\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    newsitems: \"newsitems-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    location: '::Gameui::Map',\n    report: 'Report',\n    photo: 'Photo',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    GoogleMaps: \"GoogleMaps\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    TabiversePlanet: \"TabiversePlanet\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV1Fullscreen: \"ThreePanelV1Fullscreen\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: { // for localStorage\n    editorMode: 'editorMode',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n  ref: {\n    init: 'init',\n    loading: 'loading',\n  },\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n  vote_values: {\n    up: 'up',\n    down: 'down',\n  },\n}\nexport default C\n","\n/**\n * Constants\n *\n * * C.anonUser\n * * C.current_user\n * * C.jwt_token\n * * C.item_types\n *\n */\nconst C = {\n\n  // A\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: {\n    scratchpad: 'Scratchpad',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","\nimport axios from \"axios\"\n\n/*\nimport config from \"config\"\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings)\n*/\n\nexport default axios.create({})\n","\n/**\n * Style Constants\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    blue: '#6aa3e9',\n    darkGrey: '#605d5d',\n    lightGrey: '#988b8b',\n    red: 'red',\n    border: 'black',\n    cardBackground: 'white'\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    blue: '#73b0fa',\n    darkGrey: '#b3afaf',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n    border: 'white',\n    cardBackground: '#1a1a1a'\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}","\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\n\nimport {\n  C,\n } from \"$shared\"\n\nconst TwofoldContext = React.createContext({})\nconst TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n    theme, toggleTheme, // @TODO: Theme is not part of TwofoldContext! _vp_ 2022-09-04\n  } = props\n\n  const api = useApi()\n\n  useEffect(() => {\n    let closure = setTimeout(async () => {\n      const result = await api.getMyAccount()\n      setCurrentUser(result)\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch?\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalIsOpen, setPurchaseModalIsOpen ] = useState(false)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalIsOpen, setPurchaseModalIsOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\nTwofoldContextProvider.propTypes = {} // none so far\n\nexport {\n  TwofoldContext,\n  TwofoldContextProvider,\n}\n// Is is better to have, or not have, this default export? _vp_ 2022-09-04\nexport default TwofoldContextProvider\n\n","/*\n *  $shared / index\n */\nimport { arrowBack, closeOutline, } from 'ionicons/icons'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport {\n  ChevronLeft as _ChevronLeft,\n  ChevronRight as _ChevronRight,\n  Close as _Close,\n  Menu as _MenuIcon,\n} from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\nimport {\n  Route as _Route, useHistory,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport C from './C'\n\n/* A */\n\nconst Actions = styled.div`\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n`;\nexport { Actions }\n\n/* B */\n\n/**\n * Back Button\n */\n// const BackIcon = styled(IonIcon)\n// @TODO: reintroduce IonIcon maybe?\nconst BackIcon = styled.div`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n`;\n\n\n/* C */\nexport { default as C } from './C'\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * CloseBtn\n**/\nexport const CloseBtn = ({ children, ...props }) => {\n  return <_Close style={{ cursor: 'pointer', ...props.style }} {...props} />\n};\nCloseBtn.propTypes = {\n  onClick: PropTypes.func.isRequired,\n}\n\n/* D */\n\n/* F */\n\n/**\n * FlexCol\n**/\nconst _FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n`;\nexport const FlexCol = ({ children, ...props }) => <_FlexCol className=\"FlexCol\" {...props} >{children}</_FlexCol>\n\n/**\n * FlexRow\n *\n * @TODO: Remove. Where is this used?! This is silly.\n**/\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n`;\n\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0 && typeof window !== \"undefined\") {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n\nconst _Header = styled.div`\n  flex-grow: 1;\n  text-align: center;\n  font-size: 1.2rem;\n`;\nexport const ModalHeader = ({ children, onClose, ...props }) => {\n  return <FlexRow >\n    <_Header>{children}</_Header>\n    <CloseBtn onClick={onClose} />\n  </FlexRow>\n}\nModalHeader.propTypes = {\n  onClose: PropTypes.func.isRequired,\n}\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport { TwofoldContext, TwofoldContextProvider } from './TwofoldContext'\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n * Used in collapsibles and MarkersList\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","\nimport React, { Fragment as F, useContext, } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext, AuthContextProvider,\n  FacebookLogin,\n  LoginModal, LoginWithEmail,\n  RegisterModal, RegisterWithEmail,\n} from \"$components/users\"\n\nimport {\n  Btn,\n  C,\n  FlexCol, FlexRow,\n  logg,\n} from \"$shared\"\n\n\nconst RegisterWithEmailBtn = (props) => {\n  return <Btn {...props} >Register with Email</Btn>\n}\nconst LoginWithEmailBtn = (props) => {\n  return <Btn {...props} >Login with Email</Btn>\n}\n\nconst IconLogout = ({ fill, w, h, ...props }) => {\n  // const theme = useTheme()\n\n  w = w ? w : '12px'\n  h = h ? h : '12px'\n  // fill = fill ? fill : theme.colors.text // @TODO: implement theme in ishlibjs\n  fill = fill ? fill : '#333333'\n\n  return <span {...props} >\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h}\n      viewBox=\"0 0 96.943 96.943\" style={{ enableBackground: 'new 0 0 96.943 96.943' }}\n    ><g><g><path d=\"M61.168,83.92H11.364V13.025H61.17c1.104,0,2-0.896,2-2V3.66c0-1.104-0.896-2-2-2H2c-1.104,0-2,0.896-2,2v89.623 c0,1.104,0.896,2,2,2h59.168c1.105,0,2-0.896,2-2V85.92C63.168,84.814,62.274,83.92,61.168,83.92z\"/> <path d=\"M96.355,47.058l-26.922-26.92c-0.75-0.751-2.078-0.75-2.828,0l-6.387,6.388c-0.781,0.781-0.781,2.047,0,2.828 l12.16,12.162H19.737c-1.104,0-2,0.896-2,2v9.912c0,1.104,0.896,2,2,2h52.644L60.221,67.59c-0.781,0.781-0.781,2.047,0,2.828 l6.387,6.389c0.375,0.375,0.885,0.586,1.414,0.586c0.531,0,1.039-0.211,1.414-0.586l26.922-26.92 c0.375-0.375,0.586-0.885,0.586-1.414C96.943,47.941,96.73,47.433,96.355,47.058z\"/> </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g></g><g></g><g></g>\n    </svg>\n  </span>\n}\n\n/**\n * If user is logged in, display the email/handle and allow logout.\n * If user is not logged in, allow registration and login via Fb, and email+passwd.\n *\n * @TODO: doesn't seem like this belongs in ishlibjs _vp_ 2022-09-04\n**/\nconst AuthWidget = (props) => {\n  // logg(props, 'AuthWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    doLogout: _doLogout,\n    setLoginModalOpen,\n    setRegisterModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'AuthWidgetUsedAuthContext')\n\n  // @TODO: doesn't belong here. Should be injected from the host. _vp_ 2022-09-04\n  const doLogout = () => {\n    setCurrentUser(C.anonUser)\n    localStorage.removeItem('jwt_token')\n    window.location.reload(false)\n  }\n\n  const onError = (inn) => {\n    logg(inn, 'cannot login!')\n    toast('cannot login!')\n  }\n  const onSuccess = (inn) => {\n    logg('Logged in successfully.')\n    setCurrentUser(inn)\n  }\n\n  if (currentUser?.email) {\n    return <FlexRow>\n      [&nbsp;{currentUser.email}&nbsp;<IconLogout onClick={doLogout} >Logout</IconLogout>&nbsp;]\n    </FlexRow>\n  }\n\n  return <F>\n    <FlexCol>\n      {/* <FacebookLogin /> */}\n      <RegisterWithEmailBtn onClick={() => { setRegisterModalOpen(true) }} />\n      <LoginWithEmailBtn    onClick={() => { setLoginModalOpen(true) }} />\n    </FlexCol>\n\n    <RegisterModal />\n    <LoginModal {...{ onError, onSuccess }} />\n\n  </F>\n}\nAuthWidget.propTypes = {} // none so far\n\nexport default AuthWidget\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { ToastContainer, toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n  ModalHeader,\n} from \"$shared\"\nimport {\n  AuthContext,\n} from './'\n\nimport styles from './LoginModal.module.scss'\n\n/**\n * LoginModal\n**/\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal, ishlibjs')\n  const {\n    onError, onSuccess,\n  } = props\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LoginModalUsedAuthContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const api = useApi()\n\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((r) => {\n      setLoginModalOpen(false)\n      onSuccess(r)\n    }).catch((err) => {\n      logg(err, 'e323 - cannot postLogin()')\n      // setCurrentUser(C.anonUser)\n      toast(\"Could not login.\")\n      onError(err)\n    })\n  }\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={!!loginModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => setLoginModalOpen(false)} >Login</ModalHeader>\n    { 'string' === typeof loginModalOpen && <FlexRow>\n      <div className={styles.Notice} >{ loginModalOpen }</div>\n    </FlexRow> }\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input name='email' type='email' value={email} onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input name='password' type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n        onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n      />\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n      </FlexRow>\n    </FlexCol>\n    <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n    <FlexRow style={{ justifyContent: 'center' }} >\n      <a onClick={() => setLoginModalOpen(false) || setRegisterModalOpen(true) }>Register Instead</a>\n    </FlexRow>\n  </Modal>\n}\nLoginModal.propTypes = {\n  onError: PropTypes.func,\n  onSuccess: PropTypes.func,\n}\nexport default LoginModal\n","\nimport React, { useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  ModalHeader,\n  logg,\n} from '$shared'\nimport {\n  AuthContext,\n} from '$components/users'\n\nimport styles from './LoginModal.module.scss'\n\n\n/**\n * RegisterModal\n *\n * Uses LoginModal styling\n**/\nconst RegisterModal = (props) => {\n  // logg(props, 'RegisterModal')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'registerModalUsedContext')\n\n  const api = useApi()\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const [ password2, setPassword2 ] = useState('')\n\n  const doRegister = async (email, password, password2) => {\n    if (password !== password2) {\n      toast('Passwords do not match')\n      return\n    }\n    const out = api.doRegister({ email, password })\n\n    out.then((r) => {\n      setRegisterModalOpen(false)\n      setLoginModalOpen(r.message)\n    }).catch((e) => {\n      toast(\"Registration failed\")\n    })\n  }\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={registerModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => setRegisterModalOpen(false)} >Register</ModalHeader>\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input type='email'    name='email'     value={email}    onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input type='password' name='password'  value={password} onChange={(e) => setPassword(e.target.value) } />\n\n      <label htmlFor='password2'>Confirm Password</label>\n      <input type='password' name='password2' value={password2} onChange={(e) => setPassword2(e.target.value) } />\n\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn className=\"Submit\" onClick={() => doRegister(email, password, password2) }>Register</Btn>\n      </FlexRow>\n      <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n      <FlexRow style={{ justifyContent: 'center' }} >\n        <a onClick={() => setLoginModalOpen(true) || setRegisterModalOpen(false) }>Login Instead</a>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\nRegisterModal.propTypes = {} // None so far\n\nexport default RegisterModal\n","\nimport { Plugins } from '@capacitor/core'\nimport React, { createContext, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\n/* A */\nconst AuthContext = createContext({})\nconst AuthContextProvider = ({children, ...props }) => {\n  // logg(props, 'AuthContextProvider')\n  let {\n    currentUser: _currentUser = C.anonUser, setCurrentUser: _setCurrentUser,\n    loginModalOpen: _loginModalOpen = false, setLoginModalOpen: _setLoginModalOpen,\n    registerModalOpen: _registerModalOpen = false, setRegisterModalOpen: _setRegisterModalOpen,\n  } = props\n\n  let [ currentUser, setCurrentUser ] = useState(_currentUser)\n  if (_setCurrentUser) {\n    currentUser = _currentUser\n    setCurrentUser = _setCurrentUser\n  }\n\n  let [ loginModalOpen, setLoginModalOpen ] = useState(_loginModalOpen)\n  if (_setLoginModalOpen) {\n    loginModalOpen = _loginModalOpen\n    setLoginModalOpen = _setLoginModalOpen\n  }\n\n  let [ registerModalOpen, setRegisterModalOpen ] = useState(_registerModalOpen)\n  if (_setRegisterModalOpen) {\n    registerModalOpen = _registerModalOpen\n    setRegisterModalOpen = _setRegisterModalOpen\n  }\n\n  const moreProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n  }\n\n  //\n  // props.useApi isRequired\n  //\n  return <AuthContext.Provider value={{ ...props, ...moreProps }} >\n    { children }\n  </AuthContext.Provider>\n}\nAuthContextProvider.propTypes = {\n  useApi: PropTypes.func.isRequired,\n}\n\nexport {\n  AuthContext, AuthContextProvider,\n}\nexport { default as AuthWidget } from './AuthWidget'\n\n/* F */\nconst { FacebookLogin: _FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\n/* J */\n\n\n\n/* L */\nexport { default as LoginModal } from \"./LoginModal\"\n\n/* R */\nexport { default as RegisterModal } from \"./RegisterModal\"\n\n\n","\nimport React, { useState, } from 'react'\nimport { toast, ToastContainer } from 'react-toastify'\n\n// import 'react-toastify/dist/ReactToastify.css' // @TODO: re-add somehow nicer.\n\nimport {\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthWidget,\n  AuthContextProvider,\n  LoginModal,\n } from './components/users'\n\nconst config = {\n  apiOrigin: 'http://localhost:3001',\n}\n\nconst TestApp = () => {\n\n  const useApi = () => ({\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users`, { email, password }).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n  })\n\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false) // useState(\"Please login!\")\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(true) // useState(\"Please register\")\n\n  return <AuthContextProvider {...{\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  }} >\n\n    {/* <LoginModal /> */}\n    <AuthWidget />\n\n    <ToastContainer position=\"bottom-left\" />\n  </AuthContextProvider>\n}\nexport default TestApp\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport { toast } from 'react-toastify'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from \"$shared\"\n\nexport const JwtContext = React.createContext({})\n\n/**\n * JwtContextProvider\n**/\nconst JwtContextProvider = ({ children, ...props }) => {\n  logg(props, 'JwtContextProvider 222')\n  const {\n    api,\n  } = props\n\n  // const maybeUser = JSON.parse(localStorage.getItem(C.current_user)) || C.anonUser\n  const [ currentUser, setCurrentUser ] = useState(C.anonUser)\n  const [ loginModalOpen, setLoginModalOpen ] = useState({})\n\n  // call to verify creds\n  useEffect(() => {\n    logg('setting currentUser...')\n\n    // request.get(`${config.apiOrigin}${config.routes.myAccountPath}`).then((r) => r.data).then((resp) => {\n    api.getMyAccount().then((resp) => {\n      logg(resp, 'got this resp')\n\n      // localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(`Login failed: ${e}`)\n      setCurrentUser(C.anonUser)\n      // localStorage.removeItem(C.current_user)\n      // localStorage.removeItem(C.jwt_token)\n    })\n  }, [])\n\n  return <JwtContext.Provider value={{\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }} >{ children }</JwtContext.Provider>\n}\nJwtContextProvider.props = {\n  api: PropTypes.object,\n}\nexport { JwtContextProvider }\n\n// @TODO: move to shared?\nconst FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst W1 = styled.div`\n  border: 1px solid red;\n`;\n\nconst W2 = styled.div`\n  display: flex;\n`;\n\nexport const SimpleJwtRow = () => {\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  // logg(useContext(JwtContext), 'SimpleJwtRowUsedJwtContext')\n\n  return <W1>\n    <FlexRow>\n      { /* <FbLogin /> */ }\n      { currentUser.email && <W2>\n        <i>{currentUser.email}</i>\n        <Logout />\n      </W2>}\n      { !currentUser.email && <LoginWithPassword /> }\n    </FlexRow>\n  </W1>\n}\n\n\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n// // @TODO: is this obsolete and unused?\n// // _vp_ 2022-09-01\n// export const LoginWithPassword = (props) => {\n//   // logg(useContext(JwtContext), 'useContext(JwtContext)')\n//   const {\n//     api,\n//     currentUser, setCurrentUser,\n//     loginModalOpen, setLoginModalOpen,\n//   } = useContext(JwtContext)\n//   const [ email, setEmail ] = useState('')\n//   const [ password, setPassword ] = useState('')\n//   const doPasswordLogin = async (email, password) => {\n//     // logg(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, 'doPasswordLogin')\n//     // request.post(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, { email, password }).then((r) => r.data\n//     api.postLoginWithPassword({ email, password }).then((resp) => {\n//       localStorage.setItem(C.jwt_token, resp.jwt_token)\n//       // localStorage.setItem(C.current_user, JSON.stringify(resp))\n//       setCurrentUser(resp) // must be done *after* setting C.jwt_token\n//       setLoginModalOpen(false)\n//     }).catch((e) => {\n//       logg(e, 'e322')\n//       // toast(\"Login failed\")\n//       setCurrentUser(C.anonUser)\n//     })\n//   }\n//   return <_W>\n//     <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n//     <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n//       onKeyDown={(e) => {\n//         if (e.key === 'Enter') { doPasswordLogin(email, password) }\n//       }}\n//     />\n//     <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n//   </_W>\n// }\n\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(JwtContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    // localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n","\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n} from '$components/users'\nimport {\n  Actions,\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nconst W0 = styled.div`\n`;\n\n\n/**\n * A single text area that saves locally and in the cloud.\n */\nconst Scratchpad = (props) => {\n  // logg(props, 'Scratchpad')\n\n  const {\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const [ txt, setTxt ] = useState(localStorage.getItem(C.names.scratchpad) || '')\n\n  const doSave = () => {\n    localStorage.setItem(C.names.scratchpad, txt)\n    api.postProfile({ scratchpad: txt }).then((data) => {\n      // toast('Updated profile.')\n    }).catch((err) => {\n      logg('Cannot update profile:', err)\n      // toast('e54 - Cannot update profile.')\n    })\n  }\n\n  return <W0>\n    <textarea name='scratchpad' rows='20' cols='40'\n      onChange={(e) => setTxt(e.target.value) }\n      value={txt}\n    / >\n    <Actions>\n      <Btn onClick={doSave}>Save</Btn>\n    </Actions>\n  </W0>\n}\nScratchpad.propTypes = {\n  // none so far\n}\n\nexport default Scratchpad\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = ({ children, ...props }) => {\n  const { listItems } = props\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em', zIndex: 1 }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          { listItems.map( ({ label, key, path }) => <ListItem button key={key}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(path())\n            } } >{ label }\n          </ListItem> )}\n\n        </List>\n\n        { children }\n      </W0>\n    </Drawer>\n\n  </F>\n}\n\nSideMenu.propTypes = {\n  listItems: PropTypes.array.isRequired, // @TODO: specify: key, label, path\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport {\n  logg,\n} from \"./shared\"\nimport TestApp from './TestApp'\n\n// @TODO: rename\nimport * as jwtManager from './components/users/JwtContext' // this syntax is correct\n\n/* A */\nexport { Actions, } from './shared'\nexport { AuthContext, AuthContextProvider, } from './components/users'\nexport { default as AuthWidget } from \"./components/users/AuthWidget\"\n\n/* C */\nexport { CloseBtn } from './shared'\n\n/* F */\nexport { FlexCol, FlexRow } from \"./shared\"\n\n/* J */\nexport { jwtManager }\n\n/* L */\nexport { logg }\nexport { LoginModal } from './components/users'\n\n/* M */\nexport { ModalHeader } from './shared'\n\n/* P */\n\n/* R */\nexport { RegisterModal } from './components/users'\n\n/* S */\nexport { default as Scratchpad } from \"./components/users/Scratchpad\"\nexport { default as SideMenu } from './components/SideMenu'\n\nif (process.env.REACT_APP_SERVE) {\n  ReactDOM.render(<TestApp />, document.getElementById('root'))\n}\n","\nimport { Device } from '@capacitor/device'\nimport React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport * as ReactRouterDOM from 'react-router-dom'\nimport { toast } from 'react-toastify'\n\nimport {\n  AuthContext,\n  AuthContextProvider,\n  LoginModal,\n  RegisterModal,\n} from 'ishlibjs'\n\nimport {\n  CollapsibleProvider,\n  TwofoldContextProvider,\n} from \"$components/TwofoldLayout\"\nimport {\n  C,\n  logg,\n  ThemeProvider,\n  useApi,\n} from \"$shared\"\n\n/**\n * links AuthContext to LoginModal\n**/\nconst WLoginModal = (props) => {\n  // logg(props, 'WLoginModal')\n\n  const {\n    setCurrentUser,\n  } = useContext(AuthContext)\n\n  const onError = (inn) => {\n    logg(inn, 'cannot login!')\n    toast('cannot login!')\n  }\n  const onSuccess = (inn) => {\n    logg('Logged in successfully.')\n    setCurrentUser(inn)\n  }\n\n  return <LoginModal {...{ onError, onSuccess }} />\n}\n\nexport const AppContext = React.createContext({})\n\n/**\n * AppProvider: os, useHistory, theme, AuthContext (current_user, useApi), TwofoldContext, CollapsibleContext\n *\n * @TODO: move ToastContainer in here?\n *\n * @Test: os / mobile detection?\n * @Test: provides theme\n * @Test: provides auth\n * @Test: provides twofold\n * @Test: provides collapsible\n * @Test: has loginModal and WLoginModal ?\n * @Test: has registerModal\n *\n**/\nconst AppProvider = ({ children, ...props }) => {\n  // logg(props, 'AppProvider')\n  const {\n    useHistory = ReactRouterDOM.useHistory,\n  } = props\n\n  // @TODO: test-drive _vp_ 2022-09-13\n  // @TODO: this probably doesn't accommodate next_js, and raises a jest warning. _vp_ 2022-09-23\n  const [ os, setOs ] = useState(null)\n  const fn = async () => {\n    let info = await Device.getInfo() // info.operatingSystem === 'ios' || 'android'\n    setOs(info.operatingSystem)\n  }\n  fn()\n\n\n  return <AppContext.Provider value={{\n    os,\n    useHistory,\n  }} >\n    <ThemeProvider >\n      <AuthContextProvider {...{ useApi, }} >\n        <TwofoldContextProvider >\n          <CollapsibleProvider >\n\n            { children }\n\n            <WLoginModal />\n            <RegisterModal />\n\n          </CollapsibleProvider>\n        </TwofoldContextProvider>\n      </AuthContextProvider>\n    </ThemeProvider>\n  </AppContext.Provider>\n}\nAppProvider.propTypes = {}\nexport default AppProvider\n","import React, { useContext } from 'react'\n\nimport config from \"config\"\nimport {\n  AuthContext,\n} from 'ishlibjs'\n\nimport {\n  C,\n  logg, // eslint-disable-line no-unused-vars\n  request,\n} from \"$shared\"\n\nexport const apiPaths  = {}\n\n// @TODO: create direct unwrapped access to this. _vp_ 2022-09-10\nconst useApi = () => {\n\n  let token\n  try {\n    token = localStorage.getItem(C.jwt_token)\n  } catch (err) {\n    logg(err, 'Api cannot access localStorage')\n  }\n\n  return {\n    deleteNewsitem: ({ id }) => {\n      return request.delete(`${config.apiOrigin}/api/newsitems/${id}?jwt_token=${token}`).then((r) => r.data).then((r) => {\n        return r\n      })\n    },\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users/register`, { user: { email, password }} ).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n    /* Returns current user */\n    doUnlock: ({ kind, id }) => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      const path = `/api/payments/unlock?kind=${kind}&id=${id}&jwt_token=${jwt_token}`\n      return request.post(`${config.apiOrigin}${path}`).then((r) => r.data)\n    },\n\n    getCities: ()   => request.get(`${config.apiOrigin}/api/cities`).then((r) => r.data),\n    getCity: (slug) => request.get(`${config.apiOrigin}/api/cities/view/${slug}`),\n    getGallery: (slug) => {\n      return request.get(`${config.apiOrigin}/api/galleries/view/${slug}?jwt_token=${token}`\n      ).then((r) => r.data.gallery)\n    },\n\n    getLocation: (props) => { // _vp_ 2022-09-04\n      const {\n        newsitems_page: _npg,\n        slug,\n      } = props\n\n      return request.get(`/api/maps/view/${slug}?jwt_token=${token}&newsitems_page=${_npg}`\n      ).then(r => r.data).then(r => {\n        return r.map\n      }).catch((err) => {\n        return err\n      })\n    },\n\n    // @TODO: test: upon 401, return anon user. _vp_ 2022-08-15\n    getMyAccount: () => {\n      return request.post(`/api/my/account`, { jwt_token: token, }).then((r) => r.data).catch((err) => {\n        return C.anonUser\n      })\n    },\n\n    getPhoto: (slug) => request.get(`${config.apiOrigin}/api/photos/view/${slug}?jwt_token=${token}`).then((r) => r.data.photo),\n\n    getReport: (slug) => request.get(`${config.apiOrigin}/api/reports/view/${slug}?jwt_token=${token}`).then((r) => r.data.report),\n\n    getTag: (tag) => request.get(`${config.apiOrigin}/api/tags/view/${tag.slug}`).then((r) => r.data),\n\n    initPayment: (p) => request.post(`${config.apiOrigin}/api/payments2`, { jwt_token: token, amount_cents: p.amountCents }).then((r) => r.data),\n\n    longTermTokenPath: '/api/users/long_term_token', // @TODO: move to config.router _vp_ 2022-09-04\n\n    postLogin: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users/login.json`, { user: { email, password }}\n      ).then((r) => r.data).then((r) => {\n        localStorage.setItem(C.jwt_token, r.jwt_token)\n        return r\n      })\n    },\n\n    myVideosPath: \"/api/my/videos\", // @TODO: remove\n\n    applicationHome: () => {\n      request.get(`${config.apiOrigin}/api/sites/view/${config.domain}`, { params: { jwt_token: token } }).then((r) => {\n        return r.data\n      })\n    },\n\n    vote: (props) => {\n      const { value, voter_id, votee_id, votee_class_name } = props\n      return request.post(\n        `${config.apiOrigin}/api/v1/vote/${votee_class_name}/${votee_id}/${voter_id}/${value}`,\n        { params: { jwt_token: token } }\n      ).then((r) => {\n        logg(r, 'voted')\n        return r\n      })\n    },\n\n    unvote: () => {\n      logg('Unvote is not implemented!')\n    },\n  }\n\n}\n\nexport default useApi\n","\nimport { IonPage, IonLoading, IonContent, IonIcon as _IonIcon } from '@ionic/react'\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport React, { Fragment as F, useEffect, useState } from \"react\"\nimport { Link, useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { useApi,\n  logg,\n} from \"$shared\"\n\nimport \"./Cities.module.scss\"\n\nconst Counts = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  margin: 1em 0px;\n`;\n\nconst Count = styled.div`\n  // border: 1px solid red;\n\n  display: flex;\n  justify-content: center;\n\n  width: 50%;\n  text-align: center;\n  position: relative;\n  padding: 0.1em;\n`;\n\nconst IonIcon = styled(_IonIcon)`\n  font-size: 2em;\n  color: ${p=>p.theme.darkGrey};\n`;\n\nconst Number = styled.div`\n  // border: 1px solid green;\n\n  padding: 0.5em;\n\n  color: ${p=>p.theme.lightGrey};\n  font-size: 0.9em;\n  font-weight: 600;\n`;\n\nconst W0 = styled.div`\n  height: 100vh;\n`;\n\n/**\n * CitiesList\n *\n * @TODO: IonLoading can be much more HOC _vp_ 2022-09-10\n**/\nconst CitiesList = (props) => {\n  logg(props, 'CitiesList')\n\n  const [cities, setCities] = useState([])\n  const [filteredCities, setFilteredCities] = useState([])\n  const [showLoading, setShowLoading] = useState(false)\n\n  const api = useApi()\n  const history = useHistory()\n\n  useEffect(() => {\n    setShowLoading(true);\n    api.getCities().then(res => {\n      setShowLoading(false);\n      setFilteredCities(res);\n      setCities(res);\n    });\n  }, [])\n\n  const filterHandler = (ev) => {\n    let filteredCities = cities.filter(city => {\n      return city.name.toLowerCase().indexOf(ev.target.value.trim().toLowerCase()) > -1;\n    });\n    setFilteredCities(filteredCities);\n  }\n\n  return <F>\n    <W0 className='cities' >\n      <h1 className=\"heading\" >Cities</h1>\n\n      <div className=\"filter-section\">\n        <input className=\"filter-input\" onChange={filterHandler} />\n        <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n      </div>\n\n      { /* @TODO: re-add! */ }\n      { /* <div className=\"bookmark-section\">\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={() => { }} checked />\n          <span className=\"slider round\"></span>\n        </label>\n        <span className=\"bookmark-text\">Show only bookmarked</span>\n      </div> */ }\n\n      <div className=\"container\">\n        { filteredCities.map((city, i) => <div key={i} className=\"cities\" >\n            <div className=\"img-section\">\n              <span className=\"bookmark\" >\n                <IonIcon className=\"bookmark-icon\" icon={bookmark}></IonIcon>\n              </span>\n              <img className=\"city-img\" src={city.photo} />\n              <span className=\"city-title\">{city.name}</span>\n            </div>\n            <Counts>\n              <Count>\n                { /* @TODO: wire in theme provider */ }\n                <Number >{city.n_reports}</Number>\n                <IonIcon icon={newspaperOutline}></IonIcon>\n\n              </Count>\n              <Count>\n\n                <Number >{city.n_galleries}</Number>\n                <IonIcon icon={image}></IonIcon>\n              </Count>\n              <Count>\n\n                <Number >{city.n_videos}</Number>\n                <IonIcon icon={videocam}></IonIcon>\n              </Count>\n            </Counts>\n          </div>\n        ) }\n      </div>\n      &nbsp;\n    </W0>\n\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </F>\n}\n\nexport default CitiesList\n","\nimport * as React from \"react\"\nimport * as ReactDom from \"react-dom\"\nimport { Wrapper, Status } from \"@googlemaps/react-wrapper\"\n\nimport config from 'config'\n\nimport {\n  logg,\n} from '$shared'\n\n/**\n * App\n**/\nconst App = (props) => {\n  // logg(props, 'GoogleMaps2')\n  const {\n    map,\n  } = props\n\n  const [clicks, setClicks] = React.useState([]);\n  const [zoom, setZoom] = React.useState(12); // initial zoom\n  const [center, setCenter] = React.useState({ lat: map.x, lng: map.y })\n\n  const onClick = (e) => {\n    // avoid directly mutating state\n    // setClicks([...clicks, e.latLng]);\n  };\n\n  const onIdle = (m) => {\n    // console.log(\"onIdle\");\n    m.getZoom() && setZoom(m.getZoom());\n    m.getCenter() && setCenter(m.getCenter().toJSON());\n  };\n\n  const form = (\n    <div\n      style={{\n        display: 'none',\n\n        padding: \"1rem\",\n        flexBasis: \"250px\",\n        height: \"100%\",\n        overflow: \"auto\",\n      }}\n    >\n      <label htmlFor=\"zoom\">Zoom</label>\n      <input\n        type=\"number\"\n        id=\"zoom\"\n        name=\"zoom\"\n        value={zoom}\n        onChange={(event) => setZoom(Number(event.target.value))}\n      />\n      <br />\n      <label htmlFor=\"lat\">Latitude</label>\n      <input\n        type=\"number\"\n        id=\"lat\"\n        name=\"lat\"\n        value={center.lat}\n        onChange={(event) =>\n          setCenter({ ...center, lat: Number(event.target.value) })\n        }\n      />\n      <br />\n      <label htmlFor=\"lng\">Longitude</label>\n      <input\n        type=\"number\"\n        id=\"lng\"\n        name=\"lng\"\n        value={center.lng}\n        onChange={(event) =>\n          setCenter({ ...center, lng: Number(event.target.value) })\n        }\n      />\n      <h3>{clicks.length === 0 ? \"Click on map to add markers\" : \"Clicks\"}</h3>\n      {clicks.map((latLng, i) => (\n        <pre key={i}>{JSON.stringify(latLng.toJSON(), null, 2)}</pre>\n      ))}\n      <button onClick={() => setClicks([])}>Clear</button>\n    </div>\n  );\n\n  return (\n    <div style={{ display: \"flex\", height: \"100%\" }}>\n      <Wrapper apiKey={config.GOOGLE_MAPS_KEY} >\n        <Map\n          center={center}\n          onClick={onClick}\n          onIdle={onIdle}\n          zoom={zoom}\n          style={{ flexGrow: \"1\", height: \"100%\" }}\n        >\n          {map.markers.map((m, i) =>\n            <Marker key={i} position={{lat: m.x, lng: m.y}} />\n          ) }\n        </Map>\n      </Wrapper>\n      {/* Basic form for controlling center and zoom of map. */}\n      {form}\n    </div>\n  );\n};\n\n/**\n * GoogleMaps\n**/\nconst Map = ({\n  onClick,\n  onIdle,\n  children,\n  style,\n  ...options\n}) => {\n  const ref = React.useRef(null);\n  const [map, setMap] = React.useState();\n\n  React.useEffect(() => {\n    if (ref.current && !map) {\n      setMap(new window.google.maps.Map(ref.current, {}));\n    }\n  }, [ref, map]);\n\n  // because React does not do deep comparisons, a custom hook is used\n  // see discussion in https://github.com/googlemaps/js-samples/issues/946\n  useDeepCompareEffectForMaps(() => {\n    if (map) {\n      map.setOptions(options);\n    }\n  }, [map, options]);\n\n  React.useEffect(() => {\n    if (map) {\n      [\"click\", \"idle\"].forEach((eventName) =>\n        google.maps.event.clearListeners(map, eventName)\n      );\n\n      if (onClick) {\n        map.addListener(\"click\", onClick);\n      }\n\n      if (onIdle) {\n        map.addListener(\"idle\", () => onIdle(map));\n      }\n    }\n  }, [map, onClick, onIdle]);\n\n  return (\n    <>\n      <div ref={ref} style={style} />\n      {React.Children.map(children, (child) => {\n        if (React.isValidElement(child)) {\n          // set the map prop on the child component\n          return React.cloneElement(child, { map });\n        }\n      })}\n    </>\n  );\n};\n\nconst Marker = (options) => {\n  const [marker, setMarker] = React.useState();\n\n  React.useEffect(() => {\n    if (!marker) {\n      setMarker(new google.maps.Marker());\n    }\n\n    // remove marker from map on unmount\n    return () => {\n      if (marker) {\n        marker.setMap(null);\n      }\n    };\n  }, [marker]);\n\n  React.useEffect(() => {\n    if (marker) {\n      marker.setOptions(options);\n    }\n  }, [marker, options]);\n\n  return null;\n};\n\nfunction useDeepCompareMemoize(value) {\n  const ref = React.useRef();\n\n  if (value !== ref.current) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}\n\nconst useDeepCompareEffectForMaps = (callback, dependencies) => {\n  React.useEffect(callback, dependencies.map(useDeepCompareMemoize));\n}\n\nexport default App","\nimport React from 'react'\n\nimport {\n  logg,\n} from \"$shared\"\n\nexport const LocationContext = React.createContext({})\n\n/**\n * LocationProvider\n *\n * used in NewsitemGallery, for linking to a gallery inside a location.\n**/\nconst LocationProvider = ({ children, ...props }) => {\n  // logg(props, 'LocationProvider')\n\n  return <LocationContext.Provider value={{ ...props }} >\n    {children}\n  </LocationContext.Provider>\n}\n\nexport default LocationProvider\n","\nimport React from 'react'\n\nconst Page = () => {\n  return <h1>This location is restricted (tmp placeholder)</h1>\n}\nexport default Page\n","\nimport React from 'react'\n\nimport {\n  logg,\n} from \"$shared\"\n\n/**\n * PhotosShow\n**/\nconst PhotosShow = (props) => {\n  logg(props, 'PhotosShow')\n  const { item } = props\n\n  return <>\n    <img src={item.original_url} alt='' />\n    { item.subhead }\n  </>\n}\nexport default PhotosShow","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { Metaline } from \"$components/application\"\nimport { TwofoldContext } from \"$components/TwofoldLayout\"\nimport {\n  BackBtn,\n  C,\n  logg,\n  useApi,\n} from \"$shared\"\n\nimport styles from \"./Galleries.module.scss\"\n\nconst W0 = styled.div`\n  // border: 1px solid blue;\n  height: auto;\n`;\n\n/**\n * GalleriesShow\n *\n**/\nconst GalleriesShow = (props) => {\n  // logg(props, 'GalleriesShow')\n  const { match } = props\n\n  const [gallery, setGallery] = useState({})\n\n  const mountedRef = useRef('init')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n  } = useContext(TwofoldContext)\n\n  const api = useApi()\n\n  useEffect(() => {\n    api.getGallery(match.params.slug).then(_gallery => {\n      if (!mountedRef.current) { return }\n      logg(_gallery, '_gallery')\n\n      if (_gallery.is_premium && !_gallery.is_purchased) {\n        setItemToUnlock(_gallery)\n      } else {\n        setGallery(_gallery)\n      }\n    })\n    return () => {\n      mountedRef.current = null\n    }\n  }, [gallery.id, itemToUnlock.id] )\n\n  return <W0 className={styles.GalleriesShow} >\n\n    <div className={styles.narrow} >\n      <h1 className={styles.heading} >\n        <BackBtn />\n        <span className={styles.title} >{gallery.name}</span>\n      </h1>\n      <Metaline {...gallery} />\n\n      <div className={styles.thumbs} >\n        { gallery.photos && gallery.photos.map((ph, i) =>\n          <div className={styles.card} key={i}>\n            <div>\n              <IonImg src={ph.thumb_url}></IonImg>\n            </div>\n          </div>\n        ) }\n      </div>\n\n      <div dangerouslySetInnerHTML={{ __html: gallery.description }}></div>\n\n    </div>\n    <div className={styles.full_img_section} >\n\n      { gallery.photos && gallery.photos.map((ph, i) =>\n        <div className={styles.item} key={i}>\n          <img src={ph.large_url} />\n        </div>\n      ) }\n\n    </div>\n\n  </W0>\n}\n\nexport default GalleriesShow","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * ReportForm\n**/\nconst ReportForm = (props) => {\n  // logg(props, 'ReportForm')\n  const { item } = props\n\n  return <W0>\n\n    <h1>Report Form (@TODO: remove)</h1>\n\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <textarea name='name' /> subhead\n      </FlexRow>\n\n      <FlexRow>\n        item_type: default? longscroll?\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: editable slug, the fucking slug hasn't been solved in 10 years!\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: premium tier\n      </FlexRow>\n\n      <FlexRow>\n        @TODO: tags\n      </FlexRow>\n\n      <FlexRow>\n        public?\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nReportForm.propTypes = {\n};\nexport default ReportForm\n","\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport PropTypes from 'prop-types'\n\nimport {\n  logg,\n} from \"$shared\"\n\nconst W0 = styled.div``;\n\n/**\n * ReportsShow\n *\n * @TODO: logged in and no access ?\n * @TODO: logged in and access ?\n**/\nconst ReportsShow = (props) => {\n  logg(props, \"ReportsShow\")\n  const {\n    item,\n  } = props\n  let {\n    descr,\n  } = item\n\n  if (item.raw_json?.content?.rendered) {\n    descr = item.raw_json.content.rendered\n  }\n  return (<W0>\n    <h1>{item.name}</h1>\n    <div className=\"description\" dangerouslySetInnerHTML={{ __html: descr }} />\n  </W0>)\n}\nReportsShow.propTypes = {\n  item: PropTypes.object.isRequired,\n}\nexport default ReportsShow\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useHistory, useLocation, useParams } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  Actions,\n  CloseBtn,\n  ModalHeader,\n} from 'ishlibjs'\n\nimport { PhotosShow } from '$components/photos'\nimport { TwofoldContext } from \"$components/TwofoldLayout\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport {\n  ReportsForm,\n  ReportsShow,\n} from \"$components/reports\"\nimport { C, logg, } from \"$shared\"\nimport { appPaths } from \"$src/AppRouter\"\n\nimport styles from './ItemModal.module.scss'\n\n/**\n * ItemModal\n * @TODO: move to $components/application ?\n * shows items, but also I use it to create reports\n *\n**/\nconst ItemModal = (props) => {\n  logg(props, 'ItemModal')\n  const { item } = props\n  if (!item) { return null }\n\n  const params = useParams()\n  const history = useHistory()\n\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n\n  const onClose = () => {\n    history.push( appPaths.location({ slug: params.slug }) )\n    setShowItem(null)\n  }\n\n  if (!item.action) { item.action = C.actions.show } // set default, but @TODO: make sure I don't have to useState()\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`ItemModal ${styles.ItemModal}`}\n    isOpen={!!item}\n    overlayClassName={styles.ItemModalOverlay}\n    portalClassName={styles.ItemModalPortal}\n  >\n    <ModalHeader onClose={onClose} >{item.name}</ModalHeader>\n\n    { item.item_type === C.item_types.photo && <PhotosShow item={item} /> }\n    { item.item_type === C.item_types.report && item.action === C.actions.show && <ReportsShow item={item} match={{ params: { slug: item.reportname } }} /> }\n    { item.item_type === C.item_types.report && item.action === C.actions.new && <ReportsForm /> }\n    { item.item_type === C.item_types.gallery && <GalleriesShow match={{ params: { slug: item.slug } }} /> }\n    .^.\n  </Modal>\n}\n\nexport default ItemModal\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport {\n  ItemIcon,\n} from '$components/newsitems'\nimport {\n  TwofoldContext,\n} from \"$components/TwofoldLayout\"\nimport {\n  AppContext,\n  C,\n  logg,\n  PurchasedIcon,\n  WBordered,\n} from \"$shared\"\nimport {\n  appPaths,\n} from \"$src/AppRouter\"\n\n\n/**\n * Wrapper Bordered Item. It is padded, margined.\n**/\nconst _W0 = styled.a`\n  border: 2px solid var(--ion-border-color);\n  border-radius: var(--ion-border-radius);\n  background: var(--ion-card-background-color);\n  color: var(--ion-color);\n\n  display: block;\n  text-decoration: none;\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\nexport const MarkerEmpty = styled.div`\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n\n  height: 0;\n  border: none;\n  padding: 0;\n  margin: 0 .5em 0 0;\n`;\nconst W0 = ({children, ..._props}) => {\n const { className='', ...props } = _props\n return <_W0 className={`WBorderedItem ${className}`} {...props}>{children}</_W0>\n}\n\n\n/**\n * Marker\n**/\nconst Marker = ({ children, ...props }) => {\n  // logg(props, 'Marker')\n  const {\n    marker,\n  } = props\n\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n  const history = useHistory()\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    showUrl, setShowUrl,\n  } = useContext(TwofoldContext)\n\n\n  const href = appPaths.location({ slug: marker.destination_slug })\n\n  const goto = (e) => {\n    e.preventDefault()\n    if (marker.premium_tier && !marker.is_purchased) {\n      setItemToUnlock(marker)\n    } else {\n      if (marker.url) {\n        setShowUrl(marker.url) // @TODO: this should be encoded in the (server-side) router eventually. _vp_ 2022-09-11\n      }\n      else {\n        history.push(href)\n      }\n    }\n  }\n\n  return <W0\n    onClick={goto}\n    {...{ href, ...props }}\n  >\n    <img src={marker.title_img_path} /><br />\n    <ItemIcon {...marker } /> { marker.name }\n  </W0>\n}\nMarker.propTypes = {\n  marker: PropTypes.object.isRequired,\n}\nexport default Marker\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport {\n  TwofoldContext,\n} from \"$components/TwofoldLayout\"\nimport {\n  C,\n  logg,\n  NavigationContext,\n  PurchasedIcon,\n  WBordered,\n} from \"$shared\"\nimport {\n  appPaths,\n} from \"$src/AppRouter\"\nimport { Marker, MarkerEmpty } from './'\n\n/* W */\nconst _W0 = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n`;\nconst W0 = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBordered {...props}>{children}</WBordered>\n  } else {\n    return <_W0 {...props}>{children}</_W0>\n  }\n}\n\n/**\n * MarkersList\n * @TODO: review variant, it's currently always bordered. _vp_ 2022-09-11\n *\n**/\nconst MarkersList = (props) => {\n  // logg(props, 'MarkersList')\n  const { variant } = props\n\n  // @TODO: re-add variant. It was there for ParagonAustin, WasyaCo, locations like that. _vp_ 2022-09-11\n\n  const markers = []\n  props.markers.map((m, idx) => {\n    if (m.destination_slug) {\n      markers.push(<Marker key={idx} marker={m} />)\n    }\n  })\n\n  // Zero-height padding for the last row.\n  const times = 12 - markers.length % 12\n  for (let i = 0; i < times; i++) {\n    markers.push(<MarkerEmpty key={`padded-${i}`} />)\n  }\n\n  return <W0 className=\"MarkersList\" >{ markers }</W0>\n}\nMarkersList.propTypes = {\n  markers: PropTypes.arrayOf( PropTypes.shape({\n    destination_slug: PropTypes.string,\n  }) ).isRequired,\n  variant: PropTypes.string,\n}\nexport default MarkersList\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  FlexRow,\n  logg,\n} from 'ishlibjs'\n\nconst Actions = styled.div``;\n\nconst W0 = styled.div``;\n\n/**\n * MarkerForm\n**/\nconst MarkerForm = (props) => {\n  // logg(props, 'MarkerForm')\n  const { item } = props\n\n  return <W0>\n    <form>\n\n      <FlexRow>\n        <input type='text' name='name' /> name\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='name' /> destination\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        map image\n      </FlexRow>\n\n      <FlexRow>\n        <input type='file' name='title_image' />\n        title image\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_active' /> active?\n      </FlexRow>\n\n      <FlexRow>\n        <checkbox name='is_public' /> public?\n      </FlexRow>\n\n      <FlexRow>\n        <input type='text' name='url' /> url\n      </FlexRow>\n\n      <textarea /> description\n\n      <Actions>\n        <button type='submit'>Create</button>\n      </Actions>\n    </form>\n  </W0>\n}\nMarkerForm.propTypes = {\n};\nexport default MarkerForm\n","\nimport React, {\n  useContext, useState,\n} from 'react'\nimport Modal from 'react-modal'\n\n\nconst MarkerContext = React.createContext({})\n\n/**\n * MarkerProvider - for editing, right? _vp_ 2022-09-18\n**/\nconst MarkerContextProvider = ({ children, ...props }) => {\n\n  const [ marker, setMarker ] = useState()\n  const [ MarkerEditModalOpen, setMarkerEditModalOpen ] = useState(false)\n\n  return <MarkerContext.Provider value={{ marker, setMarker, MarkerEditModalOpen, setMarkerEditModalOpen, }}\n  >{children}</MarkerContext.Provider>\n}\n\nexport {\n  MarkerContext,\n  MarkerContextProvider,\n}\n\n\nexport { default as Marker, MarkerEmpty } from './Marker'\nexport { default as MarkerEditModal } from './MarkerEditModal'\nexport { default as MarkersList } from \"./MarkersList\"\nexport { default as MarkerForm } from './MarkerForm'\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport {\n  AuthContext,\n} from \"ishlibjs\"\n\nimport {\n  Breadcrumbs,\n  UnlockModal,\n} from \"$components/application\"\nimport { ItemModal, } from \"$components/ItemModal\"\nimport { Newsitems } from \"$components/newsitems\"\nimport {\n  MarkersList,\n} from '$components/markers'\nimport {\n  Collapsible,\n  LongLine,\n  TwofoldContext,\n} from \"$components/TwofoldLayout\"\nimport {\n  AppContext,\n  C, Card, ChevronLeft, ChevronRight,\n  Loading,\n  logg,\n  useWindowSize,\n} from \"$shared\"\nimport {\n  LocationProvider,\n  LocationsShowMobile3d,\n  WrappedMapPanel,\n} from \"./\"\n\n/**\n * MoveLeftRightIcon\n**/\nconst _MoveLeftRightIcon = ({ fill='var(--ion-inactive-color)', ...props }) => {\n\n  return <div {...props} >\n    <svg width=\"17\" height=\"17\" viewBox=\"0 -0.5 17 17\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <defs></defs>\n      <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\"\n      ><g transform=\"translate(1.000000, 0.000000)\" fill={fill} >\n        <path d=\"M5.958,8.951 L5.958,7.007 L3.979,7.007 L3.97900001,5.06677246 C3.97900001,4.57762889 0.265,7.332 0.265,7.332 C-0.095,7.696 -0.095,8.29 0.264,8.655 C0.264,8.655 3.97900001,11.4734899 3.97900001,10.9475709 L3.979,8.951 L5.958,8.951 Z\"\n        ></path><path d=\"M10.002,7 L10.002,8.973 L12.048,8.973 L12.048,11 C12.048,11.4553833 15.695,8.684 15.695,8.684 C16.055,8.336 16.055,7.771 15.695,7.423 C15.695,7.423 11.980774,4.64377734 11.980774,5.03546143 L12.048,7 L10.002,7 Z\"></path><rect x=\"7\" y=\"0\" width=\"2\" height=\"16\"></rect></g></g>\n    </svg>\n </div>\n}\nconst MoveLeftRightIcon = () => {\n  return <_MoveLeftRightIcon />\n}\n\n/**\n * Description\n *\n * @TODO: move Description into shared ?\n**/\nconst _D = styled.div``;\nconst Description = ({ item={} }) => {\n  if (!item.description) { return }\n  return <_D className=\"Description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n\n/**\n * Handle\n**/\nconst _Handle = styled.div`\n  border: ${p => p.debug ? 1 : 0 }px solid green;\n  // background: rgba(64, 64, 64, 0.5);\n\n  position: absolute;\n  top: 0;\n  bottom: 0;\n\n  left: ${p => p.foldedLeft ? 0 :\n    p.foldedRight ? 'auto' :\n    `${p.twofoldPercent*100}%` };\n  right: ${p => p.foldedRight ? 0 : 'auto' };\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  width: var(--handle-width);\n\n  z-index: 2;\n`;\nconst Handle = (props) => {\n  const {} = props\n\n  const {\n    folded, setFolded,\n    foldedLeft, foldedRight,\n    twofoldPercent, setTwofoldPercent,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'Handle Used TwofoldContext')\n\n  const [ w ] = useWindowSize()\n  const [ offsetX, setOffsetX ] = useState()\n  const [ dragging, setDragging ] = useState(false)\n\n  const foldLeft = () => {\n    if (folded === C.foldedRight) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedLeft)\n    }\n  }\n\n  const foldRight = () => {\n    if (folded === C.foldedLeft) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedRight)\n    }\n  }\n\n  const onMouseDown = (e) => {\n    setDragging(true)\n    setOffsetX(e.pageX)\n  }\n\n  const onMouseMove = (e) => {\n    if (!dragging) { return }\n    if (e.clientX === 0) { return }\n    const movedBy = e.clientX - offsetX\n    if (movedBy === 0) { return }\n    const movedByPercent = movedBy/w\n    setTwofoldPercent(prev => prev + movedByPercent)\n  }\n\n  const onMouseUp = (e) => {\n    setDragging(false)\n    // document.removeEventListener('mousemove', onMouseMove)\n    // document.removeEventListener('mousedown', onMouseDown)\n  }\n\n  // draggable=\"true\"\n  return <_Handle className=\"Handle\"\n    debug={config.debug}\n    {...{ foldedLeft, foldedRight, twofoldPercent }}\n    // onMouseMove={onMouseMove}\n    // onMouseDown={onMouseDown}\n    // onMouseLeave={onMouseUp}\n    // onMouseUp={onMouseUp}\n  >\n    <ChevronLeft onClick={foldLeft} />\n    <ChevronRight onClick={foldRight} />\n    <MoveLeftRightIcon />\n    { [C.foldedRight, C.foldedLeft].indexOf(folded) !== -1  && <LongLine orientation={C.vertical} /> }\n  </_Handle>\n}\n\n\n// @TODO: belongs in TwofoldLayout _vp_ 2022-09-21\nconst IframeModal = (props) => {\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  return (<Modal ariaHideApp={false} isOpen={!!showUrl} >\n    <span onClick={() => {  setShowUrl(false) }} >[x]</span>\n\n    <iframe height=\"100%\" style={{ width: \"100%\", height: \"100%\" }} scrolling={\"yes\"} src={props.src}\n      frameBorder=\"no\" allowtransparency=\"true\" allowFullScreen={true} >\n    </iframe>\n  </Modal>)\n}\n\n\n/**\n * Left\n**/\nconst _Left = styled.div`\n  background: ${p => p.theme.colors.background};\n  flex: ${p => p.foldedRight ? '99%' : `${p.twofoldPercent*100}%` };\n  overflow: hidden;\n\n  display: flex;\n  flex-direction: column;\n\n  margin-right: ${p => p.foldedRight ? '30px' : 0 };\n  height: calc(100vh - ${p => p.theme.borderWidth}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\nconst Left = ({ children, ...props }) => {\n  const {\n    bottomDrawerOpen,\n    folded, foldedLeft, foldedRight,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n  if (foldedLeft) { return null }\n  return <_Left className='Left' {...{ bottomDrawerOpen, foldedRight, twofoldPercent }} >\n    { children }\n  </_Left>\n}\n\n\n/**\n * Right\n**/\nconst _Right = styled.div`\n  position: relative;\n\n  padding: 0 0 0 var(--handle-width);\n  display: ${p => p.foldedRight ? 'none' : 'flex'};\n  // flex: ${p => p.foldedRight ? '2%' : `${(1-p.twofoldPercent)*100}%` };\n  flex: ${p => `${(1-p.twofoldPercent)*100}%`};\n  overflow-x: hidden;\n\n  flex-direction: column;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\nconst Right = ({ children, ...props }) => {\n  const {\n    bottomDrawerOpen,\n    folded, foldedLeft, foldedRight,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n  return <_Right className='Right' {...{ bottomDrawerOpen, foldedRight, twofoldPercent }} >\n    { children }\n  </_Right>\n}\n\n\nconst W0 = styled.div`\n  // border: 1px solid magenta;\n\n  display: flex;\n  position: relative;\n`;\n\n\n/**\n * LocationsShow (Static)\n * _vp_ 2022-09-06\n * _vp_ 2022-09-11\n *\n * @TODO: re-introduce MenuIcon in Handle. _vp_ 2022-09-01\n * @TODO: can this be shared across desktop and mobile? _vp_ 2022-09-06\n * @TODO: location.is_purchased doesn't look right... _vp_ 2022-09-06\n *\n * @TODO: hella enable caching all around and measure throughput. _vp_ 2022-09-10\n**/\nconst LocationsShow = (props) => {\n  // logg(props, 'LocationsShow')\n  const {\n    location,\n    match,\n    showItem,\n  } = props\n  if (!location) { return null }\n\n  const {\n    currentUser,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LocationsShow Used AuthContext')\n\n  const {\n    os,\n  } = useContext(AppContext)\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    folded, setFolded, foldedLeft, foldedRight,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation, // @TODO: move out of this context?\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'LocationsShowUsedTwofoldContext')\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  const [ loading, setLoading ] = useState(false)\n\n  const mapPanelRef = useRef(null)\n\n  // Show ItemToUnlock Modal\n  useEffect(() => {\n    // @TODO: having location.is_purchased doesn't sound performant, expecially with caching.\n    if (location.is_premium && ( !currentUser.email || !location.is_purchased )) {\n      setItemToUnlock({\n        closable: false,\n        item_type: C.item_types.location,\n        ...location })\n    } else {\n      setItemToUnlock(false)\n    }\n  }, [ currentUser, location ])\n\n  // Set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  if (['ios', 'android'].indexOf(os) !== -1) {\n    return <LocationsShowMobile3d {...{ ...props, location }} />\n  }\n\n  return <W0><LocationProvider {...location} >\n\n    <Left >\n      <Breadcrumbs {...location} />\n      <WrappedMapPanel\n        map={location.map ? location.map : location}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n      />\n    </Left>\n    <Handle />\n    <Right >\n\n      { /* Markers */ }\n      { location.markers.length && <Collapsible\n          className='Markers'\n          label={location.labels.markers}\n          slug={C.collapsible.markers}\n          variant={C.variants.transparent}\n      >\n        <MarkersList markers={location.markers}\n          variant={C.variants.bordered}\n        />\n      </Collapsible> || null }\n\n      { /* Description */ }\n      { location.description && <Collapsible\n          className='Description'\n          label={location.labels.description}\n          slug={C.collapsible.description}\n          variant={C.variants.bordered}\n      >\n        <Description item={location} />\n      </Collapsible> || null }\n\n      { /* Newsitems */ }\n      { location.newsitems.length && <Collapsible\n          className='Newsitems'\n          label={location.labels.newsitems}\n          slug={C.collapsible.newsitems}\n          variant={C.variants.transparent}\n      >\n        <Newsitems\n          newsitems={location.newsitems}\n          variant={C.variants.bordered}\n        />\n      </Collapsible> || null }\n\n    </Right>\n\n    { showUrl && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading && <Loading /> }\n\n    <UnlockModal />\n\n  </LocationProvider></W0>\n}\nLocationsShow.propTypes = {\n  location: PropTypes.object,\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      slug: PropTypes.string.isRequired,\n    }),\n  }),\n  showItem: PropTypes.object,\n}\n\nexport default LocationsShow\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport { toast } from 'react-toastify'\nimport { useLocation } from 'react-router-dom'\n\nimport {\n  C,\n  inflector,\n  logg,\n  SsrContext,\n  useApi,\n} from '$shared'\nimport {\n  LocationsRestricted,\n  LocationsShow,\n} from './'\n\n/**\n * LocationsShowAsync\n *\n * uses react-router for search params\n *\n *\n**/\nconst LocationsShowAsync = (props) => {\n  // logg(props, 'LocationsShowAsync')\n  const { match } = props\n\n  // @TODO: this is elegantly LocationProvider _vp_ 2022-09-12\n  const [ location, setLocation ] = useState()\n\n  // @TODO: this is so ugly... _vp_ 2022-09-20\n  function useQuery() {\n    const { search } = useLocation()\n    return React.useMemo(() => new URLSearchParams(search), [search]);\n  }\n  const q = useQuery()\n  match.params  = { ...match.params,\n    newsitems_page: q.get('newsitems_page') || 1,\n  }\n\n  const [ showItem, setShowItem ] = useState()\n  const api = useApi()\n\n  useEffect(() => {\n    const chain = [ api.getLocation( match.params ) ]\n    if (match.params.item_type) {\n      const itemType = inflector.classify(match.params.item_type)\n      switch (itemType) {\n        case C.item_types.gallery:\n          chain.push( api.getGallery(match.params.item_slug) )\n          break\n        case C.item_types.photo:\n          chain.push( api.getPhoto(match.params.item_slug) )\n          break\n        case C.item_types.report:\n          chain.push( api.getReport(match.params.item_slug) )\n          break\n        default:\n          logg(itemType, 'Cannot get this item type!')\n          toast(`Cannot get this item type: ${itemType}`)\n      }\n    }\n    Promise.all(chain).then(rs => {\n      // logg(rs, 'LocationsShowAsync ChainResults')\n      setLocation(rs[0])\n\n      // @TODO: test-drive this. Clicking from a location-gallery back to location, should un-set the showItem. _vp_ 2022-09-11\n      setShowItem(rs[1] ? rs[1] : null)\n\n    }).catch(err => {\n      // logg(err, \"Could not load Location.\")\n      // toast(\"Could not load Location.\")\n    })\n  }, [\n    match.params.item_type,\n    match.params.item_slug,\n    match.params.slug,\n    match.params.newsitems_page ])\n\n  if (!location) { return  null }\n  if (location.is_premium && !location.is_purchased) { return <LocationsRestricted /> }\n  return <LocationsShow {...{ location, match, showItem }} />\n}\nLocationsShowAsync.propTypes = {\n  match: PropTypes.object.isRequired,\n}\nexport default LocationsShowAsync\n","\n\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nconst _Blocker = styled.div`\n  border: 2px solid var(--ion-highlight-color);\n  border-radius: var(--ion-border-radius);\n\n  position: relative;\n  height: 100%;\n\n  #Crosshair {\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: calc(50% - 0px);\n    top: calc(50% - 4px);\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: var(--ion-highlight-color);\n      border-style: solid;\n      border-width: 0 2px 0 0;\n      height: 16px;\n      top: 0em;\n      left: 0;\n      transform: rotate(90deg);\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: var(--ion-highlight-color);\n      border-style: solid;\n      border-width: 0 2px 0 0;\n      height: 16px;\n      top: 0em;\n      left: 0;\n    }\n  }\n`;\n\n/**\n * @TODO: is this mobile-only for now? _vp_ 2022-09-14\n**/\nexport default React.forwardRef((props, ref) => {\n  const { children, ..._props } = props\n  return <_Blocker ref={ref} className=\"Blocker\" {..._props} >\n    {children}\n  </_Blocker>\n})\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst Crosshair = styled.div`\n// border: 2px solid yellow;\n\nwidth: 50px;\nheight: 50px;\n\nposition: absolute;\nleft: 50%;\ntop: 50%;\n\n::before {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n  transform: rotate(90deg);\n\n  // margin-top: -1em;\n\n}\n::after {\n  content: '';\n  position: absolute;\n  border-color: white;\n  border-style: solid;\n  border-width: 0 2px 0 0;\n  height: 20px;\n  top: -10px;\n  left: -1px;\n\n  // margin-top: -1em;\n  // width: 0.5em;\n}\n`;\n\nexport default Crosshair\n","import {\n\tEuler, EventDispatcher, Vector3,\n} from \"three\"\n\nconst _euler = new Euler( 0, 0, 0, 'YXZ' );\nconst _vector = new Vector3();\n\nconst _changeEvent = { type: 'change' };\nconst _lockEvent = { type: 'lock' };\nconst _unlockEvent = { type: 'unlock' };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n\n\tconstructor( camera, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\t\tdomElement = document.body;\n\n\t\t}\n\n\t\tthis.domElement = domElement;\n\t\tthis.isLocked = false;\n\n\t\t// Set to constrain the pitch of the camera\n\t\t// Range is 0 to Math.PI radians\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\tconst scope = this;\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.isLocked === false ) return;\n\n\t\t\tconst movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\t\tconst movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\t\t_euler.setFromQuaternion( camera.quaternion );\n\n\t\t\t_euler.y -= movementX * 0.002;\n\t\t\t_euler.x -= movementY * 0.002;\n\n\t\t\t_euler.x = Math.max( _PI_2 - scope.maxPolarAngle, Math.min( _PI_2 - scope.minPolarAngle, _euler.x ) );\n\n\t\t\tcamera.quaternion.setFromEuler( _euler );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t}\n\n\t\tfunction onPointerlockChange() {\n\n\t\t\tif ( scope.domElement.ownerDocument.pointerLockElement === scope.domElement ) {\n\n\t\t\t\tscope.dispatchEvent( _lockEvent );\n\n\t\t\t\tscope.isLocked = true;\n\n\t\t\t} else {\n\n\t\t\t\tscope.dispatchEvent( _unlockEvent );\n\n\t\t\t\tscope.isLocked = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerlockError() {\n\n\t\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t\t}\n\n\t\tthis.connect = function () {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.disconnect = function () {\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.disconnect();\n\n\t\t};\n\n\t\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\t\treturn camera;\n\n\t\t};\n\n\t\tthis.getDirection = function () {\n\n\t\t\tconst direction = new Vector3( 0, 0, - 1 );\n\n\t\t\treturn function ( v ) {\n\n\t\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.moveForward = function ( distance ) {\n\n\t\t\t// move forward parallel to the xz-plane\n\t\t\t// assumes camera.up is y-up\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\t_vector.crossVectors( camera.up, _vector );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.moveRight = function ( distance ) {\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.lock = function () {\n\n\t\t\tthis.domElement.requestPointerLock();\n\n\t\t};\n\n\t\tthis.unlock = function () {\n\n\t\t\tscope.domElement.ownerDocument.exitPointerLock();\n\n\t\t};\n\n\t\tthis.connect();\n\n\t}\n\n}\n\nexport {\n\tPointerLockControls,\n}\n\nconst unlockEvent = _unlockEvent\nexport { unlockEvent }\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n  color: white;\n  font-size: 2em;\n  border: 1px solid red;\n`;\n\n/**\n * RotationPad\n * _vp_ 2022-09-02\n**/\nconst RotationPad = (props) => {\n  logg(props, 'RotationPad')\n  const { container, } = props\n\n  var mouseDown = false;\n  var mouseStopped = false;\n  var mouseStopTimeout, eventRepeatTimeout;\n  var newLeft, newTop, distance, angle;\n\n\n  const mouseDownHandler = (event) => {\n    mouseDown = true\n    self.handle.css(\"opacity\", \"1.0\")\n    update(event.pageX, event.pageY)\n  }\n\n  self.regionData = {};\n  self.handleData = {};\n\n  // self.rotationPad = $('<div class=\"rotation-pad\"></div>')\n  // self.region = $('<div class=\"region\"></div>')\n  // self.handle = $('<div class=\"handle\"></div>')\n  self.rotationPad = <h1>R</h1>\n  self.region = <h2 onMouseDown={mouseDownHandler} >region</h2>\n  self.handle = <h2>handle</h2>\n\n  // self.rotationPad.append(self.region).append(self.handle)\n  // self.container.append(self.rotationPad)\n\n  // // Aligning pad:\n  // self.rotationPad.css({\n  //   // _vp_ 2022-09-02\n  //   // top: self.container.find(\"canvas\").height() + self.container.position().top - self.region.outerHeight() - 10,\n  //   // left: self.container.find(\"canvas\").width() - self.region.outerWidth() - 20\n  //   top: 100,\n  //   left: 200,\n  // });\n\n  // self.regionData.width = self.region.outerWidth();\n  // self.regionData.height = self.region.outerHeight();\n  // self.regionData.position = self.region.position();\n  // self.regionData.offset = self.region.offset();\n  // self.regionData.radius = self.regionData.width / 2;\n  // self.regionData.centerX = self.regionData.position.left + self.regionData.radius;\n  // self.regionData.centerY = self.regionData.position.top + self.regionData.radius;\n\n  // self.handleData.width = self.handle.outerWidth();\n  // self.handleData.height = self.handle.outerHeight();\n  // self.handleData.radius = self.handleData.width / 2;\n\n  // self.regionData.radius = self.regionData.width / 2 - self.handleData.radius;\n\n  // Mouse events:\n\n  // $(document).on(\"mouseup\", function () {\n  //   mouseDown = false;\n  //   self.resetHandlePosition();\n  // });\n\n  // $(document).on(\"mousemove\", function(event) {\n  //   if (!mouseDown) return;\n  //   update(event.pageX, event.pageY);\n  // });\n\n  // self.region.on(\"touchstart\", function (event) {\n  //   mouseDown = true;\n  //   self.handle.css(\"opacity\", \"1.0\");\n  //   update(event.originalEvent.targetTouches[0].pageX, event.originalEvent.targetTouches[0].pageY);\n  // });\n\n  // $(document).on(\"touchend touchcancel\", function () {\n  //   mouseDown = false;\n  //   self.resetHandlePosition();\n  // });\n\n  // $(document).on(\"touchmove\", function(event) {\n  //   if (!mouseDown) return;\n  //   update(event.originalEvent.touches[0].pageX, event.originalEvent.touches[0].pageY);\n  // });\n\n\n  function update(pageX, pageY) {\n    newLeft = (pageX - self.regionData.offset.left);\n    newTop = (pageY - self.regionData.offset.top);\n\n    // If handle reaches the pad boundaries.\n    distance = Math.pow(self.regionData.centerX - newLeft, 2) + Math.pow(self.regionData.centerY - newTop, 2);\n    if (distance > Math.pow(self.regionData.radius, 2)) {\n      angle = Math.atan2((newTop - self.regionData.centerY), (newLeft - self.regionData.centerX));\n      newLeft = (Math.cos(angle) * self.regionData.radius) + self.regionData.centerX;\n      newTop = (Math.sin(angle) * self.regionData.radius) + self.regionData.centerY;\n    }\n    newTop = Math.round(newTop * 10) / 10;\n    newLeft = Math.round(newLeft * 10) / 10;\n\n    self.handle.css({\n      top: newTop - self.handleData.radius,\n      left: newLeft - self.handleData.radius\n    });\n    // console.log(newTop , newLeft);\n\n    // Providing event and data for handling camera movement.\n    var deltaX = self.regionData.centerX - parseInt(newLeft);\n    var deltaY = self.regionData.centerY - parseInt(newTop);\n    // Normalize x,y between -2 to 2 range.\n    deltaX = -2 + (2+2) * (deltaX - (-self.regionData.radius)) / (self.regionData.radius - (-self.regionData.radius));\n    deltaY = -2 + (2+2) * (deltaY - (-self.regionData.radius)) / (self.regionData.radius - (-self.regionData.radius));\n    deltaX = -1 * Math.round(deltaX * 10) / 10;\n    deltaY = -1 * Math.round(deltaY * 10) / 10;\n    // console.log(deltaX, deltaY);\n\n    sendEvent(deltaX, deltaY);\n  }\n\n  function sendEvent(dx, dy) {\n    if (!mouseDown) {\n      clearTimeout(eventRepeatTimeout);\n      return;\n    }\n\n    clearTimeout(eventRepeatTimeout);\n    eventRepeatTimeout = setTimeout(function() {\n      sendEvent(dx, dy);\n    }, 5);\n\n    var moveEvent = $.Event(\"YawPitch\", {\n      detail: {\n        \"deltaX\": dx,\n        \"deltaY\": dy\n      },\n      bubbles: false\n    });\n    $(self).trigger(moveEvent);\n  }\n\n  const resetHandlePosition = () => {\n    logg('resetting handle position...')\n    // this.handle.animate({\n    //   top: this.regionData.centerY - this.handleData.radius,\n    //   left: this.regionData.centerX - this.handleData.radius,\n    //   opacity: 0.1\n    // }, \"fast\");\n  }\n\n  resetHandlePosition()\n\n  return <W0>[ Rotate4 ]</W0>\n}\n\nexport default RotationPad\n\n\n","\nimport React, { Fragment as F, useEffect, useRef, useState } from 'react'\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport styled from 'styled-components'\n\nimport {\n  logg, logg_v,\n} from \"$shared\"\nimport {\n  Blocker,\n} from './'\nimport TouchControls from './vendor/TouchControls'\nimport MovementPad from './vendor/MovementPad'\n\n/**\n * Local Constants\n**/\nconst _C = {\n  epsilon: 0.001,\n  events: {\n    move: 'move',\n    stopMove: 'stopMove',\n    gotoPosition: 'gotoPosition',\n  },\n  origin: [0, 10, 0],\n}\nexport {\n  _C as C,\n}\n\n/**\n * ThreePanelMobile\n *\n * _vp_ 2021-11-14 :: Markers are objects\n * _vp_ 2022-08-13 :: Cont.\n * _vp_ 2022-09-02 :: Cont.\n * _vp_ 2022-09-14 :: local constants,\n *\n *\n */\nconst Loc = (props) => {\n  logg(props, 'ThreePanelMobile')\n  const { map } = props\n\n  let camera, controls\n  let fpsBody\n  let markerObjects = [], markerObjectsIdxs = []\n  let object, objects = []\n  let raycaster, renderer\n  let scene\n  let texture // sky and floor, maybe all textures will share this memory?\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n  const loader = new GLTFLoader()\n  const worldOctree = new Octree()\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n    onWindowResize()\n  }, [])\n\n  const onWindowResize = () => {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function init() {\n\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.set(..._C.origin)\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    const axesHelper = new THREE.AxesHelper( 5 )\n    scene.add( axesHelper )\n\n    // Controls\n    var options = {\n      speedFactor: 0.5,\n      delta: 1,\n      rotationFactor: 0.002,\n      maxPitch: 55,\n      hitTest: true,\n      hitTestDistance: 40\n    };\n    // controls = new TouchControls(blockerRef.current, camera, options);\n    // controls.setPosition(0, 35, 400);\n\n    // controls.addToScene(scene);\n    // scene.add( controls.getObject() )\n\n    // blockerRef.current.addEventListener( 'click', function () {\n    //   logg('locked controls')\n    //   controls.lock()\n    // } )\n\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    const onStopMove = (e) => {\n      // logg(e, 'onStopMove')\n      moveRight = moveLeft = moveForward = moveBackward = false\n    }\n\n    /*\n     * The coords of the event.detail are that of the pad:\n     * -2..+2 deltaY = backward/forward\n     * -2..+2 deltaX = left/right\n    **/\n    const onMove = ({ detail }) => {\n      // logg(detail, 'onMove')\n      const {\n        deltaX, deltaY,\n      } = detail\n\n      const v = new THREE.Vector3(deltaX, 0, -deltaY)\n      v.normalize()\n      v.multiplyScalar(0.2) // move slower\n      velocity.add( v )\n    }\n\n    const gotoPosition = ({ detail }) => {\n      // logg(detail, 'going to position')\n      camera.position.set( ...detail )\n    }\n\n    document.addEventListener(_C.events.move, onMove )\n    document.addEventListener(_C.events.stopMove, onStopMove )\n    document.addEventListener(_C.events.gotoPosition, gotoPosition )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Populate objects\n    **/\n    if (true) {\n      /*\n      * Floor\n      **/\n\n      // moon floor\n      texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n      let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n      floorGeometry.rotateX( - Math.PI / 2 )\n      const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n      const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n      scene.add( floor )\n\n      map.markers.map((marker, idx) => {\n\n        loader.load( marker.asset3d_path, ( gltf ) => {\n          scene.add( gltf.scene );\n          worldOctree.fromGraphNode( gltf.scene );\n          gltf.scene.traverse( child => {\n            if ( child.isMesh ) {\n              child.castShadow = true;\n              child.receiveShadow = true;\n              if ( child.material.map ) {\n                child.material.map.anisotropy = 4;\n              }\n            }\n          } )\n        })\n\n      })\n\n      /*\n      * Skybox\n      **/\n      const textureLoader = new THREE.TextureLoader()\n      texture = textureLoader.load(`/assets/textures/space-5.jpg`, () => {\n        const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n        rt.fromEquirectangularTexture(renderer, texture)\n        scene.background = rt.texture\n      });\n\n      /*\n      * Camera Holder\n      **/\n      var cameraHolder = new THREE.Object3D();\n      cameraHolder.name = \"cameraHolder\";\n      // cameraHolder.add(camera);\n\n      fpsBody = new THREE.Object3D();\n      fpsBody.add(cameraHolder);\n    }\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n  }\n\n\n  // @TODO: it's not a camera, the camera must be held by something, to do object collision. _vp_ 2022-09-14\n  // @TODO: add collisions, boundary?\n  // @TODO: re-implement jumping and gravity, from threejs fps example. _vp_ 2022-09-14\n  function animate() {\n    requestAnimationFrame( animate )\n    const direction = new THREE.Vector3()\n    const time = performance.now()\n    const delta = ( time - prevTime ) / 1000\n\n    /*\n     * Friction\n    **/\n    if (Math.abs(velocity.x) < _C.epsilon) {\n      velocity.x = 0\n    } else {\n      velocity.x -= velocity.x * 10.0 * delta\n    }\n    if (Math.abs(velocity.y) < _C.epsilon) {\n      velocity.y = 0\n    } else {\n      // gravity\n      // velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n    }\n    if (Math.abs(velocity.z) < _C.epsilon) {\n      velocity.z = 0\n    } else {\n      velocity.z -= velocity.z * 10.0 * delta\n    }\n\n    // if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n    // if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n\n    // velocity.z -= direction.z * 400.0 * delta\n    // velocity.x -= direction.x * 400.0 * delta\n\n\n    camera.translateX(velocity.x);\n    camera.translateZ(velocity.z);\n\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} className=\"Blocker\" >\n      <div id=\"Crosshair\" />\n      {/* <TouchControls container={blockerRef} camera={camera} options={{}} /> */}\n      <MovementPad />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n\n\n\n","\nimport React, { useEffect, useRef } from 'react'\nimport styled from 'styled-components'\n\nimport { C } from \"$components/locations3d/ThreePanelMobile\"\nimport {\n  logg,\n} from \"$shared\"\nimport bgImg from './MovementPadBg.png'\nimport aimSvg from './aim.svg'\n\nconst _Region = styled.div`\n  width: 100%;\n  height: 100%;\n  background: rgba(126, 126, 0, .5);\n`;\nconst Region = ({ children, ref, ...props }) => {\n  return <_Region innerRef={ref} className='Region' {...props} >\n    {children}\n  </_Region>\n}\n\nconst _C = {\n  thresh: 0.2, // the center eg 20% of the pad are insensitive.\n  ...C,\n}\n\nconst _Handle = styled.div``;\nconst Handle = ({ children, ...props }) => <_Handle className='Handle' {...props} >{children}</_Handle>\n\nconst _Pad = styled.div`\n  // top: container.find(\"canvas\").height() + container.position().top - regionRef.currentouterHeight() - 10,\n  // left: 20,\n\n  top: 50px;\n  right: 50px;\n\n  position: absolute;\n  width: 100px;\n  height: 100px;\n  border: 1px solid cyan;\n`;\nconst Pad = ({ children, ...props }) => {\n  return <_Pad className='MovementPad' {...props} >\n    {children}\n  </_Pad>\n}\n\n\n/**\n * MovementPad\n * _vp_ 2022-09-02 ::\n * _vp_ 2022-09-14 :: Continue, MovementPad helper, axesHelper,\n *\n**/\nconst MovementPad = (props) => {\n  logg(props, 'MovementPad')\n  const {} = props\n\n  let mouseDown = false\n  let mouseStopped = false\n  let eventStopTimeout, eventRepeatTimeout\n  let newLeft, newTop, distance, angle\n\n  const regionData = {}\n  const regionRef = useRef(null)\n  const handleData = {}\n\n  if (regionRef.current) {\n    regionData.w = regionRef.current.clientWidth\n    regionData.radius = regionData.w / 2\n    regionData.h = regionRef.current.clientHeight\n    regionData.x = regionRef.current.getBoundingClientRect().x\n    regionData.y = regionRef.current.getBoundingClientRect().y\n    regionData.centerX = regionData.x + regionData.w / 2\n    regionData.centerY = regionData.y + regionData.h / 2\n\n    // handleData.width = handle.outerWidth();\n    // handleData.height = handle.outerHeight();\n    // handleData.radius = handleData.width / 2;\n\n    // regionData.radius = regionData.width / 2 - handleData.radius;\n  }\n\n  const onTouchEnd = (e) => { // and touchcancel\n    // logg(e, 'onTouchEnd')\n    mouseDown = false\n    resetHandlePosition()\n    sendEvent()\n  }\n\n  const onTouchMove = (e) => {\n    // logg(e, 'onTouchMove')\n    if (!mouseDown) return\n    update(e.touches[0].pageX, e.touches[0].pageY);\n  }\n\n  const onTouchStart = (e) => {\n    // logg(e, 'onTouchStart')\n    // logg([e.targetTouches[0].pageX, e.targetTouches[0].pageY], 'onTouchStart')\n    e.persist()\n\n    mouseDown = true\n    // handle.css(\"opacity\", \"1.0\")\n    update(e.targetTouches[0].pageX, e.targetTouches[0].pageY)\n  }\n\n  const update = (pageX, pageY) => {\n    // logg(regionData, 'regionData')\n\n    newLeft = (pageX - regionData.x)\n    newTop = (pageY - regionData.y)\n\n    // logg([newLeft, newTop], 'update: newLeft, newTop')\n    // logg([ regionData.centerX, regionData.centerY ], 'centerX, centerY')\n\n    // // If handle reaches the pad boundaries.\n    // distance = Math.pow(regionData.centerX - newLeft, 2) + Math.pow(regionData.centerY - newTop, 2);\n    // if (distance > Math.pow(regionData.radius, 2)) {\n    //   angle = Math.atan2((newTop - regionData.centerY), (newLeft - regionData.centerX));\n    //   newLeft = (Math.cos(angle) * regionData.radius) + regionData.centerX;\n    //   newTop = (Math.sin(angle) * regionData.radius) + regionData.centerY;\n    // }\n    // newTop = Math.round(newTop * 10) / 10;\n    // newLeft = Math.round(newLeft * 10) / 10;\n\n    // handle.css({\n    //   top: newTop - handleData.radius,\n    //   left: newLeft - handleData.radius\n    // });\n    // console.log(newTop , newLeft);\n\n    regionData.centerX = 50\n    regionData.centerY = 50\n\n    // Providing event and data for handling camera movement.\n    let deltaX = regionData.centerX - parseInt(newLeft);\n    let deltaY = regionData.centerY - parseInt(newTop);\n    // Normalize x,y between -2 to 2 range.\n    deltaX = -2 + (2+2) * (deltaX - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n    deltaY = -2 + (2+2) * (deltaY - (-regionData.radius)) / (regionData.radius - (-regionData.radius));\n    deltaX = Math.round(deltaX * 10) / 10;\n    deltaY = Math.round(deltaY * 10) / 10;\n    // touching the center is insensitive\n    if (Math.abs(deltaX) < _C.thresh && Math.abs(deltaY) < _C.thresh) {\n      deltaX = 0\n      deltaY = 0\n    }\n\n    // console.log(deltaX, deltaY);\n\n    sendEvent(-deltaX, deltaY, 0);\n  }\n\n  const stopEvent = new CustomEvent(\"stopMove\", {\n    bubbles: false\n  })\n\n  function sendEvent(dx, dy, middle) {\n\n    if (!mouseDown) {\n      clearTimeout(eventRepeatTimeout);\n      document.dispatchEvent(stopEvent)\n      return\n    }\n\n    // logg([dx, dy, middle, mouseDown], 'sendEvent')\n\n    // stop moving after 1sec ? _vp_ 2022-09-13\n    clearTimeout(eventStopTimeout);\n    eventStopTimeout = setTimeout(function() {\n      logg('stopping...')\n      document.dispatchEvent(stopEvent)\n    }, 0.2 * 1000);\n\n    eventStopTimeout\n\n    var moveEvent = new CustomEvent(_C.events.move, {\n      detail: {\n        \"deltaX\": dx,\n        \"deltaY\": dy,\n      },\n      bubbles: false\n    })\n    document.dispatchEvent(moveEvent)\n  }\n\n  const resetPosition = () => {\n    const ev = new CustomEvent(_C.events.gotoPosition, {\n      detail: _C.origin,\n      bubbles: false\n    })\n    document.dispatchEvent(ev)\n  }\n\n  const resetHandlePosition = () => {\n    // handle.animate({\n    //   top: this.regionData.centerY - this.handleData.radius,\n    //   left: this.regionData.centerX - this.handleData.radius,\n    //   opacity: 0.1\n    // }, \"fast\");\n  }\n\n  // resetHandlePosition()\n\n\n\n  return <Pad >\n    <div className='Region'\n      style={{ width: '100px', height: '100px', background: `center center url(\"${bgImg}\") rgba(255,0,0,.5)` }}\n      onTouchEnd={onTouchEnd}\n      onTouchCancel={onTouchEnd}\n      onTouchStart={onTouchStart}\n      onTouchMove={onTouchMove}\n      ref={regionRef}\n    >\n      <Handle />\n    </div>\n    <img style={{ width: 25, height: 25, position: 'absolute', right: 0, top: 125 }} src={aimSvg} onClick={resetPosition} />\n  </Pad>\n};\n\nexport default MovementPad","\nimport React from 'react'\nimport * as THREE from \"three\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\n\nimport RotationPad from './RotationPad'\nimport MovementPad from './MovementPad'\n\nconst W0 = styled.div`\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n  border: 1px solid red;\n  z-index: 2;\n  color: white;\n  font-size: 2em;\n`;\n\n/**\n * TouchControls\n * _vp_ 2022-09-02\n *\n**/\nconst TouchControls = (props) => {\n  logg(props, 'TouchControls')\n  const { container, camera, options } = props\n\n  if (!container?.current) {\n    logg('no current ref in TouchControls!')\n    return null\n  }\n\n  const config = { ...options, ...{\n    speedFactor: 0.5,\n    delta: 1,\n    rotationFactor: 0.002,\n    maxPitch: 55,\n    hitTest: true,\n    hitTestDistance: 40\n  }}\n\n  var isRightMouseDown = false;\n  var rotationMatrices = [];\n  var hitObjects = [];\n\n  var moveForward = false;\n  var moveBackward = false;\n  var moveLeft = false;\n  var moveRight = false;\n  var lockMoveForward = false;\n  var lockMoveBackward = false;\n  var lockMoveLeft = false;\n  var lockMoveRight = false;\n\n  var ztouch = 1, xtouch = 1;\n  var PI_2 = Math.PI / 2;\n  var maxPitch = config.maxPitch * Math.PI / 180;\n  var velocity = new THREE.Vector3(0, 0, 0);\n\n  var cameraHolder = new THREE.Object3D()\n  cameraHolder.name = \"cameraHolder\"\n  cameraHolder.add(camera)\n\n  const scene = null;\n  const fpsBody = new THREE.Object3D();\n  fpsBody.add(cameraHolder);\n  const enabled = true;\n\n  const mouse = new THREE.Vector2();\n\n  $(self.rotationPad).on(\"YawPitch\", function(event) {\n    var rotation = calculateCameraRotation(event.detail.deltaX, event.detail.deltaY);\n    self.setRotation(rotation.rx, rotation.ry);\n  });\n\n  // // Creating movement pad:\n  // self.movementPad = new MovementPad(container);\n  // $(self.movementPad).on(\"move\", function(event) {\n  //   ztouch = Math.abs(event.detail.deltaY);\n  //   xtouch = Math.abs(event.detail.deltaX);\n\n  //   if (event.detail.deltaY == event.detail.middle) {\n  //     ztouch = 1;\n  //     moveForward = moveBackward = false;\n  //   } else {\n  //     if (event.detail.deltaY > event.detail.middle) {\n  //       moveForward = true;\n  //       moveBackward = false;\n  //     }\n  //     else if (event.detail.deltaY < event.detail.middle) {\n  //       moveForward = false;\n  //       moveBackward = true;\n  //     }\n  //   }\n\n  //   if (event.detail.deltaX == event.detail.middle) {\n  //     xtouch = 1;\n  //     moveRight = moveLeft = false;\n  //   } else {\n  //     if (event.detail.deltaX < event.detail.middle) {\n  //       moveRight = true;\n  //       moveLeft = false;\n  //     }\n  //     else if (event.detail.deltaX > event.detail.middle) {\n  //       moveRight = false;\n  //       moveLeft = true;\n  //     }\n  //   }\n  // });\n  // $(self.movementPad).on(\"stopMove\", function(event) {\n  //   ztouch = xtouch = 1;\n  //   moveForward = moveBackward = moveLeft = moveRight = false;\n  // });\n\n\n\n  // container.on(\"contextmenu\", onContextMenu);\n  // container.on(\"mousedown\", onMouseDown);\n  // container.on(\"mouseup\", onMouseUp);\n  container.current.addEventListener('contextmenu', onContextMenu)\n  container.current.addEventListener('mousedown', onMouseDown)\n  container.current.addEventListener('mouseup', onMouseUp)\n\n\n  // $(document).on(\"keydown\", onKeyDown);\n  // $(document).on(\"keyup\", onKeyUp);\n  // $(document).on(\"mousemove\", onMouseMove);\n  // $(document).on(\"mouseout\", onMouseOut);\n\n  container.current.addEventListener('keydown', onKeyDown)\n  container.current.addEventListener(\"keyup\", onKeyUp);\n  container.current.addEventListener(\"mousemove\", onMouseMove);\n  container.current.addEventListener(\"mouseout\", onMouseOut);\n\n  prepareRotationMatrices();\n\n  //\n  // Events:\n  //\n  function onContextMenu(event) {\n    event.preventDefault();\n  };\n\n  function onMouseDown(event) {\n    if (self.enabled && event.button === 2) {\n      isRightMouseDown = true;\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  };\n\n  function onMouseUp(event) {\n    if (self.enabled && event.button === 2) {\n      isRightMouseDown = false;\n    }\n  };\n\n  function onMouseMove(event) {\n    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n\n    if (!self.enabled || !isRightMouseDown) return;\n\n    var movementX = event.originalEvent.movementX || event.originalEvent.mozMovementX || event.originalEvent.webkitMovementX || 0;\n    var movementY = event.originalEvent.movementY || event.originalEvent.mozMovementY || event.originalEvent.webkitMovementY || 0;\n    var rotation = calculateCameraRotation(-1 * movementX, -1 * movementY);\n\n    // console.log(self.mouse, \"\\n\", movementX, rotation);\n\n    self.setRotation(rotation.rx, rotation.ry);\n\n    // updateNavPad();\n  };\n\n  function onMouseOut(e) {\n    isRightMouseDown = false;\n    // self.stopMouseMoving();\n  };\n\n  function onKeyDown(e) {\n    if (!self.enabled) return;\n    switch (e.keyCode) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = true;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = true;\n        break;\n\n      case 40: // down\n      case 83: // s\n        moveBackward = true;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = true;\n        break;\n    }\n  };\n\n  function onKeyUp(e) {\n    switch (e.keyCode) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = false;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = false;\n        break;\n\n      case 40: // down\n      case 83: // a\n        moveBackward = false;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = false;\n        break;\n    }\n  };\n\n  //\n  // Private functions:\n  //\n  function prepareRotationMatrices() {\n    var rotationMatrixF = new THREE.Matrix4();\n    rotationMatrixF.makeRotationY(0);\n    rotationMatrices.push(rotationMatrixF); // forward direction.\n\n    var rotationMatrixB = new THREE.Matrix4();\n    rotationMatrixB.makeRotationY(180 * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixB);\n\n    var rotationMatrixL = new THREE.Matrix4();\n    rotationMatrixL.makeRotationY(90 * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixL);\n\n    var rotationMatrixR = new THREE.Matrix4();\n    rotationMatrixR.makeRotationY((360 - 90) * Math.PI / 180);\n    rotationMatrices.push(rotationMatrixR);\n  };\n\n  function calculateCameraRotation(dx, dy, factor) {\n    var factor = factor ? factor : self.config.rotationFactor;\n    var ry = self.fpsBody.rotation.y - (dx * factor);\n    var rx = cameraHolder.rotation.x - (dy * factor);\n    rx = Math.max(-maxPitch, Math.min(maxPitch, rx));\n\n    return {\n      rx: rx,\n      ry: ry\n    };\n  };\n\n  function lockDirectionByIndex(index) {\n    if (index == 0)\n      self.lockMoveForward(true);\n    else if (index == 1)\n      self.lockMoveBackward(true);\n    else if (index == 2)\n      self.lockMoveLeft(true);\n    else if (index == 3)\n      self.lockMoveRight(true);\n  }\n\n  //\n  // Public functions:\n  //\n  const update = function() {\n    return\n\n    if (config.hitTest)\n      self.hitTest();\n\n    velocity.x += (-1 * velocity.x) * 0.75 * self.config.delta;\n    velocity.z += (-1 * velocity.z) * 0.75 * self.config.delta;\n\n    if (moveForward && !lockMoveForward) velocity.z -= ztouch * self.config.speedFactor * self.config.delta;\n    if (moveBackward && !lockMoveBackward) velocity.z += ztouch * self.config.speedFactor * self.config.delta;\n\n    if (moveLeft && !lockMoveLeft) velocity.x -= xtouch * self.config.speedFactor * self.config.delta;\n    if (moveRight && !lockMoveRight) velocity.x += xtouch * self.config.speedFactor * self.config.delta;\n\n    fpsBody.translateX(velocity.x);\n    fpsBody.translateY(velocity.y);\n    fpsBody.translateZ(velocity.z);\n  };\n\n  const hitTest = function() {\n    return\n\n    self.unlockAllDirections();\n    hitObjects = [];\n    var cameraDirection = self.getDirection2(new THREE.Vector3(0, 0, 0)).clone();\n\n    for (var i = 0; i < 4; i++) {\n      // Applying rotation for each direction:\n      var direction = cameraDirection.clone();\n      direction.applyMatrix4(rotationMatrices[i]);\n\n      var rayCaster = new THREE.Raycaster(fpsBody.position, direction);\n      var intersects = rayCaster.intersectObject(self.scene, true);\n      if ((intersects.length > 0 && intersects[0].distance < self.config.hitTestDistance)) {\n        lockDirectionByIndex(i);\n        hitObjects.push(intersects[0]);\n        // console.log(intersects[0].object.name, i);\n      }\n    }\n\n    return hitObjects;\n  };\n\n  const getDirection2 = function(v) {\n    return\n\n    var self = this;\n    var direction = new THREE.Vector3(0, 0, -1);\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n    var rx = fpsBody.getObjectByName(\"cameraHolder\").rotation.x;;\n    var ry = fpsBody.rotation.y;\n\n    // console.log(\"DIRECTION:\", this);\n    rotation.set(rx, ry, 0);\n    v.copy(direction).applyEuler(rotation);\n    // console.log(v);\n    return v;\n  };\n\n  const getDirection = function() {\n    return\n\n    var self = this;\n    var rx = 0;\n    var ry = 0;\n    var direction = new THREE.Vector3(0, 0, -1);\n    var rotation = new THREE.Euler(0, 0, 0, \"YXZ\");\n\n    // console.log(\"DIRECTION:\", this);\n    if (self != undefined) {\n      rx = fpsBody.getObjectByName(\"cameraHolder\").rotation.x;\n      ry = fpsBody.rotation.y;\n      console.log(rx, ry);\n    }\n    // var camHolder = self.fpsBody.getObjectByName(\"cameraHolder\");\n\n    return function(v) {\n      rotation.set(rx, ry, 0);\n      v.copy(direction).applyEuler(rotation);\n      // console.log(v);\n      return v;\n    }\n  }();\n\n  // const moveLeft = function() {\n  //   return moveLeft;\n  // };\n\n  // const moveRight = function() {\n  //   return moveRight;\n  // };\n\n  // const moveForward = function() {\n  //   return moveForward;\n  // };\n\n  // const moveBackward = function() {\n  //   return moveBackward;\n  // };\n\n  // const lockMoveForward = function(boolean) {\n  //   lockMoveForward = boolean;\n  // };\n\n  // const lockMoveBackward = function(boolean) {\n  //   lockMoveBackward = boolean;\n  // };\n\n  // const lockMoveLeft = function(boolean) {\n  //   lockMoveLeft = boolean;\n  // };\n\n  // const lockMoveRight = function(boolean) {\n  //   lockMoveRight = boolean;\n  // };\n\n  const unlockAllDirections = function() {\n    self.lockMoveForward(false);\n    self.lockMoveBackward(false);\n    self.lockMoveLeft(false);\n    self.lockMoveRight(false);\n  }\n\n  const setRotation = (x, y) => {\n    var camHolder = fpsBody.getObjectByName(\"cameraHolder\");\n\n    if (x !== null)\n      camHolder.rotation.x = x;\n\n    if (y !== null)\n      fpsBody.rotation.y = y;\n  }\n\n  return <RotationPad />\n  return <W0>[ Touch4 ]</W0>\n}\n\nTouchControls.prototype = {\n  addToScene: function(scene) {\n    this.scene = scene;\n    scene.add(this.fpsBody);\n  },\n\n  setPosition: function(x, y, z) {\n    this.fpsBody.position.set(x, y, z);\n  },\n\n  stopMouseMoving: function() {\n    isRightMouseDown = false;\n  },\n\n  getHitObjects: function() {\n    return hitObjects;\n  }\n\n};\n\nexport default TouchControls\n","\n/*\n * @TODO: this is just a copy of equirectangular2, discard\n */\n\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport { PointerLockControls } from './vendor/PointerLockControls'\nimport TouchControls from \"./vendor/TouchControls\"\nimport RotationPad from \"./vendor/RotationPad\"\n\nconst Blocker = styled.div`\n  border: 1px dashed red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n\n  #Crosshair {\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\nconst W = styled.div`\n  border: 1px solid blue;\n  height: 90vh;\n`;\n\n/**\n * Equirectangular2\n * _vp_ 2021-11-15\n * Let's wire in a simple floor and full-window sizing.\n *\n * Threejs units of measure are centimeters (cm).\n *\n */\nconst Equirectangular2 = (props) => {\n  logg(props, 'Equirectangular2')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene;\n\n  var width, height;\n  var viewAngle = 45,\n    near = 1,\n    far = 10000;\n  var aspect;\n  var stats;\n  var sceneObject, intersected;\n\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const blockerRef = useRef(null)\n  const wContainerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 ) // @TODO: what this?\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 ) // @TODO: what this?\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Origin: axis helper\n     */\n    var axes = new THREE.AxisHelper(700)\n\t\tscene.add(axes)\n\n    const wContainer = wContainerRef.current\n\n    function addControls() {\n      var options = {\n        speedFactor: 0.5,\n        delta: 1,\n        rotationFactor: 0.002,\n        maxPitch: 55,\n        hitTest: true,\n        hitTestDistance: 40\n      };\n      controls = new TouchControls({\n        container: wContainer, camera,\n        options,\n        RotationPad: rotationPad,\n        THREE,\n      });\n      controls.setPosition(0, 35, 400);\n      controls.addToScene(scene);\n      // controls.setRotation(0.15, -0.15);\n    }\n    addControls()\n\n    /*\n     * Floor\n     */\n\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.PlaneGeometry( 100, 100, 10, 10 ) // width, height, w segments, h segments\n    // let floorGeometry = new THREE.CircleGeometry(100, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/100x100_lazer-floor.png`)\n    texture.wrapS = THREE.RepeatWrapping\n    texture.wrapT = THREE.RepeatWrapping\n    texture.repeat.set( 10, 10 )\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      map: texture,\n      // transparent: true,\n    })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    // const scenesPath = '/assets/scenes/'\n    // const objectsPath = '/assets/objects/'\n    // let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    // const texturePath = `${modelName}/${modelName}.mtl`\n    // const modelPath = `${modelName}/${modelName}.obj`\n    // const manager = new THREE.LoadingManager()\n    // const onProgress = (xhr) => {\n    //   if (xhr.lengthComputable) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }\n    // const onError = () => {}\n    // const onLoad = (materials) => {\n    //   materials.preload()\n    //   const objLoader = new OBJLoader( manager )\n    //   objLoader.setMaterials( materials )\n    //   objLoader.setPath( scenesPath)\n    //   objLoader.load( modelPath, ( object ) => {\n    //     object.traverse((child) => {\n    //       if (child.isMesh) {\n    //         child.geometry.scale(0.10, 0.10, 0.10) // @TODO: change?\n    //       }\n    //     })\n    //     object.position.x = Math.random() * 500\n    //     object.position.y = 10\n    //     object.position.z = Math.random() * 500\n\n    //     logg(object, '1st object')\n    //     scene.add( object )\n    //     markerObjects.push( object )\n    //     markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' }) // @TODO: change!\n\n    //   }, onProgress, onError )\n    // }\n    // const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setPath(scenesPath)\n    // mtlLoader.load(texturePath, onLoad)\n\n\n    /*\n     * Skybox\n     */\n    const textureLoader = new THREE.TextureLoader()\n    const assetPath = map.img_path\n    texture = textureLoader.load(assetPath, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  /* From: https://threejsfundamentals.org/threejs/lessons/threejs-responsive.html */\n  function resizeRendererToDisplaySize() {\n    const canvas = renderer.domElement\n    const width = blockerRef.current.clientWidth\n    const height = blockerRef.current.clientHeight\n    const needResize = canvas.width !== width || canvas.height !== height\n    if (needResize) {\n      renderer.setSize(width, height)\n    }\n    return needResize\n  }\n  function onWindowResize() {\n    if (resizeRendererToDisplaySize()) {\n      const width = blockerRef.current.clientWidth\n      const height = blockerRef.current.clientHeight\n      camera.aspect = width / height\n      camera.updateProjectionMatrix()\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <W ref={wContainerRef} >\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n\n      <RotationPad />\n    </Blocker>\n  </W>\n}\n\nexport default Equirectangular2\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  Blocker,\n} from './'\nimport { logg, S } from \"$shared\"\n\n/**\n * TabiversePlanet\n */\nconst TabiversePlanet = (props) => {\n\n  let camera\n  let geometry\n  let material\n  let planet\n  let renderer\n  let texture\n  let scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  function init() {\n\n    camera = new THREE.PerspectiveCamera( 75, 2, 0.1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n    camera.position.z = -10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0x31231f )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    /*\n     * Floor\n     */\n    // texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n    // let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    // floorGeometry.rotateX( - Math.PI / 2 )\n    // const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    /*\n     * Planet\n    **/\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/2k_mercury.jpeg`)\n    geometry = new THREE.SphereBufferGeometry(1, 32, 32)\n    // geometry = new THREE.BoxGeometry( 1, 1, 1 );\n    // material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\n    material = new THREE.MeshBasicMaterial({ map: texture })\n    planet = new THREE.Mesh(geometry, material)\n    planet.position.y = 10\n    planet.position.z = -12\n    scene.add(planet)\n\n    /*\n     * Render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n\n    // camera.rotation.x += 0.01\n    // camera.rotation.y += 0.01\n\n    planet.rotation.y += 0.00035\n\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <Blocker {...S} ref={blockerRef} >\n    </Blocker>\n  </F>\n}\n\nexport default TabiversePlanet\n","import {\n\tMatrix4,\n\tObject3D,\n\tVector3\n} from 'three';\n\nclass CSS2DObject extends Object3D {\n\n\tconstructor( element = document.createElement( 'div' ) ) {\n\n\t\tsuper();\n\n\t\tthis.isCSS2DObject = true;\n\n\t\tthis.element = element;\n\n\t\tthis.element.style.position = 'absolute';\n\t\tthis.element.style.userSelect = 'none';\n\n\t\tthis.element.setAttribute( 'draggable', false );\n\n\t\tthis.addEventListener( 'removed', function () {\n\n\t\t\tthis.traverse( function ( object ) {\n\n\t\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n\t\t\t\t\tobject.element.parentNode.removeChild( object.element );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.element = source.element.cloneNode( true );\n\n\t\treturn this;\n\n\t}\n\n}\n\n//\n\nconst _vector = new Vector3();\nconst _viewMatrix = new Matrix4();\nconst _viewProjectionMatrix = new Matrix4();\nconst _a = new Vector3();\nconst _b = new Vector3();\n\nclass CSS2DRenderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tconst _this = this;\n\n\t\tlet _width, _height;\n\t\tlet _widthHalf, _heightHalf;\n\n\t\tconst cache = {\n\t\t\tobjects: new WeakMap()\n\t\t};\n\n\t\tconst domElement = parameters.element !== undefined ? parameters.element : document.createElement( 'div' );\n\n\t\tdomElement.style.overflow = 'hidden';\n\n\t\tthis.domElement = domElement;\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\t\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t\t_viewMatrix.copy( camera.matrixWorldInverse );\n\t\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\n\n\t\t\trenderObject( scene, scene, camera );\n\t\t\tzOrder( scene );\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\n\t\t};\n\n\t\tfunction renderObject( object, scene, camera ) {\n\n\t\t\tif ( object.isCSS2DObject ) {\n\n\t\t\t\t_vector.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t_vector.applyMatrix4( _viewProjectionMatrix );\n\n\t\t\t\tconst visible = ( object.visible === true ) && ( _vector.z >= - 1 && _vector.z <= 1 ) && ( object.layers.test( camera.layers ) === true );\n\t\t\t\tobject.element.style.display = ( visible === true ) ? '' : 'none';\n\n\t\t\t\tif ( visible === true ) {\n\n\t\t\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\t\t\tconst element = object.element;\n\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + ( _vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\t\t\tif ( element.parentNode !== domElement ) {\n\n\t\t\t\t\t\tdomElement.appendChild( element );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t\t\t}\n\n\t\t\t\tconst objectData = {\n\t\t\t\t\tdistanceToCameraSquared: getDistanceToSquared( camera, object )\n\t\t\t\t};\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\trenderObject( object.children[ i ], scene, camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getDistanceToSquared( object1, object2 ) {\n\n\t\t\t_a.setFromMatrixPosition( object1.matrixWorld );\n\t\t\t_b.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn _a.distanceToSquared( _b );\n\n\t\t}\n\n\t\tfunction filterAndFlatten( scene ) {\n\n\t\t\tconst result = [];\n\n\t\t\tscene.traverse( function ( object ) {\n\n\t\t\t\tif ( object.isCSS2DObject ) result.push( object );\n\n\t\t\t} );\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction zOrder( scene ) {\n\n\t\t\tconst sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\t\tif ( a.renderOrder !== b.renderOrder ) {\n\n\t\t\t\t\treturn b.renderOrder - a.renderOrder;\n\n\t\t\t\t}\n\n\t\t\t\tconst distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\t\tconst distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\t\treturn distanceA - distanceB;\n\n\t\t\t} );\n\n\t\t\tconst zMax = sorted.length;\n\n\t\t\tfor ( let i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };","\nimport React, { Fragment as F, useContext, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport { Capsule } from 'three/examples/jsm/math/Capsule'\nimport { CSS2DRenderer, CSS2DObject } from './vendor/CSS2DRenderer.js'\nimport styled from 'styled-components'\n\nimport {\n  AppContext,\n  logg,\n} from \"$shared\"\nimport {\n  TwofoldContext,\n} from \"$components/TwofoldLayout\"\nimport {\n  Blocker,\n} from './'\nimport { PointerLockControls } from './vendor/PointerLockControls'\nimport { appPaths } from \"$src/AppRouter\"\n\n/**\n * ThreePanelDesktop\n *\n * Units are centimeters\n *\n * Math capsule: https://github.com/mrdoob/three.js/blob/dev/examples/jsm/math/Capsule.js\n *\n * Markers are obejcts _vp_ 2021-11-14\n * Continue.           _vp_ 2022-08-13\n * Continue.           _vp_ 2022-09-13\n *\n**/\nconst ThreePanelDesktop = (props) => {\n  // logg(props, 'ThreePanelDesktop')\n  const { map } = props\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n\n  // const {\n  //   resizeCount,\n  // } = useContext(TwofoldContext)\n\n  const history = useHistory()\n  let markers2destinationSlugs = {}\n\n  let camera, controls,\n    object, objects = [],\n    collisionObjects = [],\n    pickingObjects = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const GRAVITY = 30;\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n    onWindowResize()\n  }, [])\n\n  // useEffect(() => {\n  //   onWindowResize()\n  // }, [resizeCount])\n\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  const textureLoader = new THREE.TextureLoader()\n  const gltfLoader = new GLTFLoader()\n  const worldOctree = new Octree()\n\n\n  const helperMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 })\n  const wireframeMaterial = new THREE.MeshStandardMaterial()\n  wireframeMaterial.wireframe = true\n\n  const playerCollider = new Capsule( new THREE.Vector3( 0, 0, 0 ),\n    new THREE.Vector3( 0, 17.5, 0 ),\n    6 ) // begin, end, radius\n  const playerColliderHelper = new THREE.Mesh(\n    new THREE.CylinderBufferGeometry(6, 6, 17.5, 5), // radiusTop, radiusBottom, height, radialSegments\n    helperMaterial )\n\n  let playerOnFloor = false\n\n  let prevTime = performance.now()\n  const playerVelocity = new THREE.Vector3()\n  const playerDirection = new THREE.Vector3()\n  let colliderCenter = new THREE.Vector3()\n  let deltaPosition\n\n  const playerCtlGeometry = new THREE.SphereGeometry(5, 8, 8) // radius, widthSegments, heightSegments, phiStart, phiEnd, thetaStart, thetaEnd\n  const playerBodyGeometry = new THREE.BoxGeometry(16, 20, 2)\n\n\n  const playerCtl = new THREE.Mesh( playerCtlGeometry, wireframeMaterial )\n  const playerBody = new THREE.Mesh( playerBodyGeometry, wireframeMaterial )\n  playerBody.position.y = 0\n  playerBody.castShadow = true\n  playerCtl.position.y = 17.5\n  // playerCtl.add(playerBody)\n\n  let collisionObject, collisionObectSavedColor\n  let pickedObject, pickedObjectSavedColor\n\n  var vector = new THREE.Vector3()\n  var quaternion = new THREE.Quaternion() // create one and reuse it\n  var matrix = new THREE.Matrix4(); // create one and reuse it\n\n\n  function init() {\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const axesHelper = new THREE.AxesHelper( 5 )\n    scene.add( axesHelper )\n\n    // 1.75m tall guy\n    camera = new THREE.PerspectiveCamera( 75, 2, .1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 17.5 // 1.75m tall guy\n    camera.position.z = 40 // this much behind the body\n\n    playerCtl.add( camera )\n    // playerCtl.add( playerCollider )\n    scene.add( playerCollider )\n    scene.add( playerCtl )\n    scene.add( playerBody )\n    scene.add( playerColliderHelper )\n\n\n    // const labelRenderer = new CSS2DRenderer()\n    // const earthDiv = document.createElement( 'div' )\n    // earthDiv.className = 'label'\n    // earthDiv.textContent = 'Earth'\n    // earthDiv.style.marginTop = '-1em'\n    // const earthLabel = new CSS2DObject( earthDiv )\n    // earthLabel.position.set( 0, 20, 0 )\n    // playerCtl.add( earthLabel )\n    // earthLabel.layers.set( 0 )\n    // labelRenderer.setSize( window.innerWidth, window.innerHeight )\n    // labelRenderer.domElement.style.position = 'absolute'\n    // labelRenderer.domElement.style.top = '0px'\n    // document.body.appendChild( labelRenderer.domElement )\n\n\n    /*\n     * Lights\n    **/\n    {\n\n      // // Illuminate everytyhing\n      const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n      light.position.set( 0.5, 1, 0.75 )\n      scene.add( light )\n\n      // Shadow\n      const white = 0xffffff\n      const shadowLightIntensity = 2\n      const shadowLightPosition = [ 0*10, 40*10, -10*100 ]\n      const shadowLight = new THREE.DirectionalLight(white, shadowLightIntensity)\n      shadowLight.castShadow = true\n      // shadowLight.shadow.mapSize.width = 512\n      // shadowLight.shadow.mapSize.height = 512\n\n      shadowLight.shadow.camera.bottom = -150\n      shadowLight.shadow.camera.top = 150\n      shadowLight.shadow.camera.left = -150\n      shadowLight.shadow.camera.right = 150\n      shadowLight.shadow.camera.near = 10\n      shadowLight.shadow.camera.far = 5000\n      shadowLight.shadow.camera.updateProjectionMatrix()\n\n      shadowLight.position.set( ...shadowLightPosition )\n      scene.add( shadowLight )\n      // const helper = new THREE.DirectionalLightHelper( shadowLight, 5 )\n      const helper = new THREE.CameraHelper(shadowLight.shadow.camera)\n      scene.add( helper )\n\n    } // endLights\n\n\n    /*\n     * Controls\n    **/\n    {\n      controls = new PointerLockControls( playerCtl, document.body )\n\n      blockerRef.current.addEventListener( 'click', function () {\n        logg('event #click, locked controls')\n        controls.lock()\n      } )\n\n      controls.addEventListener( 'lock', function () {\n        logg('event #lock')\n        // instructions.style.display = 'none'\n        // blocker.style.display = 'none'\n      } )\n\n      controls.addEventListener( 'unlock', function () {\n        logg('event #unlock')\n        // blocker.style.display = 'block'\n        // instructions.style.display = ''\n      } )\n\n      scene.add( controls.getObject() )\n\n\n      const onClick = (event) => {\n        // e.preventDefault()\n        if (pickedObject) {\n          // logg(pickedObject, 'pickedObject')\n          // logg(markers2destinationSlugs, 'all of them')\n          history.push( appPaths.location({\n            slug: markers2destinationSlugs[pickedObject.uuid].destination_slug\n          }) )\n        }\n      }\n\n\n      const onKeyDown = (event) => {\n        // logg(event.code, '#onKeyDown')\n\n        switch ( event.code ) {\n          case 'ArrowUp':\n          case 'KeyW':\n            moveForward = true\n            break\n          case 'ArrowLeft':\n          case 'KeyA':\n            moveLeft = true\n            break\n          case 'ArrowDown':\n          case 'KeyS':\n            moveBackward = true\n            break\n          case 'ArrowRight':\n          case 'KeyD':\n            moveRight = true\n            break\n          case 'Space':\n            if ( canJump === true ) playerVelocity.y += 350\n            canJump = false\n            break\n        }\n      }\n\n      const onKeyUp = function ( event ) {\n        switch ( event.code ) {\n          case 'ArrowUp':\n          case 'KeyW':\n            moveForward = false\n            break\n          case 'ArrowLeft':\n          case 'KeyA':\n            moveLeft = false\n            break\n          case 'ArrowDown':\n          case 'KeyS':\n            moveBackward = false\n            break\n          case 'ArrowRight':\n          case 'KeyD':\n            moveRight = false\n            break\n        }\n      }\n\n      document.addEventListener( 'keydown', onKeyDown )\n      document.addEventListener( 'keyup', onKeyUp )\n      document.addEventListener( 'click', onClick )\n\n      raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n    } // endControls\n\n\n    /*\n     * Ground, Skybox\n    **/\n    {\n      // Moon floor\n      texture = textureLoader.load(`/assets/textures/moon-1.jpg`)\n      let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n      floorGeometry.translate(0, 0, -1)\n      floorGeometry.rotateX( - Math.PI / 2 )\n\n      let floorMaterial\n      // floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n      // floorMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 })\n      floorMaterial = new THREE.MeshPhongMaterial({\n        map: texture,\n        side: THREE.DoubleSide,\n      })\n      const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n      floor.receiveShadow = true\n      // scene.add( floor )\n\n      // Skybox\n      texture = textureLoader.load(`/assets/textures/space-5.jpg`, () => {\n        const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n        // rt.fromEquirectangularTexture(renderer, texture)\n        scene.background = rt.texture\n      })\n\n    } // endGround\n\n\n    /*\n     * Load, import models of markers\n    **/\n    {\n      map.markers.map((marker, idx) => {\n\n        gltfLoader.load( marker.asset3d_path, ( gltf ) => {\n\n          gltf.scene.position.x = marker.x\n          gltf.scene.position.y = marker.y\n          gltf.scene.scale.multiplyScalar(17)\n          // @TODO: and Z ?!\n          // @TODO: and parent-child relationships ?!\n          scene.add( gltf.scene )\n\n          /*\n           * Collisions\n          **/\n          worldOctree.fromGraphNode( gltf.scene )\n          // collisionObjects.push( gltf.scene )\n\n          /*\n           * Picking\n          **/\n          if (marker.destination_slug) {\n            pickingObjects.push( gltf.scene )\n          }\n\n\n\n          gltf.scene.traverse( child => {\n            if ( child.isMesh ) {\n              child.castShadow = true\n              child.receiveShadow = true\n\n              // logg(child, 'mesh child')\n\n\n              if ( child.material.map ) {\n                // child.material.map.anisotropy = 4\n              }\n\n              /*\n              * Picking\n              **/\n              if (marker.destination_slug) {\n                markers2destinationSlugs[child.uuid] = { destination_slug: marker.destination_slug }\n              }\n\n            }\n          } )\n        })\n\n      })\n    } // endLoadModels\n\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    renderer.shadowMap.enabled = true\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    const delta = ( time - prevTime ) / 1000\n\n    if ( controls.isLocked === true ) {\n      camera.updateMatrixWorld()\n      playerCtl.updateMatrixWorld()\n\n      var cameraDirection = new THREE.Vector3()\n      camera.getWorldDirection( cameraDirection )\n      cameraDirection.normalize()\n\n      var cameraPosition = camera.position.clone()\n      cameraPosition.applyMatrix4( camera.matrixWorld )\n      // logg(cameraPosition, 'cameraPosition')\n\n      /*\n       * Picking\n       */\n      const pickingScope = (() => {\n        raycaster = new THREE.Raycaster( cameraPosition, cameraDirection )\n\n        const pickingIntersections = raycaster.intersectObjects( pickingObjects, true )\n\n        if (pickedObject) {\n          pickedObject.material.emissive.setHex(pickedObjectSavedColor)\n          pickedObject = undefined\n        }\n        if (pickingIntersections.length) {\n          pickedObject = pickingIntersections[0].object\n          pickedObjectSavedColor = pickedObject.material.emissive.getHex()\n          pickedObject.material.emissive.setHex(0xFFFF00);\n        }\n      })()\n\n\n      /*\n       * Third-person body\n       */\n      const bodyScope = (() => {\n\n        let damping = Math.exp( - 4 * delta ) - 1;\n        if ( ! playerOnFloor ) {\n          playerVelocity.y -= GRAVITY * delta;\n          // small air resistance\n          damping *= 0.1;\n        }\n        playerVelocity.addScaledVector( playerVelocity, damping );\n\n        const onObject = false // collisionIntersections.length > 0\n\n        playerVelocity.x -= playerVelocity.x * 10.0 * delta\n        playerVelocity.z -= playerVelocity.z * 10.0 * delta\n        playerVelocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n\n        playerDirection.z = Number( moveForward ) - Number( moveBackward )\n        playerDirection.x = Number( moveRight ) - Number( moveLeft )\n        if ( moveForward || moveBackward ) playerVelocity.z -= playerDirection.z * 400.0 * delta\n        if ( moveLeft || moveRight ) playerVelocity.x -= playerDirection.x * 400.0 * delta\n        if ( onObject === true ) {\n          playerVelocity.y = Math.max( 0, playerVelocity.y )\n          canJump = true\n        }\n        playerDirection.normalize()\n\n        controls.moveRight( - playerVelocity.x * delta )\n        controls.moveForward( - playerVelocity.z * delta )\n        controls.getObject().position.y += ( playerVelocity.y * delta )\n        if ( controls.getObject().position.y < 10 ) {\n          playerVelocity.y = 0\n          controls.getObject().position.y = 10\n          canJump = true\n        }\n\n        deltaPosition = playerVelocity.clone().multiplyScalar( delta )\n\n\n        playerCollider.translate( deltaPosition )\n\n\n        { // logs\n\n        /* cameraDirection */\n        // const arrowHCD = new THREE.ArrowHelper(\n        //   cameraDirection,\n        //   controls.getObject().position,\n        //   10,\n        //   0x336699 )\n        // scene.add( arrowHCD )\n        // logg(cameraDirection, 'cameraDirection')\n\n        /* show deltaPosition - in body coords */\n        // const arrowHDP = new THREE.ArrowHelper(\n        //   deltaPosition,\n        //   controls.getObject().position,\n        //   20,\n        //   0xffffff )\n        // scene.add( arrowHDP )\n\n        /* shows controls' position */\n        // const arrowH1 = new THREE.ArrowHelper(\n        //   controls.getObject().clone().position.normalize(),\n        //   new THREE.Vector3(0, 0, 0),\n        //   new THREE.Vector3(0, 0, 0).distanceTo( controls.getObject().position ),\n        //   0xffffff )\n        // scene.add( arrowH1 )\n\n        /* playerDirection - not used much. */\n\n        /* Shows playerVelocity */\n        // const arrowHPV = new THREE.ArrowHelper(\n        //   playerVelocity,\n        //   controls.getObject().position,\n        //   10,\n        //   0xffff00 )\n        // scene.add( arrowHPV )\n\n\n        /* shows deltaPosition above your head */\n        /* this is object-relative, left/right switched (-x) */\n        // const arrowH2 = new THREE.ArrowHelper(\n        //   deltaPosition.clone().normalize(),\n        //   controls.getObject().position,\n        //   deltaPosition.length()*10, // 10, // new THREE.Vector3(0, 0, 0).distanceTo( controls.getObject().position ),\n        //   0xff00ff )\n        // scene.add( arrowH2 )\n\n        } // endLogs\n\n\n        /* The below works well. */\n        playerCollider.getCenter( colliderCenter )\n        playerColliderHelper.position.x = colliderCenter.x\n        playerColliderHelper.position.y = colliderCenter.y\n        playerColliderHelper.position.z = colliderCenter.z\n\n\n      })()\n\n\n      /*\n       * Collisions\n       * I'm mixing several methodologies here, should stick to one (for Desktop at least)\n       */\n      const collisionsScope = (() => {\n        const collisionIntersections = worldOctree.capsuleIntersect( playerCollider )\n\n        if (collisionIntersections.length) {\n          logg(collisionIntersections, 'collisionIntersections')\n\n          if (collisionIntersections[0].distance < 5) {\n            moveForward = false\n          }\n        }\n\n        const result = worldOctree.capsuleIntersect( playerCollider )\n\n        playerOnFloor = false\n        if ( result ) {\n          playerOnFloor = result.normal.y > 0\n          if ( !playerOnFloor ) {\n            playerVelocity.addScaledVector( result.normal, - result.normal.dot( playerVelocity ) )\n          }\n          playerCollider.translate( result.normal.multiplyScalar( result.depth ) )\n        }\n      })()\n\n\n\n\n    } // end if controls are locked\n\n    prevTime = time\n    renderer.render( scene, camera )\n\n  } // end animate()\n\n  const onWindowResize = () => {\n    // logg([blockerRef.current.clientWidth, blockerRef.current.clientHeight], 'ThreePanelDesktop. OnWindowResize')\n\n    // if (!blockerRef.current) { return }\n    // if (!camera) { return }\n\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  return <F>\n    <div ref={instructionsRef} className='Instructions empty' />\n    <Blocker ref={blockerRef} className=\"Blocker\" >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default ThreePanelDesktop\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport { PointerLockControls } from './vendor/PointerLockControls'\n\nconst Blocker = styled.div`\n  height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n`;\n\n/**\n * ThreePanelV1\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\nconst Loc = (props) => {\n  logg(props, 'ThreePanelV1')\n\n  let camera, controls,\n    object, objects = [],\n    raycaster, renderer,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n    /*\n    // PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n    // fov  Camera frustum vertical field of view.\n    // aspect  Camera frustum aspect ratio.\n    // near  Camera frustum near plane.\n    // far  Camera frustum far plane.\n    */\n    // camera = new THREE.PerspectiveCamera( 75, 2, 1, 100 )\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 300 )\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    // floor\n    // @TODO: it's not aligned to parcels the way I want\n    let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n\n    // vertex displacement\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      vertex.fromBufferAttribute( position, i )\n      vertex.x += Math.random() * 20 - 10\n      vertex.y += Math.random() * 2\n      vertex.z += Math.random() * 20 - 10\n      position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    floorGeometry.x = -200\n    floorGeometry.y = -200\n    floorGeometry.z = -200\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    // objects\n    /*\n    const boxGeometry = new THREE.BoxGeometry( 20, 20, 20 ).toNonIndexed()\n    position = boxGeometry.attributes.position\n    const colorsBox = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsBox.push( color.r, color.g, color.b )\n    }\n    boxGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsBox, 3 ) )\n    for ( let i = 0; i < 500; i ++ ) {\n      const boxMaterial = new THREE.MeshPhongMaterial( { specular: 0xffffff, flatShading: true, vertexColors: true } )\n      boxMaterial.color.setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n\n      const box = new THREE.Mesh( boxGeometry, boxMaterial )\n      box.position.x = Math.floor( Math.random() * 20 - 10 ) * 20\n      box.position.y = Math.floor( Math.random() * 20 ) * 20 + 10\n      box.position.z = Math.floor( Math.random() * 20 - 10 ) * 20\n      scene.add( box )\n      objects.push( box )\n    }\n    */\n\n    // load OBJ\n\n    // manager\n\n    // this is specifically for tiny-house-1\n    const loadModel = () => {\n      object.traverse((child) => {\n        if ( child.isMesh ) {\n          child.material.map = texture\n          child.geometry.scale(10, 10, 10)\n        }\n      })\n      object.position.x = 100\n      object.position.y = 10\n      object.position.z = 100\n\n      scene.add( object )\n    }\n    const manager = new THREE.LoadingManager( loadModel )\n    manager.onProgress = function ( item, loaded, total ) {\n      console.log( item, loaded, total )\n    }\n\n    // texture\n\n    const textureLoader = new THREE.TextureLoader( manager )\n    const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n    // model\n\n    // tiny-house-1\n    const loader = new OBJLoader( manager )\n    loader.load( '/assets/scenes/tiny-house-1/tiny-house-1.obj', ( obj ) => {\n      object = obj\n    }, ( xhr ) => {\n      if ( xhr.lengthComputable ) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }, (e) => {\n      logg(e, 'onError')\n    } )\n\n\n    // some delimiters for the first 6 parcels!\n    let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    let cube = new THREE.Mesh( geometry, material )\n    cube.position.x = 0\n    cube.position.y = 5\n    cube.position.z = 0\n    scene.add( cube )\n    const items = [\n      { color: 0xff0000, x: 1, y: 0, z: 0 },\n      { color: 0x00ff00, x: 0, y: 1, z: 0 },\n      { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    ]\n    items.map((item, idx) => {\n      logg(item, 'item')\n      const { color, x, y, z } = item\n      geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n      material = new THREE.MeshBasicMaterial({ color: color })\n      cube = new THREE.Mesh( geometry, material )\n      cube.position.x = x*5\n      cube.position.y = 10+y*5\n      cube.position.z = z*5\n      scene.add( cube )\n    })\n\n    const parcels = [\n      { color: 0xff0000, x: 100, y: 1, z: 100 },\n      { color: 0x00ff00, x: 100, y: 1, z: 320 },\n      { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n      { color: 0x660000, x: -120, y: 1, z: 100 },\n      { color: 0x006600, x: -120, y: 1, z: -120 },\n      { color: 0x000066, x: 100, y: 1, z: -120 },\n    ]\n    parcels.map((item, idx) => {\n      const { color, x, y, z } = item\n      const g = new THREE.BoxGeometry( 200, 2, 200 )\n      const m = new THREE.MeshBasicMaterial({color: color})\n      const p = new THREE.Mesh( g, m )\n      p.position.x = x\n      p.position.y = y\n      p.position.z = z\n      scene.add( p )\n    })\n\n    //\n\n\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    // renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setPixelRatio(1)\n    renderer.setSize( 800, 400 )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n      raycaster.ray.origin.copy( controls.getObject().position )\n      raycaster.ray.origin.y -= 10\n      const intersections = raycaster.intersectObjects( objects, false )\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} />\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './vendor/PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * Loc = Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\nconst Loc = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    let modelName = 'polycity' // 'wasyaco-reception' // 'tiny-house-2'\n    let modelName2 = 'girl'\n    const texturePath = `${modelName}/${modelName}.mtl`\n    const modelPath = `${modelName}/${modelName}.obj`\n    const modelPath2 = `${modelName2}/${modelName2}.obj`\n    const manager = new THREE.LoadingManager()\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    // onProgress = function ( item, loaded, total ) {\n    //   console.log( item, loaded, total )\n    // }\n    const onError = () => {}\n    const onLoad = (materials) => {\n      materials.preload()\n      const objLoader = new OBJLoader( manager )\n      objLoader.setMaterials( materials )\n      objLoader.setPath( scenesPath)\n      objLoader.load( modelPath, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(0.10, 0.10, 0.10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '1st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'camaro75', slug: 'construct1' })\n\n      }, onProgress, onError )\n    }\n    const onLoad2 = (materials) => {\n      // materials.preload()\n      const objLoader = new OBJLoader( manager )\n      // objLoader.setMaterials( materials )\n      objLoader.setPath( objectsPath )\n      objLoader.load( modelPath2, ( object ) => {\n        object.traverse((child) => {\n          if (child.isMesh) {\n            child.geometry.scale(10, 10, 10)\n          }\n        })\n        object.position.x = Math.random() * 500\n        object.position.y = 10\n        object.position.z = Math.random() * 500\n\n        logg(object, '2st object')\n        scene.add( object )\n        markerObjects.push( object )\n        markerObjectsIdxs.push({ uuid: object.uuid, name: 'girl', slug: 'demmitv' })\n\n      }, onProgress, onError )\n    }\n    const mtlLoader = new MTLLoader(manager)\n    // mtlLoader.setBaseUrl(scenesPath)\n    mtlLoader.setPath(scenesPath)\n    mtlLoader.load(texturePath, onLoad)\n    mtlLoader.load(texturePath, onLoad2)\n\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        // collision\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\nimport * as THREE from \"three\"\nimport Stats from 'three/examples/jsm/libs/stats.module'\nimport { Octree } from 'three/examples/jsm/math/Octree'\nimport { Capsule } from 'three/examples/jsm/math/Capsule'\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"\n\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  C,\n  logg,\n} from \"$shared\"\nimport { Crosshair } from \"./\"\nimport { PointerLockControls, } from './vendor/PointerLockControls'\n\nconst Blocker = styled.div`\n  // border: 2px solid red;\n\n  position: relative;\n  width: 100%;\n  height: 100%;\n`;\n\n/**\n * Location\n *\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n *\n * Octree! From: https://threejs.org/examples/games_fps.html\n * @TODO: let's load the map, and collision player on map. _vp_ 202-04-20\n *\n**/\nconst Location = (props) => {\n  // logg(props, 'Loc')\n\n  const history = useHistory()\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  let camera, clock,\n    directionalLight,\n    fillLight1,\n    glow,\n    markerObjects = [],\n    pickedObject, plc,\n    raycaster, removedObject, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  useEffect(() => {\n    window.dispatchEvent(new Event('resize'));\n  }, [ bottomDrawerOpen, folded, twofoldPercent ])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n\n\n\n  function init_old() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    const aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera = new THREE.PerspectiveCamera( 75, aspect, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    // scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    const onClick = (event) => {\n      // logg(event, 'onCLick')\n      // logg(pickedObject, 'pickedObject')\n\n      // @TODO: prevent lock-outs!\n      if (pickedObject) {\n        // plc.unlock()\n        // history.push(`/en/locations/show/${pickedObject.slug}`)\n      }\n    }\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n    document.addEventListener( 'click', onClick )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n\n    /*\n     * Floor\n     */\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const manager = new THREE.LoadingManager()\n\n    let importModels = [\n      // { modelName: 'wasyaco-reception-2', slug: 'construct1' },\n\n      { modelName: 'camaro75', slug: 'construct1' },\n      { modelName: 'girl',     slug: 'demmitv' },\n\n      // { modelName: 'girl-5',     slug: 'demmitv' },\n    ]\n\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(objectsPath)\n\n    importModels.map(({ modelName, slug }) => {\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n\n          objLoader.setPath(objectsPath)\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10)\n              }\n            })\n            object.position.x = Math.random() * 200\n            object.position.y = 10\n            object.position.z = Math.random() * 200\n\n            scene.add( object )\n            markerObjects.push({ uuid: object.uuid, name: 'camaro75', object, slug: 'construct1', })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath))\n    })\n\n\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n  }\n\n\n  const GRAVITY = 30;\n\n  const NUM_SPHERES = 100;\n  const SPHERE_RADIUS = 0.2;\n\n  const STEPS_PER_FRAME = 5;\n\n  const sphereGeometry = new THREE.IcosahedronGeometry( SPHERE_RADIUS, 5 );\n  const sphereMaterial = new THREE.MeshLambertMaterial( { color: 0xbbbb44 } );\n\n  const spheres = [];\n  let sphereIdx = 0;\n\n  const worldOctree = new Octree();\n\n  const playerCollider = new Capsule( new THREE.Vector3( 0, 0.35, 0 ), new THREE.Vector3( 0, 1, 0 ), 0.35 );\n\n  const playerVelocity = new THREE.Vector3();\n  const playerDirection = new THREE.Vector3();\n\n  let playerOnFloor = false;\n  let mouseTime = 0;\n\n  const keyStates = {};\n\n  const vector1 = new THREE.Vector3();\n  const vector2 = new THREE.Vector3();\n  const vector3 = new THREE.Vector3();\n\n  const init = () => {\n    clock = new THREE.Clock();\n\n    scene = new THREE.Scene();\n    scene.background = new THREE.Color( 0x88ccee );\n    scene.fog = new THREE.Fog( 0x88ccee, 0, 50 );\n\n    camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 1000 );\n    camera.rotation.order = 'YXZ';\n\n    fillLight1 = new THREE.HemisphereLight( 0x4488bb, 0x002244, 0.5 );\n    fillLight1.position.set( 2, 1, 1 );\n    scene.add( fillLight1 );\n\n    directionalLight = new THREE.DirectionalLight( 0xffffff, 0.8 );\n    directionalLight.position.set( - 5, 25, - 1 );\n    directionalLight.castShadow = true;\n    directionalLight.shadow.camera.near = 0.01;\n    directionalLight.shadow.camera.far = 500;\n    directionalLight.shadow.camera.right = 30;\n    directionalLight.shadow.camera.left = - 30;\n    directionalLight.shadow.camera.top\t= 30;\n    directionalLight.shadow.camera.bottom = - 30;\n    directionalLight.shadow.mapSize.width = 1024;\n    directionalLight.shadow.mapSize.height = 1024;\n    directionalLight.shadow.radius = 4;\n    directionalLight.shadow.bias = - 0.00006;\n    scene.add( directionalLight );\n\n    for ( let i = 0; i < NUM_SPHERES; i ++ ) {\n      const sphere = new THREE.Mesh( sphereGeometry, sphereMaterial );\n      sphere.castShadow = true;\n      sphere.receiveShadow = true;\n\n      scene.add( sphere );\n\n      spheres.push( {\n        mesh: sphere,\n        collider: new THREE.Sphere( new THREE.Vector3( 0, - 100, 0 ), SPHERE_RADIUS ),\n        velocity: new THREE.Vector3()\n      } );\n    }\n\n    /*\n     * controls\n    **/\n    plc = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      plc.lock()\n    } )\n\n    plc.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    plc.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( plc.getObject() )\n\n    /*\n     * Render\n    **/\n    renderer = new THREE.WebGLRenderer( { antialias: true } )\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n    renderer.shadowMap.enabled = true\n    renderer.shadowMap.type = THREE.VSMShadowMap\n    renderer.outputEncoding = THREE.sRGBEncoding\n    renderer.toneMapping = THREE.ACESFilmicToneMapping\n\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n    /*\n     * GLFT Loader\n    **/\n    const loader = new GLTFLoader().setPath( './assets/objects/gltf/' );\n\n    loader.load( 'collision-world.glb', ( gltf ) => {\n      scene.add( gltf.scene );\n      worldOctree.fromGraphNode( gltf.scene );\n      gltf.scene.traverse( child => {\n        if ( child.isMesh ) {\n          child.castShadow = true;\n          child.receiveShadow = true;\n          if ( child.material.map ) {\n            child.material.map.anisotropy = 4;\n          }\n        }\n      } );\n\n      // const helper = new OctreeHelper( worldOctree );\n      // helper.visible = false;\n      // scene.add( helper );\n\n      animate();\n    } );\n\n    /*\n     * keyboard control, event listeners\n    **/\n    document.addEventListener( 'keydown', ( event ) => {\n      keyStates[ event.code ] = true;\n    } );\n\n    document.addEventListener( 'keyup', ( event ) => {\n      keyStates[ event.code ] = false;\n    } );\n\n    document.addEventListener( 'mouseup', () => {\n      if ( document.pointerLockElement !== null ) throwBall();\n    } );\n\n    // document.body.addEventListener( 'mousemove', ( event ) => {\n    //   if ( document.pointerLockElement === document.body ) {\n    //     camera.rotation.y -= event.movementX / 500;\n    //     camera.rotation.x -= event.movementY / 500;\n    //   }\n    // } );\n\n    document.addEventListener( 'mousedown', () => {\n      document.body.requestPointerLock();\n      mouseTime = performance.now();\n    } );\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = blockerRef.current.clientWidth / blockerRef.current.clientHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( blockerRef.current.clientWidth, blockerRef.current.clientHeight )\n  }\n\n  function playerCollisions() {\n    const result = worldOctree.capsuleIntersect( playerCollider );\n    playerOnFloor = false;\n    if ( result ) {\n      playerOnFloor = result.normal.y > 0;\n      if ( ! playerOnFloor ) {\n        playerVelocity.addScaledVector( result.normal, - result.normal.dot( playerVelocity ) );\n      }\n      playerCollider.translate( result.normal.multiplyScalar( result.depth ) );\n    }\n  }\n\n  function updateSpheres( deltaTime ) {\n    spheres.forEach( sphere => {\n      sphere.collider.center.addScaledVector( sphere.velocity, deltaTime );\n      const result = worldOctree.sphereIntersect( sphere.collider );\n      if ( result ) {\n        sphere.velocity.addScaledVector( result.normal, - result.normal.dot( sphere.velocity ) * 1.5 );\n        sphere.collider.center.add( result.normal.multiplyScalar( result.depth ) );\n      } else {\n        sphere.velocity.y -= GRAVITY * deltaTime;\n      }\n      const damping = Math.exp( - 1.5 * deltaTime ) - 1;\n      sphere.velocity.addScaledVector( sphere.velocity, damping );\n      playerSphereCollision( sphere );\n    } );\n    spheresCollisions();\n    for ( const sphere of spheres ) {\n      sphere.mesh.position.copy( sphere.collider.center );\n    }\n  }\n\n  function throwBall() {\n    const sphere = spheres[ sphereIdx ];\n    camera.getWorldDirection( playerDirection );\n    sphere.collider.center.copy( playerCollider.end ).addScaledVector( playerDirection, playerCollider.radius * 1.5 );\n    // throw the ball with more force if we hold the button longer, and if we move forward\n    const impulse = 15 + 30 * ( 1 - Math.exp( ( mouseTime - performance.now() ) * 0.001 ) );\n    sphere.velocity.copy( playerDirection ).multiplyScalar( impulse );\n    sphere.velocity.addScaledVector( playerVelocity, 2 );\n    sphereIdx = ( sphereIdx + 1 ) % spheres.length;\n  }\n\n  function getForwardVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    return playerDirection;\n  }\n\n  function getSideVector() {\n    camera.getWorldDirection( playerDirection );\n    playerDirection.y = 0;\n    playerDirection.normalize();\n    playerDirection.cross( camera.up );\n    return playerDirection;\n  }\n\n  function updatePlayer( deltaTime ) {\n    let damping = Math.exp( - 4 * deltaTime ) - 1;\n    if ( ! playerOnFloor ) {\n      playerVelocity.y -= GRAVITY * deltaTime;\n      // small air resistance\n      damping *= 0.1;\n    }\n    playerVelocity.addScaledVector( playerVelocity, damping );\n    const deltaPosition = playerVelocity.clone().multiplyScalar( deltaTime );\n    playerCollider.translate( deltaPosition );\n    playerCollisions();\n    camera.position.copy( playerCollider.end );\n  }\n\n  function spheresCollisions() {\n    for ( let i = 0, length = spheres.length; i < length; i ++ ) {\n      const s1 = spheres[ i ];\n      for ( let j = i + 1; j < length; j ++ ) {\n        const s2 = spheres[ j ];\n\n        const d2 = s1.collider.center.distanceToSquared( s2.collider.center );\n        const r = s1.collider.radius + s2.collider.radius;\n        const r2 = r * r;\n\n        if ( d2 < r2 ) {\n          const normal = vector1.subVectors( s1.collider.center, s2.collider.center ).normalize();\n          const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( s1.velocity ) );\n          const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( s2.velocity ) );\n\n          s1.velocity.add( v2 ).sub( v1 );\n          s2.velocity.add( v1 ).sub( v2 );\n\n          const d = ( r - Math.sqrt( d2 ) ) / 2;\n\n          s1.collider.center.addScaledVector( normal, d );\n          s2.collider.center.addScaledVector( normal, - d );\n        }\n      }\n    }\n  }\n\n  function playerSphereCollision( sphere ) {\n    const center = vector1.addVectors( playerCollider.start, playerCollider.end ).multiplyScalar( 0.5 );\n    const sphere_center = sphere.collider.center;\n    const r = playerCollider.radius + sphere.collider.radius;\n    const r2 = r * r;\n\n    // approximation: player = 3 spheres\n    for ( const point of [ playerCollider.start, playerCollider.end, center ] ) {\n      const d2 = point.distanceToSquared( sphere_center );\n\n      if ( d2 < r2 ) {\n        const normal = vector1.subVectors( point, sphere_center ).normalize();\n        const v1 = vector2.copy( normal ).multiplyScalar( normal.dot( playerVelocity ) );\n        const v2 = vector3.copy( normal ).multiplyScalar( normal.dot( sphere.velocity ) );\n\n        playerVelocity.add( v2 ).sub( v1 );\n        sphere.velocity.add( v1 ).sub( v2 );\n\n        const d = ( r - Math.sqrt( d2 ) ) / 2;\n        sphere_center.addScaledVector( normal, - d );\n      }\n    }\n  }\n\n  function teleportPlayerIfOob() {\n    if ( camera.position.y <= - 25 ) {\n      playerCollider.start.set( 0, 0.35, 0 );\n      playerCollider.end.set( 0, 1, 0 );\n      playerCollider.radius = 0.35;\n      camera.position.copy( playerCollider.end );\n      camera.rotation.set( 0, 0, 0 );\n    }\n  }\n\n  function controls( deltaTime ) {\n    // gives a bit of air control\n    const speedDelta = deltaTime * ( playerOnFloor ? 25 : 8 );\n\n    if ( keyStates[ 'KeyW' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyS' ] ) {\n      playerVelocity.add( getForwardVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyA' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( - speedDelta ) );\n    }\n\n    if ( keyStates[ 'KeyD' ] ) {\n      playerVelocity.add( getSideVector().multiplyScalar( speedDelta ) );\n    }\n\n    if ( playerOnFloor ) {\n      if ( keyStates[ 'Space' ] ) {\n        playerVelocity.y = 15;\n      }\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( plc.isLocked === true ) {\n\n      const deltaTime = Math.min( 0.05, clock.getDelta() ) / STEPS_PER_FRAME;\n\n      // we look for collisions in substeps to mitigate the risk of\n      // an object traversing another too quickly for detection.\n\n      for ( let i = 0; i < STEPS_PER_FRAME; i ++ ) {\n        controls( deltaTime );\n        updatePlayer( deltaTime );\n        updateSpheres( deltaTime );\n        teleportPlayerIfOob();\n      }\n\n    }\n    prevTime = time\n\n    // @TODO: add stats\n    // @TODO: add OctreeHelper\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <Crosshair />\n    </Blocker>\n  </F>\n}\n\nexport default Location\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport * as THREE from \"three\"\n// import MTLLoader from 'three-mtl-loader' // @TODO: remove from package.json\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\"\nimport styled from 'styled-components'\n\nimport {\n  logg,\n} from \"$shared\"\nimport { PointerLockControls } from './vendor/PointerLockControls'\n\nconst Blocker = styled.div`\n  border: 2px solid red;\n\n  position: relative;\n  // height: calc(100% - ${p => p.theme.breadcrumbsHeight});\n  width: 700px;\n  height: 350px;\n\n  #Crosshair {\n    // border: 1px solid yellow;\n    width: 50px;\n    height: 50px;\n\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    color: white;\n\n    ::before {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      transform: rotate(90deg);\n      // width: 0.5em;\n    }\n    ::after {\n      content: '';\n      position: absolute;\n      border-color: white;\n      border-style: solid;\n      border-width: 0 0.1em 0 0;\n      height: 1em;\n      top: 0em;\n      left: 0.3em;\n      // margin-top: -1em;\n      // width: 0.5em;\n    }\n  }\n`;\n\n/**\n * ThreePanelV4\n * Markers are obejcts _vp_ 2021-11-14\n *\n */\nconst ThreePanelV4 = (props) => {\n  logg(props, 'ThreePanelV4')\n  const { map } = props\n\n  const history = useHistory()\n\n  let camera, controls,\n    object, objects = [], markerObjects = [], markerObjectsIdxs = [],\n    raycaster, renderer,\n    texture,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n\n    /**\n     * PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n     *\n     * fov  Camera frustum vertical field of view.\n     * aspect  Camera frustum aspect ratio.\n     * near  Camera frustum near plane.\n     * far  Camera frustum far plane.\n    */\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 1000 ) // fov, aspect, near, far\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n\n    /*\n     * Crosshair\n     * From: https://codepen.io/driezis/pen/jOPzjLG?editors=1000\n     */\n    var pMat = new THREE.ShaderMaterial({\n        uniforms: { main_color: {value: {r: 1, g: 1, b: 1}},\n                    border_color: {value: {r: 0, g: 0, b: 0.1}},\n\n                    thickness: {value:0.006},\n                    height: {value:0.13},\n                    offset: {value:0.05},\n                    border: {value:0.003},\n\n                    opacity: {value: 1},\n                    center: {value: {x: 0.5, y: 0.5}},\n                    rotation: {value: 0}\n                },\n        vertexShader: `\n                uniform float rotation;\n                uniform vec2 center;\n                #include <common>\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n                    vec2 scale;\n                    scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n                    scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n                    #ifndef USE_SIZEATTENUATION\n                        bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n                        if ( isPerspective ) scale *= - mvPosition.z;\n                    #endif\n                    vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n                    vec2 rotatedPosition;\n                    rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n                    rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n                    mvPosition.xy += rotatedPosition;\n                    gl_Position = projectionMatrix * mvPosition;\n                }\n            `,\n        fragmentShader: `\n            uniform vec3 main_color;\n            uniform vec3 border_color;\n            uniform float opacity;\n\n            uniform float thickness;\n            uniform float height;\n            uniform float offset;\n            uniform float border;\n\n            varying vec2 vUv;\n            void main() {\n\n                float a = (step(abs(vUv.x - 0.5), thickness)) * step(abs(vUv.y - 0.5), height + offset) * step(offset, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness)) * step(abs(vUv.x - 0.5), height + offset) * step(offset, abs(vUv.x - 0.5));\n                float b = (step(abs(vUv.x - 0.5), thickness - border)) * step(abs(vUv.y - 0.5), height + offset - border) * step(offset + border, abs(vUv.y - 0.5)) + (step(abs(vUv.y - 0.5), thickness - border)) * step(abs(vUv.x - 0.5), height + offset - border) * step(offset + border, abs(vUv.x - 0.5));\n                gl_FragColor = vec4( mix(border_color, main_color, b), a * opacity);\n            }\n        `,\n        transparent: true,\n    });\n    var sprite = new THREE.Sprite(pMat);\n    // scene.add(sprite);\n    // sprite.position.set(0,0,-5);\n\n    /*\n     * Reticle\n     */\n    // var scale = 3\n    // var cursorSize = 500\n    // var reticle = new THREE.Mesh(\n    //   new THREE.RingBufferGeometry( 0.85 * cursorSize, cursorSize, 32),\n    //   new THREE.MeshBasicMaterial({color: 0xffffff, blending: THREE.AdditiveBlending, side: THREE.DoubleSide })\n    // );\n    // reticle.position.z = -100\n    // reticle.lookAt(camera.position)\n    // camera.add(reticle)\n\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    /*\n     * Floor\n     */\n\n    // // random\n    // // @TODO: it's not aligned to parcels the way I want\n    // let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    // floorGeometry.rotateX( - Math.PI / 2 )\n\n    // // vertex displacement\n    // let position = floorGeometry.attributes.position\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   vertex.fromBufferAttribute( position, i )\n    //   vertex.x += Math.random() * 20 - 10\n    //   vertex.y += Math.random() * 2\n    //   vertex.z += Math.random() * 20 - 10\n    //   position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    // }\n    // floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    // floorGeometry.x = -200\n    // floorGeometry.y = -200\n    // floorGeometry.z = -200\n    // position = floorGeometry.attributes.position\n    // const colorsFloor = []\n    // for ( let i = 0, l = position.count; i < l; i ++ ) {\n    //   color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n    //   colorsFloor.push( color.r, color.g, color.b )\n    // }\n    // floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    // const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    // const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    // scene.add( floor )\n\n    // moon floor\n    texture = THREE.ImageUtils.loadTexture(`/assets/textures/moon-1.jpg`)\n\n    // let floorGeometry = new THREE.PlaneGeometry( 1000, 1000, 100, 100 ) // width, height, w segments, h segments\n    /**\n     * From: https://threejs.org/docs/#api/en/geometries/CircleGeometry\n     * CircleGeometry(radius : Float, segments : Integer, thetaStart : Float, thetaLength : Float)\n     *\n     * radius  Radius of the circle, default = 1.\n     * segments  Number of segments (triangles), minimum = 3, default = 8.\n     * thetaStart  Start angle for first segment, default = 0 (three o'clock position).\n     * thetaLength  The central angle, often called theta, of the circular sector. The default is 2*Pi, which makes for a complete circle.\n     */\n    let floorGeometry = new THREE.CircleGeometry(1000, 32) // radius, segments, thetaStart, thetaLength\n    floorGeometry.rotateX( - Math.PI / 2 )\n    const floorMaterial = new THREE.MeshBasicMaterial({ map: texture })\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    /*\n     * Model Import\n     */\n    const scenesPath = '/assets/scenes/'\n    const objectsPath = '/assets/objects/'\n    const texturesPath = '/assets/textures/'\n    const manager = new THREE.LoadingManager()\n    const mtlLoader = new MTLLoader(manager)\n    mtlLoader.setPath(texturesPath)\n    const onProgress = (xhr) => {\n      if (xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }\n    const onError = () => {}\n\n\n    map.markers.map((marker, idx) => {\n      let modelName = marker.slug\n      const texturePath = `${modelName}/${modelName}.mtl`\n      const modelPath = `${modelName}/${modelName}.obj`\n      const wrappedOnLoad = (modelPath, modelName) => {\n        return (materials) => {\n          materials.preload()\n          const objLoader = new OBJLoader( manager )\n          objLoader.setMaterials( materials )\n          objLoader.setPath( objectsPath )\n          objLoader.load( modelPath, ( object ) => {\n            object.traverse((child) => {\n              if (child.isMesh) {\n                child.geometry.scale(10, 10, 10) // @TODO change, girl-6 accepts 1,1,1\n              }\n            })\n            object.position.x = Math.random() * 100\n            object.position.y = 10\n            object.position.z = Math.random() * 100\n\n            // object.rotateX( - Math.PI / 2 ) // girl-6 only.\n\n            logg(object, 'loaded obj')\n\n            scene.add( object )\n            markerObjects.push( object )\n            markerObjectsIdxs.push({ uuid: object.uuid, name: modelName })\n\n          }, onProgress, onError )\n        }\n      }\n      mtlLoader.load(texturePath, wrappedOnLoad(modelPath, modelName))\n    })\n\n    // /* texture */\n    // const textureLoader = new THREE.TextureLoader( manager )\n    // const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n\n    // const loader = new OBJLoader( manager )\n    // loader.load( `/assets/scenes/${modelName}/${modelName}.obj`, ( obj ) => {\n    //   object = obj\n    // }, ( xhr ) => {\n    //   if ( xhr.lengthComputable ) {\n    //     const percentComplete = xhr.loaded / xhr.total * 100\n    //     console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n    //   }\n    // }, (e) => {\n    //   logg(e, 'onError')\n    // } )\n\n\n    /*\n     * parcels\n     */\n\n    // // some delimiters for the first 6 parcels!\n    // let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    // let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    // let cube = new THREE.Mesh( geometry, material )\n    // cube.position.x = 0\n    // cube.position.y = 5\n    // cube.position.z = 0\n    // // scene.add( cube )\n    // const items = [\n    //   { color: 0xff0000, x: 1, y: 0, z: 0 },\n    //   { color: 0x00ff00, x: 0, y: 1, z: 0 },\n    //   { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    // ]\n    // items.map((item, idx) => {\n    //   logg(item, 'item')\n    //   const { color, x, y, z } = item\n    //   geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n    //   material = new THREE.MeshBasicMaterial({ color: color })\n    //   cube = new THREE.Mesh( geometry, material )\n    //   cube.position.x = x*5\n    //   cube.position.y = 10+y*5\n    //   cube.position.z = z*5\n    //   // scene.add( cube )\n    // })\n\n    // const parcels = [\n    //   { color: 0xff0000, x: 100, y: 1, z: 100 },\n    //   { color: 0x00ff00, x: 100, y: 1, z: 320 },\n    //   { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n    //   { color: 0x660000, x: -120, y: 1, z: 100 },\n    //   { color: 0x006600, x: -120, y: 1, z: -120 },\n    //   { color: 0x000066, x: 100, y: 1, z: -120 },\n    // ]\n    // parcels.map((item, idx) => {\n    //   const { color, x, y, z } = item\n    //   const g = new THREE.BoxGeometry( 200, 2, 200 )\n    //   const m = new THREE.MeshBasicMaterial({color: color})\n    //   const p = new THREE.Mesh( g, m )\n    //   p.position.x = x\n    //   p.position.y = y\n    //   p.position.z = z\n    //   // scene.add( p )\n    // })\n\n\n    /*\n     * Skybox\n     */\n    const loader = new THREE.TextureLoader()\n    texture = loader.load(`/assets/textures/space-5.jpg`, () => {\n      const rt = new THREE.WebGLCubeRenderTarget(texture.image.height)\n      rt.fromEquirectangularTexture(renderer, texture)\n      scene.background = rt.texture\n    });\n\n\n    /*\n     * and render\n     */\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setSize( 700, 350 ) // aspect ratio 0.5\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( markerObjects, true )\n      if (intersections.length) {\n        const pickedObject = intersections[0].object\n\n        /* collision */\n        // if (intersections[0].distance < 5) {\n        //   moveForward = false\n        // }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker ref={blockerRef} >\n      <div id=\"Crosshair\" />\n    </Blocker>\n  </F>\n}\n\nexport default ThreePanelV4\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport {\n  ThreePanelMobile,\n} from \"$components/locations3d\"\nimport {\n  Breadcrumbs,\n  Metaline,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  MarkersList,\n} from '$components/markers'\nimport {\n  C,\n  Loading, logg,\n  request,\n  useApi, useWindowSize,\n} from \"$shared\"\n\n\nconst W = styled.div`\n  // border: 1px solid yellow;\n`;\n\n\n/**\n * LocationsShowMobile3d\n * Simplified, full-screen, cannot scroll outside canvas\n * _vp_ 2022-09-02\n *\n */\nconst LocationsShowMobile3d = (props) => {\n  logg(props, 'LocationsShowMobile3d')\n  const {\n    location,\n    match,\n  } = props\n\n  const mapPanelRef = useRef(null)\n\n  return (<W className='LocationsShowMobile3d' >\n\n    { location && <ThreePanelMobile\n      map={location.map || location}\n      ref={mapPanelRef}\n      slug={match.params.slug}\n    />}\n\n  </W>)\n}\n\nexport default LocationsShowMobile3d\n\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  MarkerContext,\n} from '$components/markers'\nimport {\n  AppContext,\n  C, Card,\n  logg,\n  useWindowSize,\n} from \"$shared\"\n\nconst Actions = styled.div`\n  border: 1px solid red;\n\n  position: absolute;\n  top: 0;\n  right: 0;\n\n  z-index: 2;\n`;\n\n// W\nconst W0 = styled.div`\n  border: 2px solid var(--ion-border-color);\n  border-radius: var(--ion-border-radius);\n  background: ${p => p.theme.colors.background};\n\n  height: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n`;\n\nconst W1 = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  position: relative;\n  height: 100%;\n`;\n\n\n/**\n * MapPanel\n *\n * _vp_ 2021-09 @TODO: merge this into MapPanel, have zoom={false} as a prop\n * But I couldn't do it in 10 mins... It's a bit complicated?\n *\n * _vp_ 2021-10-29 But actually this component is getting more work than the zoom one right now...\n**/\nconst MapPanel = (props) => {\n  // logg(props, 'MapPanel')\n  const { map } = props\n\n  const {\n    bottomDrawerOpen,\n    editorMode,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'MapPanelUsedContext')\n\n  const {\n    markerModalOpen, setMarkerModalOpen,\n  } = useContext(MarkerContext)\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n\n  const history = useHistory()\n  const [ windowWidth, windowHeight ] = useWindowSize()\n  // logg(useWindowSize(), 'usedWindowSize')\n\n\n  /*\n   * Sets the zoom (in panelNoZoom) to full-panel _vp_ 2021-10-29\n   * w: 1184 h: 819\n   */\n  useEffect(() => {\n    // logg([windowWidth, windowHeight, map.w, map.h], 'MapPanel setting zoom')\n    if (windowWidth === 0) { return; }\n\n    let nextZoomByWidth = windowWidth/map.w // .3 mobile // 1.94 desktop\n    let nextZoomByHeight = windowHeight/map.h // .9 mobile // .82 desktop\n    // logg4([nextZoomByWidth, nextZoomByHeight], 'nextZoomOptions')\n\n    let nextZoom = Math.min(nextZoomByWidth, nextZoomByHeight)\n    const slack = 0.01 // image should not overlap with the border... 1% slack added.\n    nextZoom = nextZoom + slack\n\n    setZoom(nextZoom)\n  }, [\n    mapPanelWidth, mapPanelHeight, map.id,\n    windowWidth, windowHeight,\n  ])\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    // logg(m, '111 - tmpMarker')\n\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  /*\n   * @TODO: need to get the ACL from api, and use it to determine what to display or not.\n  **/\n\n  return <W0 className=\"W0 MapPanel\" >\n\n    { editorMode && <Actions>\n      <Card onClick={() => setMarkerModalOpen(true)} >\n        + Marker\n      </Card>\n    </Actions> }\n\n    <W1 className=\"W1\" >\n      <img\n        src={map.img_path}\n        style={{\n          maxWidth: '100%',\n          maxHeight: '100%',\n          width: 'auto',\n          height: 'auto',\n\n          position: 'relative',\n          zIndex: 0,\n        }}\n      />\n      { markers }\n    </W1>\n  </W0>\n}\n\nexport default MapPanel\n","\n\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport {\n  MapPanel,\n} from \"./\"\nimport GoogleMaps from './GoogleMaps'\nimport {\n  Equirectangular4,\n  TabiversePlanet, ThreePanelV1, ThreePanelV2, ThreePanelV3, ThreePanelV4, ThreePanelDesktop,\n} from \"$components/locations3d\"\nimport {\n  C,\n  logg,\n} from \"$shared\"\n\n/* W */\nconst W0 = styled.div`\n  overflow: hidden;\n  flex-grow: 1;\n`;\n\n// full-width\nconst FW = styled.div`\n  // border: 1px solid red;\n  // position: absolute;\n  // top: 0;\n  // right: 0;\n  // left: 0;\n  // bottom: 10px;\n`;\n\n/**\n * Renders either MapPanel (W0 really, a simple wrapper), or ThreePanelV1, etc.\n * @TODO: on on MapPanel2D, markers don't scale well but should. Also, re-review z-index of markers. _vp_ 2022-09-13\n *\n**/\nconst WrappedMapPanel = React.forwardRef((props, ref) => {\n  // logg(props, 'WrappedMapPanel')\n  const {\n    // map,\n  } = props\n\n  // // Testing overrides\n  // switch (props.slug) {\n  //   case 'root':\n  //     return <FW ref={ref} ><ThreePanelDesktop {...props} /></FW>\n  // }\n\n  switch (props.map.config.map_panel_type) {\n\n    case C.map_panel_types.Equirectangular:\n      return <W0 ref={ref} className=\"Equirectangular4\" ><Equirectangular4 {...props} /></W0>\n\n    case C.map_panel_types.MapPanel:\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanel withZoom={false} {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV1:\n      return <ThreePanelDesktop {...props} />\n\n    case C.map_panel_types.ThreePanelV1Fullscreen:\n      return <FW ref={ref} className='FW' ><ThreePanelDesktop {...props} /></FW>\n\n    case C.map_panel_types.TabiversePlanet: // markers are objects\n      return <W0><TabiversePlanet {...props} /></W0>\n\n    case C.map_panel_types.ThreePanelV4: // markers are objects\n      return <W0><ThreePanelV4 {...props} /></W0>\n\n    case C.map_panel_types.GoogleMaps:\n      return <W0><GoogleMaps {...props} /></W0>\n\n    default:\n      return <W0 ref={ref} className=\"WrappedMapPanel\" ><MapPanel {...props} /></W0>\n  }\n})\nexport default WrappedMapPanel\n\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\n\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  logg,\n} from \"$shared\"\n\nconst W = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  z-index: 1;\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * ZoomCtrl\n */\nconst ZoomCtrl = (props) => {\n  logg(props, 'ZoomCtrl')\n\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <W className='ZoomCtrl' >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </W>\n}\n\nexport default ZoomCtrl\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext } from \"react\"\nimport styled from 'styled-components'\n\nimport {\n  LocationContext,\n} from \"$components/locations\"\nimport {\n  AppContext,\n  logg,\n} from \"$shared\"\nimport { appPaths } from \"$src/AppRouter\"\nimport { NewsitemContainer } from './'\n\nimport \"./Newsitems.module.scss\"\n\nconst Images = styled.a`\n  // border: 1px solid red;\n\n  display: block;\n\n  position: relative;\n  width: 100%;\n  max-width: 600px;\n  height: 0;\n  padding-bottom: min( 400px, 66.66% );\n\n  margin: auto;\n`;\n\nconst Thumb0 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 1px;\n  box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n\n  width: 66.66%;\n  height: 0;\n  padding-bottom: 66.66%;\n\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst Thumb1 = styled.div`\n  // background: #660000;\n\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 0 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 0;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  background-color: #dedede; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\n\nconst _Thumb2 = styled.div`\n  border: solid ${p => p.theme.colors.text};\n  border-width: 1px 1px 1px 0;\n\n  position: absolute;\n  left: 66.66%;\n  top: 50%;\n\n  width: 33.33%;\n  height: 0;\n  padding-bottom: 33.33%;\n\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n\n  background-color: #c4c4c4; // @TODO: put in theme\n  background-image: url('${p => p.src}');\n  background-size: contain;\n`;\nconst Thumb2 = ({ children, src, ...props }) => {\n  return <_Thumb2\n    style={{ background: src }}\n  ><div style={{ marginTop: 'calc( 50% - 0.5em )' }} >{children}</div></_Thumb2>\n}\n\n/**\n * NewsitemGallery\n * _vp_ 2022-09-12\n *\n * @TODO: variant is used, but move it to LocationProvider, rather than props. _vp_ 2022-09-12\n**/\nconst NewsitemGallery = (props) => {\n  // logg(props, 'NewsitemGallery')\n  const { item, variant } = props\n\n  const {\n    slug: location_slug,\n  } = useContext(LocationContext)\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n\n  const history = useHistory()\n  const href = appPaths.gallery({ location_slug, slug: item.slug })\n\n  // @TODO: only if purchased or free! IMPORTANT _vp_ 2022-09-12\n  const goto = (e) => {\n    e.preventDefault()\n    history.push(href)\n  }\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <Images className='Images'\n      href={href}\n      onClick={goto}\n    >\n      <Thumb0 src={item.photos[0] && item.photos[0].thumb_url} />\n      <Thumb1 src={item.photos[1] && item.photos[1].thumb_url} />\n      <Thumb2 src={item.photos[2] && item.photos[2].thumb_url} >({item.n_photos} photos)</Thumb2>\n    </Images>\n  </NewsitemContainer>\n}\nNewsitemGallery.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired,\n  }),\n}\nexport default NewsitemGallery\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { NewsitemContainer } from './'\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\nconst ImageLarge = styled.img`\n  max-width: 100%;\n`;\n\nconst W0 = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\n/**\n * default\n */\nconst NewsitemPhoto = (props) => {\n  // logg(props, 'NewsitemPhoto')\n  const { item, variant } = props\n\n  return <NewsitemContainer className='Newsitem NewsitemPhoto' {...{ item, variant }} >\n    <W0>\n      { item.photos[0] && <ImageLarge src={item.photos[0].large_url} /> }\n    </W0>\n  </NewsitemContainer>\n}\n\nNewsitemPhoto.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired, // @TODO: this is wrong, just show one photo\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemPhoto\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon, NewsitemContainer } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, C, logg, request, TwofoldContext } from \"$shared\"\n\nimport \"./Newsitems.module.scss\"\n\n/**\n * NewsitemReport\n**/\nconst NewsitemReport = (props) => {\n  // logg(props, \"NewsitemReport\");\n  const { item, variant, } = props\n\n  return <NewsitemContainer {...props} />\n}\nNewsitemReport.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemReport\n\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { NewsitemContainer } from \"./\"\n\nimport \"./Newsitems.module.scss\"\n\n/**\n * NewsitemVideo\n *\n**/\nconst NewsitemVideo = (props) => {\n  // logg(props, 'NewsitemVideo')\n  const { item, variant } = props\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <div style={{ display: 'flex', justifyContent: 'center' }} >\n      { item.youtube_id ?\n          <iframe className=\"iframe\" width=\"100%\" height=\"315\" src={`//www.youtube.com/embed/${item.youtube_id}`} frameBorder=\"0\" allow=\"autoplay; encrypted-media\" allowFullScreen></iframe>\n          : <video style={{ maxWidth: '100%', maxHeight: '50vh' }}  preload=\"metadata\" height=\"auto\" controls><source src={item.url} type=\"video/mp4\" /></video>\n      }\n    </div>\n  </NewsitemContainer>\n}\n\nNewsitemVideo.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemVideo\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, } from \"react\"\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport config from 'config'\n\nimport {\n  LocationContext,\n} from \"$components/locations\"\nimport NewsitemGallery from \"$components/newsitems/NewsitemGallery\"\nimport NewsitemReport from \"$components/newsitems/NewsitemReport\"\nimport NewsitemPhoto from \"$components/newsitems/NewsitemPhoto\"\nimport NewsitemVideo from \"$components/newsitems/NewsitemVideo\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  Btn,\n  C,\n  logg,\n  useApi,\n} from \"$shared\"\nimport {\n  appPaths,\n} from \"$src/AppRouter\"\nimport { GenericNewsitem } from \"./\"\n\nimport \"./Newsitems.module.scss\"\n\n\nconst Pagination = styled.div`\n  border: ${p => p.debug ? 1 : 0}px solid cyan;\n\n  display: flex;\n`;\nconst CurrentPageNum = styled.div`\n  text-decoration: bold;\n`;\nconst PageNum = styled.a`\n  display: block;\n`;\n\n\nconst W0 = styled.div`\n`;\n\nconst W1 = styled.div`\n  position: relative;\n  ::before {\n    content: '${p => p.debug && p._key}';\n    position: absolute;\n    top: 2px;\n    left: 2px;\n    color: var(--ion-debug-color);\n  }\n`;\n\nconst _EditModeActions = styled.div`\n  position: absolute;\n  right: 1em;\n  top: 1em;\n  z-index: 2;\n`;\nconst EditModeActions = ({ children, ...props }) => {\n  // logg(props, 'EditModeActions')\n  const { item } = props\n\n  const {\n    editorMode,\n  } = useContext(TwofoldContext)\n\n  if (!editorMode) { return null }\n\n  const api = useApi()\n\n  const removeStory = (e) => {\n    if (!confirm('Are you sure?')) { return }\n    api.deleteNewsitem({ id: item.newsitem_id }).then((resp) => {\n      toast('Removed the story')\n    }).catch((err) => {\n      logg('320 - cannot delete newsitem')\n    })\n  }\n\n  return <_EditModeActions>\n\n    <Btn onClick={removeStory} >\n      Remove Story\n    </Btn>\n\n  </_EditModeActions>\n}\n\n/**\n * Newsitems\n *\n * @TODO: variant should come from the location, right? _vp_ 2022-09-11\n**/\nconst Newsitems = (props) => {\n  logg(props, 'Newsitems')\n  const {\n    newsitems=[],\n    variant,\n  } = props\n\n  if (!newsitems.length) { return <div>No Newsitems</div> }\n\n  const {\n    newsitems_pagination,\n    slug: destination_slug,\n  } = useContext(LocationContext)\n\n  const rendered = []\n  newsitems.map((newsitem, idx) => {\n    const premium_tier = newsitem.premium_tier || 0\n    // const icon = ICONS[premium_tier]\n    let item\n\n    switch (newsitem.item_type) {\n      case C.item_types.gallery:\n        item = <NewsitemGallery item={newsitem} variant={variant} />\n        break\n      case C.item_types.report:\n        item = <NewsitemReport  item={newsitem} variant={variant} />\n        break\n      case C.item_types.video:\n        item = <NewsitemVideo   item={newsitem} variant={variant} />\n        break\n      case C.item_types.photo:\n        item = <NewsitemPhoto   item={newsitem} variant={variant} />\n        break\n      default:\n        item = <GenericNewsitem item={newsitem} />\n    }\n\n    rendered.push(\n      <W1 key={idx} _key={idx+1} className={`premium-${premium_tier}`} debug={config.debug} >\n        <EditModeActions item={newsitem} />\n        { item }\n      </W1>\n    )\n  })\n\n  return (\n    <W0 className=\"Newsitems\" {...{ variant }} >\n      { rendered }\n\n      <Pagination >\n        Pages:\n        { newsitems_pagination.previous &&\n          <PageNum href={ appPaths.location({ slug: destination_slug, newsitems_page: newsitems_pagination.previous }) }\n          >previous</PageNum>\n        || null }\n        <CurrentPageNum>{newsitems_pagination.current}</CurrentPageNum>\n        { newsitems_pagination.next &&\n          <PageNum href={ appPaths.location({ slug: destination_slug, newsitems_page: newsitems_pagination.next }) }\n          >next</PageNum>\n        || null }\n      </Pagination>\n\n    </W0>\n  )\n}\nNewsitems.propTypes = {\n  newsitems: PropTypes.array.isRequired,\n  variant: PropTypes.string,\n}\nexport default Newsitems\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport { toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  FlexCol as _FlexCol, FlexRow,\n  logg,\n} from 'ishlibjs'\n\nimport {\n  C,\n  useApi,\n} from \"$shared\"\n\nconst FlexCol = styled(_FlexCol)`\n  color: var(--ion-color);\n`;\n\nconst _IconUp = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n      width=\"20px\" height=\"20px\" viewBox=\"0 0 124.138 124.138\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.138 124.138' }}\n    >\n      <g><path d=\"M50.569,124.138h23.1c4.7,0,9-3.8,9-8.601V81.138c0-4.7,3.5-9,8.2-9h14.699c7.2,0,11.2-8.101,6.801-13.8l-44.101-55\n     c-3.5-4.5-10.2-4.4-13.6,0l-42.9,55c-4.4,5.699-0.4,13.8,6.8,13.8h14.8c4.7,0,8.3,4.2,8.3,9v34.399\n     C41.669,120.338,45.769,124.138,50.569,124.138z\"/></g>\n      <g></g><g></g><g></g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n   </svg>\n </div>\n}\nconst IconUp = styled(_IconUp)`\n  cursor: pointer;\n`;\n\n\nconst _IconDown = ({ fill, ...props }) => {\n  return <div {...props} >\n    <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\"\n\t    width=\"20px\" height=\"20px\" viewBox=\"0 0 124.075 124.075\"\n      fill={fill}\n      style={{ enableBackground: 'new 0 0 124.075 124.075' }}\n\t  >\n      <g><path d=\"M54.628,120.7c3.5,4.5,10.2,4.5,13.601,0l44.1-54.9c4.4-5.7,0.4-13.8-6.8-13.8h-14.7c-4.7,0-8.2-4.2-8.2-9V8.6\n\t\tc0-4.8-4.2-8.6-9-8.6h-23.1c-4.8,0-8.9,3.8-8.9,8.6V43c0,4.7-3.6,9-8.3,9h-14.8c-7.1,0-11.2,8-6.8,13.7L54.628,120.7z\"/>\n      </g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </div>\n}\nconst IconDown = styled(_IconDown)`\n  cursor: pointer;\n`;\n\nconst WCount = styled.div`\n  text-align: center;\n`;\n\n/**\n * Votable\n *\n**/\nconst Votable = (props) => {\n  // logg(props, 'Votable')\n  const { item } = props\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'Votable Used AuthContext')\n\n  const api = useApi()\n\n  const [ votesScore, setVotesScore ] = useState('undefined' === typeof item.votes_score ? '-' : item.votes_score)\n  const [ upFill, setUpFill ] = useState(\"#cecece\")\n  const [ downFill, setDownFill ] = useState(\"#cecece\")\n\n  const [ currentUserVoteValue, setCurrentUserVoteValue ] = useState(item.current_user_vote_value)\n  useEffect(() => {\n    if (currentUserVoteValue === C.vote_values.up) {\n      setUpFill('#cc3333') // @TODO: abstract these colors _vp_ 2022-09-19\n      setDownFill('#cecece')\n    }\n    if (currentUserVoteValue === C.vote_values.down) {\n      setUpFill('#cecece')\n      setDownFill('#cc3333')\n    }\n  }, [currentUserVoteValue])\n\n\n  const voteUp = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.up) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n\n      api.vote({\n        value: C.vote_values.up,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'upvoted')\n        setUpFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.up)\n        if (currentUserVoteValue === C.vote_values.down) {\n          setDownFill('#cecece')\n          setVotesScore(votesScore + 2)\n        } else {\n          setVotesScore(votesScore + 1)\n        }\n      })\n\n      // api.vote({\n      //   value: C.vote_values.up,\n      //   votee_class_name: item.item_type, // eg Video\n      //   votee_id: item.id,\n      //   voter_id: currentUser.id,\n      // })\n    }\n  }\n\n  const voteDown = () => {\n    if (!currentUser.email) {\n      setLoginModalOpen(\"Please login or register to upvote or downvote.\")\n      return\n    }\n\n    if (currentUserVoteValue === C.vote_values.down) {\n      logg('unvoting is not implemented!')\n      toast('unvoting is not implemented!')\n      api.unvote()\n    } else {\n      api.vote({\n        value: C.vote_values.down,\n        votee_class_name: 'Newsitem',\n        votee_id: item.newsitem_id,\n        voter_id: currentUser.id,\n      }).then((r) => {\n        logg(r, 'downvoted')\n        setDownFill('#cc3333')\n        setCurrentUserVoteValue(C.vote_values.down)\n        if (currentUserVoteValue === C.vote_values.up) {\n          setUpFill('#cecece')\n          setVotesScore(votesScore - 2)\n        } else {\n          setVotesScore(votesScore - 1)\n        }\n      })\n    }\n  }\n\n  return <FlexCol>\n    <IconUp onClick={voteUp} width={20} height={20} fill={upFill} />\n    <WCount>{ votesScore}</WCount>\n    <IconDown onClick={voteDown} width={20} height={20} fill={downFill} />\n  </FlexCol>\n}\nVotable.propTypes = {\n  item: PropTypes.object.isRequired,\n}\nexport default Votable\n","\nimport Votable from './Votable'\n\nexport { default as Votable } from './Votable'\n\nexport default Votable\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\nimport { useHistory, } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport {\n  Metaline,\n} from \"$components/application\"\nimport {\n  LocationContext,\n} from \"$components/locations\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport Votable from \"$components/Votable\"\nimport {\n  C, Card,\n  logg,\n  WBordered,\n} from \"$shared\"\nimport {\n  appPaths,\n} from \"$src/AppRouter\"\nimport {\n  ItemIcon,\n} from \"./\"\n\n// alphabetized\n\nconst Col = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst _Row = styled.div`\n  display: flex;\n  align-items: flex-start;\n\n  margin-top: ${p=>p.theme.smallWidth};\n`;\nconst Row = ({ children, ...props }) => <_Row className='Row' {...props}>{children}</_Row>\n\nconst RowInline = styled.div`\n  > * {\n    display: inline;\n  }\n`;\n\nconst A = styled.a`\n  color: var(--ion-color);\n  text-decoration: none;\n`;\n\nconst TitleA = styled.a`\n  margin-top: 0;\n  margin-bottom: 0;\n\n  color: var(--ion-color);\n  // cursor: pointer;\n\n  font-size: 2em;\n  text-decoration: none;\n`;\n\n// @TODO: better management of variant, for ParagonAustin and such _vp_ 2022-09-12\nconst W0 = ({ children, ...props }) => {\n  // logg(props, 'W0')\n  const {\n    variant,\n  } = props\n\n  switch (variant) {\n    case C.variants.bordered:\n      return <WBordered {...props} >{ children }</WBordered>\n    default:\n      throw 'not implemented, how do I show a newsitem without a border?'\n  }\n}\n\n\n\n/**\n * NewsitemContainer\n *\n * @TODO: should be config with variants: standard container, container for a single photo, etc.\n * but for now I'll use item.item_type\n * _vp_ 2022-03-13\n *\n**/\nconst NewsitemContainer = ({ children, ...props }) => {\n  // logg(props, 'NewsitemContainer')\n  const {\n    className, // @TODO: this is silly, remove _vp_ 2022-09-19\n    item,\n    variant, // @TODO: this is silly, remove _vp_ 2022-09-19\n  } = props\n\n  const {\n    slug: destination_slug,\n  } = useContext(LocationContext)\n  // logg(useContext(LocationContext), 'NewsitemContainer Used LocationContext')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    layout,\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'NewsitemContainerUsedContext')\n\n  const history = useHistory()\n\n  const href = appPaths.item({ item, location: {slug: destination_slug} })\n  const navigateToItem = (e) => {\n    e.preventDefault()\n    if (item.is_premium && !item.is_purchased) {\n      setItemToUnlock(item)\n    } else {\n      history.push( href )\n    }\n  }\n\n  return <W0 {...{ className, variant }} >\n    { children }\n    <Row >\n      <Col style={{ alignItems: 'center' }} >\n        <Votable item={item} />\n      </Col>\n      <Col style={{ overflowWrap: 'break-word' }} >\n        <RowInline>\n          <ItemIcon {...item} />\n          <TitleA href={href} onClick={navigateToItem} >{item.name}</TitleA>\n        </RowInline>\n        <Metaline {...item} />\n      </Col>\n    </Row>\n    { item.subhead?.length && <A className=\"subhead\"\n      href={href}\n      onClick={navigateToItem}\n      dangerouslySetInnerHTML={{ __html: item.subhead }}\n    /> || null }\n  </W0>\n}\nNewsitemContainer.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemContainer\n","\nimport * as Ic from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport styled, { useTheme } from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\nconst ReportIcon = () => <div>@TODO: ReportIcon</div>\n\nconst _Icon = styled.span`\n  margin: 0 ${p => p.theme.smallWidth} 0 0;\n`;\n\nconst IconGallery = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n      viewBox=\"0 0 45.964 45.964\" style={{ enableBackground: 'new 0 0 45.964 45.964' }}\n    ><g><g><path d=\"M7.071,30.834V11.062H4.042C1.803,11.062,0,12.893,0,15.13v26.732c0,2.24,1.803,4.051,4.042,4.051h26.733    c2.238,0,4.076-1.811,4.076-4.051v-2.92H15.179C10.733,38.943,7.071,35.281,7.071,30.834z\"/>   <path d=\"M41.913,0.05H15.179c-2.238,0-4.066,1.813-4.066,4.051v26.733c0,2.241,1.829,4.067,4.066,4.067h26.734    c2.237,0,4.051-1.826,4.051-4.067V4.102C45.964,1.862,44.15,0.05,41.913,0.05z M41.363,28.589    c-0.223,0.412-0.652,0.656-1.12,0.656H17.336c-0.403,0-0.782-0.18-1.022-0.502c-0.24-0.324-0.313-0.736-0.197-1.123l3.277-10.839    c0.216-0.713,0.818-1.24,1.554-1.361c0.736-0.12,1.476,0.19,1.908,0.797l4.582,6.437c0.617,0.867,1.812,1.082,2.689,0.484    l4.219-2.865c0.434-0.295,0.967-0.402,1.48-0.299c0.515,0.102,0.966,0.408,1.253,0.848l4.229,6.472    C41.564,27.687,41.585,28.179,41.363,28.589z\"/>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\nconst IconGem = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.gold\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGem'>\n    <svg viewBox=\"0 -32 576 576\" xmlns=\"http://www.w3.org/2000/svg\"\n      width={w} height={h} fill={fill}\n    ><path d=\"M485.5 0L576 160H474.9L405.7 0h79.8zm-128 0l69.2 160H149.3L218.5 0h139zm-267 0h79.8l-69.2 160H0L90.5 0zM0 192h100.7l123 251.7c1.5 3.1-2.7 5.9-5 3.3L0 192zm148.2 0h279.6l-137 318.2c-1 2.4-4.5 2.4-5.5 0L148.2 192zm204.1 251.7l123-251.7H576L357.3 446.9c-2.3 2.7-6.5-.1-5-3.2z\"/>\n    </svg>\n  </_Icon>\n}\n\nconst IconGlasses = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.cyan\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconGlasses'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 297 297\"\n      style={{ enableBackground: 'new 0 0 297 297' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M115.167,101.47H24.012C10.751,101.469,0,112.22,0,125.482v43.477c0,14.674,11.896,26.57,26.57,26.57h39.67     c21.977,0,41.223-14.737,46.954-35.953l10.297-45.336c0.633-3.567-0.276-7.232-2.431-9.804     C120.132,103.328,118.132,101.47,115.167,101.47z M24.542,138.106c-1.945,0-3.888-0.742-5.373-2.225     c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747     l-5.428,5.428C28.432,137.364,26.487,138.106,24.542,138.106z M64.111,130.453l-21.71,21.71     c-1.484,1.483-3.429,2.225-5.374,2.225c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71     c2.968-2.966,7.779-2.966,10.747,0C67.078,122.674,67.078,127.485,64.111,130.453z\"/>    <path d=\"M160.885,106.524h-26.517c0.575,3.345,0.587,6.828-0.021,10.307l-2.22,12.693h31l-2.22-12.693     C160.299,113.352,160.311,109.868,160.885,106.524z\"/>    <path d=\"M272.988,101.47h-94.649c-2.965,0-4.965,1.858-5.893,2.966c-2.155,2.572-3.064,6.236-2.43,9.804l10.296,45.336     c5.731,21.216,24.977,35.954,46.954,35.954h43.164c14.674-0.001,26.57-11.897,26.57-26.571v-43.477     C297,112.22,286.249,101.47,272.988,101.47z M192.422,135.881c-2.967-2.968-2.967-7.779,0-10.747l5.428-5.428     c2.968-2.966,7.779-2.966,10.747,0c2.967,2.968,2.967,7.779,0,10.747l-5.428,5.428c-1.484,1.483-3.429,2.225-5.374,2.225     C195.851,138.106,193.906,137.364,192.422,135.881z M237.363,130.453l-21.71,21.71c-1.484,1.483-3.429,2.225-5.374,2.225     c-1.945,0-3.889-0.742-5.374-2.225c-2.967-2.968-2.967-7.779,0-10.747l21.71-21.71c2.968-2.966,7.779-2.966,10.747,0     C240.33,122.674,240.33,127.485,237.363,130.453z\"/>   </g>  </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g>\n    </svg>\n  </_Icon>\n}\n\n\nconst IconReport = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconReport'>\n    <svg xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 184.153 184.153\" style={{ enableBackground: 'new 0 0 184.153 184.153' }}\n      width={w} height={h} fill={fill}\n    ><g><g><g><path d=\"M129.318,0H26.06c-1.919,0-3.475,1.554-3.475,3.475v177.203c0,1.92,1.556,3.475,3.475,3.475h132.034 c1.919,0,3.475-1.554,3.475-3.475V34.131C161.568,22.011,140.771,0,129.318,0z M154.62,177.203H29.535V6.949h99.784 c7.803,0,25.301,18.798,25.301,27.182V177.203z\"/><path d=\"M71.23,76.441c15.327,0,27.797-12.47,27.797-27.797c0-15.327-12.47-27.797-27.797-27.797 c-15.327,0-27.797,12.47-27.797,27.797C43.433,63.971,55.902,76.441,71.23,76.441z M71.229,27.797 c11.497,0,20.848,9.351,20.848,20.847c0,0.888-0.074,1.758-0.183,2.617l-18.071-2.708L62.505,29.735    C65.162,28.503,68.112,27.797,71.229,27.797z M56.761,33.668l11.951,19.869c0.534,0.889,1.437,1.49,2.462,1.646l18.669,2.799    c-3.433,6.814-10.477,11.51-18.613,11.51c-11.496,0-20.847-9.351-20.847-20.847C50.381,42.767,52.836,37.461,56.761,33.668z\"/>   <rect x=\"46.907\" y=\"90.339\" width=\"73.058\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"107.712\" width=\"48.644\" height=\"6.949\"/>   <rect x=\"46.907\" y=\"125.085\" width=\"62.542\" height=\"6.949\"/>  </g></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n    </svg>\n  </_Icon>\n}\n\nconst IconVideo = ({ fill, w, h, ...props }) => {\n  const theme = useTheme()\n\n  fill = fill ? fill : theme.colors.text\n  w = w ? w : 24\n  h = h ? h : 24\n\n  return <_Icon className='IconVideo' >\n    <svg width={w} height={h} viewBox=\"0 0 33 33\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path fillRule=\"evenodd\" clipRule=\"evenodd\"\n        fill={fill}\n        d=\"M9.89989 0H29.6999C31.5149 0 32.9999 1.485 32.9999 3.3V23.1C32.9999 24.915 31.5149 26.4 29.6999 26.4H9.89989C8.08489 26.4 6.59989 24.915 6.59989 23.1V3.3C6.59989 1.485 8.08489 0 9.89989 0ZM0 6.6H3.3V29.7H26.4V33H3.3C1.485 33 0 31.515 0 29.7V6.6ZM29.7 23.1H9.89997V3.3H29.7V23.1ZM16.5001 20.625V5.775L26.4001 13.2L16.5001 20.625Z\" />\n    </svg>\n  </_Icon>\n}\n\nconst _W0 = styled.div`\n  // border: 1px solid red;\n\n  display: inline;\n  box-sizing: border-box;\n`;\nconst W0 = ({ children, ...props }) => <_W0 className='ItemIcon' {...props}>{children}</_W0>\n\n/**\n * Displays the appropriate icon.\n *\n * @param [Boolean] props.isPurchased\n * @param [Number] props.premiumTier\n * @param [String] props.kind\n */\n export const ItemIcon = (props) => {\n  // logg(props, \"ItemIcon\")\n  const { is_purchased, item_type, premium_tier } = props\n\n  const out = []\n\n  if (premium_tier > 0) {\n    if (is_purchased) {\n      out.push(<IconGlasses key='IconGlasses' />)\n    } else {\n      out.push(<IconGem key='IconGem' />)\n    }\n  }\n  switch (item_type) {\n    case C.item_types.gallery:\n      out.push(<IconGallery key='IconGallery' />)\n      break\n    case C.item_types.report:\n      out.push(<IconReport key='IconReport' />)\n      break\n    case C.item_types.video:\n      out.push(<IconVideo key='IconVideo' />)\n      break\n    case C.item_types.location:\n      // nothing, we're inside a Marker\n      break\n    default:\n      out.push(<span key='unknown-kind'>[&nbsp;?&nbsp;]</span>)\n  }\n  return <W0>{out}</W0>\n}\nItemIcon.propTypes = {\n  is_premium: PropTypes.bool,\n  is_purchased: PropTypes.bool, // .isRequired,\n  item_type: PropTypes.string.isRequired,\n  premium_tier: PropTypes.number,\n}\nexport default ItemIcon\n","/*\n * $components / newsitems / index.jsx\n */\nimport React, { Fragment as F, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { Box, inflector, logg } from \"$shared\"\n\n/* G */\n\nexport const GenericNewsitem = (props) => {\n  // logg(props, 'GenericNewsitem')\n  const { item } = props\n\n  return <F>\n    <div dangerouslySetInnerHTML={{ __html: item.description }} />\n  </F>\n}\n\n/* N */\nexport { default as NewsitemGallery } from \"./NewsitemGallery\"\nexport { default as NewsitemPhoto } from \"./NewsitemPhoto\"\nexport { default as NewsitemReport } from \"./NewsitemReport\"\nexport { default as Newsitems } from \"./Newsitems\"\nexport { default as NewsitemContainer } from \"./NewsitemContainer\"\n\n\n\n/* I */\nexport const ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nexport { default as ItemIcon } from \"./ItemIcon\"\n\n/* V */\n\n","import React, { useEffect, useState } from \"react\"\nimport { IonIcon } from \"@ionic/react\"\nimport { starOutline, starHalf, star } from 'ionicons/icons'\n// import \"./Application.module.scss\"\n\nconst Rating = (props) => {\n\n  let rate = props.rate;\n  let [rating, setRating] = useState([]);\n\n  let iconMapping = {\n    0: starOutline,\n    1: starHalf,\n    2: star\n  };\n\n  useEffect(() => {\n\n    let rating = (new Array(5)).fill(0);\n    let i = 0;\n    while (rate > 0) {\n      if (rate < 1) {\n        rating[i] = 1;\n      } else {\n        rating[i] = 2;\n      }\n      rate--;\n      i++;\n    }\n\n    setRating(rating);\n\n  }, []);\n\n  return (\n    <div className=\"rating\">\n      { rating.map((r, i) => <IonIcon key={i} className=\"stars\" icon={iconMapping[r]} ></IonIcon>) }\n    </div>\n  )\n\n}\n\nexport default Rating;","import { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport { IonPage, IonContent, IonButton, IonImg, IonIcon } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport Rating from \"./Rating\"\n\nimport \"./Venues.module.scss\"\n\nconst Address = styled.p`\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: ${p => p.theme.darkGrey };\n  font-size: 14px;\n`;\n\nconst Col = styled.div``;\n\n// right arrow container\nconst _Ra = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\nconst RightArrow = () => <_Ra><img className=\"forward-arrow\" src=\"/assets/16x16/arrow-right.png\" /></_Ra>\n\nconst Row = styled.div`\n  display: flex;\n`;\n\nconst Title = styled.div`\n  font-size: 1.5em;\n`;\n\nconst Venue = styled.div`\n  width: 100vw;\n  padding: 1em;\n  margin-bottom: 0.5em;\n  border-bottom: 1px solid #e3d3d3;\n  box-shadow: 0px 1px 5px 1px #b3aeae;\n  background-color: white;\n  position: relative;\n\n  display: flex;\n  justify-content: space-between;\n\n  img.thumb {\n    border-radius: 10px;\n  }\n\n  > div {\n    // border: 1px solid red;\n  }\n`;\n\nconst Venues = (props) => {\n  logg(props, 'Venues')\n\n  const defaultRating = 3.5\n  const [filteredVenues, setFilteredVenues] = useState(props.venues)\n\n  function filterHandler(ev) {\n    let venues = props.venues.filter(venue => {\n      return venue.name.toLowerCase().includes(ev.target.value.toLowerCase())\n    })\n    setFilteredVenues(venues)\n  }\n\n  return (\n    <div className=\"venues-section\">\n      <div>\n        <div className=\"filter-section\">\n          <input className=\"filter-input\" onChange={filterHandler} />\n          <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n        </div>\n      </div>\n      <div className=\"container\">\n\n        { filteredVenues.map((venue, idx) => <Venue key={idx} >\n          <Row>\n            <Col><img style={{ paddingRight: '1em' }} className='thumb' src={venue.photo} /></Col>\n            <Col>\n              <Title>{venue.name}</Title>\n              <div className=\"rating-section\">\n                <Rating rate={defaultRating}></Rating>\n                <span className=\"reviews\">5 reviews</span>\n              </div>\n              <div className=\"tags-section\">\n                { venue.tags.map((tag, idx) => <span key={idx} className=\"tags\">{tag.name}</span> )}\n              </div>\n              <p className=\"description\" dangerouslySetInnerHTML={{ __html: venue.subhead }}></p>\n              { venue.address && <Address>{venue.address}</Address> }\n            </Col>\n\n          </Row>\n          <RightArrow />\n        </Venue> )}\n\n      </div>\n    </div>\n  )\n}\n\nVenues.propTypes = {\n  venues: PropTypes.array.isRequired,\n}\nexport default Venues\n","\nimport { pin, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react'\nimport React, { useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { appPaths } from '$src/AppRouter'\nimport { useApi, logg } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { Venues } from \"$components/venues\"\nimport \"./Cities.module.scss\"\n\nconst W0 = styled.div`\n  height: 100vh;\n`;\n\n/**\n * CitiesShow\n * @TODO: this won't work with next_js, so a rewrite is in order.\n**/\nconst CitiesShow = (props) => {\n  // logg(props, 'CitiesShow')\n  const { match } = props\n\n  const api = useApi()\n  const history = useHistory()\n  const thisPath = appPaths.cityPath(match.params.name)\n\n  const location = useLocation()\n\n  const [city, setCity] = useState(null)\n  const [showLoading, setShowLoading] = useState(false)\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    setShowLoading(true)\n    api.getCity(match.params.name).then(res => {\n      if (mountedRef.current) {\n        setCity(res.data.city)\n        setShowLoading(false)\n      }\n    })\n    return () => mountedRef.current = false\n  }, [match.params.name])\n\n  return <W0>\n\n    { city && <div className='wrapper'>\n      <div className='city-show'>\n\n        <header style={{ backgroundImage: `url(${city.hero_img}}`, backgroundSize: \"contain\" }}></header>\n\n        <section className=\"section-one\">\n          <IonIcon icon={pin} className=\"location\"></IonIcon>\n          <h1 className=\"city-name\">{city.name}</h1>\n          <div className=\"status\">\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={newspaperOutline}></IonIcon>\n              <span className=\"numbers\">{city.n_reports}</span>\n            </div>\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={image}></IonIcon>\n              <span className=\"numbers\">{city.n_galleries}</span>\n            </div>\n            <div className=\"status-grid mid\">\n              <IonIcon className=\"info-icon\" icon={videocam}></IonIcon>\n              <span className=\"numbers \">{city.n_videos}</span>\n            </div>\n          </div>\n        </section>\n\n        { /* @TODO: re-add tags here! */ }\n        { /* city.tags && <section className=\"tags-section\">\n          <span className=\"btn delete-btn\" >\n            <IonIcon name=\"close\"> </IonIcon> deselect all\n          </span>\n          { city.tags.map((tag, i) => <span className=\"btn\" key={i} >{tag.name}</span>) }\n        </section> */ }\n\n        <section className=\"section-three\">\n          <div className=\"menu-option\" onClick={() => history.push(appPaths.cityPath(match.params.name))} >\n            <img src=\"/assets/newsfeed-icon.svg\" alt=\"Newsfeed\" />\n            <p className={`${location.pathname == thisPath ? \"selected\" : \"\"} menu-item`}>Newsfeed</p>\n          </div>\n          <div className=\"menu-option\" onClick={() => history.push(appPaths.cityVenuesPath(match.params.name))} >\n            <img src=\"/assets/venue-icon.svg\" alt=\"Venues\" />\n            <p className={`${location.pathname.includes(\"venues\") ? \"selected\" : \"\"} menu-item`}>Venues</p>\n          </div>\n        </section>\n\n\n        <Switch>\n          <Route exact path={`${match.url}/venues`} render={() => <Venues    venues={city.venues} />} />\n          <Route exact path={match.url}             render={() => <Newsitems newsitems={city.newsitems} /> } />\n        </Switch>\n\n\n      </div>\n    </div>}\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </W0>\n}\n\nexport default CitiesShow\n","\nimport { Capacitor } from '@capacitor/core'\nimport { PushNotifications } from '@capacitor/push-notifications'\nimport { Toast } from \"@capacitor/toast\"\nimport { ethers } from 'ethers'\nimport {\n  IonButton, IonButtons,\n  IonCard, IonCardContent, IonContent,\n  IonFooter,\n  IonHeader,\n  IonItem,\n  IonLabel, IonListHeader, IonList,\n  IonMenuButton,\n  IonPage,\n  IonText, IonTitle, IonToolbar,\n} from '@ionic/react'\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport React, {\n  Fragment as F,\n  useContext, useEffect, useState,\n} from \"react\"\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { SideMenu } from \"$components/application\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport { C, logg } from \"$shared\"\nimport Greeter from '$src/artifacts/contracts/Greeter.sol/Greeter.json'\nimport Token from '$src/artifacts/contracts/Token.sol/Token.json'\n\nimport { FbLogin, Logout, } from \"./\"\n\nconst isPushNotificationsAvailable = Capacitor.isPluginAvailable('PushNotifications')\n\n// Update with the contract address logged out to the CLI when it was deployed\nconst greeterAddress = \"0x4bE9765Ca063E73E0aaEd227fd6731473508DbE0\"\nconst tokenAddress = \"0xffa52d00685aC60e65457922aEae2c2783c0cB0E\"\n\nexport const PasswordLogin = () => {\n  return <div>PasswordLogin - @TODO: remove</div>\n}\n\nconst LoginRow = styled.div`\n  display: flex;\n  // border: 1px solid yellow;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst Account = (props) => {\n  // logg(props, 'Account')\n\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const [ greeting, setGreetingValue ] = useState(\"\")\n  const [notifications, setNotifications] = useState([])\n  const [ scratchpad, setScratchpad ] = useState(\"\")\n  const saveScratchpad = () => {}\n\n  // push notifications\n  const register = () => {\n    // Register with Apple / Google to receive push via APNS/FCM\n    PushNotifications.register()\n\n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration', (token) => {\n      showToast('Push registration success')\n    })\n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError', (error) => {\n      alert('Error on registration: ' + JSON.stringify(error))\n    })\n\n    // Show us the notification payload if the app is open on our device\n    PushNotifications.addListener('pushNotificationReceived', (_n) => {\n      const n = _n\n      setNotifications((ns) => {\n        return [...ns, { ...n, type: 'foreground' }]\n      })\n    })\n\n    // Method called when tapping on a notification\n    PushNotifications.addListener('pushNotificationActionPerformed', ({ nofitication: n }) => {\n      setNotifications((ns) => {\n        return [...ns, { ...n, type: 'action' }]\n      })\n    })\n  }\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // push notifications\n  useEffect(() => {\n    if (!isPushNotificationsAvailable) { return }\n\n    PushNotifications.checkPermissions().then((res) => {\n        if (res.receive === 'granted') {\n          register()\n        } else {\n          PushNotifications.requestPermissions().then((res) => {\n            if (res.receive === 'denied') {\n              showToast('Push Notification permission denied')\n            } else {\n              showToast('Push Notification permission granted')\n              register()\n            }\n          })\n        }\n      })\n  }, [])\n\n  // request access to the user's MetaMask account\n  async function requestAccount() {\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n  }\n\n  // call the smart contract, read the current greeting value\n  async function fetchGreeting() {\n    if (typeof window.ethereum !== 'undefined') {\n      const provider = new ethers.providers.Web3Provider(window.ethereum)\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, provider)\n      try {\n        const data = await contract.greet()\n        setGreetingValue(data)\n        // console.log('data: ', data)\n      } catch (err) {\n        console.log(\"Error: \", err)\n      }\n    }\n  }\n\n  async function getBalance() {\n    if (typeof window.ethereum !== 'undefined') {\n      const [account] = await window.ethereum.request({ method: 'eth_requestAccounts' })\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const contract = new ethers.Contract(tokenAddress, Token.abi, provider)\n      const balance = await contract.balanceOf(account);\n      console.log(\"Balance: \", balance.toString());\n    }\n  }\n\n  // call the smart contract, send an update\n  async function setGreeting() {\n    if (!greeting) return\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner()\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, signer)\n      const transaction = await contract.setGreeting(greeting)\n      await transaction.wait()\n      fetchGreeting()\n    }\n  }\n\n  async function sendCoins() {\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(tokenAddress, Token.abi, signer);\n      const transation = await contract.transfer(userAccount, amount);\n      await transation.wait();\n      console.log(`${amount} Coins successfully sent to ${userAccount}`);\n    }\n  }\n\n  return <IonPage>\n    <Grid container>\n      <SideMenu variant={C.variants.inline} />\n      <h1>Account</h1>\n    </Grid>\n    <IonContent className=\"ion-padding\">\n\n      <Grid container spacing={2} >\n        <Grid item xs={12}>\n          <Grid container>\n            <Grid item xs={6}>\n              <img src=\"/assets/accounts/default-avatar.png\" alt=\"profile pic\" />\n\n              { /* NFT */ }\n              <div>\n                <button onClick={fetchGreeting}>Fetch Greeting</button>\n                <br />\n                <button onClick={setGreeting}>Set Greeting</button>\n                <br />\n                <input value={greeting} onChange={e => setGreetingValue(e.target.value)} placeholder=\"Set greeting\" />\n              </div>\n              <hr />\n              <div>\n                <button onClick={getBalance}>Get Balance</button>\n                <br />\n                <button onClick={sendCoins}>Send Coins</button>\n                <br />\n                <input onChange={e => setUserAccount(e.target.value)} placeholder=\"Account ID\" />\n                <br />\n                <input onChange={e => setAmount(e.target.value)} placeholder=\"Amount\" />\n              </div>\n\n            </Grid>\n            <Grid item xs={6}>\n              { !!currentUser\n                && <F>\n                  <h4>{currentUser.email}</h4>\n                  <ul>\n                    <li><Link to={\"/en/account/my/galleries\"} >My Galleries</Link></li>\n                    <li><a onClick={() => props.history.push(\"/en/account/my/videos\")}>My Videos</a></li>\n                    <li><Logout /></li>\n                  </ul>\n                </F>\n                || <F>\n                  <h4>Not logged in</h4>\n\n                  <LoginRow>\n                    <FbLogin />\n                    <PasswordLogin />\n                  </LoginRow>\n\n                </F> }\n            </Grid>\n          </Grid>\n          <Grid container spacing={2}>\n            <Grid item xs={6} >\n              <textarea value={scratchpad} onChange={setScratchpad} />\n              <button type='submit' onClick={saveScratchpad}>Save Scratchpad</button>\n            </Grid>\n          </Grid>\n        </Grid>\n      </Grid>\n\n      <hr />\n      { /* push notifications */ }\n      { notifications.length && <IonList>\n        { notifications.map((notif) => <IonItem key={notif.id}>\n          <IonLabel>\n            <IonText><h3 className=\"notif-title\">{ notif.title }</h3></IonText>\n            <p>{ notif.body }</p>\n            { notif.type==='foreground' && <p>This data was received in foreground</p> }\n            { notif.type==='action' && <p>This data was received on tap</p> }\n          </IonLabel>\n        </IonItem>) }\n      </IonList> || 'no notifications so far' }\n\n    </IonContent>\n    <IonFooter>\n      <IonToolbar>\n        { isPushNotificationsAvailable && <IonButton\n          color=\"success\" expand=\"full\" onClick={register}>Register for Push</IonButton>\n          || <div><h1>Push notifications not available</h1></div> }\n      </IonToolbar>\n    </IonFooter>\n  </IonPage>\n}\n\nexport default Account\n","\nimport { ethers } from 'ethers'\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline'\nimport EditIcon from '@material-ui/icons/Edit'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport { toast } from 'react-toastify'\nimport Toggle from 'react-toggle'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport config from \"config\"\nimport {\n  AuthContext, AuthWidget,\n} from 'ishlibjs'\n\nimport {\n  PurchaseModal,\n} from '$components/application'\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  Btn,\n  Card,\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  FbLogin2,\n} from \"./\"\n\nimport \"react-toggle/style.css\"\n\nimport bodyNFT from '$src/artifacts/contracts/Body.sol/BodyNFT.json'\n\nconst FlexRow = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\n\n/*\n * ropsten, _vp_ 2021-10-26\n * Dana, nude 1 (nude 3)\n */\nconst bodyAddress = '0x3e1a03a9e1682f4dd95413e0be69e5b7bccaf15d'\n\nconst Cell = styled.div`\n  margin-right: ${p => p.theme.smallWidth};\n`;\n\nconst Edit = styled(EditIcon)`\n  font-size: 18px;\n  // color: red;\n  position: absolute;\n  top: 2px;\n  right: 2px;\n  cursor: pointer;\n`;\n\n\n/**\n * Avatar PFP\n**/\nconst _Img = styled.div`\n  border: 1px solid #333333;\n  border-radius: 4px;\n\n  position: relative;\n\n  // max-width: 100px;\n  // max-height: 100px;\n  width: 90px;\n  height: 90px;\n  margin: 5px;\n  margin-right: ${p => p.theme.smallWidth};\n\n  background-image: url('${p => p.src}');\n  background-size: cover;\n`;\nconst Img = ({ src }) => {\n  const doEdit = () => {\n    toast('Editing your avatar is not yet implemented')\n  }\n\n  return <_Img src={src}>\n    <Edit onClick={doEdit} />\n  </_Img>\n}\n\nconst injected = new InjectedConnector() // { supportedChainIds: [1, 3, 4, 5, 42], })\n\nconst _CoinManager = styled.div`\n  display: flex;\n`;\nconst CoinManager = ({ children, ...props }) => {\n  return <_CoinManager className=\"CoinManager\" {...props} >{children}</_CoinManager>\n}\n\nconst W0 = styled.div`\n  // border: 1px solid cyan;\n\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n`;\n\nconst W1 = styled.div``;\n\n/**\n * MyAccountWidget\n**/\nconst MyAccountWidget = (props) => {\n  // logg(props, 'MyAccountWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'MyAccountWidgetUsedAuthContext')\n\n  // @TODO: does this really belong to TwofoldContext?\n  const {\n    editorMode, setEditorMode,\n    purchaseModalOpen, setPurchaseModalOpen,\n  } = useContext(TwofoldContext)\n\n  /*\n   * @TODO: avatar would be an object s.t. multiple styles/sizes are there,\n   * and it should be in a context - shared across threemap, and accountWidget.\n   */\n  const [ avatar, setAvatar ] = useState(\"https://d15g8hc4183yn4.cloudfront.net/wp-content/uploads/2022/09/05174137/20220904-PFP.jpg\")\n  const api = useApi()\n  const { active, account, library, connector, activate, deactivate } = useWeb3React()\n\n  async function connect() {\n    try {\n      await activate(injected)\n    } catch (ex) {\n      logg(ex, 'could not connect')\n    }\n  }\n\n  async function disconnect() {\n    try {\n      deactivate()\n    } catch (ex) {\n      console.log(ex)\n    }\n  }\n\n  // request access to the user's MetaMask account\n  const requestAccount = async () => {\n    await window.ethereum.request({ method: 'eth_requestAccounts' })\n  }\n\n  const myBodies = async () => {\n    if (window.ethereum) {\n      await requestAccount()\n      if (account) {\n        const provider = new ethers.providers.Web3Provider(window.ethereum)\n        const signer = provider.getSigner()\n        const contract = new ethers.Contract(bodyAddress, bodyNFT.abi, signer)\n        const tokensOfOwner = await contract.tokensOfOwner(account)\n\n        // @TODO: this is only first, I need to support unlimited number of bodies connected to the account.\n        const i = 0\n        const result = await contract.tokenURI(tokensOfOwner[i])\n        request.get(result).then(r => r.data.image).then(r => {\n          setAvatar(r)\n        })\n      }\n    }\n  }\n\n\n  useEffect(() => {\n    (async () => {\n      setCurrentUser(await api.getMyAccount())\n    })()\n  }, [])\n\n  return <W0 className=\"MyAccountWidget\" >\n\n\n    { currentUser?.email && <Img src={currentUser?.profile_photo_url || avatar} /> }\n\n    <FlexRow>\n\n      { currentUser.email && <CoinManager>\n        [&nbsp;{ typeof currentUser.n_unlocks === 'undefined' ? '?' : currentUser.n_unlocks} coins&nbsp;\n        <AddCircleOutlineIcon onClick={() => setPurchaseModalOpen(true)} />&nbsp;]\n      </CoinManager> }\n\n      { /* set EditorMode */ }\n      {/* <Card>\n        <label>\n          <Toggle\n            defaultChecked={editorMode}\n            icons={false}\n            onChange={() => setEditorMode(!editorMode) } />\n          <span>Editor mode</span>\n        </label>\n      </Card> */}\n\n      <AuthWidget />\n\n    </FlexRow>\n\n    <PurchaseModal />\n\n  </W0>\n}\nMyAccountWidget.propTypes = {\n  // no props\n};\n\n// const WrappedMyAccountWidget = (props) => <Elements stripe={stripePromise}><MyAccountWidget {...props} /></Elements>;\n// export default WrappedMyAccountWidget\nexport default MyAccountWidget\n\n\n\n// { active && <W1> [\n//   <span>Connected with <b>{account}</b></span>\n//   <button onClick={disconnect} >Disconnect</button>\n//   <button onClick={myBodies} >myBodies</button> ]</W1> }\n// { !active && <W1>\n// <span>Not Connected</span>\n// <button onClick={connect} >Connect to MetaMask</button>\n// </W1> }\n\n\n","/*\n * components / users / index\n */\nimport { Plugins } from '@capacitor/core'\nimport { FacebookLoginResponse } from '@capacitor-community/facebook-login'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport styled from 'styled-components'\n\nimport config from 'config'\n\nimport { TwofoldContext, } from '$components/TwofoldLayout'\nimport {\n  Btn,\n  C,\n  logg, request, useApi,\n} from \"$shared\"\n\n/* A */\nexport { default as Account } from \"./Account\"\n\n\n/* F */\n// @deprecated below, use ishlibjs\nconst { FacebookLogin } = Plugins\nconst FACEBOOK_PERMISSIONS = ['email']\nexport const FbLogin = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        // localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>FB Login</Btn>\n}\nexport const FbLogin2 = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        // localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>Login or Register with Facebook</Btn>\n}\n// ^ @deprecated above\n\n\n\n/* L */\n\nconst BuyBtn = styled.span`\n  border: 1px solid ${p => p.theme.colors.text};\n\n  padding: 5px;\n  cursor: pointer;\n`;\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    // localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <BuyBtn onClick={doLogout}>X</BuyBtn>\n}\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/* M */\nexport { default as MyAccountWidget } from \"./MyAccountWidget\"\n\n/* P */\n\n\n/* R */\n\n","\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport {\n  Switch,\n  Redirect, Route, BrowserRouter as Router,\n} from 'react-router-dom'\nimport styled, { useTheme } from 'styled-components'\n\nimport config from \"config\"\n\nimport { CitiesList, CitiesShow } from \"$components/cities\"\nimport {\n  GalleriesShow,\n} from \"$components/galleries\"\nimport {\n  LocationsShowAsync,\n  LocationsShowMobile3d,\n} from \"$components/locations\"\nimport { ReportsShow } from \"$components/reports\"\nimport {\n  Account,\n} from \"$components/users\"\nimport {\n  C,\n  inflector,\n  logg,\n} from \"$shared\"\n\n/**\n * appPaths\n *\n * @TODO: test-drive: (1) when providing location_slug, (2) when providing location, (3) when neither. _vp_ 2022-09-12\n * @TODO: for Photo, can show full-screen pic. _vp_ 2022-04-17\n *\n**/\nexport const appPaths = {\n  cityVenuesPath: (slug) => `/en/cities/travel-to/${slug}/venues`,\n  cityPath: (slug) => `/en/cities/travel-to/${slug}`,\n\n  item: (props) => {\n    // logg(props, 'appPaths.item')\n\n    let item, location\n    if (props.item_type) {\n      item = props\n    } else {\n      ({ item, location } = props)\n    }\n    let { item_type, slug } = item\n    if (!slug) { // for Photo only\n      slug = item.id\n    }\n\n    if (item_type === C.item_types.location) {\n      return `/en/locations/show/${slug}`\n    }\n\n    if (location) {\n      return `/en/locations/show/${location.slug}/${inflector.tableize(item_type)}/show/${slug}`\n    } else {\n      return `/en/${inflector.tableize(item_type)}/show/${slug}`\n    }\n  },\n\n  gallery: ({ location, location_slug, slug }) => {\n    if (location_slug) {\n      return `/en/locations/show/${location_slug}/galleries/show/${slug}`\n    }\n    if (location) {\n      return `/en/locations/show/${location.slug}/galleries/show/${slug}`\n    } else {\n      // return `/en/${inflector.tableize(item_type)}/show/${slug}`\n      return `/en/galleries/show/${slug}`\n    }\n  },\n\n  location: ({ slug, newsitems_page }) => {\n    const newsitems_page_str = newsitems_page ?\n      `newsitems_page=${newsitems_page}` : ''\n\n    return `/en/locations/show/${slug}?${newsitems_page_str}`\n  },\n}\n\n/**\n * AppRouter - obsoletes AppMobile and AppDesktop\n * _vp_ 2022-09-06\n *\n * @TODO: remove mentions of layout from router, yes? _vp_ 2022-09-10\n *\n**/\nconst AppRouter = (props) => {\n  // logg(props, 'AppRouter')\n\n  return <Router>\n    <Switch main >\n\n      <Redirect exact from=\"/\" to={config.homePath} />\n\n      <Route exact path=\"/en/account\" component={Account} />\n\n      <Route exact path=\"/en/cities\"                 component={CitiesList} />\n      <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n      <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n      <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowAsync} layout={C.layout_mapui} />\n      <Route exact path=\"/en/locations/show/:slug/:item_type/show/:item_slug\" component={LocationsShowAsync} layout={C.layout_mapui} />\n      <Route exact path=\"/en/locations/show2/:slug\" component={LocationsShowAsync} layout={C.layout_mapui} />\n      <Route exact path=\"/en/locations/show3d/:slug\" component={LocationsShowMobile3d} layout={C.layout_mapui} />\n\n      { /* @TODO: Remove, this appears obsolete _vp_ 2022-09-10 */ }\n      <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n    </Switch>\n  </Router>\n}\n\nexport default AppRouter\n","import axios from \"axios\";\nimport config from \"config\";\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings);","\n/**\n * Style Constants\n *\n * @TODO: remove this file entirely. _vp_ 2022-09-20\n * @deprecated, use variables.css and css vars\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '24px',\n  bottomDrawerOpenHeight: '124px',\n  breadcrumbsHeight: '30px',\n\n  smallWidth: '10px',\n  mediumWidth: '20px',\n\n  thinBorderWidth: '2px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    border: 'black', // removing this...\n    blue: '#6aa3e9',\n    cardBackground: 'white',\n    cyan: \"#49bcc6\",\n    darkGrey: '#605d5d',\n    gold: '#ffe100',\n    lightGrey: '#988b8b',\n    red: 'red',\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    border: 'white', // removing this...\n    blue: '#73b0fa',\n    cardBackground: '#1a1a1a',\n    cyan: \"#49bcc6\",\n    darkGrey: '#b3afaf',\n    gold: '#ffe100',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}\n","\nimport PropTypes from 'prop-types'\nimport React, { useState } from 'react'\n\nimport {\n  logg,\n} from '$shared'\n\nexport const SsrContext = React.createContext({})\n\n/**\n * SsrProvider\n**/\nconst SsrProvider = ({ children, ...props }) => {\n  // logg(props, 'SsrProvider')\n  const {\n    location: _location,\n  } = props\n\n  const [ location, setLocation ] = useState(_location)\n\n  return <SsrContext.Provider value={{ location, setLocation }} >\n    { children }\n  </SsrContext.Provider>\n}\nSsrProvider.propTypes = {\n  location: PropTypes.object,\n}\nexport default SsrProvider\n","\nimport React, { useEffect, useState, } from 'react'\nimport { ThemeProvider as _ThemeProvider } from 'styled-components'\n\nimport {\n  C,\n  logg,\n  S,\n} from '$shared'\n\n/**\n * ThemeProvider - this one is my own.\n**/\nexport const ThemeContext = React.createContext({})\nconst ThemeProvider = ({ children, ...props }) => {\n\n  const defaultTheme = 'undefined' === typeof window ? C.themes.light : ( window.localStorage.getItem(C.theme) || C.themes.light )\n  const [theme, setTheme] = useState(defaultTheme)\n\n  // set the body class on page load, client only\n  useEffect(() => {\n    const positive = theme === C.themes.light ? C.themes.light : C.themes.dark\n    const negative = theme === C.themes.light ? C.themes.dark : C.themes.light\n    document.body.classList.remove(negative)\n    document.body.classList.add(positive)\n  }, [])\n\n  // used by DayNightToggle\n  const toggleTheme = (e) => {\n    e.preventDefault()\n    if (theme === C.themes.light) {\n      window.localStorage.setItem(C.theme, C.themes.dark)\n      setTheme(C.themes.dark)\n      document.body.classList.remove(C.themes.light)\n      document.body.classList.add(C.themes.dark)\n    } else {\n      window.localStorage.setItem(C.theme, C.themes.light)\n      setTheme(C.themes.light)\n      document.body.classList.add(C.themes.light)\n      document.body.classList.remove(C.themes.dark)\n    }\n  }\n\n  return <ThemeContext.Provider value={{ theme, setTheme, toggleTheme }} >\n    <_ThemeProvider theme={theme == C.themes.light ? S.lightTheme: S.darkTheme} >\n      { children }\n    </_ThemeProvider>\n  </ThemeContext.Provider>\n}\nexport default ThemeProvider\n\n","import { useLayoutEffect, useState, } from 'react'\n\n/**\n * useWindowSize\n */\nconst useWindowSize = () => {\n  const [size, setSize] = useState([0, 0]);\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    window.addEventListener('resize', updateSize);\n    updateSize();\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n  return size;\n}\n\nexport default useWindowSize\n","/*\n *  $shared / index\n**/\n// alphabetized\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport C from \"./C\"\nimport AppProvider, {\n  AppContext,\n} from './AppProvider'\nimport { TwofoldContext, TwofoldContextProvider } from '$components/TwofoldLayout'\n\n/* A */\nexport { default as useApi } from \"./Api\"\nexport {\n  AppProvider,\n  AppContext,\n}\nexport { appPaths } from '$src/AppRouter'\n\n/* B */\n\n/**\n * Back Button\n */\nconst BackIcon = styled(IonIcon)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n  const history = useHistory()\n\n  const {\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'BackBtn usedContext')\n\n  const onClick = () => {\n    setShowItem(null)\n    history.goBack()\n  }\n\n  return <BackIcon className=\"BackBtn\"\n    icon={arrowBack}\n    onClick={onClick}\n  ></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n\n  padding: .3em 1em;\n  cursor: pointer;\n`;\n\n\n/* C */\n\nexport { C }\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * A Card\n * @deprecated, use WBordered instead. _vp_ 2022-09-19\n */\nconst _Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: ${p => p.theme.smallWidth};\n  background: var(--ion-card-background-color);\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\nexport const Card = ({ children, ..._props }) => {\n  // logg(_props, 'Card')\n  const { navigateToItem, ...props } = _props\n\n  return <_Card className=\"Card\" {...props}>{ children }</_Card>\n}\n\n\n/* D */\n\n/* F */\n\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n *\n * @TODO: move into appRouter\n */\nexport const inflector = {\n  classify: (m) => {\n    if (m === 'locations') {\n      return '::Gameui::Map'\n    }\n\n    if (m.slice(-3)==='ies') {\n      m = m.slice(0, -3) + 'y'\n    }\n    if (m.slice(-1)==='s') {\n      m = m.slice(0, -1)\n    }\n    const ms = m.split('_')\n    for (var i = 0; i < ms.length; i++) {\n      ms[i] = ms[i].charAt(0).toUpperCase() + ms[i].slice(1)\n    }\n    return ms.join(\"\")\n  },\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      case '::Gameui::Map':\n        return 'locations'\n      default:\n        // Report, what else?\n        return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  if ('undefined' === typeof window) { return }\n\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// loggs a non-empty vector\nconst logg_v = (a, b=\"\", c=null) => {\n  // threejs\n  if ('undefined' !== typeof a) {\n    if ('undefined' !== typeof a.z) { // it's a vector\n      if (a.x+a.y+a.z !== 0) {\n        console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n      }\n      return\n    }\n  }\n  logg(a, b, c)\n}\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg_android = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nconst logga = logg_android\nexport {\n  logg,\n  logg_android,\n  logg_v,\n  logga,\n};\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* N */\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\nexport const Root = styled.div`\n  background: ${p => p.theme.colors.background};\n  height: 100vh;\n  overflow: auto;\n`;\n\n\n/* S */\nexport { default as S } from \"./S\"\nexport { default as SsrProvider, SsrContext } from './SsrProvider'\n\n/* T */\nexport { default as ThemeProvider, ThemeContext } from './ThemeProvider'\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered\n *\n * Used in collapsibles and MarkersList\n * prefer this to Card.\n */\nconst _WBordered = styled.div`\n  border: 2px solid var(--ion-border-color);\n  border-radius: var(--ion-border-radius);\n  background: var(--ion-card-background-color);\n  color: var(--ion-color);\n\n  margin-bottom: 1em;\n  padding: .5em;\n\n  cursor: ${p => p.onClick ? 'pointer' : null};\n`;\nexport const WBordered = ({ children, ..._props }) => {\n  const { className='', ...props } = _props\n  return <_WBordered className={`${className} WBordered`} {...props} >{children}</_WBordered>\n}\n\n\n/* Z */\n// @TODO: move this into its own Zoom components, or into MapPanel\nexport const ZoomContext = React.createContext({})\n\n\n\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  WBordered,\n} from '$shared'\n\n/**\n * CollapsibleProvider\n**/\nexport const CollapsibleContext = React.createContext({})\nexport const CollapsibleProvider = ({ children, ...props }) => {\n  // logg(props, 'CollapsibleProvider')\n\n  let defaultCollapsibles = {\n    [C.collapsible.descr]: true,\n  }\n  let tmp\n  try {\n    if (tmp = localStorage.getItem(C.collapsibles)) {\n      defaultCollapsibles = JSON.parse(tmp)\n    }\n  } catch (err) {\n    logg(err, 'Could not parse collapsibles from localStorage')\n  }\n  const [ collapsibles, _setCollapsibles ] = useState(defaultCollapsibles)\n  const setCollapsibles = (m) => {\n    localStorage.setItem(C.collapsibles, JSON.stringify(m))\n    _setCollapsibles(m)\n  }\n\n  return <CollapsibleContext.Provider value={{\n    collapsibles, setCollapsibles,\n  }} >{ children }</CollapsibleContext.Provider>\n}\n\n\n\nconst Gt = () => <span>&nbsp;&gt;&nbsp;&nbsp;</span>\n\nconst Inner = styled.div`\n  clear: left;\n`;\n\nconst Lt = () => <span>&nbsp;&lt;&nbsp;&nbsp;</span>\n\nconst Label = styled.div`\n  display: flex;\n  margin-bottom: ${p => p.theme.borderWidth};\n  color: ${p => p.theme.colors.text};\n`;\n\nconst WTransparent = styled.div`\n  // background: ${p => p.theme.colors.background};\n  padding: 0 .5em .5em .5em;\n`;\nconst W0 = ({ children, variant, ...props }) => {\n  switch (variant) {\n    case C.variants.bordered:\n      return <WBordered {...props} >{children}</WBordered>\n    default:\n      return <WTransparent {...props} >{children}</WTransparent>\n  }\n}\n\n\n/**\n * Collapsible\n *\n * @TODO: test-driven _vp_ 2021-10-29\n */\nconst Collapsible = ({ children, ...props }) => {\n  // logg(props, 'Collapsible')\n  const {\n    className='', config={},\n    slug,\n    variant,\n  } = props\n\n  const {\n    collapsibles, setCollapsibles\n  } = useContext(CollapsibleContext)\n\n  const doToggle = () => setCollapsibles({ ...collapsibles, [slug]: !collapsibles[slug] })\n\n  const collapsible = typeof config.collapsible === 'undefined' ? true : config.collapsible\n  const folded = collapsible ? !!collapsibles[slug] : false\n\n  return <W0 variant={variant} className={`Collapsible ${className}`} >\n    { props.label &&  collapsible && <Label onClick={doToggle} >{folded ? <Lt /> : <Gt />} {props.label}</Label> }\n    { props.label && !collapsible && <Label >{props.label}</Label> }\n    { !folded && <Inner>{ children }</Inner> }\n  </W0>\n}\nCollapsible.propTypes = {\n  className: PropTypes.string,\n  config: PropTypes.shape({\n    collapsible: PropTypes.bool,\n  }),\n  label: PropTypes.string,\n  slug: PropTypes.string.isRequired,\n  variant: PropTypes.string,\n}\nexport default Collapsible\n","/*\n * components / TwofoldLayout / index.jsx\n */\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\n/**\n * LongLine\n *\n * Turns out I need this still - part of the layout.\n */\nconst LongLine = styled.div`\n  border: 2px solid var(--ion-border-color);\n  border-radius: var(--ion-border-radius);\n\n  flex-grow: 1;\n\n  width: ${p => p.orientation === C.horizontal ? 'auto' : '10px'};\n  height: ${p => p.orientation === C.horizontal ? '10px' : 'auto'};\n\n  padding: 2px;\n  background: ${p => p.theme.colors.background};\n`;\nLongLine.propTypes = {\n  orientation: PropTypes.string, // 'horizontal' or 'vertical'\n}\n\nexport default LongLine\n","\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport { ChevronLeft as _ChevronLeft, ChevronRight as _ChevronRight, Menu as _MenuIcon, } from '@material-ui/icons'\nimport React, { useEffect, useRef, useState } from 'react'\n\nimport {\n  C,\n  logg,\n} from \"$shared\"\n\nconst TwofoldContext = React.createContext({})\n\n/**\n * TwofoldContextProvider\n *\n * ishjs has an older version of this - discard it. _vp_ 2022-03-05, 2022-09-12\n*/\nconst TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  let {\n    currentUser: _currentUser, setCurrentUser: _setCurrentUser, // for testing only. _vp_ 2022-03-18\n    itemToUnlock, setItemToUnlock,\n    layout, setLayout,\n    showItem: _showItem, setShowItem: _setShowItem,\n    zoom=1, setZoom, // it's a prop for testing only. _vp_ 2022-03-18\n  } = props\n\n  /* B */\n\n  // bottomDrawerOpen\n  let _bdo = true // for unregistered users, the drawer is open\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(_bdo)\n  const setBottomDrawerOpen = (m) => {\n    try {\n      localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    } catch (e) {}\n    _setBottomDrawerOpen(m)\n  }\n  useEffect(() => {\n    try {\n      let tmp = JSON.parse(localStorage.getItem(C.bottomDrawerOpen))\n      _setBottomDrawerOpen(tmp)\n    } catch (e) {} // no window, or cannot parse json\n  }, [])\n\n\n\n  // let [ currentUser, setCurrentUser ] = useState(C.anonUser)\n  // if (_setCurrentUser) {\n  //   [ currentUser, setCurrentUser ] = [ _currentUser, _setCurrentUser ]\n  // }\n  // /* Get the current_user on load */\n  // const mountedRef = useRef('init')\n  // useEffect(() => {\n  //   if (!mountedRef.current) { return } // @TODO: hmmm do I need this?\n  //   const fn = async () => {\n  //     const r = await api.getMyAccount()\n  //     setCurrentUser(r)\n  //   }\n  //   fn()\n  //   return () => mountedRef.current = null\n  // }, [currentUser])\n  // // Refresh current_user if is_purchasing\n  // useEffect(() => {\n  //   let closure = setTimeout(() => {\n  //     const fn = async () => {\n  //       const r = await api.getMyAccount()\n  //       setCurrentUser(r)\n  //     }\n  //     fn()\n  //   }, 1 * 1000)\n  //   return () => clearTimeout(closure)\n  // }, [currentUser.is_purchasing])\n\n\n  /* E */\n  // const [ editorMode, _setEditorMode ] = useState(JSON.parse(localStorage.getItem(C.names.editorMode)))\n  // const setEditorMode = (t) => {\n  //   localStorage.setItem(C.names.editorMode, t)\n  //   _setEditorMode(t)\n  // }\n  const [ editorMode, setEditorMode ] = useState(false)\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  /* I */\n  const [ _itemToUnlock, _setItemToUnlock ] = useState({})\n  if (!itemToUnlock) {\n    itemToUnlock = _itemToUnlock\n    setItemToUnlock = _setItemToUnlock\n  }\n\n  /* L */\n  // const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalOpen, setPurchaseModalOpen ] = useState(false)\n\n  /* R */\n\n  // const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  // const setRatedConfirmation = (which) => {\n  //   localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n  //   _setRatedConfirmation(which)\n  // }\n  const [ ratedConfirmation, setRatedConfirmation ] = useState(true)\n\n  const [ resizeCount, setResizeCount ] = useState(0)\n  const touchResize = () => setResizeCount(resizeCount+1)\n\n  // const [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n\n  /* S */\n  let [ showItem, setShowItem ] = useState(false)\n  if (!!_setShowItem) { setShowItem = _setShowItem }\n  if (!!_showItem) { showItem = _showItem }\n\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n\n  // twofoldPercent\n  // @TODO: fix, this makes no sense. _vp_ 2022-09-12\n  let _tfp\n  try {\n    _tfp = JSON.parse(localStorage.getItem(C.twofoldPercent))\n  } catch (e) {\n  }\n  const [ twofoldPercent, _setTwofoldPercent ] = useState(_tfp||0.5)\n  const setTwofoldPercent = (p) => {\n    try {\n      localStorage.setItem(C.twofoldPercent, JSON.stringify(p))\n    } catch (e) {}\n    _setTwofoldPercent(p)\n  }\n\n  /* Z */\n  const [ _zoom, _setZoom ] = useState(1)\n  if (!setZoom) {\n    [ zoom, setZoom ] = [ _zoom, _setZoom ]\n  }\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    editorMode, setEditorMode,\n\n    folded, setFolded, foldedLeft, foldedRight,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalOpen, setPurchaseModalOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n    resizeCount, touchResize,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n\n  }} >{ children }</TwofoldContext.Provider>\n}\n\nexport default TwofoldContext\nexport {\n  TwofoldContextProvider,\n}\n","\nimport _Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport {  } from \"$components/application\"\nimport {\n  LongLine,\n  TwofoldContext,\n} from \"$components/TwofoldLayout\"\nimport { MyAccountWidget } from \"$components/users\"\nimport {\n  C, logg, MenuIcon, S,\n} from \"$shared\"\n\nconst Drawer = styled(_Drawer)`\n  .MuiDrawer-paper {\n    // border: 1px solid cyan;\n\n    background: ${p=>p.theme.colors.background};\n    z-index: 0;\n  }\n\n  .MuiDrawer-paperAnchorDockedBottom {\n    border-top: 0;\n  }\n`;\n\nfunction getLibrary(provider) {\n  return new Web3(provider)\n}\n\nconst Inner0 = styled.div`\n  display: flex;\n  align-items: flex-start;\n  color: ${p => p.theme.colors.text};\n`;\n\nconst Inner1 = styled.div`\n  border: 2px solid var(--ion-border-color);\n  border-radius: var(--ion-border-radius);\n\n  // background: var(--ion-background-color);\n  height: calc(${p=>p.theme.bottomDrawerOpenHeight} + 1*${p=>p.theme.borderHeight});\n  margin: ${p=>p.theme.borderWidth};\n\n  flex-grow: 1;\n`;\n\n// TODO: I may not need this\nconst Inner2 = styled.div`\n  // border: 1px solid green;\n\n  // background: var(--ion-background-color);\n  height: 100px;\n  display: flex;\n`;\n\nconst WClosed = styled.div`\n  // border: 1px solid yellow;\n\n  position: absolute;\n  bottom: -10px;\n  // left: 10px;\n\n  width: calc(100% - 2*${p=>p.theme.borderWidth});\n\n  display: flex;\n  align-items: center;\n`;\n\n/**\n * BottomDrawer\n */\nconst BottomDrawer = (props) => {\n  // logg(props, 'BottomDrawer')\n  const {} = props\n\n  const {\n    bottomDrawerOpen, setBottomDrawerOpen,\n  } = useContext(TwofoldContext)\n\n  return <F>\n\n    <WClosed>\n      <IconButton\n        aria-label=\"open drawer\"\n        onClick={() => setBottomDrawerOpen(true)}\n      ><MenuIcon\n        fontSize=\"small\"\n      /></IconButton>\n      <LongLine orientation={C.horizontal} />\n    </WClosed>\n\n    <Drawer anchor={\"bottom\"}\n      elevation={1}\n      open={!!bottomDrawerOpen}\n      onClose={() => setBottomDrawerOpen(false)}\n      BackdropProps={{ invisible: true }}\n      variant={\"persistent\"}\n    >\n      <Inner0 >\n        <IconButton\n          aria-label=\"open drawer\"\n          onClick={() => setBottomDrawerOpen(false)}\n          style={{ paddingRight: 0 }}\n        ><MenuIcon\n          fontSize=\"small\"\n        /></IconButton>\n\n        <Inner1 >\n          <Inner2 >\n\n            {/* @TODO: move this upstream */}\n            <Web3ReactProvider getLibrary={getLibrary}>\n              <MyAccountWidget />\n            </Web3ReactProvider>\n\n          </Inner2>\n        </Inner1>\n      </Inner0>\n    </Drawer>\n  </F>\n}\nBottomDrawer.propTypes = {} // none so far\n\nexport default BottomDrawer\n\n\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport styled from 'styled-components'\n\nimport config from 'config'\n\nimport {\n  SideMenu,\n  DayNightToggle,\n} from \"$components/application\"\nimport {\n  AppContext,\n  appPaths,\n  C,\n  logg,\n} from \"$shared\"\n\n\n// One breadcrumb\nconst B0 = styled.a`\n  color: var(--ion-color);\n  display: block;\n`;\n\n// The divider\nconst B1 = styled.div`\n  padding: 0.5em;\n  color: var(--ion-color);\n`;\n\nconst W0 = styled.div`\n  border: ${p=>p.debug?'1':'0'}px solid cyan;\n\n  display: flex;\n  align-items: center;\n  justify-content: stretch;\n\n  z-index: 0;\n`;\n\nconst WBreadcrumbs = styled.div`\n  display: block;\n  flex-grow: 1;\n\n  > * {\n    display: inline;\n  }\n`;\n\n\n/**\n * Breadcrumbs\n */\nconst Breadcrumbs = (props) => {\n  // logg(props, 'Breakcrumbs')\n  const { breadcrumbs=[] } = props\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n  const history = useHistory()\n\n  const out = []\n  breadcrumbs.map((b, idx) => {\n    if (idx+1 === props.breadcrumbs.length) { // last one\n      out.push(<B0 key={idx}\n      >{b.name}</B0>)\n    } else {\n      const href = appPaths.location({ slug: b.slug })\n      const goto = (e) => {\n        e.preventDefault()\n        history.push( href )\n      }\n      out.push(<B0 key={idx}\n        href={href}\n        onClick={goto}\n      >{b.name}</B0>)\n      out.push(<B1 key={`${idx}-divider`} >&gt;</B1>)\n    }\n  })\n\n  return <W0 debug={config.debug} className=\"Breadcrumbs\" >\n    <SideMenu variant={C.variants.inline} />\n    <WBreadcrumbs className='WBreadcrumbs' >{ out }</WBreadcrumbs>\n    <DayNightToggle />\n  </W0>\n}\nBreadcrumbs.propTypes = {\n  breadcrumbs: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      slug: PropTypes.string.isRequired,\n    }),\n  ),\n}\nexport default Breadcrumbs\n","\nimport PropTypes from 'prop-types'\nimport React, { useContext } from 'react'\n\nimport {\n  C,\n  logg,\n  ThemeContext,\n} from '$shared'\n\nimport styles from './DayNightToggle.module.scss'\n\n/**\n * DayNightToggle\n * From: https://codepen.io/fagnanm/pen/RpWNyb\n * From: https://devbeep.com/css-day-night-toggle-switch/\n *\n * @TODO: test-drive. toggling *once* changes the theme *once*\n**/\nconst DayNightToggle = (props) => {\n  // logg(props, 'DayNightToggle')\n  const {} = props\n\n  const {\n    theme, toggleTheme,\n  } = useContext(ThemeContext)\n  // logg(useContext(ThemeContext), 'DayNightToggle Used ThemeContext')\n\n  return (\n    <div className={`DaynightToddle ${styles.container}`} onClick={toggleTheme} >\n      <div className={styles.switch} >\n        <label htmlFor=\"toggle\">\n          <input readOnly={true} type=\"checkbox\" checked={theme === C.themes.dark} ></input>\n          <div className={styles.sunMoon} ><div className={styles.dots} ></div></div>\n          <div className={styles.background} ><div className={styles.stars1}></div><div className={styles.stars2}></div></div>\n          {/* <div className={styles.fill}></div> */}\n        </label>\n      </div>\n    </div>\n  );\n}\nDayNightToggle.propTypes = {} // none\n\nexport default DayNightToggle\n","\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport styles from \"./Metaline.module.scss\"\n\nimport {\n  logg,\n  pp_date,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  margin: .5em 0;\n  color: ${p=>p.theme.colors.text};\n`\n\n/**\n * Metaline\n**/\nconst Metaline = (props) => {\n  // logg(props, 'Metaline')\n  const {\n    created_at, city,\n    tags = [],\n    username,\n  } = props\n\n  return (\n    <W0 className={styles.Metaline} >\n      { created_at && <span className=\"date\">On {pp_date(created_at)}&nbsp;</span>}\n      { username && <>by <span className=\"user\" style={{ textDecoration: 'underline' }} >{username}</span>&nbsp;</> }\n      {/* { city     && <>in <span className=\"city\" onClick={navigateToCity}> {city.name} </span>&nbsp;</> } */}\n      {/* { tags     && tags.map((tag, i) => <span key={i} className=\"tags\">{tag.name}</span>) } */}\n    </W0>\n  );\n\n}\n\nexport default Metaline\n\n","\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport { CardElement, Elements, useElements, useStripe, } from '@stripe/react-stripe-js'\nimport { loadStripe } from '@stripe/stripe-js'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  ModalHeader,\n} from 'ishlibjs'\nimport config from 'config'\n\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  logg,\n  useApi,\n} from \"$shared\"\n\nimport styles from './PurchaseModal.module.scss'\n\nconst FlexRow = styled.div``;\n\nconst stripePromise = loadStripe(config.stripePublicKey)\n\nconst _PurchaseModal = (props) => {\n  // logg(props, '_PurchaseModal')\n\n  const {\n    currentUser, setCurrentUser,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'PurchaseModalUsedAuthContext')\n\n  const {\n    purchaseModalOpen, setPurchaseModalOpen,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'PurchaseModalUsedTwofoldContext')\n\n  const api = useApi()\n  const stripe = useStripe()\n  const elements = useElements()\n\n  const [ amountCents, setAmountCents ] = useState(50)\n\n  // @TODO: add a virual cue \"Loading\" on button click.\n  const buyUnlocks = async (event) => {\n    event.preventDefault()\n    if (!stripe || !elements) { return }\n\n    // const cardElement = elements.getElement(CardElement)\n    let client_secret = await api.initPayment({ amountCents, })\n\n    const result = await stripe.confirmCardPayment(client_secret.client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    })\n\n    if (result.error) {\n      toast('We are sorry, but something went wrong.')\n      logg(result.error.message, 'e41 - cannot buyUnlocks()')\n\n    } else {\n      if (result.paymentIntent.status === 'succeeded') {\n        const handle = setInterval(async () => {\n\n          let response = await api.getMyAccount()\n          logg(response, 'tr2 success')\n          if (!response.is_purchasing) {\n            logg('clearing interval!')\n            setCurrentUser(response)\n            setPurchaseModalOpen(false)\n            clearInterval(handle)\n          }\n\n        }, 1 * 500)\n        setTimeout(() => clearInterval(handle), 10 * 1000)\n      }\n    }\n  }\n\n  Modal.setAppElement('body')\n\n  return <Modal\n    className={`PurchaseModal ${styles.LoginModal}`}\n    isOpen={purchaseModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <ModalHeader onClose={() => { setPurchaseModalOpen(false) } } >Buy unlocks</ModalHeader>\n    <form onSubmit={buyUnlocks} >\n      <FlexRow>\n        How many cents would you pay for 1 coin? Minimum 50 cents.\n        <input value={amountCents} onChange={e => setAmountCents(e.target.value)} />\n      </FlexRow>\n      <CardElement />\n      <button type=\"submit\" disabled={!stripe} >Pay</button>\n    </form>\n  </Modal>\n}\nconst PurchaseModal = (props) => <Elements stripe={stripePromise}><_PurchaseModal {...props} /></Elements>;\nexport default PurchaseModal\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\n/**\n * RatedRestrictionModal\n */\nconst RatedRestrictionModal = (props) => {\n  // logg(props, 'RatedRestrictionModal')\n  const { ratedConfirmation, setRatedConfirmation } = props\n\n  return <Modal isOpen={!ratedConfirmation} >\n    <p>You must be 18 years of age or older to view this content.</p>\n    <button onClick={() => setRatedConfirmation(true) } >I am over 18</button>\n    &nbsp; &nbsp;\n    <button onClick={() => window.location = 'https://disney.com' } >I am NOT over 18</button>\n  </Modal>\n};\nRatedRestrictionModal.propTypes = {\n  // ratedConfirmation, setRatedConfirmation - but maybe from a context instead?\n};\nexport default RatedRestrictionModal\n","\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\n// import { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\n\nimport { TwofoldContext } from \"$components/TwofoldLayout\"\nimport {\n  AppContext,\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n/**\n * SideMenu\n**/\nconst SideMenu = (props) => {\n  // logg(props, 'SideMenu')\n  const {} = props\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em' }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          <ListItem button key={'newsfeed'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(config.homePath)\n            } } >Home\n          </ListItem>\n\n          { /* <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/threev1\")\n            } } >Three\n          </ListItem>\n\n          <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/construct03d\")\n            } } >Construct0 3D\n          </ListItem>\n\n          <ListItem button key={'cities'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/cities\")\n            } }>\n            <span >Cities</span>\n          </ListItem>\n\n          <ListItem button key={'map 1'} >\n            <span onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations\")\n            } }>The Directory</span>\n          </ListItem> */ }\n\n          { currentUser && currentUser.bookmarks?.map((b, idx) =>\n            <ListItem button key={idx}\n              onClick={() => {\n                setDrawerOpen(false)\n                history.push(`/en/locations/show/${b.slug}`)\n              } } >\n              <span >{b.name}</span>\n            </ListItem>\n          ) }\n\n          <ListItem>REACT_ENV: {config.REACT_ENV}</ListItem>\n        </List>\n\n      </W0>\n    </Drawer>\n  </F>\n}\nSideMenu.propTypes = {\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, } from 'react'\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n  ModalHeader,\n} from 'ishlibjs'\nimport config from 'config'\n\nimport {\n  LocationContext,\n} from \"$components/locations\"\nimport { TwofoldContext, } from \"$components/TwofoldLayout\"\nimport {\n  AppContext,\n  Btn,\n  C,\n  inflector,\n  logg,\n} from \"$shared\"\nimport { appPaths } from \"$src/AppRouter\"\n\nimport * as styles from './UnlockModal.module.scss'\n\nconst BtnRow = styled.div`\n  display: flex;\n  justify-content: space-around;\n`;\n\n\n/**\n * UnlockModal\n *\n * Alphabetized contexts\n**/\nconst UnlockModal = (props) => {\n  // logg(props, 'UnlockModal')\n  const {} = props\n\n  const {\n    useHistory,\n  } = useContext(AppContext)\n  const history = useHistory()\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'unlockModalUsedAuthContext')\n\n  const location = useContext(LocationContext)\n  // logg(location, 'UnlockModal Used LocationContext')\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    purchaseModalOpen, setPurchaseModalOpen,\n    ratedConfirmation, setRatedConfirmation,\n  } = useContext(TwofoldContext)\n  // logg(useContext(TwofoldContext), 'unlockModalUsedTwofoldContext')\n\n  const api = useApi()\n\n\n  const doUnlock = async () => {\n\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    // @TODO: Do I Need to refresh the newsfeed? _vp_ 2022-09-04\n    await api.doUnlock({ kind: itemToUnlock.item_type, id: itemToUnlock.id }).then((r) => {\n      logg(r, 'UnlockModal Unlocked')\n\n      // @TODO: Change this to null if possible. Test-drive this change. _vp_ 2022-09-04\n      setItemToUnlock({})\n      setCurrentUser(r)\n\n      history.push(appPaths.item({ item: itemToUnlock, location, }))\n\n    }).catch((e) => {\n      logg(e, 'e19 - cannot doUnlock')\n    })\n  }\n\n  if (!itemToUnlock?.id) { return null }\n\n  let closable = typeof itemToUnlock.closable === 'undefined' ? true : itemToUnlock.closable\n\n  // @TODO: this is messy\n  let gohome = () => {\n    setItemToUnlock({})\n    setRatedConfirmation(true)\n    history.push(config.homePath)\n  }\n\n  const cost = itemToUnlock.premium_tier\n\n  Modal.setAppElement('body')\n\n  return (<Modal\n    isOpen={!!itemToUnlock.id}\n    className={`UnlockModal ${styles.UnlockModal}`}\n    overlayClassName={styles.UnlockModalOverlay}\n    portalClassName={styles.UnlockModalPortal}\n  >\n    <ModalHeader onClose={() => closable && setItemToUnlock(false) } >Unlock this item?</ModalHeader>\n    <p>To access this content, please unlock it first. It costs {cost} coin(s) to unlock.</p>\n    { currentUser.email && <>\n        <p>You have <b>{currentUser.n_unlocks || '-'}</b> unlocks.</p>\n        { currentUser.n_unlocks >= cost\n          && <Btn className='doUnlock' onClick={doUnlock} >Unlock</Btn>\n          || <>\n            <p>You don't have enough unlocks.</p>\n            <Btn onClick={() => { setPurchaseModalOpen(true) ; setItemToUnlock(false)} } >Purchase more.</Btn>\n        </> }\n      </> || <>\n        <p>You have to be logged in to unlock content. <a onClick={() => { setLoginModalOpen(true) ; setItemToUnlock(false) }}>Please login.</a></p>\n    </> }\n    <BtnRow>\n      { !closable && <Btn onClick={gohome} >Go Home</Btn> }\n    </BtnRow>\n  </Modal>)\n\n}\nUnlockModal.propTypes = {} // none\nexport default UnlockModal\n","\n\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState, } from 'react'\nimport { toast, ToastContainer } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  BottomDrawer,\n} from '$components/application'\nimport {\n  AppProvider,\n  C,\n  logg,\n} from \"$shared\"\nimport AppRouter from '$src/AppRouter'\n\n// I'm using this. _vp_ 2022-09-10\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n\n// @TODO: stop exporting, move to AppProvider, along with BottomDrawer and ToastContainer.\nexport const Root = styled.div`\n  padding: var(--ion-small-padding);\n`;\n\n\n\n/**\n * WrappedApp\n *\n * The preferred AppWrapper. The previous one was obsoleted by next_js _vp_ 2022-09-09\n * Now, AppProvider has all the providers, and this wrapper is empty. _vp_ 2022-09-18\n *\n *\n * @Test: has toast container\n * @Test: has bottomDrawer\n *\n * @DONE: unlockModal cannot be here, it must be inside react-router.\n *\n**/\nconst WrappedApp = (props) => {\n  // logg(props, 'WrappedApp')\n  const {} = props\n\n  return (<AppProvider >\n\n    <Root className='Root' >\n\n      <AppRouter />\n\n    </Root>\n\n    <BottomDrawer />\n    <ToastContainer position=\"bottom-left\" />\n\n  </AppProvider>)\n}\nWrappedApp.propTypes = {} // none\nexport default WrappedApp\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { useHistory } from 'react-router-dom'\n\nimport WrappedApp from './WrappedApp'\nimport * as serviceWorker from './serviceWorker'\n\nimport 'react-toastify/dist/ReactToastify.css'\nimport 'ishlibjs/dist/index.css'\nimport './variables.css'\nimport './application.scss'\n\nReactDOM.render(<WrappedApp />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n\n\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"GalleriesShow\":\"Galleries_GalleriesShow__eB0J9\",\"heading\":\"Galleries_heading__i_svo\",\"title\":\"Galleries_title__3tmwS\",\"narrow\":\"Galleries_narrow__1LN1G\",\"thumbs\":\"Galleries_thumbs__bq4Ur\",\"card\":\"Galleries_card__vP3-g\",\"full_img_section\":\"Galleries_full_img_section__1V5cq\",\"item\":\"Galleries_item__3uUTi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"DayNightToggle_container__3SXTK\",\"switch\":\"DayNightToggle_switch__2IqQw\",\"fill\":\"DayNightToggle_fill__Bgb5K\",\"background\":\"DayNightToggle_background__3k8xs\",\"stars1\":\"DayNightToggle_stars1__tkZmJ\",\"stars2\":\"DayNightToggle_stars2__3Bruk\",\"sunMoon\":\"DayNightToggle_sunMoon__12mN8\",\"dots\":\"DayNightToggle_dots__2ECIQ\"};"],"sourceRoot":""}