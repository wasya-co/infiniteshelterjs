{"version":3,"sources":["../config/environments/production_guydme/config.js","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","shared/C.jsx","shared/Api.jsx","components/TwofoldLayout/index.jsx","components/application/BottomDrawer.jsx","components/application/MainHeader.jsx","components/application/MapuiLayout.jsx","components/application/MapuiMobileLayout.jsx","components/application/Menu.jsx","components/application/MenuLeft.jsx","components/application/Metaline.jsx","components/application/Rating.jsx","components/application/UnlockModal.jsx","components/users/Account.jsx","components/users/LoginModal.jsx","components/users/MyAccountWidget.jsx","components/users/index.js","shared/AppMock.jsx","shared/AppRouter.jsx","shared/Collapsible.jsx","shared/request.jsx","shared/S.jsx","shared/useWindowSize.jsx","shared/index.jsx","components/cities/CitiesList.jsx","components/newsitems/NewsitemGallery.jsx","components/newsitems/NewsitemReport.jsx","components/newsitems/NewsitemVideo.jsx","components/newsitems/Newsitems.jsx","components/newsitems/NewsitemContainer.jsx","components/newsitems/ItemIcon.jsx","components/newsitems/index.js","components/venues/Venues.jsx","components/cities/CitiesShow.jsx","components/galleries/GalleriesShow.jsx","components/galleries/MyGalleries.jsx","components/locations/Breadcrumbs.jsx","components/reports/ReportsShow.jsx","components/locations/ItemModal.jsx","components/locations3/PointerLockControls.js","components/locations3/ThreePanelV1.jsx","components/locations3/ThreePanelV2.jsx","components/locations/LocationsShowDesktop.jsx","components/locations/LocationsShowMobile.jsx","components/locations/MapPanel.jsx","components/locations/MapPanelNoZoom.jsx","components/locations/MarkersList.jsx","components/locations/RatedRestrictionModal.jsx","components/locations/WrappedMapPanel.jsx","components/sites/Features.jsx","components/sites/SitesShow.jsx","components/sites/SitesShow1.jsx","components/videos/Videos.jsx","AppDesktop.jsx","AppMobile.jsx","AppWrapper.jsx","serviceWorker.js","index.jsx"],"names":["module","exports","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","C","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","report","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","MapPanel","MapPanelNoZoom","ThreePanelV1","rated","nc17","ratedConfirmation","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","useApi","useContext","TwofoldContext","token","currentUser","setCurrentUser","localStorage","getItem","doUnlock","kind","getMyAccount","request","post","loginPath","longTermTokenPath","myAccount","myVideosPath","paymentsPath","reportsGet","a","JSON","parse","jwt","config","apiOrigin","getCities","get","r","data","getCity","slug","getTag","tag","applicationHome","domain","params","out","LongLine","styled","div","p","theme","thinBorder","thinBorderRadius","orientation","propTypes","PropTypes","string","Drawer","_Drawer","colors","background","getLibrary","provider","Web3","Inner0","Inner1","bottomDrawerOpenHeight","borderHeight","borderWidth","Inner2","WClosed","BottomDrawer","props","layout","setBottomDrawerOpen","IconButton","aria-label","onClick","fontSize","style","color","anchor","elevation","open","onClose","BackdropProps","invisible","variant","paddingRight","Header","Root","MainHeader","MapuiContainer","bottomDrawerHeight","MapuiLayout","bottomDrawerClosedHeight","MapuiMobileLayout","S","newspaperOutline","bus","person","powerOutline","W1","MenuLeft","React","useState","drawerOpen","setDrawerOpen","history","useHistory","Fab","position","top","left","margin","List","ListItem","button","key","push","homeLocation","bookmarks","b","idx","name","W","withRouter","created_at","username","city","tags","className","pp_date","i","Rating","rate","rating","setRating","iconMapping","0","starOutline","1","starHalf","2","star","useEffect","Array","fill","icon","Btn0","BtnRow","modalStyle","overlay","content","maxWidth","UnlockModal","itemToUnlock","setItemToUnlock","setLoginModalOpen","loginModalOpen","setRatedConfirmation","api","path","item_type","logg","mountedRef","useRef","jwtToken","current","fn","closable","cost","premium_tier","ariaHideApp","isOpen","n_unlocks","Btn","isPushNotificationsAvailable","Capacitor","isPluginAvailable","greeterAddress","tokenAddress","Account","greeting","setGreetingValue","notifications","setNotifications","register","PushNotifications","addListener","showToast","error","alert","stringify","_n","n","logg2","ns","type","nofitication","msg","Toast","show","text","requestAccount","window","ethereum","method","fetchGreeting","ethers","providers","Web3Provider","contract","Contract","Greeter","abi","greet","console","log","account","Token","balanceOf","balance","toString","signer","getSigner","setGreeting","transaction","wait","transfer","userAccount","amount","transation","checkPermissions","res","receive","requestPermissions","Grid","container","spacing","item","xs","src","alt","value","onChange","target","placeholder","setUserAccount","setAmount","email","to","length","notif","title","body","expand","LoginModal","zIndex","BuyBtn","_Img","Img","injected","InjectedConnector","stripePromise","loadStripe","Login","MyAccountWidget","stripe","useStripe","elements","useElements","purchaseModalIsOpen","setPurchaseModalIsOpen","avatar","setAvatar","handleSubmit","event","preventDefault","getElement","CardElement","client_secret","confirmCardPayment","payment_method","card","result","message","paymentIntent","status","response","useWeb3React","active","activate","library","connector","deactivate","ex","myBodies","bodyNFT","tokensOfOwner","tokenURI","image","profile_photo_url","width","onSubmit","disabled","WrappedMyAccountWidget","FacebookLogin","Plugins","FACEBOOK_PERMISSIONS","FbLogin","doFbLogin","login","permissions","accessToken","resp","setItem","err","Logout","removeItem","PasswordLogin","setEmail","password","setPassword","doPasswordLogin","toast","onKeyDown","AppRouter","cityVenuesPath","cityPath","Gt","Inner","Lt","Label","WTransparent","children","WBordered","Collapsible","ctx","CollapsibleContext","setCollapsibles","folded","label","shape","bool","isRequired","settings","baseURL","axios","create","blue","darkGrey","lightGrey","red","breadcrumbsHeight","thinBorderWidth","useWindowSize","size","setSize","useLayoutEffect","updateSize","innerWidth","innerHeight","addEventListener","removeEventListener","BackIcon","IonIcon","BackBtn","goBack","arrowBack","Card","_Box","cursor","createContext","CollapsibleContextProvider","tmp","defaultCollapsibles","descr","_setCollapsibles","Provider","m","inflector","toLowerCase","_Circle","Loading","c","replace","inspect","d","substring","TwofoldContextProvider","setLayout","_setBottomDrawerOpen","setFolded","_setItemToUnlock","mapPanelWidth","setMapPanelWidth","mapPanelHeight","setMapPanelHeight","_setRatedConfirmation","showItem","setShowItem","showUrl","setShowUrl","setTwofoldPercent","zoom","setZoom","which","WBorderedItem","WidgetContainer","Wrapper","Counts","Count","_IonIcon","Number","Cities","cities","setCities","filteredCities","setFilteredCities","showLoading","setShowLoading","ev","filter","indexOf","trim","funnel","bookmark","photo","n_reports","n_galleries","n_videos","videocam","onDidDismiss","duration","Images","ImageLarge","img","ImageThumb1","ImageThumb2","NewsitemGallery","photos","thumb_url","array","NewsitemReport","object","NewsitemVideo","youtube_id","height","frameBorder","allow","allowFullScreen","preload","controls","url","Newsitems","newsitems","newsitem","Col","Row","Title","h2","navigateToItem","boxShadow","NewsitemContainer","is_premium","is_purchased","dangerouslySetInnerHTML","__html","subhead","ItemIcon","number","GenericNewsitem","Address","_Ra","RightArrow","Venue","Venues","venues","filteredVenues","setFilteredVenues","venue","includes","address","CitiesShow","match","thisPath","location","useLocation","setCity","backgroundImage","hero_img","backgroundSize","pin","pathname","exact","render","GalleriesShow","setGallery","getGallery","ph","large_url","MyGalleries","galleries","setGalleries","g","B","B1","L","WDayNight","DayNightToggle","debug","WBreadcrumbs","Breadcrumbs","breadcrumbs","textDecoration","arrayOf","ReportsShow","getReport","ItemModal","reportname","_euler","Euler","_vector","Vector3","_changeEvent","_lockEvent","_unlockEvent","_PI_2","Math","PI","PointerLockControls","camera","domElement","undefined","warn","document","isLocked","minPolarAngle","maxPolarAngle","scope","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","setFromQuaternion","quaternion","y","x","max","min","setFromEuler","dispatchEvent","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","connect","disconnect","dispose","this","getObject","getDirection","direction","v","copy","applyQuaternion","moveForward","distance","setFromMatrixColumn","matrix","crossVectors","up","addScaledVector","moveRight","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","Blocker","Loc","raycaster","renderer","scene","objects","blockerRef","instructionsRef","THREE","fog","light","set","add","moveLeft","moveBackward","canJump","velocity","floorGeometry","rotateX","attributes","l","count","vertex","fromBufferAttribute","random","z","setXYZ","toNonIndexed","colorsFloor","setHSL","setAttribute","floorMaterial","vertexColors","floor","manager","traverse","child","isMesh","material","texture","geometry","scale","onProgress","loaded","total","load","OBJLoader","obj","xhr","lengthComputable","percentComplete","round","cube","antialias","setPixelRatio","appendChild","onWindowResize","init","animate","prevTime","performance","now","aspect","updateProjectionMatrix","requestAnimationFrame","time","ray","origin","onObject","intersectObjects","delta","normalize","ref","cameraDirection","clone","intersections","_D","Description","WH","Handle","w","offsetX","setOffsetX","dragging","setDragging","onMouseUp","clientX","movedBy","movedByPercent","prev","onMouseDown","pageX","onMouseLeave","pointer","ChevronLeft","ChevronRight","IframeModal","scrolling","allowtransparency","Left","Right","LocationsShowDesktop","windowWidth","windowHeight","loading","setLoading","setLocation","setMarkers","mapPanelRef","offsetWidth","offsetHeight","labels","_Description","LocationsShowMobile","withZoom","Div1","ZoomCtrl","right","padding","display","flexDirection","div1Ref","scroll","behavior","centerOffsetY","centerOffsetX","img_path","maxHeight","h","nextZoomByWidth","nextZoomByHeight","nextZoom","_Marker","Marker","_W","MarkersList","goto","title_img_path","RatedRestrictionModal","WrappedMapPanel","forwardRef","map_panel_type","ThreePanelV2","Features","features","f","inner_html","sm","marginBottom","SitesShow","site","setSite","SitesShow1","artTag","setArtTag","homeRow1Tag","setHomeRow1Tag","interestingLocationsTag","setInterestingLocationsTag","useStyles","makeStyles","paper","textAlign","palette","secondary","redBorder","border","root","flexGrow","overflow","VideoItem","Video","video_url","Videos","videos","setVideos","classes","AppDesktop","Container","Route","main","from","component","CitiesList","__Container","_Container","AppMobile","AppWrapper","requireLogin","os","setOs","Device","getInfo","info","operatingSystem","childProps","Boolean","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"4znBACAA,EAAOC,QAAU,CACf,UAAa,+BACb,aAAgB,YAEhB,OAAU,mBAEV,aAAgB,2BAEhB,cAAgB,I,+j0DCTlB,IAAIC,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAy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","file":"static/js/main.ec1515ea.chunk.js","sourcesContent":["\nmodule.exports = {\n  \"apiOrigin\": \"https://manager.piousbox.com\",\n  \"appIndexPath\": \"src/index\",\n\n  \"domain\": \"tgm.piousbox.com\", // required! 20210831\n\n  \"homeLocation\": \"/en/locations/show/earth\",\n\n  \"requireLogin\": false,\n};\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t811,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t812,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t813,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t814,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t815,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t816,\n\t\t46\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t817,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t818,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t819,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t820,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t821,\n\t\t47\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t822,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t823,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t824,\n\t\t48\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t825,\n\t\t49\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t826,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t827,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t828,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t829,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t830,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t831,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t832,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t833,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t834,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t835,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t836,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t837,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t838,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t839,\n\t\t50\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t840,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t841,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t842,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t843,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t844,\n\t\t51\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t845,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t846,\n\t\t52\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t847,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t848,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t849,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t850,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t851,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t852,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t853,\n\t\t53\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 415;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t854,\n\t\t60\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 417;\nmodule.exports = webpackAsyncContext;","\n// Constants\nconst C = {\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","import React, { useContext } from 'react'\n\nimport config from \"config\"\nimport { C,\n  logg, // eslint-disable-line no-unused-vars\nrequest, TwofoldContext } from \"$shared\"\n\nconst useApi = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const token = localStorage.getItem(C.jwt_token);\n\n  return {\n    doUnlock: ({ kind, id }) => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      return `/api/payments/unlock?kind=${kind}&id=${id}&jwt_token=${jwt_token}`;\n    },\n\n    getMyAccount: () => {\n      const jwt_token = localStorage.getItem('jwt_token')\n      return request.post(`/api/my/account`, {\n        jwt_token: jwt_token,\n      })\n    },\n\n    loginPath: '/api/users/login.json',\n    longTermTokenPath: '/api/users/long_term_token',\n\n    myAccount: () => \"/api/my/account\",\n    myVideosPath: \"/api/my/videos\",\n\n    paymentsPath: \"/api/payments2\",\n\n    reportsGet: (a) => {\n      const currentUser = JSON.parse(localStorage.getItem(\"current_user\")) || {};\n      let jwt = \"\";\n      if (currentUser) {\n        jwt = `jwt_token=${currentUser.jwt_token}`\n      }\n      return `${config.apiOrigin}/api/reports/view/${a}?${jwt}`;\n    },\n\n    getCities: ()   => request.get(`${config.apiOrigin}/api/cities`).then((r) => r.data),\n    getCity: (slug) => request.get(`${config.apiOrigin}/api/cities/view/${slug}`),\n    getTag: (tag) => request.get(`${config.apiOrigin}/api/tags/view/${tag.slug}`).then((r) => r.data),\n\n    applicationHome: async () => {\n      const out = await request.get(`${config.apiOrigin}/api/sites/view/${config.domain}`, { params: { jwt_token: token } })\n      return out.data\n    }\n  }\n\n}\n\nexport default useApi\n","/*\n * components / TwofoldLayout / index.jsx\n */\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\n/**\n * Documentation\n */\nconst LongLine = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  flex-grow: 1;\n\n  width: ${p => p.orientation === C.horizontal ? 'auto' : '10px'};\n  height: ${p => p.orientation === C.horizontal ? '10px' : 'auto'};\n\n  padding: 2px;\n  background: white;\n`;\nLongLine.propTypes = {\n  orientation: PropTypes.string,\n}\n\nexport { LongLine }\n","\nimport _Drawer from '@material-ui/core/Drawer'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport { C, logg, S, TwofoldContext, } from \"$shared\"\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport { MyAccountWidget } from \"$components/users\"\n\n\n\nconst Drawer = styled(_Drawer)`\n  .MuiDrawer-paper {\n    // border: 1px solid cyan;\n\n    background: ${p=>p.theme.colors.background};\n  }\n\n  .MuiDrawer-paperAnchorDockedBottom {\n    border-top: 0;\n  }\n\n`;\n\nfunction getLibrary(provider) {\n  return new Web3(provider)\n}\n\nconst Inner0 = styled.div`\n  display: flex;\n  align-items: flex-start;\n`;\n\nconst Inner1 = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n\n  background: ${p=>p.theme.colors.background};\n  height: calc(${p=>p.theme.bottomDrawerOpenHeight} + 1*${p=>p.theme.borderHeight});\n  margin: ${p=>p.theme.borderWidth};\n\n  flex-grow: 1;\n`;\n\n// TODO: I may not need this\nconst Inner2 = styled.div`\n  // border: 1px solid green;\n\n  background: white;\n  height: 100px;\n  display: flex;\n`;\n\nconst WClosed = styled.div`\n  // border: 1px solid yellow;\n\n  position: absolute;\n  bottom: -10px;\n  // left: 10px;\n\n  width: calc(100% - 2*${p=>p.theme.borderWidth});\n\n  display: flex;\n  align-items: center;\n`;\n\n/**\n * Documentation?\n */\nconst BottomDrawer = (props) => {\n  // logg(props, 'BottomDrawer')\n\n  const { bottomDrawerOpen, layout, setBottomDrawerOpen } = useContext(TwofoldContext)\n\n  // @TODO: move the component to layout_onecol then\n  if (layout === C.layout_onecol) { return null; }\n\n  return <F>\n\n    <WClosed>\n      <IconButton\n        aria-label=\"open drawer\"\n        onClick={() => setBottomDrawerOpen(true)}\n      ><MenuIcon\n        fontSize=\"small\"\n        style={{ color: 'black' }}\n      /></IconButton>\n      <LongLine orientation={C.horizontal} />\n    </WClosed>\n\n\n    <Drawer anchor={\"bottom\"}\n      elevation={1}\n      open={bottomDrawerOpen}\n      onClose={() => setBottomDrawerOpen(false)}\n      BackdropProps={{ invisible: true }}\n      variant={\"persistent\"}\n    >\n      <Inner0 >\n        <IconButton\n          aria-label=\"open drawer\"\n          onClick={() => setBottomDrawerOpen(false)}\n          style={{ paddingRight: 0 }}\n        ><MenuIcon\n          fontSize=\"small\"\n          style={{\n            color: 'black',\n          }}\n        /></IconButton>\n\n        <Inner1 >\n          <Inner2 >\n\n            <Web3ReactProvider getLibrary={getLibrary}>\n              <MyAccountWidget />\n            </Web3ReactProvider>\n\n          </Inner2>\n        </Inner1>\n      </Inner0>\n    </Drawer>\n  </F>\n}\n\nexport default BottomDrawer\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { logg, C, } from \"$shared\"\nimport { MenuLeft, } from \"$components/application\"\n\nconst Header = styled.div`\n  // border: 1px solid red;\n\n  flex-grow: 1;\n\n  text-align: center;\n  font-size: 2em;\n\n\n`;\n\nconst Root = styled.div`\n  // border: 1px solid blue;\n\n  display: flex;\n  justify-content: center;\n  line-height: 2em;\n  padding: 2em 0;\n`;\n\nconst MainHeader = (props) => {\n  // logg(props, 'MainMenu')\n\n  return <Root>\n    <MenuLeft variant={C.variants.inline} />\n    <Header>My Local Guide</Header>\n  </Root>\n}\n\nexport default MainHeader\n","\nimport React from 'react'\nimport styled from 'styled-components'\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid purple;\n\n  background: white;\n\n  overflow: hidden;\n  margin: 10px;\n  height: calc(100vh - ${p => p.borderWidth*2}px - ${p => p.bottomDrawerOpen ? `${p.bottomDrawerHeight - p.borderWidth/2}px` : '0px' });\n`\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiLayout = (props) => {\n  return <MapuiContainer {...props} />\n}\n\nexport default MapuiLayout\n","\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\n\nconst MapuiContainer = styled.div`\n  // border: 1px solid cyan;\n\n  background: white;\n\n  overflow-y: auto;\n\n  height: calc(100vh\n    - ${p => p.bottomDrawerOpen ? p.bottomDrawerOpenHeight : p.bottomDrawerClosedHeight });\n`;\n\nexport {\n  MapuiContainer,\n}\n\nconst MapuiMobileLayout = (props) => {\n  const { bottomDrawerOpen } = useContext(TwofoldContext)\n  return <MapuiContainer {...props} {...{ bottomDrawerOpen }} {...S} />\n}\n\nexport default MapuiMobileLayout\n","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonMenu,\n  IonMenuToggle,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { newspaperOutline, bus, person, powerOutline } from 'ionicons/icons';\nimport './application.scss';\n\nconst appPages = [\n  {\n    title: 'Homefeed',\n    icon: newspaperOutline,\n    url: \"/en\"\n  },\n  {\n    title: 'Cities',\n    icon: bus,\n    url: \"/en/cities\"\n  },\n  {\n    title: 'My Account',\n    icon: person,\n    url: \"/en/account\"\n  },\n  {\n    title: 'Account2',\n    icon: person,\n    url: \"/en/account2\"\n  },\n  {\n    title: 'Login',\n    icon: powerOutline\n  }\n];\n\n/**\n * 20210529 - I think this is obsolete somehow, I'm using MyDrawer in App.jsx\n *\n */\nconst Menu = () => {\n  return (\n    <IonMenu contentId=\"main\" type=\"overlay\">\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Menu</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <img src=\"/assets/hero.png\" />\n        <IonList id=\"inbox-list\">\n          { appPages.map((appPage, index) => <IonMenuToggle key={index} autoHide={false}>\n            <IonItem\n              routerLink={appPage.url}\n              routerDirection=\"none\"\n              lines=\"none\"\n              detail={false}>\n              <IonIcon\n                slot=\"start\"\n                ios={appPage.icon}\n                md={appPage.icon} />\n              <IonLabel>{appPage.title}</IonLabel>\n            </IonItem>\n          </IonMenuToggle>) }\n        </IonList>\n      </IonContent>\n    </IonMenu>\n  )\n}\n\nexport default Menu\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { Menu } from \"$components/application\"\nimport { Api, C, Debug, logg, TwofoldContext } from \"$shared\"\n\nconst _LeftWrapper = styled.div`\n  // border: 1px solid green;\n`;\n\nconst W1 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\nconst W2 = styled.div`\n`;\n\nconst MenuLeft= (props) => {\n  // logg(props, 'MenuLeft')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n\n  return <F>\n\n    { /* <Menu /> */ }\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em' }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W1>\n        <List>\n\n          <ListItem button key={'newsfeed'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(config.homeLocation)\n            } } >Home\n          </ListItem>\n\n          { /* <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/threev1\")\n            } } >Three\n          </ListItem>\n\n          <ListItem button key={'three'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations/show/construct03d\")\n            } } >Construct0 3D\n          </ListItem>\n\n          <ListItem button key={'cities'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/cities\")\n            } }>\n            <span >Cities</span>\n          </ListItem>\n\n          <ListItem button key={'map 1'} >\n            <span onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/locations\")\n            } }>The Directory</span>\n          </ListItem> */ }\n\n          { currentUser && currentUser.bookmarks.map((b, idx) =>\n            <ListItem button key={idx}\n              onClick={() => {\n                setDrawerOpen(false)\n                history.push(`/en/locations/show/${b.slug}`)\n              } } >\n              <span >{b.name}</span>\n            </ListItem>\n          ) }\n\n          <ListItem button key={'account'}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(\"/en/account\")\n            } } >\n            <span >Account</span>\n          </ListItem>\n\n        </List>\n        { /* <W2>\n          { loading && 'Loading...' }\n          { currentUser && <F>\n            {currentUser.email}<br />\n            {currentUser.n_stars}<br />\n            some action\n          </F> }\n        </W2> */ }\n      </W1>\n    </Drawer>\n  </F>\n}\n\nMenuLeft.propTypes = {\n  variant: PropTypes.string,\n}\nexport default MenuLeft\n","import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport \"./application.scss\";\nimport styled from 'styled-components'\n\nimport { Api, logg, request, pp_date } from \"$shared\"\n\nconst W = styled.div`\n  margin-top: .5em;\n`\n\nconst Metaline = (props) => {\n  // logg(props, 'Metaline')\n\n  const { created_at, username, city, tags = [] } = props;\n\n  function navigateToCity(){\n    props.history.push(`/en/cities/travel-to/${city.slug}/show/newsfeed`);\n  }\n\n  return (\n    <W>\n      { created_at && <span className=\"date\"> On {pp_date(created_at)} </span>}\n      { username && <>by <span className=\"user\"> {username} </span></> }\n      { city     && <>in <span className=\"city\" onClick={navigateToCity}> {city.name} </span></> }\n      { tags     && tags.map((tag, i) => <span key={i} className=\"tags\">{tag.name}</span>) }\n    </W>\n  );\n\n}\n\nexport default withRouter(Metaline);","import React, { useEffect, useState } from \"react\";\nimport { IonIcon } from \"@ionic/react\";\nimport { starOutline, starHalf, star } from 'ionicons/icons';\nimport \"./application.scss\";\n\nconst Rating = (props) => {\n\n  let rate = props.rate;\n  let [rating, setRating] = useState([]);\n\n  let iconMapping = {\n    0: starOutline,\n    1: starHalf,\n    2: star\n  };\n\n  useEffect(() => {\n\n    let rating = (new Array(5)).fill(0);\n    let i = 0;\n    while (rate > 0) {\n      if (rate < 1) {\n        rating[i] = 1;\n      } else {\n        rating[i] = 2;\n      }\n      rate--;\n      i++;\n    }\n\n    setRating(rating);\n\n  }, []);\n\n  return (\n    <div className=\"rating\">\n      { rating.map((r, i) => <IonIcon key={i} className=\"stars\" icon={iconMapping[r]} ></IonIcon>) }\n    </div>\n  )\n\n}\n\nexport default Rating;","\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef, } from 'react'\nimport Modal from \"react-modal\"\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport './UnlockModal.scss'\nimport { Btn, C, logg, request, TwofoldContext, useApi, } from \"$shared\"\n\nconst Btn0 = styled.div`\n  display: inline;\n  cursor: pointer;\n`;\nconst BtnRow = styled.div`\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst modalStyle = {\n  overlay: {},\n  content: {\n    margin: 'auto',\n    maxWidth: '400px',\n\n  }\n}\n\n/**\n * UnlockModal\n */\nconst UnlockModal = (props) => {\n  // logg(props, 'UnlockModal')\n\n  const history = useHistory()\n\n  const {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n    ratedConfirmation, setRatedConfirmation,\n  } = useContext(TwofoldContext)\n  const usedTwofoldContext = useContext(TwofoldContext)\n\n  const api = useApi()\n\n  const doUnlock = async () => {\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    const path = api.doUnlock({ kind: itemToUnlock.item_type, id: itemToUnlock.id })\n    await request.post(`${config.apiOrigin}${path}`).then((r) => {\n      setItemToUnlock({})\n    }).catch((e) => {\n      logg(e, 'e19')\n    })\n  }\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n\n    const fn = async () => {\n      const jwtToken = localStorage.getItem(C.jwt_token)\n      await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`).then((r) => {\n        if (!mountedRef.current) { return }\n        setCurrentUser(r.data)\n      }).catch((e) => {\n        // logg(e, 'e12')\n        // setCurrentUser(null)\n      })\n    }\n    fn()\n    return () => mountedRef.current = null\n  }, [itemToUnlock.id])\n\n  if (!itemToUnlock.id) { return null }\n\n  let closable = typeof itemToUnlock.closable === 'undefined' ? true : itemToUnlock.closable\n\n  // @TODO: this is messy\n  let gohome = () => {\n    setItemToUnlock({})\n    setRatedConfirmation(true)\n    history.push(config.homeLocation)\n  }\n\n  const cost = itemToUnlock.premium_tier\n\n  return (<Modal style={modalStyle} ariaHideApp={false} isOpen={!!itemToUnlock.id} >\n    <Header>\n      <h1>Unlock this item?</h1>\n      { closable && <Btn0 onClick={() => closable && setItemToUnlock(false) } >&times;</Btn0> }\n    </Header>\n    <p>To access this content, please unlock it first. It costs {cost} coin(s) to unlock.</p>\n    { !!currentUser\n      && <p>You have <b>{currentUser.n_unlocks}</b> unlocks.</p>\n      || <p>You have to be logged in to unlock content. <a onClick={() => { setLoginModalOpen(true) ; setItemToUnlock(false) }}>Please login.</a></p> }\n    <BtnRow>\n      { !!currentUser && <Btn onClick={doUnlock} >Unlock</Btn> }\n      { !closable && <Btn onClick={gohome} >Go Home</Btn> }\n    </BtnRow>\n  </Modal>)\n\n}\n\nexport default UnlockModal\n","\nimport { Capacitor } from '@capacitor/core'\nimport { PushNotifications } from '@capacitor/push-notifications'\nimport { Toast } from \"@capacitor/toast\"\nimport { ethers } from 'ethers'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport {\n  IonButton, IonButtons,\n  IonCard, IonCardContent, IonContent,\n  IonFooter,\n  IonHeader,\n  IonItem,\n  IonLabel, IonListHeader, IonList,\n  IonMenuButton,\n  IonPage,\n  IonText, IonTitle, IonToolbar,\n} from '@ionic/react'\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Link } from 'react-router-dom'\n\nimport { FbLogin, Logout, PasswordLogin } from \"./\"\nimport { C, logg, logg2, TwofoldContext } from \"$shared\"\nimport { MenuLeft } from \"$components/application\"\nimport Greeter from '$src/artifacts/contracts/Greeter.sol/Greeter.json'\nimport Token from '$src/artifacts/contracts/Token.sol/Token.json'\n\nconst isPushNotificationsAvailable = Capacitor.isPluginAvailable('PushNotifications')\n\n// Update with the contract address logged out to the CLI when it was deployed\nconst greeterAddress = \"0x4bE9765Ca063E73E0aaEd227fd6731473508DbE0\"\nconst tokenAddress = \"0xffa52d00685aC60e65457922aEae2c2783c0cB0E\"\n\n\nconst Account = (props) => {\n  logg(props, 'Account')\n\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const [ greeting, setGreetingValue ] = useState(\"\")\n  const [notifications, setNotifications] = useState([])\n\n  // push notifications\n  const register = () => {\n    // Register with Apple / Google to receive push via APNS/FCM\n    PushNotifications.register()\n\n    // On success, we should be able to receive notifications\n    PushNotifications.addListener('registration', (token) => {\n      showToast('Push registration success')\n    })\n\n    // Some issue with our setup and push will not work\n    PushNotifications.addListener('registrationError', (error) => {\n      alert('Error on registration: ' + JSON.stringify(error))\n    })\n\n    // Show us the notification payload if the app is open on our device\n    PushNotifications.addListener('pushNotificationReceived', (_n) => {\n      const n = _n\n      logg2(n, 'pushNotificationReceived')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'foreground' }]\n      })\n    })\n\n    // Method called when tapping on a notification\n    PushNotifications.addListener('pushNotificationActionPerformed', ({ nofitication: n }) => {\n      logg2(n, 'pushNotificationActionPerformed')\n      setNotifications((ns) => {\n        logg2(ns, 'setNofitications')\n        return [...ns, { ...n, type: 'action' }]\n      })\n    })\n  }\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // push notifications\n  useEffect(() => {\n    if (!isPushNotificationsAvailable) { return }\n\n    PushNotifications.checkPermissions().then((res) => {\n        if (res.receive === 'granted') {\n          register()\n        } else {\n          PushNotifications.requestPermissions().then((res) => {\n            if (res.receive === 'denied') {\n              showToast('Push Notification permission denied')\n            } else {\n              showToast('Push Notification permission granted')\n              register()\n            }\n          })\n        }\n      })\n  }, [])\n\n  // request access to the user's MetaMask account\n  async function requestAccount() {\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n  }\n\n  // call the smart contract, read the current greeting value\n  async function fetchGreeting() {\n    if (typeof window.ethereum !== 'undefined') {\n      const provider = new ethers.providers.Web3Provider(window.ethereum)\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, provider)\n      try {\n        const data = await contract.greet()\n        setGreetingValue(data)\n        // console.log('data: ', data)\n      } catch (err) {\n        console.log(\"Error: \", err)\n      }\n    }\n  }\n\n  async function getBalance() {\n    if (typeof window.ethereum !== 'undefined') {\n      const [account] = await window.ethereum.request({ method: 'eth_requestAccounts' })\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const contract = new ethers.Contract(tokenAddress, Token.abi, provider)\n      const balance = await contract.balanceOf(account);\n      console.log(\"Balance: \", balance.toString());\n    }\n  }\n\n  // call the smart contract, send an update\n  async function setGreeting() {\n    if (!greeting) return\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner()\n      const contract = new ethers.Contract(greeterAddress, Greeter.abi, signer)\n      const transaction = await contract.setGreeting(greeting)\n      await transaction.wait()\n      fetchGreeting()\n    }\n  }\n\n  async function sendCoins() {\n    if (typeof window.ethereum !== 'undefined') {\n      await requestAccount()\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const contract = new ethers.Contract(tokenAddress, Token.abi, signer);\n      const transation = await contract.transfer(userAccount, amount);\n      await transation.wait();\n      console.log(`${amount} Coins successfully sent to ${userAccount}`);\n    }\n  }\n\n  return <IonPage>\n    <Grid container>\n      <MenuLeft variant={C.variants.inline} />\n      <h1>Account</h1>\n    </Grid>\n    <IonContent className=\"ion-padding\">\n      <Grid container spacing={2} >\n        <Grid item xs={12}>\n          <Grid container>\n            <Grid item xs={6}>\n              <img src=\"/assets/accounts/default-avatar.png\" alt=\"profile pic\" />\n\n              { /* NFT */ }\n              <div>\n                <button onClick={fetchGreeting}>Fetch Greeting</button>\n                <br />\n                <button onClick={setGreeting}>Set Greeting</button>\n                <br />\n                <input value={greeting} onChange={e => setGreetingValue(e.target.value)} placeholder=\"Set greeting\" />\n              </div>\n              <hr />\n              <div>\n                <button onClick={getBalance}>Get Balance</button>\n                <br />\n                <button onClick={sendCoins}>Send Coins</button>\n                <br />\n                <input onChange={e => setUserAccount(e.target.value)} placeholder=\"Account ID\" />\n                <br />\n                <input onChange={e => setAmount(e.target.value)} placeholder=\"Amount\" />\n              </div>\n\n            </Grid>\n            <Grid item xs={6}>\n              { !!currentUser\n                && <F>\n                  <h4>{currentUser.email}</h4>\n                  <ul>\n                    <li><Link to={\"/en/account/my/galleries\"} >My Galleries</Link></li>\n                    <li><a onClick={() => props.history.push(\"/en/account/my/videos\")}>My Videos</a></li>\n                    <li><Logout /></li>\n                  </ul>\n                </F>\n                || <F>\n                  <h4>Not logged in 4</h4>\n                  <FbLogin />\n                  <br /><br />\n                  <PasswordLogin />\n\n                </F> }\n            </Grid>\n          </Grid>\n        </Grid>\n      </Grid>\n\n      <hr />\n      { /* push notifications */ }\n      { notifications.length && <IonList>\n        { notifications.map((notif) => <IonItem key={notif.id}>\n          <IonLabel>\n            <IonText><h3 className=\"notif-title\">{ notif.title }</h3></IonText>\n            <p>{ notif.body }</p>\n            { notif.type==='foreground' && <p>This data was received in foreground</p> }\n            { notif.type==='action' && <p>This data was received on tap</p> }\n          </IonLabel>\n        </IonItem>) }\n      </IonList> || 'no notifications so far' }\n\n    </IonContent>\n    <IonFooter>\n      <IonToolbar>\n        { isPushNotificationsAvailable && <IonButton\n          color=\"success\" expand=\"full\" onClick={register}>Register for Push</IonButton>\n          || <div><h1>Push notifications not available</h1></div> }\n      </IonToolbar>\n    </IonFooter>\n  </IonPage>\n}\n\nexport default Account\n","\nimport { IonPage, IonContent } from \"@ionic/react\"\nimport { Container, Grid } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from 'react-modal'\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { FbLogin, Logout, PasswordLogin } from \"./\"\nimport { C, logg, TwofoldContext } from \"$shared\"\n\n\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal')\n  const { loginModalOpen, setLoginModalOpen } = useContext(TwofoldContext)\n\n  return <Modal style={{ zIndex: 3 }} isOpen={loginModalOpen} >\n\n    <h1>\n      Please Login\n      <button onClick={() => setLoginModalOpen(false)} >[x]</button>\n    </h1>\n    <FbLogin />\n    <PasswordLogin />\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport { ethers } from 'ethers'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { CardElement, Elements, useElements, useStripe, } from '@stripe/react-stripe-js'\nimport { loadStripe } from '@stripe/stripe-js'\nimport styled from 'styled-components'\nimport Web3 from 'web3'\nimport { useWeb3React, Web3ReactProvider } from \"@web3-react/core\"\nimport { InjectedConnector } from '@web3-react/injected-connector'\n\nimport config from \"config\"\nimport { logg, S, request, TwofoldContext, useApi } from \"$shared\"\nimport bodyNFT from '$src/artifacts/contracts/Body.sol/BodyNFT.json'\n\n/*\n * ropsten, _vp_ 2021-10-26\n * Dana, nude 1 (nude 3)\n */\nconst bodyAddress = '0x3e1a03a9e1682f4dd95413e0be69e5b7bccaf15d'\n\nconst BuyBtn = styled.div`\n  border: 1px solid black;\n  padding: 5px;\n  cursor: pointer;\n`;\n\nconst _Img = styled.div`\n  // border: 1px solid red;\n\n  max-width: 100px;\n  max-height: 100px;\n\n`;\nconst Img = ({ src }) => {\n  return <_Img><img src={src} alt='' /></_Img>\n}\nconst injected = new InjectedConnector() // { supportedChainIds: [1, 3, 4, 5, 42], })\n\nconst stripePromise = loadStripe('pk_test_qr1QPmSpLdBFt1F7itdWJOj3') // @TODO: this is active, but change.\n\nconst Login = (props) => {\n  return (<F>\n    <button>do login</button>\n  </F>)\n};\n\nconst W = styled.div`\n  border: 2px solid black;\n\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n\n  // background: #dedede;\n  // background: white;\n  // height: 100px;\n  // width: calc(100vw - 2*${p => p.theme.borderWidth});\n  // padding: 1em;\n  // margin-bottom: ${p => p.theme.borderWidth};\n`;\n\nconst MyAccountWidget = (props) => {\n  // logg(props, 'MyAccountWidget')\n\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const stripe = useStripe()\n  const elements = useElements()\n\n  const [purchaseModalIsOpen, setPurchaseModalIsOpen] = useState(false)\n  /*\n   * @TODO: avatar would be an object s.t. multiple styles/sizes are there,\n   * and it should be in a context - shared across threemap, and accountWidget.\n   */\n  const [ avatar, setAvatar ] = useState(\"\")\n\n  // buy unlocks (coins?)\n  const handleSubmit = async (event) => {\n    event.preventDefault()\n    logg('purchasing...')\n\n    if (!stripe || !elements) { return }\n    const cardElement = elements.getElement(CardElement)\n\n    const jwtToken = localStorage.getItem('jwt_token')\n    let client_secret = await request.get(`${config.apiOrigin}${api.paymentsPath}?jwt_token=${jwtToken}`)\n    client_secret = client_secret.data.client_secret;\n    logg(client_secret, 'client_secret');\n\n    const result = await stripe.confirmCardPayment(client_secret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n      },\n    })\n    logg(result, 'result')\n\n    if (result.error) {\n      logg(result.error.message, 'error message')\n    } else {\n      if (result.paymentIntent.status === 'succeeded') {\n        let response = await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`)\n        logg(response, 'ze3response')\n      } else {\n        logg('something else');\n      }\n    }\n  }\n\n  const { active, account, library, connector, activate, deactivate } = useWeb3React()\n\n  /* useEffect(() => {\n    const fn = async () => {\n      await connect()\n      await myBodies()\n    }\n    fn()\n  }) */\n\n  async function connect() {\n    try {\n      await activate(injected)\n    } catch (ex) {\n      logg(ex, 'could not connect')\n    }\n  }\n\n  async function disconnect() {\n    try {\n      deactivate()\n    } catch (ex) {\n      console.log(ex)\n    }\n  }\n\n  // request access to the user's MetaMask account\n  const requestAccount = async () => {\n    await window.ethereum.request({ method: 'eth_requestAccounts' })\n  }\n\n  const myBodies = async () => {\n    if (window.ethereum) {\n      await requestAccount()\n      if (account) {\n        const provider = new ethers.providers.Web3Provider(window.ethereum)\n        const signer = provider.getSigner()\n        const contract = new ethers.Contract(bodyAddress, bodyNFT.abi, signer)\n        const tokensOfOwner = await contract.tokensOfOwner(account)\n\n        // @TODO: this is only first, I need to support unlimited number of bodies connected to the account.\n        const i = 0\n        const result = await contract.tokenURI(tokensOfOwner[i])\n        request.get(result).then(r => r.data.image).then(r => {\n          setAvatar(r)\n        })\n      }\n    }\n  }\n\n  if (!currentUser) { return null }\n  return <W className=\"MyAccountWidget\" >\n\n    { /* currentUser.profile_photo_url && <Img src={currentUser.profile_photo_url} /> */ }\n    <Img src={avatar || currentUser.profile_photo_url} />\n\n    { currentUser.email ? currentUser.email : <Login /> } &nbsp;\n    [&nbsp;{ typeof currentUser.n_unlocks === 'number' ? currentUser.n_unlocks : '?' } coins&nbsp;]&nbsp; &nbsp;\n    <BuyBtn onClick={() => setPurchaseModalIsOpen(true) }>buy</BuyBtn>\n\n    { /* ethers */ }\n    <div className=\"flex flex-col items-center justify-center\">\n      { active ? <F>\n        <span>Connected with <b>{account}</b></span>\n        <button onClick={disconnect} >Disconnect</button>\n        <button onClick={myBodies} >myBodies</button>\n      </F> : <F>\n        <span>Not connected</span>\n        <button onClick={connect} >Connect to MetaMask</button>\n      </F> }\n    </div>\n\n\n    <Modal isOpen={purchaseModalIsOpen} ariaHideApp={false} style={{  width: '500px' }} >\n      <h1>\n        Purchase this\n        <span onClick={() => {\n          logg('clicking...')\n          setPurchaseModalIsOpen(false)\n        } } >[x]</span>\n      </h1>\n      <form onSubmit={handleSubmit} >\n        <CardElement />\n        <button type=\"submit\" disabled={!stripe} >Pay</button>\n      </form>\n    </Modal>\n\n  </W>\n}\n\n// no props?!\nMyAccountWidget.propTypes = {\n}\n\nconst WrappedMyAccountWidget = (props) => <Elements stripe={stripePromise}><MyAccountWidget {...props} /></Elements>;\n\nexport default WrappedMyAccountWidget\n","/*\n * components / users / index\n */\nimport { Plugins } from '@capacitor/core'\nimport { FacebookLoginResponse } from '@capacitor-community/facebook-login';\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport config from 'config'\nimport { Btn, C, logg, request, TwofoldContext, useApi, } from \"$shared\"\n\nexport { default as Account } from \"./Account\"\n\nconst { FacebookLogin } = Plugins\n\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\nexport const FbLogin = (props) => {\n  const api = useApi()\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n\n  const doFbLogin = async () => {\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>FB Login</Btn>\n}\n\nexport { default as LoginModal } from \"./LoginModal\"\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(TwofoldContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser(null)\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n\nexport const PasswordLogin = (props) => {\n  const api = useApi()\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(TwofoldContext)\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const doPasswordLogin = async (email, password) => {\n    request.post(`${config.apiOrigin}${api.loginPath}`, { email, password }).then((r) => r.data).then((resp) => {\n      setCurrentUser(resp)\n      localStorage.setItem('jwt_token', resp.jwt_token)\n      localStorage.setItem('current_user', JSON.stringify(resp))\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(null)\n    })\n  }\n\n  return <F>\n    <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') { doPasswordLogin(email, password) }\n      }}\n    /><br />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n  </F>\n}\n\n\nexport { default as MyAccountWidget } from \"./MyAccountWidget\";\n","\n/*\n *  $shared / AppMock\n */\n\nimport { createMemoryHistory } from 'history'\nimport _Box from '@material-ui/core/Box'\nimport React, { useState } from 'react'\nimport {\n  Link, Switch, Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { logg, TwofoldContext } from \"$shared\"\nimport { LoginModal } from \"$components/users\"\n\nconst AppMock = (props) => {\n  let { currentUser, setCurrentUser } = props\n  const history = createMemoryHistory()\n  history.push(\"/en/cities/travel-to/chicago\") // @TODO: move where appropriate\n\n  const [ itemToUnlock, setItemToUnlock ] = useState({})\n  const [ localCurrentUser, setLocalCurrentUser ] = useState(false)\n  if (!currentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n\n  return <Router history={history} >\n    <TwofoldContext.Provider value={{\n      // bottomDrawerOpen, setBottomDrawerOpen,\n      currentUser, setCurrentUser,\n      itemToUnlock, setItemToUnlock,\n      // layout, setLayout,\n      // showUrl, setShowUrl,\n      // zoom, setZoom,\n    }} >\n      { props.children }\n      <LoginModal />\n    </TwofoldContext.Provider>\n  </Router>\n}\n\nexport default AppMock\n","\nconst AppRouter = {\n\n  cityVenuesPath: (slug) => `/en/cities/travel-to/${slug}/venues`,\n  cityPath: (slug) => `/en/cities/travel-to/${slug}`,\n\n};\n\nexport default AppRouter;\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport {\n  C, CollapsibleContext,\n  logg,\n  S,\n  WBordered, WBorderedItem,\n} from '$shared'\n\nconst Gt = () => <span>&nbsp;&gt;&nbsp;&nbsp;</span>\n\nconst Inner = styled.div`\n  // border: 2px solid red;\n  // max-height: 100vh;\n\n  clear: left;\n`;\n\nconst Lt = () => <span>&nbsp;&lt;&nbsp;&nbsp;</span>\n\nconst Label = styled.div`\n  display: flex;\n  margin-bottom: ${p => p.theme.borderWidth};\n`;\n\nconst WTransparent = styled.div`\n  background: #dedede;\n\n  margin: 0 0.5 1em .5em;\n  padding: 0 .5em .5em .5em;\n\n`;\nconst W = ({ children, variant, ...props }) => {\n  switch (variant) {\n    case C.variants.bordered:\n      return <WBordered {...props} >{children}</WBordered>\n    default:\n      return <WTransparent {...props} >{children}</WTransparent>\n  }\n}\n\n\n/**\n * Collapsible\n *\n * @TODO: test-driven _vp_ 2021-10-29\n */\nconst Collapsible = ({ children, ...props }) => {\n  // logg(props, 'Collapsible')\n  const { className='', config, variant, } = props\n\n  const ctx = useContext(CollapsibleContext)\n  if (!ctx) { return null }\n  const { collapsibles, setCollapsibles } = ctx\n\n  const doToggle = () => setCollapsibles({ ...collapsibles, [props.slug]: !collapsibles[props.slug] })\n\n  const collapsible = typeof config === 'undefined' ? true\n    : typeof config.collapsible === 'undefined' ? true\n      : config.collapsible\n  const folded = collapsible ? !!collapsibles[props.slug] : false\n\n  return <W variant={variant} className={`Collapsible ${className}`} >\n    { props.label &&  collapsible && <Label onClick={doToggle} >{folded ? <Lt /> : <Gt />} {props.label}</Label> }\n    { props.label && !collapsible && <Label >{props.label}</Label> }\n    { !folded && <Inner>{ children }</Inner> }\n  </W>\n}\n\nCollapsible.propTypes = {\n  className: PropTypes.string,\n  config: PropTypes.shape({\n    collapsible: PropTypes.bool,\n  }),\n  label: PropTypes.string,\n  slug: PropTypes.string.isRequired,\n  variant: PropTypes.string,\n}\nexport default Collapsible\n","import axios from \"axios\";\nimport config from \"config\";\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings);","\n/**\n * Style Constants\n */\nconst S = {\n\n  colors: {\n    background: '#dedede',\n    blue: '#6aa3e9',\n    darkGrey: '#605d5d',\n    lightGrey: '#988b8b',\n    red: 'red',\n  },\n\n\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  thinBorder: '2px solid black',\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n\n}\n\nexport default S","import { useLayoutEffect, useState, } from 'react'\n\nconst useWindowSize = () => {\n  const [size, setSize] = useState([0, 0]);\n  useLayoutEffect(() => {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n    window.addEventListener('resize', updateSize);\n    updateSize();\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n  return size;\n}\n\nexport default useWindowSize\n","/*\n *  $shared / index\n */\n// alphabetized\nimport { arrowBack } from 'ionicons/icons'\nimport { IonIcon } from '@ionic/react'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport React, { useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport C from \"./C\"\n\n/* A */\nexport { default as useApi } from \"./Api\"\nexport { default as AppMock } from \"./AppMock\"\nexport { default as AppRouter } from \"./AppRouter\"\n\n/* B */\n\n/**\n * Back Button\n */\nconst BackIcon = styled(IonIcon)`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n\n  padding: .3em 1em;\n  cursor: pointer;\n`;\n\n\n/* C */\n\nexport { C }\n\n/**\n * A Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\nexport { default as Collapsible } from \"./Collapsible\"\nexport const CollapsibleContext = React.createContext({})\n/**\n * @TODO: test-driven\n */\nexport const CollapsibleContextProvider = ({ children, ...props }) => {\n  // logg(props, 'CollapsibleContextProvider')\n\n  let defaultCollapsibles = {\n    [C.collapsible.descr]: true,\n  }\n  let tmp\n  if (tmp = localStorage.getItem(C.collapsibles)) {\n    try {\n      defaultCollapsibles = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'Could not parse collapsibles from localStorage')\n    }\n  }\n  const [ collapsibles, _setCollapsibles ] = useState(defaultCollapsibles)\n  const setCollapsibles = (m) => {\n    localStorage.setItem(C.collapsibles, JSON.stringify(m))\n    _setCollapsibles(m)\n  }\n\n  return <CollapsibleContext.Provider value={{\n    collapsibles, setCollapsibles,\n  }} >{ children }</CollapsibleContext.Provider>\n}\n\n/* D */\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport const TwofoldContext = React.createContext({})\nexport const TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    currentUser, setCurrentUser,\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n  } = props\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    logg(which, 'setting')\n\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser, // @TODO: move this to an AppWrapper context\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    zoom, setZoom,\n  }} >{ children }</TwofoldContext.Provider>\n}\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: white;\n  padding: .5em;\n\n  // display: flex;\n  // flex-wrap: wrap;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: white;\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","import { IonPage, IonLoading, IonContent, IonIcon as _IonIcon } from '@ionic/react';\nimport { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons';\nimport React, { Fragment as F, useEffect, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from 'styled-components'\n\nimport { useApi, AppRouter,\n  logg, // eslint-disable-line no-unused-vars\n  Wrapper } from \"$shared\"\nimport \"./cities.scss\"\n\nconst Counts = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  margin: 1em 0px;\n`;\n\nconst Count = styled.div`\n  // border: 1px solid red;\n\n  display: flex;\n  justify-content: center;\n\n  width: 50%;\n  text-align: center;\n  position: relative;\n  padding: 0.1em;\n`;\n\nconst IonIcon = styled(_IonIcon)`\n  font-size: 2em;\n  color: ${p=>p.theme.darkGrey};\n`;\n\nconst Number = styled.div`\n  // border: 1px solid green;\n\n  padding: 0.5em;\n\n  color: ${p=>p.theme.lightGrey};\n  font-size: 0.9em;\n  font-weight: 600;\n`;\n\nconst Cities = (props) => {\n  const [cities, setCities] = useState([]);\n  const [filteredCities, setFilteredCities] = useState([]);\n  const [showLoading, setShowLoading] = useState(false);\n  const api = useApi()\n  const history = useHistory()\n\n  useEffect(() => {\n    setShowLoading(true);\n    api.getCities().then(res => {\n      setShowLoading(false);\n      setFilteredCities(res);\n      setCities(res);\n    });\n  }, [])\n\n  const filterHandler = (ev) => {\n    let filteredCities = cities.filter(city => {\n      return city.name.toLowerCase().indexOf(ev.target.value.trim().toLowerCase()) > -1;\n    });\n    setFilteredCities(filteredCities);\n  }\n\n  return <F>\n    <Wrapper className='cities' >\n      <h1 className=\"heading\" >Cities</h1>\n\n      <div className=\"filter-section\">\n        <input className=\"filter-input\" onChange={filterHandler} />\n        <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n      </div>\n\n      { /* @TODO: re-add! */ }\n      { /* <div className=\"bookmark-section\">\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={() => { }} checked />\n          <span className=\"slider round\"></span>\n        </label>\n        <span className=\"bookmark-text\">Show only bookmarked</span>\n      </div> */ }\n\n      <div className=\"container\">\n        { filteredCities.map((city, i) => <div key={i} className=\"cities\" onClick={() => history.push(AppRouter.cityPath(city.slug)) } >\n            <div className=\"img-section\">\n              <span className=\"bookmark\" >\n                <IonIcon className=\"bookmark-icon\" icon={bookmark}></IonIcon>\n              </span>\n              <img className=\"city-img\" src={city.photo} />\n              <span className=\"city-title\">{city.name}</span>\n            </div>\n            <Counts>\n              <Count>\n                { /* @TODO: wire in theme provider */ }\n                <Number >{city.n_reports}</Number>\n                <IonIcon icon={newspaperOutline}></IonIcon>\n\n              </Count>\n              <Count>\n\n                <Number >{city.n_galleries}</Number>\n                <IonIcon icon={image}></IonIcon>\n              </Count>\n              <Count>\n\n                <Number >{city.n_videos}</Number>\n                <IonIcon icon={videocam}></IonIcon>\n              </Count>\n            </Counts>\n          </div>\n        ) }\n      </div>\n      &nbsp;\n    </Wrapper>\n\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n  </F>\n}\n\nexport default Cities;\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { NewsitemContainer } from './'\nimport { Metaline } from \"$components/application\"\nimport { logg } from \"$shared\"\n\nimport \"./newsitems.scss\"\n\n\nconst Image = styled.div`\n  position: relative;\n  padding-top: 100%;\n  overflow: hidden;\n  z-index: 10;\n  background-position: center;\n  background-size: cover;\n  background-repeat: no-repeat;\n\n  width: 100px;\n  height: 100px;\n`;\n\nconst Image2 = styled.div`\n`;\n\nconst Images = styled.div`\n  position: relative;\n`;\n\nconst ImageLarge = styled.img`\n  width: 200px;\n`;\n\nconst ImageThumb1 = styled.img`\n  position: absolute;\n  left: 200px;\n  top: 0;\n`;\n\nconst ImageThumb2 = styled.img`\n  position: absolute;\n  left: 200px;\n  top: 100px;\n`;\n\n/**\n * TDD\n */\nconst NewsitemGallery = (props) => {\n  // logg(props, 'NewsitemGallery')\n  const { item, variant } = props\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <Images >\n      { item.photos[0] && <ImageLarge src={item.photos[0].thumb_url} /> }\n      { item.photos[1] && <ImageThumb1 src={item.photos[1].thumb_url} /> }\n      { item.photos[2] && <ImageThumb2 src={item.photos[2].thumb_url} /> }\n    </Images>\n  </NewsitemContainer>\n}\n\nNewsitemGallery.propTypes = {\n  item: PropTypes.shape({\n    photos: PropTypes.array.isRequired,\n  }),\n  variant: PropTypes.string,\n}\nexport default NewsitemGallery\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon, NewsitemContainer } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport { Api, C, logg, request, TwofoldContext } from \"$shared\"\n\nimport \"./newsitems.scss\"\n\n\nconst NewsitemReport = (props) => {\n  // logg(props, \"NewsitemReport\");\n  const { item, variant, } = props\n  return (<NewsitemContainer item={item} variant={variant} />)\n}\n\nNewsitemReport.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemReport\n\n","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { NewsitemContainer } from \"./\"\nimport \"./newsitems.scss\"\n\n\nconst NewsitemVideo = (props) => {\n  logg(props, 'NewsitemVideo')\n  const { item, variant } = props\n\n  return <NewsitemContainer item={item} variant={variant} >\n    <div className=\"image-section\">\n      { item.youtube_id ?\n          <iframe className=\"iframe\" width=\"100%\" height=\"315\" src={`https://www.youtube.com/embed/${item.youtube_id}`} frameBorder=\"0\" allow=\"autoplay; encrypted-media\" allowFullScreen></iframe>\n          : <video width=\"100%\" preload=\"metadata\" height=\"auto\" controls>\n            <source src={item.url} type=\"video/mp4\" />\n          </video> }\n    </div>\n  </NewsitemContainer>\n}\n\nNewsitemVideo.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemVideo","\nimport PropTypes from 'prop-types'\nimport React from \"react\"\nimport styled from 'styled-components'\n\nimport { GenericNewsitem } from \"./\"\nimport NewsitemGallery from \"$components/newsitems/NewsitemGallery\"\nimport NewsitemReport from \"$components/newsitems/NewsitemReport\"\nimport NewsitemVideo from \"$components/newsitems/NewsitemVideo\"\nimport { Api, C, logg } from \"$shared\"\n\nimport \"./newsitems.scss\"\n\nconst ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nconst W = styled.div`\n  // border: 2px solid yellow;\n  margin: ${p => p.variant === C.variants.bordered ? '.5em' : 0};\n  margin-top: 0;\n  margin-bottom: 0;\n`;\n\nconst Newsitems = (props) => {\n  // logg(props, 'Newsitems')\n  const { newsitems, variant } = props\n\n  if (!newsitems || !newsitems.length) { return <div>No Newsitems</div> }\n\n  return (\n    <W {...{ variant }} >\n      { newsitems.map((newsitem, idx) => {\n        const premium_tier = newsitem.premium_tier || 0\n        const icon = ICONS[premium_tier]\n\n        return (\n          <div key={idx} className={`items premium-${premium_tier}`}>\n            { newsitem.item_type === C.item_types.gallery && <NewsitemGallery item={newsitem} variant={variant} /> }\n            { newsitem.item_type === C.item_types.report  && <NewsitemReport  item={newsitem} variant={variant} /> }\n            { newsitem.item_type === C.item_types.video   && <NewsitemVideo   item={newsitem} variant={variant} /> }\n            { !newsitem.item_type && <GenericNewsitem item={newsitem} /> }\n          </div>\n        )\n      }) }\n    </W>\n  )\n}\n\nNewsitems.propTypes = {\n  variant: PropTypes.string,\n}\nexport default Newsitems\n","\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useEffect, useContext, useState } from \"react\"\n\nimport { useHistory } from \"react-router-dom\"\nimport styled from 'styled-components'\n\nimport { ItemIcon } from \"./\"\nimport { Metaline, } from \"$components/application\"\nimport {\n  C, Card,\n  inflector,\n  logg,\n  request,\n  TwofoldContext,\n  WidgetContainer,\n} from \"$shared\"\n\n// alphabetized\n\nconst Col = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  margin-left: 0.5em;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  align-items: flex-start;\n`;\n\nconst Title = styled.h2`\n  margin-top: 0;\n`;\n\nconst W = (props) => {\n  const { children, navigateToItem, variant } = props\n  // @TODO: better management of navigateToItem\n\n  switch (variant) {\n    case C.variants.bordered:\n      return <WidgetContainer {...props} onClick={navigateToItem} cursor=\"pointer\" >{ children }</WidgetContainer>\n    default:\n      return <Card boxShadow={2} {...props} onClick={navigateToItem} cursor=\"pointer\" ></Card>\n  }\n}\n\n/**\n * NewsitemContainer\n */\nconst NewsitemContainer = ({ children, ...props }) => {\n  // logg(props, 'NewsitemContainer')\n  const { item, variant } = props\n  const { item_type, slug } = item\n\n  const history = useHistory()\n\n  const {\n    itemToUnlock, setItemToUnlock,\n    layout,\n    showItem, setShowItem,\n  } = useContext(TwofoldContext)\n\n  const navigateToItem = () => {\n    logg('navigating')\n\n    if (item.is_premium && !item.is_purchased) {\n      setItemToUnlock(item)\n    } else {\n      if (layout === C.layout_mapui) {\n        setShowItem(item)\n      } else {\n        history.push(`/en/${inflector.tableize(item_type)}/show/${slug}`)\n      }\n    }\n  }\n\n  return <W {...{ navigateToItem, variant }} >\n    { children }\n    <Row>\n      <ItemIcon {...item} />\n      <Col>\n        <Title>{item.name}</Title>\n        <Metaline {...item} />\n      </Col>\n    </Row>\n    <p className=\"subhead\" dangerouslySetInnerHTML={{ __html: item.subhead }} />\n  </W>\n}\n\nNewsitemContainer.propTypes = {\n  item: PropTypes.object.isRequired,\n  variant: PropTypes.string,\n}\nexport default NewsitemContainer\n","\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport styled from 'styled-components'\n\nimport { C, logg } from \"$shared\"\n\nconst W = styled.div`\n  padding: 10px;\n  width: 100px;\n  height: 100px;\n\n  box-sizing: border-box;\n`;\n\n/**\n * Displays the appropriate icon.\n *\n * @param [Boolean] props.isPurchased\n * @param [Number] props.premiumTier\n * @param [String] props.kind\n */\n export const ItemIcon = (props) => {\n  // logg(props, \"ItemIcon\")\n  const { is_purchased, item_type, premium_tier } = props\n\n  if (is_purchased) {\n    return <img className=\"icon\" src=\"/assets/icons/glasses.png\" alt='' />\n  }\n  if (premium_tier > 0) {\n    return <img className=\"icon\" src=\"/assets/icons/gem.png\" alt='' />\n  }\n  switch (item_type) {\n    case C.item_types.gallery:\n      return <W><img className=\"icon\" src=\"/assets/icons/gallery.png\" alt='' /></W>\n    case C.item_types.report:\n      return <W><img className=\"icon\" src=\"/assets/icons/report.png\" alt='' /></W>\n    case C.item_types.video:\n      return <W><img className=\"icon\" src=\"/assets/newsfeed/video_icon.svg\" alt='' /></W>\n    default:\n      return <W>[unknown kind]</W>\n  }\n}\n\nItemIcon.propTypes = {\n  is_purchased: PropTypes.bool, // .isRequired,\n  item_type: PropTypes.string.isRequired,\n  premium_tier: PropTypes.number,\n}\nexport default ItemIcon\n","/*\n * $components / newsitems / index.jsx\n */\nimport React, { Fragment as F, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { Box, inflector, logg } from \"$shared\"\n\n/* G */\n\nexport const GenericNewsitem = (props) => {\n  // logg(props, 'GenericNewsitem')\n  const { item } = props\n  return <div dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n/* N */\nexport { default as NewsitemGallery } from \"./NewsitemGallery\"\nexport { default as NewsitemReport } from \"./NewsitemReport\"\nexport { default as Newsitems } from \"./Newsitems\"\nexport { default as NewsitemContainer } from \"./NewsitemContainer\"\n\n\n\n/* I */\nexport const ICONS = {\n  1: \"/assets/newsfeed/sunglass.png\",\n  2: \"/assets/newsfeed/gem_premium.png\"\n}\n\nexport { default as ItemIcon } from \"./ItemIcon\"\n\n","import { funnel, bookmark, newspaperOutline, image, videocam } from 'ionicons/icons'\nimport { IonPage, IonContent, IonButton, IonImg, IonIcon } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { logg } from \"$shared\"\nimport { Rating } from \"$components/application\"\nimport \"./venues.scss\"\n\nconst Address = styled.p`\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: ${p => p.theme.darkGrey };\n  font-size: 14px;\n`;\n\nconst Col = styled.div``;\n\n// right arrow container\nconst _Ra = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\nconst RightArrow = () => <_Ra><img className=\"forward-arrow\" src=\"/assets/16x16/arrow-right.png\" /></_Ra>\n\nconst Row = styled.div`\n  display: flex;\n`;\n\nconst Title = styled.div`\n  font-size: 1.5em;\n`;\n\nconst Venue = styled.div`\n  width: 100vw;\n  padding: 1em;\n  margin-bottom: 0.5em;\n  border-bottom: 1px solid #e3d3d3;\n  box-shadow: 0px 1px 5px 1px #b3aeae;\n  background-color: white;\n  position: relative;\n\n  display: flex;\n  justify-content: space-between;\n\n  img.thumb {\n    border-radius: 10px;\n  }\n\n  > div {\n    // border: 1px solid red;\n  }\n`;\n\nconst Venues = (props) => {\n  logg(props, 'Venues')\n\n  const defaultRating = 3.5\n  const [filteredVenues, setFilteredVenues] = useState(props.venues)\n\n  function filterHandler(ev) {\n    let venues = props.venues.filter(venue => {\n      return venue.name.toLowerCase().includes(ev.target.value.toLowerCase())\n    })\n    setFilteredVenues(venues)\n  }\n\n  return (\n    <div className=\"venues-section\">\n      <div>\n        <div className=\"filter-section\">\n          <input className=\"filter-input\" onChange={filterHandler} />\n          <IonIcon className=\"filter-icon\" icon={funnel}></IonIcon>\n        </div>\n      </div>\n      <div className=\"container\">\n\n        { filteredVenues.map((venue, idx) => <Venue key={idx} >\n          <Row>\n            <Col><img style={{ paddingRight: '1em' }} className='thumb' src={venue.photo} /></Col>\n            <Col>\n              <Title>{venue.name}</Title>\n              <div className=\"rating-section\">\n                <Rating rate={defaultRating}></Rating>\n                <span className=\"reviews\">5 reviews</span>\n              </div>\n              <div className=\"tags-section\">\n                { venue.tags.map((tag, idx) => <span key={idx} className=\"tags\">{tag.name}</span> )}\n              </div>\n              <p className=\"description\" dangerouslySetInnerHTML={{ __html: venue.subhead }}></p>\n              { venue.address && <Address>{venue.address}</Address> }\n            </Col>\n\n          </Row>\n          <RightArrow />\n        </Venue> )}\n\n      </div>\n    </div>\n  )\n}\n\nVenues.propTypes = {\n  venues: PropTypes.array.isRequired,\n}\nexport default Venues\n","import React, { useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react'\nimport { pin, newspaperOutline, image, videocam } from 'ionicons/icons'\n\nimport { AppRouter, useApi, logg, Wrapper } from \"$shared\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { Venues } from \"$components/venues\"\nimport \"./cities.scss\"\n\nconst CitiesShow = (props) => {\n  logg(props, 'CitiesShow')\n  const { match } = props\n\n  const api = useApi()\n  const history = useHistory()\n  const thisPath = AppRouter.cityPath(match.params.name)\n\n  const location = useLocation()\n\n  const [city, setCity] = useState(null)\n  const [showLoading, setShowLoading] = useState(false)\n\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    setShowLoading(true)\n    api.getCity(match.params.name).then(res => {\n      if (mountedRef.current) {\n        setCity(res.data.city)\n        setShowLoading(false)\n      }\n    })\n    return () => mountedRef.current = false\n  }, [match.params.name])\n\n  // @TODO: remove this!\n  function changeMenuHandler(menu) {\n    // history.push(`${match.url}/${menu}`);\n  }\n\n  return <Wrapper>\n\n    { city && <div className='wrapper'>\n      <div className='city-show'>\n\n        <header style={{ backgroundImage: `url(${city.hero_img}}`, backgroundSize: \"contain\" }}></header>\n\n        <section className=\"section-one\">\n          <IonIcon icon={pin} className=\"location\"></IonIcon>\n          <h1 className=\"city-name\">{city.name}</h1>\n          <div className=\"status\">\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={newspaperOutline}></IonIcon>\n              <span className=\"numbers\">{city.n_reports}</span>\n            </div>\n            <div className=\"status-grid\">\n              <IonIcon className=\"info-icon\" icon={image}></IonIcon>\n              <span className=\"numbers\">{city.n_galleries}</span>\n            </div>\n            <div className=\"status-grid mid\">\n              <IonIcon className=\"info-icon\" icon={videocam}></IonIcon>\n              <span className=\"numbers \">{city.n_videos}</span>\n            </div>\n          </div>\n        </section>\n\n        { /* @TODO: re-add tags here! */ }\n        { /* city.tags && <section className=\"tags-section\">\n          <span className=\"btn delete-btn\" >\n            <IonIcon name=\"close\"> </IonIcon> deselect all\n          </span>\n          { city.tags.map((tag, i) => <span className=\"btn\" key={i} >{tag.name}</span>) }\n        </section> */ }\n\n        <section className=\"section-three\">\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityPath(match.params.name))} >\n            <img src=\"/assets/newsfeed-icon.svg\" alt=\"Newsfeed\" />\n            <p className={`${location.pathname == thisPath ? \"selected\" : \"\"} menu-item`}>Newsfeed</p>\n          </div>\n          <div className=\"menu-option\" onClick={() => history.push(AppRouter.cityVenuesPath(match.params.name))} >\n            <img src=\"/assets/venue-icon.svg\" alt=\"Venues\" />\n            <p className={`${location.pathname.includes(\"venues\") ? \"selected\" : \"\"} menu-item`}>Venues</p>\n          </div>\n        </section>\n\n\n        <Switch>\n          <Route exact path={`${match.url}/venues`} render={() => <Venues    venues={city.venues} />} />\n          <Route exact path={match.url}             render={() => <Newsitems newsitems={city.newsitems} /> } />\n        </Switch>\n\n\n      </div>\n    </div>}\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n\n    <br /><br /><br />\n  </Wrapper>\n}\n\nexport default CitiesShow\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\n\nimport { C, logg, request, TwofoldContext, BackBtn } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport \"./galleries.scss\"\n\nconst GalleriesShow = (props) => {\n  logg(props, 'GalleriesShow')\n  const { match } = props\n\n  const [showLoading, setShowLoading] = useState(false) // @TODO: hmm could it be moved to TwofoldContext ?\n  const [gallery, setGallery] = useState({})\n\n  const mountedRef = useRef('init')\n\n  const {\n    currentUser, setCurrentUser,\n    itemToUnlock, setItemToUnlock,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(TwofoldContext)\n\n  const getGallery = async () => {\n    const token = localStorage.getItem(C.jwt_token)\n    await request.get(`/api/galleries/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (!mountedRef.current) { return }\n      const gallery = res.data.gallery\n      if (gallery.is_premium && !gallery.is_purchased) {\n        setItemToUnlock(gallery)\n      } else {\n        setGallery(res.data.gallery)\n      }\n    })\n  }\n\n  useEffect(() => {\n    getGallery()\n    return () => {\n      mountedRef.current = null\n    }\n  }, [gallery.id, itemToUnlock.id] )\n\n  return (<F>\n\n    { <div className=\"gallery-show\">\n      <div className='narrow'>\n        <h1 className=\"heading\">\n          <BackBtn />\n          <img src=\"/assets/newsfeed/photos_icon.png\" />\n          <span className=\"title\">{gallery.name}</span>\n        </h1>\n        <Metaline {...gallery} />\n\n        <div className=\"thumbs\">\n          { gallery.photos && gallery.photos.map((ph, i) =>\n            <div className='card' key={i}>\n              <div className='card-inner'>\n                <IonImg src={ph.thumb_url}></IonImg>\n              </div>\n            </div>\n          ) }\n        </div>\n        <div dangerouslySetInnerHTML={{ __html: gallery.description }}></div>\n      </div>\n      <div className=\"full-img-section\">\n        { gallery.photos && gallery.photos.map((ph, i) =>\n          <div className='item' key={i}>\n            <img src={ph.large_url} />\n          </div>\n        ) }\n      </div>\n    </div>}\n\n  </F>)\n}\n\nexport default GalleriesShow","import React, { useEffect, useState } from \"react\";\nimport { IonLoading } from \"@ionic/react\";\n\nimport request from \"$shared/request\";\nimport { logg } from \"$shared\";\nimport { Galleries } from \"./\";\nimport { NewsitemGallery } from \"$components/newsitems\";\n\nconst MyGalleries = (props) => {\n  const [galleries, setGalleries] = useState(null);\n  const [showLoading, setShowLoading] = useState(false);\n\n  useEffect(() => {\n    setShowLoading(true);\n    const token = localStorage.getItem(\"jwtToken\");\n    request.get(`/api/my/galleries`, { params: { jwt_token: token } }).then(r => {\n      logg(r.data, 'MyGalleries data')\n      setGalleries(r.data);\n      setShowLoading(false);\n    })\n  }, []);\n\n  return (<>\n    <IonLoading\n      isOpen={showLoading}\n      onDidDismiss={() => setShowLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n    { galleries && galleries.length && galleries.map((g) => <NewsitemGallery key={g.id} data={g} /> ) }\n  </>);\n}\n\nexport default MyGalleries;","\nimport {\n  IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonToggle, IonList, IonItem,\n  IonLabel, IonItemDivider,\n} from '@ionic/react'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext } from 'react'\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { C, logg, request, S, TwofoldContext } from \"$shared\"\nimport { MenuLeft } from \"$components/application\"\n\n/* B */\n\n// One breadcrumb\nconst B = styled.div`\n  padding: 0.5em;\n`;\n\n// The divider\nconst B1 = styled.div`\n  padding: 0.5em 0;\n`;\n\n/* D */\nconst L = styled.div`\n  margin-top: .5em;\n`;\nconst WDayNight = styled.div`\n  // border: 1px solid green;\n\n  display: flex;\n\n  margin: 0 1em;\n`;\nconst DayNightToggle = (props) => {\n  return <WDayNight>\n    <L>Day</L>\n    <IonToggle value=\"DayNight\" />\n    <L>Night</L>\n  </WDayNight>\n}\n\n\n\n/* W */\n\nconst W = styled.div`\n  border: ${p=>p.debug?'1':'0'}px solid cyan;\n\n  display: flex;\n  align-items: center;\n  z-index: 1;\n\n  height: ${p => p.theme.breadcrumbsHeight};\n`;\n\nconst WBreadcrumbs = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-grow: 1;\n`;\n\n\n/**\n * Breadcrumbs\n */\nconst Breadcrumbs = (props) => {\n  // logg(props, 'Breakcrumbs')\n  const { breadcrumbs=[] } = props\n  const { layout } = useContext(TwofoldContext)\n  const history = useHistory()\n\n  const out = []\n  breadcrumbs.map((b, idx) => {\n    if (idx+1 === props.breadcrumbs.length) {\n      // last one\n      out.push(<B key={idx} >{b.name}</B>)\n    } else {\n      out.push(<B\n        key={idx}\n        style={{ textDecoration: 'underline' }}\n        onClick={() => history.push(`/en/locations/show/${b.slug}`) }\n      >{b.name}</B>)\n      out.push(<B1 key={`${idx}-divider`} >&gt;</B1>)\n    }\n  })\n\n  return <W debug={config.debug} className=\"Breadcrumbs\" >\n    { layout === C.layout_mapui && <MenuLeft variant={C.variants.inline} /> }\n    <WBreadcrumbs>{ out }</WBreadcrumbs>\n    <DayNightToggle />\n  </W>\n}\n\nBreadcrumbs.propTypes = {\n  breadcrumbs: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      slug: PropTypes.string.isRequired,\n    }),\n  ),\n}\nexport default Breadcrumbs\n","\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\n\nimport config from \"config\"\nimport { useApi, Card as Box, logg, request } from \"$shared\"\n\nconst W = styled.div`\n  padding: 2em 0;\n`\n\n/**\n * Default\n */\nconst ReportsShow = (props) => {\n  // logg(props, \"ReportsShow\")\n\n  let [ item, setItem ] = useState({})\n  let api = useApi()\n\n  // @TODO: refactor\n  const currentUser = JSON.parse(localStorage.getItem(\"current_user\")) || {};\n\n  // @TODO: not logged in and has access\n  const getReport = async () => {\n    logg(null, 'getting report...')\n\n    request.get(api.reportsGet(props.match.params.slug)).then(r => r.data).then(data => {\n      logg(data, 'got report')\n      setItem(data.report);\n    });\n  };\n\n  useEffect(() => {\n    getReport();\n  }, []);\n\n  // @TODO: logged in and no access\n\n  // @TODO: logged in and access\n\n  return (<W>\n    <Box boxShadow={2}>\n      <h1>Report {item.name}</h1>\n      <div className=\"description\" dangerouslySetInnerHTML={{ __html: item.description }} />\n    </Box>\n  </W>)\n}\n\n// @TODO: wrap in login HOC\nexport default ReportsShow\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { C, logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport { ReportsShow } from \"$components/reports\"\nimport { Newsitems } from \"$components/newsitems\"\n\n/*\n * @TODO: move to $components/application\n */\nconst ItemModal = (props) => {\n  logg(props, 'ItemModal')\n  const { item } = props\n\n  const { showItem, setShowItem } = useContext(TwofoldContext)\n\n  return <Modal isOpen={!!showItem} >\n    <h1 onClick={() => setShowItem(false)} >[x]</h1>\n    { item.item_type === C.item_types.report && <ReportsShow match={{ params: { slug: item.reportname } }} /> }\n    { item.item_type === C.item_types.gallery && <GalleriesShow match={{ params: { slug: item.slug } }} /> }\n  </Modal>\n}\n\nexport default ItemModal\n","import {\n\tEuler, EventDispatcher, Vector3,\n} from \"three\"\n\nconst _euler = new Euler( 0, 0, 0, 'YXZ' );\nconst _vector = new Vector3();\n\nconst _changeEvent = { type: 'change' };\nconst _lockEvent = { type: 'lock' };\nconst _unlockEvent = { type: 'unlock' };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n\n\tconstructor( camera, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\t\tdomElement = document.body;\n\n\t\t}\n\n\t\tthis.domElement = domElement;\n\t\tthis.isLocked = false;\n\n\t\t// Set to constrain the pitch of the camera\n\t\t// Range is 0 to Math.PI radians\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\tconst scope = this;\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.isLocked === false ) return;\n\n\t\t\tconst movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\t\tconst movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\t\t_euler.setFromQuaternion( camera.quaternion );\n\n\t\t\t_euler.y -= movementX * 0.002;\n\t\t\t_euler.x -= movementY * 0.002;\n\n\t\t\t_euler.x = Math.max( _PI_2 - scope.maxPolarAngle, Math.min( _PI_2 - scope.minPolarAngle, _euler.x ) );\n\n\t\t\tcamera.quaternion.setFromEuler( _euler );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t}\n\n\t\tfunction onPointerlockChange() {\n\n\t\t\tif ( scope.domElement.ownerDocument.pointerLockElement === scope.domElement ) {\n\n\t\t\t\tscope.dispatchEvent( _lockEvent );\n\n\t\t\t\tscope.isLocked = true;\n\n\t\t\t} else {\n\n\t\t\t\tscope.dispatchEvent( _unlockEvent );\n\n\t\t\t\tscope.isLocked = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerlockError() {\n\n\t\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t\t}\n\n\t\tthis.connect = function () {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.disconnect = function () {\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.disconnect();\n\n\t\t};\n\n\t\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\t\treturn camera;\n\n\t\t};\n\n\t\tthis.getDirection = function () {\n\n\t\t\tconst direction = new Vector3( 0, 0, - 1 );\n\n\t\t\treturn function ( v ) {\n\n\t\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.moveForward = function ( distance ) {\n\n\t\t\t// move forward parallel to the xz-plane\n\t\t\t// assumes camera.up is y-up\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\t_vector.crossVectors( camera.up, _vector );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.moveRight = function ( distance ) {\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.lock = function () {\n\n\t\t\tthis.domElement.requestPointerLock();\n\n\t\t};\n\n\t\tthis.unlock = function () {\n\n\t\t\tscope.domElement.ownerDocument.exitPointerLock();\n\n\t\t};\n\n\t\tthis.connect();\n\n\t}\n\n}\n\nexport { PointerLockControls };","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  height: calc(100% - ${p => p.breadcrumbsHeight});\n`;\n\n/**\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\n\n\nconst Loc = (props) => {\n  let camera, controls,\n    object, objects = [],\n    raycaster, renderer,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n    /*\n    // PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n    // fov  Camera frustum vertical field of view.\n    // aspect  Camera frustum aspect ratio.\n    // near  Camera frustum near plane.\n    // far  Camera frustum far plane.\n    */\n    // camera = new THREE.PerspectiveCamera( 75, 2, 1, 100 )\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 300 )\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    // floor\n    // @TODO: it's not aligned to parcels the way I want\n    let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n\n    // vertex displacement\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      vertex.fromBufferAttribute( position, i )\n      vertex.x += Math.random() * 20 - 10\n      vertex.y += Math.random() * 2\n      vertex.z += Math.random() * 20 - 10\n      position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    floorGeometry.x = -200\n    floorGeometry.y = -200\n    floorGeometry.z = -200\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n    // objects\n    /*\n    const boxGeometry = new THREE.BoxGeometry( 20, 20, 20 ).toNonIndexed()\n    position = boxGeometry.attributes.position\n    const colorsBox = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsBox.push( color.r, color.g, color.b )\n    }\n    boxGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsBox, 3 ) )\n    for ( let i = 0; i < 500; i ++ ) {\n      const boxMaterial = new THREE.MeshPhongMaterial( { specular: 0xffffff, flatShading: true, vertexColors: true } )\n      boxMaterial.color.setHSL( Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n\n      const box = new THREE.Mesh( boxGeometry, boxMaterial )\n      box.position.x = Math.floor( Math.random() * 20 - 10 ) * 20\n      box.position.y = Math.floor( Math.random() * 20 ) * 20 + 10\n      box.position.z = Math.floor( Math.random() * 20 - 10 ) * 20\n      scene.add( box )\n      objects.push( box )\n    }\n    */\n\n    // load OBJ\n\n    // manager\n\n    // this is specifically for tiny-house-1\n    const loadModel = () => {\n      object.traverse((child) => {\n        if ( child.isMesh ) {\n          child.material.map = texture\n          child.geometry.scale(10, 10, 10)\n        }\n      })\n      object.position.x = 100\n      object.position.y = 10\n      object.position.z = 100\n\n      scene.add( object )\n    }\n    const manager = new THREE.LoadingManager( loadModel )\n    manager.onProgress = function ( item, loaded, total ) {\n      console.log( item, loaded, total )\n    }\n\n    // texture\n\n    const textureLoader = new THREE.TextureLoader( manager )\n    const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n    // model\n\n    // tiny-house-1\n    const loader = new OBJLoader( manager )\n    loader.load( '/assets/scenes/tiny-house-1/tiny-house-1.obj', ( obj ) => {\n      object = obj\n    }, ( xhr ) => {\n      if ( xhr.lengthComputable ) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }, (e) => {\n      logg(e, 'onError')\n    } )\n\n\n    // some delimiters for the first 6 parcels!\n    let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    let cube = new THREE.Mesh( geometry, material )\n    cube.position.x = 0\n    cube.position.y = 5\n    cube.position.z = 0\n    scene.add( cube )\n    const items = [\n      { color: 0xff0000, x: 1, y: 0, z: 0 },\n      { color: 0x00ff00, x: 0, y: 1, z: 0 },\n      { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    ]\n    items.map((item, idx) => {\n      logg(item, 'item')\n      const { color, x, y, z } = item\n      geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n      material = new THREE.MeshBasicMaterial({ color: color })\n      cube = new THREE.Mesh( geometry, material )\n      cube.position.x = x*5\n      cube.position.y = 10+y*5\n      cube.position.z = z*5\n      scene.add( cube )\n    })\n\n    const parcels = [\n      { color: 0xff0000, x: 100, y: 1, z: 100 },\n      { color: 0x00ff00, x: 100, y: 1, z: 320 },\n      { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n      { color: 0x660000, x: -120, y: 1, z: 100 },\n      { color: 0x006600, x: -120, y: 1, z: -120 },\n      { color: 0x000066, x: 100, y: 1, z: -120 },\n    ]\n    parcels.map((item, idx) => {\n      const { color, x, y, z } = item\n      const g = new THREE.BoxGeometry( 200, 2, 200 )\n      const m = new THREE.MeshBasicMaterial({color: color})\n      const p = new THREE.Mesh( g, m )\n      p.position.x = x\n      p.position.y = y\n      p.position.z = z\n      scene.add( p )\n    })\n\n    //\n\n\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    // renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setPixelRatio(1)\n    renderer.setSize( 800, 400 )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n      raycaster.ray.origin.copy( controls.getObject().position )\n      raycaster.ray.origin.y -= 10\n      const intersections = raycaster.intersectObjects( objects, false )\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} />\n  </F>\n}\n\nexport default Loc\n","\nimport React, { Fragment as F, useEffect, useRef } from 'react'\nimport * as THREE from \"three\"\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\"\nimport styled from 'styled-components'\n\nimport { logg, S } from \"$shared\"\nimport { PointerLockControls } from './PointerLockControls'\n\nconst Blocker = styled.div`\n  height: calc(100% - ${p => p.breadcrumbsHeight});\n`;\n\n/**\n * Excellent documentation. From: https://threejs.org/examples/#misc_controls_pointerlock\n * Right now the unit is 1cm, 1/10 of a meter.\n */\n\n\nconst Loc = (props) => {\n  let camera, controls,\n    object, objects = [],\n    raycaster, renderer,\n    scene\n\n  const blockerRef = useRef(null)\n  const instructionsRef = useRef(null)\n  useEffect(() => {\n    init()\n    animate()\n  }, [])\n\n  let moveForward = false\n  let moveBackward = false\n  let moveLeft = false\n  let moveRight = false\n  let canJump = false\n\n  let prevTime = performance.now()\n  const velocity = new THREE.Vector3()\n  const direction = new THREE.Vector3()\n  const vertex = new THREE.Vector3()\n  const color = new THREE.Color()\n\n  function init() {\n    /*\n    // PerspectiveCamera( fov : Number, aspect : Number, near : Number, far : Number )\n    // fov  Camera frustum vertical field of view.\n    // aspect  Camera frustum aspect ratio.\n    // near  Camera frustum near plane.\n    // far  Camera frustum far plane.\n    */\n    // camera = new THREE.PerspectiveCamera( 75, 2, 1, 100 )\n    camera = new THREE.PerspectiveCamera( 75, 2, 1, 300 )\n    camera.position.y = 10\n\n    scene = new THREE.Scene()\n    scene.background = new THREE.Color( 0xffffff )\n    scene.fog = new THREE.Fog( 0xffffff, 0, 750 )\n\n    const light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 )\n    light.position.set( 0.5, 1, 0.75 )\n    scene.add( light )\n\n    controls = new PointerLockControls( camera, document.body )\n\n    blockerRef.current.addEventListener( 'click', function () {\n      logg('locked controls')\n      controls.lock()\n    } )\n\n    controls.addEventListener( 'lock', function () {\n      logg('event #lock')\n      // instructions.style.display = 'none'\n      // blocker.style.display = 'none'\n    } )\n\n    controls.addEventListener( 'unlock', function () {\n      // blocker.style.display = 'block'\n      // instructions.style.display = ''\n    } )\n\n    scene.add( controls.getObject() )\n\n    const onKeyDown = (event) => {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = true\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = true\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = true\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = true\n          break\n        case 'Space':\n          if ( canJump === true ) velocity.y += 350\n          canJump = false\n          break\n      }\n    }\n\n    const onKeyUp = function ( event ) {\n      switch ( event.code ) {\n        case 'ArrowUp':\n        case 'KeyW':\n          moveForward = false\n          break\n        case 'ArrowLeft':\n        case 'KeyA':\n          moveLeft = false\n          break\n        case 'ArrowDown':\n        case 'KeyS':\n          moveBackward = false\n          break\n        case 'ArrowRight':\n        case 'KeyD':\n          moveRight = false\n          break\n      }\n    }\n\n    document.addEventListener( 'keydown', onKeyDown )\n    document.addEventListener( 'keyup', onKeyUp )\n\n    raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 )\n\n    // floor\n    // @TODO: it's not aligned to parcels the way I want\n    let floorGeometry = new THREE.PlaneGeometry( 460, 680, 100, 100 )\n    floorGeometry.rotateX( - Math.PI / 2 )\n\n    // vertex displacement\n    let position = floorGeometry.attributes.position\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      vertex.fromBufferAttribute( position, i )\n      vertex.x += Math.random() * 20 - 10\n      vertex.y += Math.random() * 2\n      vertex.z += Math.random() * 20 - 10\n      position.setXYZ( i, vertex.x, vertex.y, vertex.z )\n    }\n    floorGeometry = floorGeometry.toNonIndexed() // ensure each face has unique vertices\n    floorGeometry.x = -200\n    floorGeometry.y = -200\n    floorGeometry.z = -200\n    position = floorGeometry.attributes.position\n    const colorsFloor = []\n    for ( let i = 0, l = position.count; i < l; i ++ ) {\n      color.setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 )\n      colorsFloor.push( color.r, color.g, color.b )\n    }\n    floorGeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colorsFloor, 3 ) )\n    const floorMaterial = new THREE.MeshBasicMaterial( { vertexColors: true } )\n    const floor = new THREE.Mesh( floorGeometry, floorMaterial )\n    scene.add( floor )\n\n\n\n    const loadModel = () => {\n      object.traverse((child) => {\n        if (child.isMesh) {\n          child.material.map = texture\n          child.geometry.scale(10, 10, 10)\n        }\n      })\n      object.position.x = 100\n      object.position.y = 10\n      object.position.z = 100\n\n      scene.add( object )\n    }\n    const manager = new THREE.LoadingManager( loadModel )\n    manager.onProgress = function ( item, loaded, total ) {\n      console.log( item, loaded, total )\n    }\n\n    // texture\n\n    const textureLoader = new THREE.TextureLoader( manager )\n    const texture = textureLoader.load( 'textures/uv_grid_opengl.jpg' )\n\n    /*\n     * Import obj\n     */\n\n    // The construct\n    const loader = new OBJLoader( manager )\n    loader.load( '/assets/scenes/weird/weird.obj', ( obj ) => {\n      object = obj\n    }, ( xhr ) => {\n      if ( xhr.lengthComputable ) {\n        const percentComplete = xhr.loaded / xhr.total * 100\n        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' )\n      }\n    }, (e) => {\n      logg(e, 'onError')\n    } )\n\n\n    // some delimiters for the first 6 parcels!\n    let geometry = new THREE.BoxGeometry( 10, 10, 10 )\n    let material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n    let cube = new THREE.Mesh( geometry, material )\n    cube.position.x = 0\n    cube.position.y = 5\n    cube.position.z = 0\n    scene.add( cube )\n    const items = [\n      { color: 0xff0000, x: 1, y: 0, z: 0 },\n      { color: 0x00ff00, x: 0, y: 1, z: 0 },\n      { color: 0x0000ff, x: 0, y: 0, z: 1 }\n    ]\n    items.map((item, idx) => {\n      logg(item, 'item')\n      const { color, x, y, z } = item\n      geometry = new THREE.BoxGeometry( 1 + x*10, 1 + y*10, 1 + z*10 )\n      material = new THREE.MeshBasicMaterial({ color: color })\n      cube = new THREE.Mesh( geometry, material )\n      cube.position.x = x*5\n      cube.position.y = 10+y*5\n      cube.position.z = z*5\n      scene.add( cube )\n    })\n\n    const parcels = [\n      { color: 0xff0000, x: 100, y: 1, z: 100 },\n      { color: 0x00ff00, x: 100, y: 1, z: 320 },\n      { color: 0x0000ff, x: -120, y: 1, z: 320 },\n\n      { color: 0x660000, x: -120, y: 1, z: 100 },\n      { color: 0x006600, x: -120, y: 1, z: -120 },\n      { color: 0x000066, x: 100, y: 1, z: -120 },\n    ]\n    parcels.map((item, idx) => {\n      const { color, x, y, z } = item\n      const g = new THREE.BoxGeometry( 200, 2, 200 )\n      const m = new THREE.MeshBasicMaterial({color: color})\n      const p = new THREE.Mesh( g, m )\n      p.position.x = x\n      p.position.y = y\n      p.position.z = z\n      scene.add( p )\n    })\n\n    //\n\n\n    renderer = new THREE.WebGLRenderer({ antialias: true })\n    // renderer.setPixelRatio( window.devicePixelRatio )\n    renderer.setPixelRatio(1)\n    renderer.setSize( 800, 400 )\n    blockerRef.current.appendChild( renderer.domElement )\n    window.addEventListener( 'resize', onWindowResize )\n\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight\n    camera.updateProjectionMatrix()\n    renderer.setSize( window.innerWidth, window.innerHeight )\n  }\n\n  function animate() {\n    requestAnimationFrame( animate )\n    const time = performance.now()\n    if ( controls.isLocked === true ) {\n\n      // collision, herehere\n      objects = [ object ]\n\n      var cameraDirection = controls.getDirection(new THREE.Vector3(0, 0, 0)).clone()\n\n      // hmmm unneeded\n      // let mouse = new THREE.Vector2()\n      // mouse.x = ( cameraDirection.x / window.innerWidth ) * 2 - 1;\n\t    // mouse.y = - ( cameraDirection.y / window.innerHeight ) * 2 + 1;\n\n      /* for standing on things */\n      // raycaster.ray.origin.copy( controls.getObject().position )\n      // raycaster.ray.origin.y -= 10\n\n      raycaster = new THREE.Raycaster( camera.position, cameraDirection )\n      const intersections = raycaster.intersectObjects( objects, true )\n      logg(intersections, 'intersections')\n      if (intersections.length) {\n        if (intersections[0].distance < 5) {\n          moveForward = false\n        }\n      }\n\n      const onObject = intersections.length > 0\n      const delta = ( time - prevTime ) / 1000\n      velocity.x -= velocity.x * 10.0 * delta\n      velocity.z -= velocity.z * 10.0 * delta\n      velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n      direction.z = Number( moveForward ) - Number( moveBackward )\n      direction.x = Number( moveRight ) - Number( moveLeft )\n      direction.normalize(); // this ensures consistent movements in all directions\n      if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta\n      if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta\n      if ( onObject === true ) {\n        velocity.y = Math.max( 0, velocity.y )\n        canJump = true\n      }\n      controls.moveRight( - velocity.x * delta )\n      controls.moveForward( - velocity.z * delta )\n      controls.getObject().position.y += ( velocity.y * delta ); // new behavior\n      if ( controls.getObject().position.y < 10 ) {\n        velocity.y = 0\n        controls.getObject().position.y = 10\n        canJump = true\n      }\n    }\n    prevTime = time\n    renderer.render( scene, camera )\n  }\n\n  return <F>\n    <div ref={instructionsRef} />\n    <Blocker {...S} ref={blockerRef} />\n  </F>\n}\n\nexport default Loc\n","\nimport { Toast } from \"@capacitor/toast\"\nimport { ChevronLeft, ChevronRight, Menu as MenuIcon, } from '@material-ui/icons'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  ItemModal,\n  MapPanel, MapPanelNoZoom, MarkersList,\n  RatedRestrictionModal,\n  WrappedMapPanel,\n} from \"./\"\nimport { CitiesList } from \"$components/cities\"\nimport {\n  ThreePanelV1, ThreePanelV2,\n} from \"$components/locations3\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport {\n  C, Collapsible,\n  Loading, logg,\n  request,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\n/* C */\n\n/* D */\n\n// @TODO: move into shared\nconst _D = styled.div`\n  // border: 1px solid red;\n\n  padding: 10px;\n`;\nconst Description = ({ item={} }) => {\n  if (!item.description) { return }\n\n  return <_D dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\n/* H */\nconst WH = styled.div`\n  // border: 1px solid cyan;\n\n  position: fixed;\n  top: 5px;\n  left: ${p => p.foldedLeft\n    ? '10px'\n    : p.foldedRight\n    ? '98%'\n    : `calc(${p.twofoldPercent*100}% - 10px)` };\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  width: 30px;\n  height: 95%; /* @TODO: this needs to account for bottom being open */\n`;\nconst Handle = (props) => {\n  const [ w ] = useWindowSize()\n\n  const [ offsetX, setOffsetX ] = useState()\n  const [ dragging, setDragging ] = useState(false)\n\n  const foldLeft = () => {\n    if (folded === C.foldedRight) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedLeft)\n    }\n  }\n\n  const foldRight = () => {\n    if (folded === C.foldedLeft) {\n      setFolded(C.foldedCenter)\n    } else {\n      setFolded(C.foldedRight)\n    }\n  }\n\n  const {\n    folded, setFolded,\n    twofoldPercent, setTwofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const onMouseDown = (e) => {\n    setDragging(true)\n    setOffsetX(e.pageX)\n  }\n\n  const onMouseMove = (e) => {\n    if (!dragging) { return }\n    if (e.clientX === 0) { return }\n    const movedBy = e.clientX - offsetX\n    if (movedBy === 0) { return }\n    const movedByPercent = movedBy/w\n    setTwofoldPercent(prev => prev + movedByPercent)\n  }\n\n  const onMouseUp = (e) => {\n    setDragging(false)\n    // document.removeEventListener('mousemove', onMouseMove)\n    // document.removeEventListener('mousedown', onMouseDown)\n  }\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  // draggable=\"true\"\n  return <WH className=\"Handle\" {...{ foldedLeft, foldedRight, twofoldPercent }}\n    onMouseMove={onMouseMove}\n    onMouseDown={onMouseDown}\n    onMouseLeave={onMouseUp}\n    onMouseUp={onMouseUp}\n    style={{\n      pointer: 'cursor',\n    }}\n  >\n    <MenuIcon />\n    <ChevronLeft onClick={foldLeft} />\n    <ChevronRight onClick={foldRight} />\n    { [C.foldedRight, C.foldedLeft].indexOf(folded) !== -1  && <LongLine orientation={C.vertical} /> }\n  </WH>\n}\n\n/* I */\nconst IframeModal = (props) => {\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  return (<Modal ariaHideApp={false} isOpen={!!showUrl} >\n    <span onClick={() => {  setShowUrl(false) }} >[x]</span>\n\n    <iframe height=\"100%\" style={{ width: \"100%\", height: \"100%\" }} scrolling={\"yes\"} src={props.src}\n      frameBorder=\"no\" allowtransparency=\"true\" allowFullScreen={true} >\n    </iframe>\n  </Modal>)\n}\n\n/* L */\nconst Left = styled.div`\n  background: ${p => p.theme.colors.background};\n  flex: ${p => p.foldedRight ? '99%' : `${p.twofoldPercent*100}%` };\n  overflow: hidden;\n\n  display: flex;\n  flex-direction: column;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\n\n/* R */\n\nconst Right = styled.div`\n  background: ${p => p.theme.colors.background};\n  position: relative;\n\n  padding: 0 0 0 1em;\n  flex: ${p => p.foldedRight ? '2%' : `${(1-p.twofoldPercent)*100}%` };\n  overflow-x: hidden;\n  overflox-y: auto;\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n`;\n\nconst Row = styled.div`\n  // border: 1px solid magenta;\n\n  display: flex;\n  position: relative;\n`;\n\n\n/**\n * LocationsShowDesktop\n */\nconst LocationsShowDesktop = (props) => {\n  // logg(props, 'LocationsShowDesktop')\n  const { match } = props\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [ loading, setLoading ] = useState(false)\n  const [ location, setLocation ] = useState(null)\n  const [ markers, setMarkers ] = useState([])\n\n  const mountedRef = useRef('init')\n  const mapPanelRef = useRef(null)\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    itemToUnlock, setItemToUnlock,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    ratedConfirmation, setRatedConfirmation,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  useEffect(() => {\n    if (location) {\n      setMarkers(location.markers)\n\n      if (location.is_premium && !location.is_purchased) {\n        setItemToUnlock({ closable: false, item_type: 'Location', ...location })\n      }\n    }\n  }, [ location ])\n\n  const showToast = async (msg) => await Toast.show({ text: msg })\n\n  // Load the map\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) { return null }\n      if (!res.data.map) {\n        setLoading(false)\n        showToast('could not get Location')\n        logg('smth fuxed')\n        return null\n      }\n\n      setLocation(res.data.map)\n      if (res.data.map.rated === C.rated.nc17 && !ratedConfirmation) { // @TODO: not test-driven, bad!\n        setRatedConfirmation(false)\n      }\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  const foldedLeft = folded === C.foldedLeft\n  const foldedRight = folded === C.foldedRight\n\n  return <Row>\n    { !foldedLeft && <Left\n        className='Left'\n        {...{ bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      { <Breadcrumbs {...location} /> }\n      { location && <WrappedMapPanel\n        map={location.map ? location.map : location}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n      /> }\n    </Left> }\n\n    <Right\n        className='Right'\n        {...{\n          bottomDrawerOpen,\n          folded, foldedLeft, foldedRight,\n          twofoldPercent,\n        } }\n    >\n      <Handle />\n      { location && !foldedRight && <F>\n\n        { markers && markers.length && <Collapsible\n            config={{ collapsible: false }}\n            slug={C.collapsible.markers}\n            variant={C.variants.transparent}\n        >\n          <MarkersList markers={markers}\n            variant={C.variants.bordered}\n          />\n        </Collapsible> || null }\n\n        { location.description && <Collapsible\n            label={location.labels.description}\n            slug={C.collapsible.description}\n            variant={C.variants.bordered}\n        >\n          <Description item={location} />\n        </Collapsible> || null }\n\n        { location.newsitems && location.newsitems.length && <Newsitems\n            variant={C.variants.bordered} newsitems={location.newsitems}\n        /> || null }\n\n      </F> || null }\n    </Right>\n\n    { showUrl && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading && <Loading /> }\n    { !ratedConfirmation && <RatedRestrictionModal {...{ ratedConfirmation, setRatedConfirmation, }} /> }\n\n  </Row>\n}\n\nexport default LocationsShowDesktop\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  ItemModal,\n  MapPanel, MapPanelNoZoom, MarkersList,\n  WrappedMapPanel,\n} from \"./\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\nimport {\n  C, Collapsible, CollapsibleContext,\n  Loading, logg,\n  request,\n  S,\n  TwofoldContext,\n  useWindowSize,\n  ZoomContext,\n} from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 2px solid brown;\n\n  text-align: center;\n  display: block;\n\n  position: relative; /* required for mobile, so that zoomCtrl, etc are inside the collapsible div */\n\n  overflow: scroll;\n  max-height: 80vh; // @TODO: huh?\n`;\n\nconst CollapsibleNoMargins = styled(Collapsible)`\n  margin: 0;\n  padding: 0;\n`;\n\nconst _Description = styled.div`\n  // border: 1px solid red;\n\n  padding: 10px;\n`;\nconst Description = ({ item }) => {\n  return <_Description dangerouslySetInnerHTML={{ __html: item.description }} />\n}\n\nconst MapWrapper = styled.div`\n  // border: 1px solid red;\n\n  position: relative;\n`;\n\n\n/* W */\n\nconst W = styled.div`\n  // border: 1px solid yellow;\n`;\n\n/* Z */\n\nconst ZoomCtrlRoot = styled.div`\n  // border: 1px solid orange;\n\n  position: absolute;\n  top: 0;\n  left: calc(100vw - 80px);\n  background: white;\n  padding: 5px;\n\n  display: flex;\n  flex-direction: column;\n  z-index: 10;\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <ZoomCtrlRoot >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </ZoomCtrlRoot>\n}\n\n/**\n * LocationsShowMobile\n *\n */\nconst LocationsShowMobile = (props) => {\n  // logg(props, 'LocationsShowMobile')\n  const { match } = props\n\n  const {\n    bottomDrawerOpen,\n    folded, setFolded,\n    mapPanelWidth, setMapPanelWidth,\n    mapPanelHeight, setMapPanelHeight,\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n    twofoldPercent,\n  } = useContext(TwofoldContext)\n\n  const [ windowWidth, windowHeight ] = useWindowSize()\n\n  const [loading, setLoading] = useState(false)\n  const [location, setLocation ] = useState(null)\n\n  const mountedRef = useRef('init')\n  const mapPanelRef = useRef(null)\n\n  useEffect(() => {\n    setLoading(true)\n    const token = localStorage.getItem(\"jwt_token\")\n    request.get(`/api/maps/view/${match.params.slug}`, { params: { jwt_token: token } }).then(res => {\n      if (mountedRef.current === match.params.slug) return null\n      setLocation(res.data.map)\n      setLoading(false)\n      // @TODO: setFlash here?! If I\"m accessing a gallery I haven't bought access to?\n    }).finally(() => {\n    })\n\n    return () => {\n      mountedRef.current = match.params.slug\n    }\n  }, [ match.params.slug ])\n\n\n  // @TODO: this can probably be much improved. Take either markers of location.map, or location itself.\n  // @TODO: why is this a redirect to /null ?!\n  let markers = []\n  if (location) {\n    markers = location.markers // location ? location.markers.length ? location.markers : location.map.markers : null\n  }\n\n  // set mapPanel sizes\n  useEffect(() => {\n    if (mapPanelRef.current) {\n      setMapPanelWidth(mapPanelRef.current.offsetWidth)\n      setMapPanelHeight(mapPanelRef.current.offsetHeight)\n    }\n  }, [bottomDrawerOpen, folded, mapPanelRef.current, twofoldPercent, windowWidth, windowHeight])\n\n  return (<W className='LocationsShowMobile' >\n\n    { loading && <i>Loading...</i> }\n\n    { location && <Breadcrumbs {...location} /> }\n    { location && <Collapsible\n        label={location.labels.map}\n        slug={C.collapsible.map}\n    >\n      <WrappedMapPanel\n        map={location.map || location}\n        ref={mapPanelRef}\n        slug={match.params.slug}\n        withZoom={false}\n      />\n    </Collapsible> }\n\n    { /* @TODO: recursively render map (not location) as appropriate all around in these collapsibles. */ }\n    { markers && markers.length && <Collapsible\n        label={location.labels.markers}\n        slug={C.collapsible.markers}\n    >\n      <MarkersList markers={markers} />\n    </Collapsible> || null }\n    { location && location.description && <Collapsible\n        config={location.config.description}\n        label={location.labels.description}\n        slug={C.collapsible.description}\n    >\n      <Description item={location} />\n    </Collapsible> || null }\n    { location && location.newsitems.length && <Collapsible\n        label={location.labels.newsitems}\n        slug=\"news-sec\"\n    >\n      <Newsitems newsitems={location.newsitems} />\n    </Collapsible> || null }\n\n    { showUrl  && <IframeModal src={showUrl} /> }\n    { showItem && <ItemModal item={showItem} /> }\n    { loading  && <Loading /> }\n\n  </W>)\n}\n\nexport default LocationsShowMobile\n","import PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useRef } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport config from 'config'\nimport { logg, TwofoldContext } from \"$shared\"\n\nconst Div1 = styled.div`\n  // border: 3px solid green;\n\n  text-align: center;\n  display: block;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\n/* Same size as the map image.\n * What scrolls is this div, not the image inside it.\n */\nconst Img = styled.div`\n  // border: 2px solid cyan;\n  display: inline-block;\n  position: relative;\n`;\n\nconst Root = styled.div`\n  border: ${p=>p.debug?'1':'0'}px solid red;\n\n  position: relative;\n  overflow: auto;\n\n  height: calc(100vh - ${p => `calc(2*${p.theme.borderWidth})`}\n    - ${p => p.theme.breadcrumbsHeight}\n    - ${p => p.bottomDrawerOpen ? p.theme.bottomDrawerOpenHeight : p.theme.bottomDrawerClosedHeight });\n\n`;\n\nconst ZoomCtrl = (props) => {\n  const { zoom, setZoom } = useContext(TwofoldContext)\n\n  const zoomIn = () => {\n    setZoom(zoom/2)\n  }\n  const zoomOut = () => {\n    setZoom(zoom*2)\n  }\n  const zoomReset = () => {\n    setZoom(1)\n  }\n\n  return <div style={{\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    zIndex: 1,\n    background: 'white',\n    padding: '5px',\n\n    display: 'flex',\n    flexDirection: 'column',\n  }} >\n    <span onClick={zoomIn} >[+]</span>\n    <span onClick={zoomOut} >[-]</span>\n    <span onClick={zoomReset} >[1]</span>\n  </div>\n}\n\nconst MapPanel = (props) => {\n  // logg(props, 'MapPanel')\n  const { map, withZoom=true } = props\n\n  const {\n    bottomDrawerOpen, setBottomDrawerOpen,\n    showUrl, setShowUrl,\n    zoom, setZoom,\n  } = useContext(TwofoldContext)\n\n  const div1Ref = useRef(null)\n\n  const history = useHistory()\n\n  useEffect(() => {\n    // div1Ref.current.scrollIntoView({ block: 'end', inline: 'center' })\n    div1Ref.current.scroll({\n      top: 200,\n      left: 200,\n      behavior: 'smooth',\n     })\n  }, [])\n\n  const markers = []\n  map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => m.url ? setShowUrl(m.url) : history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: zoom > 1 ? ((m.y- m.centerOffsetY )/zoom) : ((m.y )/zoom- m.centerOffsetY),\n        left: zoom > 1 ? ((m.x- m.centerOffsetX )/zoom) : ((m.x )/zoom- m.centerOffsetX),\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w/zoom}px`,\n        maxHeight: `${m.h/zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <Root {...{ bottomDrawerOpen }} debug={config.debug} className='MapPanel' >\n    { withZoom && <ZoomCtrl /> }\n\n    <Div1 {...{ bottomDrawerOpen }} >\n      <Img ref={div1Ref} style={{\n        width: `${map.w/zoom}px`,\n        height: `${map.h/zoom}px`,\n      }} >\n        <img\n          src={map.img_path}\n          style={{\n            width: `${map.w/zoom}px`,\n            height: `${map.h/zoom}px`,\n          }}\n        />\n        { markers }\n      </Img>\n    </Div1>\n\n  </Root>\n}\n\nMapPanel.propTypes = {\n  map: PropTypes.object.isRequired,\n  withZoom: PropTypes.bool, // @TODO: I don't like it, I'd like it to be inside a config obj.\n}\nexport default MapPanel\n\n\n","import { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C, Collapsible, CollapsibleContext,\n  logg,\n  request,\n  S,\n  TwofoldContext,\n  WBordered,\n  ZoomContext,\n} from \"$shared\"\n\n\n// W\nconst W1 = styled.div`\n  display: inline-block;\n  position: relative;\n`;\n\n\n/*\n * _vp_ 2021-09 @TODO: merge this into MapPanel, have zoom={false} as a prop\n * But I couldn't do it in 10 mins... It's a bit complicated?\\\\\n * _vp_ 2021-10-29 But actually this component is getting more work than the zoom one right now...\n */\nconst MapPanelNoZoom = (props) => {\n  logg(props, 'MapPanelNoZoom')\n  const { map } = props\n\n  const history = useHistory()\n\n  const ctx = useContext(TwofoldContext)\n  logg(ctx, 'TwofoldContext')\n  const {\n    bottomDrawerOpen,\n    mapPanelWidth, mapPanelHeight,\n    zoom, setZoom,\n  } = ctx\n\n\n  // _vp_ 20211029 only sets the zoom (in panelNoZoom) to full-panel\n  // max width or height - fancy!\n  // responds to bottomDrawer!\n  // @TODO: make Left and Right arbitrarily resizable.\n  useEffect(() => {\n    let nextZoomByWidth = mapPanelWidth/map.w\n    let nextZoomByHeight = mapPanelHeight/map.h\n    let nextZoom = Math.min(nextZoomByWidth, nextZoomByHeight)\n    nextZoom = nextZoom - 0.01 // image should not overlap with the border... 1% slack added.\n    setZoom(nextZoom)\n  }, [mapPanelWidth, mapPanelHeight])\n\n\n  const markers = []\n  props.map.markers.map((m, idx) => {\n    const out = <div\n      key={idx}\n      onClick={() => history.push(`/en/locations/show/${m.slug}`) }\n      style={{\n        position: 'absolute',\n        top: m.y*zoom,\n        left: m.x*zoom,\n        zIndex: 2,\n      }} ><img src={m.img_path} style={{\n        display: 'block',\n        maxWidth: `${m.w*zoom}px`,\n        maxHeight: `${m.h*zoom}px`,\n        width: 'auto', height: 'auto',\n      }} /></div>\n    markers.push(out)\n  })\n\n  return <WBordered className=\"MapPanelNoZoom\" >\n    <W1 >\n      <img\n        src={map.img_path}\n        style={{\n          width: `${map.w*zoom}px`,\n          height: `${map.h*zoom}px`,\n\n          position: 'relative',\n          zIndex: 1,\n        }}\n      />\n      { markers }\n    </W1>\n  </WBordered>\n}\n\nexport default MapPanelNoZoom\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg, S, TwofoldContext,\n  WBordered, WBorderedItem,\n} from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\n/* M */\nconst _Marker = styled.div`\n  margin: 10px;\n  max-width: 20vw;\n  min-width: 120px;\n`;\nconst Marker = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBorderedItem {...props} >{children}</WBorderedItem>\n  } else {\n    return <_Marker {...props} >{children}</_Marker>\n  }\n}\n\n/* W */\nconst _W = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`;\nconst W = ({ children, variant, ...props }) => {\n  if (variant===C.variants.bordered) {\n    return <WBordered {...props}>{children}</WBordered>\n  } else {\n    return <_W {...props}>{children}</_W>\n  }\n}\n\n/**\n * Default\n * @TODO: test-driven\n */\nconst MarkersList = (props) => {\n  // logg(props, 'MarkersList')\n  const { variant } = props\n\n  const history = useHistory()\n  const { showUrl, setShowUrl } = useContext(TwofoldContext)\n\n  const goto = (m) => {\n    if (m.url) {\n      setShowUrl(m.url)\n    }\n    else {\n      history.push(`/en/locations/show/${m.slug}`)\n    }\n  }\n\n  const out = []\n  props.markers.map((m, idx) => {\n    out.push(<Marker className=\"Marker\" key={idx} variant={variant}\n      onClick={() => goto(m) }\n    >\n      <img src={m.title_img_path} /><br />\n      {m.name}\n    </Marker>)\n  })\n  return <W className=\"MarkersList\" >\n    {out}\n  </W>\n}\n\nMarkersList.propTypes = {\n  variant: PropTypes.string,\n}\nexport default MarkersList\n","\nimport { IonPage, IonContent, IonButton, IonImg, IonLoading } from \"@ionic/react\"\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport { Route, useLocation, useHistory, Switch } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport { C, logg, request, S, TwofoldContext, ZoomContext } from \"$shared\"\nimport { Metaline } from \"$components/application\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport { ReportsShow } from \"$components/reports\"\nimport { Newsitems } from \"$components/newsitems\"\n\n/*\n * RatedRestrictionModal\n */\nconst RatedRestrictionModal = (props) => {\n  // logg(props, 'RatedRestrictionModal')\n  const { ratedConfirmation, setRatedConfirmation } = props\n\n  return <Modal isOpen={!ratedConfirmation} >\n    <p>You must be 18 years of age or older to view this content.</p>\n    <button onClick={() => setRatedConfirmation(true) } >I am over 18</button>\n    &nbsp; &nbsp;\n    <button onClick={() => window.location = 'https://disney.com' } >I am NOT over 18</button>\n  </Modal>\n}\n\nexport default RatedRestrictionModal\n","\n\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport { ChevronLeft, ChevronRight, Menu as MenuIcon, } from '@material-ui/icons'\nimport React, { Fragment as F, useContext, useEffect, useRef, useState } from \"react\"\nimport Modal from \"react-modal\"\nimport styled from 'styled-components'\n\nimport {\n  Breadcrumbs,\n  ItemModal,\n  MapPanel, MapPanelNoZoom, MarkersList,\n} from \"./\"\nimport { CitiesList } from \"$components/cities\"\nimport {\n  ThreePanelV1, ThreePanelV2,\n} from \"$components/locations3\"\nimport { Newsitems } from \"$components/newsitems\"\nimport { LongLine } from \"$components/TwofoldLayout\"\nimport {\n  C, Collapsible,\n  logg,\n  request,\n  TwofoldContext,\n  useWindowSize,\n} from \"$shared\"\n\n/* W */\nconst W = styled.div`\n  overflow: hidden;\n\n  flex-grow: 1;\n`;\n\n/**\n * Renders either MapPanel (W really, a simple wrapper), MapPanelNoZoom, or ThreePanelV1\n */\nconst WrappedMapPanel = React.forwardRef((props, ref) => {\n  switch (props.map.config.map_panel_type) {\n    case C.map_panel_types.MapPanelNoZoom:\n      return <W ref={ref} className=\"WrappedMapPanel\" ><MapPanelNoZoom withZoom={false} {...props} /></W>\n    case C.map_panel_types.ThreePanelV1:\n      switch (props.slug) {\n        case 'threev1':\n          return <W><ThreePanelV1 {...props} /></W>\n        case 'threev2':\n          return <W><ThreePanelV2 {...props} /></W>\n        default:\n          throw 'this 3d panel is not implemented'\n      }\n    default:\n      return <W ref={ref} className=\"WrappedMapPanel\" ><MapPanel {...props} /></W>\n  }\n})\nexport default WrappedMapPanel\n\n","\nimport PropTypes from 'prop-types'\nimport { Grid } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\n\nconst Label = styled.div``;\n\nconst Features = ({ features, label, ...props }) => {\n  logg(props, 'Features')\n\n  const out = []\n  features.map((f) => {\n    if (f.inner_html) {\n      out.push(<Grid item sm={3} dangerouslySetInnerHTML={{ __html: f.inner_html }} />)\n    }\n  })\n\n  return <F>\n    {label && <Label>{label}</Label>}\n    <Grid style={{ marginBottom: '1em' }} container spacing={2}>\n      { out }\n    </Grid>\n  </F>\n}\n\nFeatures.propTypes = {\n  features: PropTypes.arrayOf(PropTypes.shape({\n    inner_html: PropTypes.string,\n  }) ),\n  label: PropTypes.string,\n}\nexport default Features","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  MainHeader,\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\nconst SitesShow = (props) => {\n  logg(props, 'SitesShow')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ loading, setLoading ] = useState(false)\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  useEffect(() => {\n    api.applicationHome().then(data => {\n      if (!mountedRef.current) { return null }\n      logg(data, 'setSite')\n      setSite(data)\n      setLoading(false)\n    })\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n      { /* <Hero /> */ }\n      <MainHeader />\n\n      <Features features={site.features} />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow\n","import { IonPage, IonLoading, IonContent } from '@ionic/react'\nimport React, { Fragment as F, useEffect, useRef, useState } from \"react\"\nimport styled from 'styled-components'\n\nimport { C, logg, useApi, } from \"$shared\"\nimport { Features } from \"./\"\nimport {\n  BottomDrawer,\n  MainHeader, Menu, MenuBottom, MenuLeft,\n  UnlockModal\n} from \"$components/application\"\nimport { Newsitems } from \"$components/newsitems\"\n\nconst _Hero = styled.div`\n  height: 370px;\n  text-align: center;\n\n  img {\n    max-width: 100%;\n  }\n`\nconst Hero = () => <_Hero><img className=\"image\" src=\"/assets/hero.png\" /></_Hero>\n\nconst Root = styled.div`\n  margin: 0;\n  padding-bottom: 1em;\n`\n\n// Currently a homepage, like a wp page.\nconst SitesShow1 = (props) => {\n  logg(props, 'SitesShow')\n\n  let [ site, setSite ] = useState({ features: [], newsitems: [] })\n  let [ artTag, setArtTag ] = useState({ features: [] })\n  let [ homeRow1Tag, setHomeRow1Tag ] = useState({ features: [] })\n  let [ interestingLocationsTag, setInterestingLocationsTag ] = useState({ features: [] })\n  let [ loading, setLoading ] = useState(false)\n\n\n  const api = useApi()\n  const mountedRef = useRef('init')\n\n  // loads all data\n  useEffect(() => {\n    // setLoading(true)\n\n    api.applicationHome().then(data => {\n      if (!mountedRef.current) { return null }\n      logg(data, 'setSite')\n      setSite(data)\n      // setLoading(false)\n    })\n\n    api.getTag({ slug: 'interesting-locations' }).then(data => {\n      if (!mountedRef.current) { return null }\n      logg(data, 'setInterestingLocations')\n      setInterestingLocationsTag(data)\n      // setLoading(false)\n    })\n\n    api.getTag({ slug: 'home-row-1' }).then(data => {\n      if (!mountedRef.current) { return null }\n      setHomeRow1Tag(data)\n    })\n\n    api.getTag({ slug: 'art' }).then(data => {\n      if (!mountedRef.current) { return null }\n      setArtTag(data)\n    })\n\n    return () => { mountedRef.current = false }\n  }, [])\n\n  return <F>\n    <Root>\n\n      <MainHeader />\n      { /* <Hero /> */ }\n\n      <Features features={interestingLocationsTag.features} label=\"Interesting Locations\" />\n      <Features features={homeRow1Tag.features} label=\"Interesting Tags\" />\n      <Features features={artTag.features} label=\"art\" />\n      <Newsitems newsitems={site.newsitems} />\n    </Root>\n    <IonLoading\n      isOpen={loading}\n      onDidDismiss={() => setLoading(false)}\n      message={'Please wait...'}\n      duration={5000}\n    />\n  </F>\n}\n\nexport default SitesShow1\n","import { IonPage, IonContent, IonIcon, IonLoading } from '@ionic/react';\nimport { Container, Grid, GridList } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useState } from \"react\";\nimport styled from 'styled-components'\nimport config from \"config\";\n\nimport { useApi, logg, request } from \"$shared\";\n\nconst useStyles = makeStyles((theme) => ({\n\n  paper: {\n    padding: theme.spacing(2),\n    textAlign: 'center',\n    color: theme.palette.text.secondary,\n  },\n  redBorder: {\n    border: '1px solid red',\n  },\n  root: {\n    flexGrow: 1,\n    overflow: 'scroll',\n    height: '100vh',\n  },\n\n}));\n\nconst VideoItem = styled.div`\n  border-bottom: 1px solid red;\n`;\n\nconst Video = (props) => {\n  logg(props, 'Video');\n  const api = useApi()\n\n  const { item: video } = props;\n\n  return <VideoItem key={props.idx} >\n    <h5>Video {video.name}</h5>\n    <p>created {video.created_at}</p>\n    <video controls preload=\"metadata\" type=\"video/mp4\" src={video.video_url}\n      style={{ maxWidth: '500px', maxHeight: '90vh' }} ></video>\n  </VideoItem>;\n};\n\nconst Videos = () => {\n  logg(config, 'Videos component');\n  console.log(JSON.stringify(config));\n\n  const [videos, setVideos] = useState([]);\n\n  const jwtToken = localStorage.getItem(\"jwtToken\");\n\n  const classes = useStyles();\n  const api = useApi()\n\n  useEffect(() => {\n    logg('posting...');\n    request.post(api.myVideosPath, { jwtToken: jwtToken }).then(r => r.data\n      ).then(({ videos }) => {\n        logg(videos, 'data')\n        setVideos(videos);\n      })\n  }, []);\n\n  return <Container maxWidth=\"md\">\n    <Grid container className={classes.root} >\n      <Grid item xs={12} >\n        <h2>My Videos</h2>\n      </Grid>\n      <Grid item xs={12}>\n        { videos && videos.map((v, idx) => <Video key={idx} item={v} ></Video> ) }\n      </Grid>\n    </Grid>\n  </Container>;\n\n};\n\nexport default Videos;\n","\n\nimport { Container as _Container, Grid, GridList } from '@material-ui/core'\nimport React, { Fragment as F, useEffect, useRef, useState } from 'react'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\n\nimport './theme/variables.css'\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport config from \"config\"\nimport {\n  BottomDrawer,\n  MainHeader, Menu, MenuBottom, MenuLeft,\n  UnlockModal\n} from \"$components/application\"\nimport MapuiLayout from \"$components/application/MapuiLayout\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\n// @TODO: MyGalleries doesn't look right...\nimport { GalleriesShow, MyGalleries } from \"$components/galleries\"\nimport { LocationsShowDesktop } from \"$components/locations\"\nimport Three from \"$components/locations3/ThreePanelV1\"\nimport { ReportsShow } from \"$components/reports\"\n// import { SitesShow } from '$components/sites'\nimport SitesShow from '$components/sites/SitesShow1'\nimport { Account, LoginModal } from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport {\n  C, CollapsibleContext, CollapsibleContextProvider,\n  Debug, logg, request, TwofoldContext, TwofoldContextProvider , useApi,\n} from \"$shared\"\n\nconst Root = styled.div`\n  // border: 1px solid #741741;\n\n  background: #dedede;\n  height: 100vh;\n  overflow: auto;\n`;\n\n\nconst AppDesktop = (props) => {\n  // logg(props, 'AppDesktop')\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = props\n\n  const api = useApi()\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n\n  const Container = (props) => {\n    switch(layout) {\n      case C.layout_onecol:\n        // main case\n        return <_Container maxWidth=\"md\" {...props} />\n      case C.layout_mapui:\n        return <MapuiLayout {...props} />\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  return (<Router>\n\n\n    <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n      <CollapsibleContextProvider >\n        <Root>\n\n          { /* This no more, if I want it to look like Financial Times */ }\n          { /* layout === C.layout_onecol && <MenuLeft variant={C.variants.floating} /> */ }\n          { /* <MainHeader /> */ }\n\n          <Container >\n            <Switch id=\"main\" main >\n\n              <Redirect exact from=\"/\" to={config.homeLocation} />\n              <Route exact path=\"/en\" ><SitesShow /></Route>\n\n              <Route exact path=\"/en/account\" component={Account} />\n              <Route exact path=\"/en/account/my/videos\" component={Videos} />\n              <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n              <Route exact path=\"/en/cities\"                 component={CitiesList} />\n              <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n              <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n              <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n              <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowDesktop} layout={C.layout_mapui} />\n\n            </Switch>\n          </Container>\n        </Root>\n\n        <BottomDrawer />\n        <UnlockModal />\n        <LoginModal />\n        <ToastContainer />\n\n      </CollapsibleContextProvider>\n    </TwofoldContextProvider>\n  </Router>)\n}\n\nexport default AppDesktop\n","import { Container as _Container, Grid, GridList } from '@material-ui/core'\n\nimport React, { Fragment as F, useEffect, useState } from 'react'\nimport Modal from \"react-modal\"\nimport {\n  Switch, BrowserRouter as Router, Redirect, Route as _Route,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport '@ionic/react/css/core.css'\nimport '@ionic/react/css/normalize.css'\nimport '@ionic/react/css/structure.css'\nimport '@ionic/react/css/typography.css'\nimport '@ionic/react/css/padding.css'\nimport '@ionic/react/css/float-elements.css'\nimport '@ionic/react/css/text-alignment.css'\nimport '@ionic/react/css/text-transformation.css'\nimport '@ionic/react/css/flex-utils.css'\nimport '@ionic/react/css/display.css'\nimport './theme/variables.css'\n\nimport config from \"config\"\nimport { BottomDrawer, Menu, MenuBottom, MenuLeft, UnlockModal } from \"$components/application\"\nimport { MapuiMobileLayout } from \"$components/application\"\nimport { CitiesList, CitiesShow } from \"$components/cities\"\nimport { GalleriesShow } from \"$components/galleries\"\nimport { LocationsShowMobile } from \"$components/locations\"\nimport { ReportsShow } from \"$components/reports\"\nimport { SitesShow } from '$components/sites'\nimport { Account, LoginModal } from \"$components/users\"\nimport { Videos } from \"$components/videos\"\nimport { Galleries, MyGalleries } from \"$components/galleries\"\nimport { useApi, C, CollapsibleContextProvider, Debug, logg, request, TwofoldContextProvider } from \"$shared\"\n\nconst Root = styled.div`\n\n\n  background: #dedede;\n  height: 100vh;\n  overflow: auto;\n`;\n\nconst __Container = styled(_Container)`\n\n  padding: 0;\n  height: 100vh;\n  overflow: scroll;\n`;\n\nconst AppMobile = (props) => {\n  logg(props, 'AppMobile')\n  const { currentUser, setCurrentUser } = props\n\n  const [ layout, setLayout ] = useState(C.layout_onecol)\n  const [ bottomDrawerOpen, setBottomDrawerOpen ] = React.useState(false)\n  const [ itemToUnlock, setItemToUnlock ] = React.useState(false)\n  const [ zoom, setZoom ] = useState(1)\n  const api = useApi()\n\n  const Container = (props) => {\n    switch(layout) {\n      case C.layout_onecol:\n        return <__Container maxWidth=\"md\" {...props} />\n      case C.layout_mapui:\n        // This is true right now (2021-10-20) for mobile even when it's one column\n        return <MapuiMobileLayout {...props} {...{ bottomDrawerOpen, setBottomDrawerOpen }} />\n    }\n  }\n\n  const Route = (props) => {\n    useEffect(() => {\n      if (props.layout) {\n        setLayout(props.layout)\n      } else {\n        setLayout(C.layout_onecol)\n      }\n    }, [props.layout])\n\n    return <_Route {...props} />\n  }\n\n  const doUnlock = async () => {\n    // @TODO: check how many unlocks I have, and offer to purchase more if not enough.\n    const path = api.doUnlock({ kind: 'Report', id: itemToUnlock.report_id });\n    const result = await request.post(`${config.apiOrigin}${path}`);\n    logg(result, 'result of unlocking')\n  };\n\n  return (<Router>\n    <TwofoldContextProvider {...props} {...{ layout, setLayout }} >\n      <CollapsibleContextProvider >\n        { layout === C.layout_onecol && <MenuLeft variant={C.variants.floating} /> }\n        <Root className=\"Root\" >\n\n          <Container className=\"Container\" >\n            <Switch id=\"main\" main >\n\n              <Redirect exact from=\"/\" to={config.homeLocation} />\n              <Route exact path=\"/en\" ><SitesShow /></Route>\n\n              <Route exact path=\"/en/account\" component={Account} />\n              <Route exact path=\"/en/account/my/videos\" component={Videos} />\n              <Route exact path=\"/en/account/my/galleries\" component={MyGalleries} />\n\n              <Route exact path=\"/en/cities\"                 component={CitiesList} />\n              <Route       path=\"/en/cities/travel-to/:name\" component={CitiesShow} />\n\n              <Route exact path=\"/en/galleries/show/:slug\" component={GalleriesShow} />\n\n              <Route exact path=\"/en/reports/show/:slug\" component={ReportsShow} />\n\n              <Route exact path=\"/en/locations/show/:slug\" component={LocationsShowMobile} layout={C.layout_mapui} />\n\n            </Switch>\n          </Container>\n        </Root>\n\n        <BottomDrawer />\n        <UnlockModal />\n        <LoginModal />\n\n      </CollapsibleContextProvider>\n    </TwofoldContextProvider>\n  </Router>)\n}\n\nexport default AppMobile\n","\nimport { Device } from '@capacitor/device'\nimport React, { useContext, useEffect, useRef, useState, } from 'react'\nimport { ThemeProvider } from 'styled-components'\n\nimport config from 'config'\nimport { C, logg, request, S, useApi } from \"$shared\"\nimport AppDesktop from './AppDesktop'\nimport AppMobile from './AppMobile'\n\n/**\n * Choses mobile vs desktop\n */\nconst AppWrapper = (props) => {\n  // logg(props, 'AppWrapper')\n  const api = useApi()\n\n\n  const [ currentUser, setCurrentUser ] = useState(false)\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n  const mountedRef = useRef('init')\n  useEffect(() => {\n    const fn = async () => {\n      const jwtToken = localStorage.getItem(C.jwt_token)\n      await request.get(`${config.apiOrigin}${api.myAccount()}?jwt_token=${jwtToken}`).then((r) => {\n        if (!mountedRef.current) { return }\n        setCurrentUser(r.data)\n      }).catch((e) => {\n        logg(e, 'e12')\n        if (e.message === \"Request failed with status code 401\") {\n          if (config.requireLogin || typeof config.requireLogin === 'undefined') {\n            setLoginModalOpen(true)\n          }\n        }\n      })\n    }\n    fn()\n    return () => mountedRef.current = null\n  }, [currentUser]) // @TODO: currentUser here is appropriate?\n\n\n  const [ os, setOs ] = useState(null)\n  // info.operatingSystem === 'ios' || 'android'\n  const fn = async () => {\n    let info = await Device.getInfo()\n    setOs(info.operatingSystem)\n  }\n  fn()\n\n\n  const childProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }\n\n  if (!os) { return null }\n  return <ThemeProvider theme={S} >\n    { \"ios android\".includes(os) ?\n      <AppMobile {...childProps} />\n      : <AppDesktop {...childProps} /> }\n  </ThemeProvider>\n}\n\nexport default AppWrapper\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppWrapper from './AppWrapper'\nimport * as serviceWorker from './serviceWorker'\nimport {\n  Link, Switch, BrowserRouter as Router, Redirect, Route as _Route, useHistory, withRouter\n} from 'react-router-dom'\n\nReactDOM.render(<AppWrapper />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n\n\n\n"],"sourceRoot":""}